{"version":3,"sources":["tui2.js"],"names":["__extends","this","d","b","__","constructor","p","hasOwnProperty","prototype","Object","create","lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","tui","dict","lang","translator","toLowerCase","_dict","str","func","cloneInternal","obj","excludeProperties","UNDEFINED","Array","newArray","idx","indexOf","push","newObj","clone","$","trim","JSON","parse","stringify","undefined","navigator","language","browserLanguage","userLanguage","tuid","EventObject","_events","bind","eventName","handler","atFirst","handlers","i","splice","unbind","on","envs","split","v","once","isOnce","off","offAll","key","fire","data","wildcardHandlers","concat","eventInfo","event","removeArray","val","call","ieVer","rv","appName","ua","userAgent","re","RegExp","exec","parseFloat","$1","ffVer","success","notmodified","error","timeout","abort","parsererror","ok","close","cancel","accept","agree","reject","yes","no","text","parseBoolean","value","isNaN","String","format","token","params","_i","arguments","formatrg","replace","toDashSplit","word","buffer","c","charAt","code","charCodeAt","toCamel","strict","upperFlag","toUpperCase","paddingNumber","min","alignLeft","result","abs","substr","getUrlParam","url","regex","results","decodeURIComponent","getUrlAnchor","anchor","match","isAbsUrl","getBaseUrl","matcher","prefix","pos","substring","lastIndexOf","joinUrl","urls","_a","urls_1","u","service","service_1","parseParameters","fn","desc","matched","toString","use","argv","map","s","get","apply","getName","path","begin","end","load","services","names","_serviceReady","tasks","name","ajax","getFunction","when","done","register","ready","fail","Service","_constructor","_services","name_1","service_2","_readyCallbacks_1","_readyCallbacks","cb","onReady","_super","widget","getEventPosition","e","positions","originalEvent","changedTouches","touch","clientX","y","clientY","openDragMask","onMove","onClose","closeDragMask","_maskOpened","_mask","setCapture","document","browser","removeNode","preventDefault","innerHTML","className","style","cursor","removeAttribute","body","appendChild","createElement","setAttribute","onselectstart","mousewheelevt","test","ev","stopPropagation","widget_1","parseValue","eval","console","nodeName","widgetRegistration","getClassName","__widget__","elem","getElementById","namedWidgets","type","initParam","TypeError","Error","element","set","getFullName","targetElem","scopeName","init","parent","initFunc","searchInitCtrls","childNodes","node","nodeType","item","initSet","initSet_1","widget_3","refresh","widget_2","search","p1","p2","searchElem","widget_4","filter","searchArea","registerResize","resizeRegistration","WidgetBase","_data","_rs","setRestriction","propCtrl","setRestrictions","restrictions","render","getComponent","dataStr","getAttribute","tmpData","_set","attributes","attr","names_1","name_2","removeNamedItem","defaultValue","setInit","Widget","root","_lastWidth","_lastHeight","_components","_","initRestriction","childNodes_1","initChildren","appendTo","detach","_this","oldId","parentNode","disable","parent_1","group","Group","tooltip","follow-tooltip","testResize","isInDoc","offsetWidth","offsetHeight","focus","Item","detectResize","nodes","getElementsByTagName","j","reorder","dialogStack","insertBefore","dlg","remove","index","removeChild","getParent","disableSelect","Dialog","_sizeTimer","_contentSize","_moved","_init","div","childNodes_2","root$","html","titleBar","children","contentDiv","buttonBar","closeIcon","content","onclick","o","target","srcElement","dialogX","offsetLeft","dialogY","offsetTop","beginX","beginY","winSize","width","height","l","t","left","top","setContent","display","setButtons","buttonDef","_loop_1","name_3","pair","btn","button","names_2","open","css","position","setInterval","scrollHeight","scrollWidth","clearInterval","titleText","maxHeight","maxWidth","outerHeight","box","centX","centY","k","keyCode","KeyCode","ESCAPE","TAB","isPosterity","activeElement","resize","makeContent","message","makeDialog","title","esc","addClass","msgbox","infobox","okbox","errbox","warnbox","askbox","buttonName","waitbox","waitDlg","refCount","waitMsg","closed","setMessage","progressbox","cancelProc","send","method","options","deffered","Deferred","ajaxData","contentType","complete","jqXHR","status","respJson","getResponseHeader","respVal","responseJSON","responseText","resolve","respText","plainType","processData","post","post_","silent","get_","getScript","xhr","XMLHttpRequest","onreadystatechange","readyState","getHtmlBody","TAG","lastIndex","m","bodyStart","bodyEnd","tag","SCRIPT_END","scriptEnd","getBody","child","param","ajaxSetup","xhrFields","withCredentials","$ajax","$post","$post_","$get","$get_","backupScrollPosition","BackupedScrollPosition","focusWithoutScroll","setActive","backup","restore","scrollToElement","distance","useAnimation","param_1","getWindowScrollElement","animate","scrollTop","offset","toElement","withParentDiv","el","firstChild","toHTML","toSafeText","args","nodeText","createTextNode","buf","nodeValue","getNodeText","setNodeText","getNodeOwnText","getRectOfParent","getRectOfPage","getRectOfScreen","$doc","scrollLeft","getTopBody","getWindow","ownerDocument","defaultView","parentWindow","documentElement","keepTopProc","scrollWindow","keepTopList_1","keepTopList","rect","oldPosition","oldTop","oldLeft","oldWidth","oldZIndex","zIndex","clientWidth","itemLeft","keepTop","keepToTop","cancelKeepToTop","newList","keepTopList_2","getCurrentStyle","currentStyle","getComputedStyle","isLButton","which","banBackspace","ban","vReadOnly","readOnly","vDisabled","disabled","flag1","flag2","cancelDefault","returnValue","cancelBubble","isAncestry","isFireInside","parentElement","saveCookie","expires","domain","secure","today","setTime","expires_date","cookie","encodeURIComponent","toUTCString","loadCookie","arr","deleteCookie","saveData","sessionOnly","storage","sessionStorage","localStorage","setItem","loadData","getItem","deleteData","removeItem","accelerate","ctrlKey","altKey","shiftKey","metaKey","_accMap","addAccelerate","actionId","deleteAccelerate","reg","r","location","allFingers","touches","touchList","identifier","setInnerHtml","backupInfo","scroll","keydown","$text","hashChange","hash","state","_rules","matchRule","_rules_1","_rules_2","_handler","startRouter","rules","stopRouter","fileFromPath","file","getExt","createUploader","container","Uploader","_settings","action","multiple","autoSubmit","_container","_input","setOptions","getOptions","createIframe","iframe","doc","contentDocument","frames","charset","createForm","settings","form","createInput","input","right","margin","padding","opacity","fontSize","fontFamily","fileExt","ext","clearInput","submit","overflow","blur","deleteInput","getInput","processResponse","toDeleteFlag","src","response","normalize","responseObj","fireError","fileId","fileName","fireInvalidError","errorMessage","submitV5","extraData","fd","FormData","files","append","upload","addEventListener","lengthComputable","percentComplete","round","loaded","total","statusText","submitV4","prop","ds","filter_1","f","sort","order","treeData","a","order_1","aVal","bVal","DSBase","_finalData","_order","_filter","setOrder","build","getOrder","setFilter","getFilter","List","array","completely","RemoteList","cacheSize","_cache1","_cache2","_length","_cacheSize","reset","size","getFromCache","page","getIndexPage","_fillCache","rder","ceil","cache","update","TreeBase","_index","_rawData","getConfig","_config","getRawData","findNodeIndex","expandItems","items","level","items_1","expand","hasChild","getExpandCount","delCount","children_1","appendNodes","collapse","Tree","config","iterate_1","items_2","RemoteTree","_querying","time","now","timespan","seconds","beg","floor","h","dateDiff","dt1","dt2","unit","d1","d2","diff","symbol","toLocaleLowerCase","NaN","dateAdd","dt","tm","getFullYear","getMonth","getDate","getHours","mi","getMinutes","getSeconds","ms","getMilliseconds","totalMonth","newDate","totalDaysOfMonth","dayOfYear","parseDateInternal","dtStr","matchEnum","enumArray","join","values","matchNumber","len","num","parseInt","mapping","gcount","isUTC","rule","y+","M+","shortMonths","months","d+","D+","h+","H+","m+","s+","[qQ]+","S+","E+","shortWeeks","weeks","a|A","z+","tz","Z","\"[^\"]*\"|'[^']*'","[^yMmdDhHsSqEaAzZ'\"]+","parseCount","hour","year","getUTCFullYear","month","getUTCMonth","date","getUTCDate","ampm","h12","minute","second","millisecond","getTimezoneOffset","setUTCFullYear","setUTCMonth","setUTCDate","setUTCHours","setUTCMinutes","setUTCSeconds","setUTCMilliseconds","parseDate","formatDate","dateFmt","fullYear","hours","getUTCHours","minutes","getUTCMinutes","getUTCSeconds","milliseconds","getUTCMilliseconds","day","getUTCDay","getDay","q+","A","regexp","source","z","Button","checked","tristate","$root","unselectable","mousedown","mouseup","keyup","onClick","groupName","result_1","click","removeClass","removeAttr","Check","Radio","formatNumber","maxValue","setText","tb","line","column","cell","rows","cells","innerText","Calendar","setFullYear","setMonth","setDate","setHours","setMinutes","setSeconds","getMaxValue","tabIndex","insertRow","insertCell","timebar","getInputTime","timebar$","o$","LEFT","RIGHT","UP","select","DOWN","KEY_0","KEY_9","_lastInputTime","newTime","hasClass","prevMonth","prevYear","nextYear","nextMonth","onPicked","dblclick","oldTime","makeTime","proc","firstDay","firstWeek","daysOfMonth","offsetMonth","preMonthDay","valueOf","childNodes_3","children_2","children_3","result_2","ButtonGroup","check","children_4","children_5","children_6","widget_5","Component","checkReady","hasHandler","hasSrc","_scriptReady","_htmlReady","_changed","_childrenInit","_noReadyCount","_fn","oldValue","loadComponents","parentUrl","getParentUrl","getNodeName","href","widget_6","name_4","fullName","","forEach","n","VALIDATORS","*email","*chinese","*url","*digital","*integer","*float","*number","*currency","*date","*key","*any","InputBase","_valid","_invalidMessage","validators","childNodes_4","validator","updateEmptyState","empty","_isEmpty","validate","validator_1","imaxLen","ival","iminLen","imax","imin","other","otherText","valid","SelectBase","_inSelection","closeSelect","popup","createPopup","label","iconRight","iconInvalid","clearButton","openSelect","keypress","charCode","SPACE","noValue","PADDING","SelectPopupBase","DatePicker","calendar","timeBar","toolbar","borderWidth","todayButton","clearable","outline","File","_uploader","onblur","Frame","_cache","_go","go","vval","Grid","_setupHeadMoveListener","_columnWidths","_vLines","_handlers","updateCallback","me","drawContent","selectable","lineHeight","LINE_HEIGHT","dataType","_vbar","_hbar","list","tree","columns","clearBuffer","activeRow","_buffer","lines","row","activeRowData","_tuid","head","direction","createStyleSheet","_gridStyle","computeHOffset","delta","detail","wheelDelta","step","scrollSize","lastPos","scrollX","lastSpeed","scrollY","inTouched","targetTouches","pageX","pageY","hittestTimer","movePos","moveX","moveY","currentTime","spanTime","keepMove","timestamp","srcX","clientHeight","mask","initColumnWidth","computeScroll","computeColumnWidth","drawHeader","hittest","col","testLine","checkKey","drawLine","ENTER","scrollTo","PRIOR","_dispLines","NEXT","HOME","END","sortable","sortType","setSortFlag","iterate","iterateItem","treeItem","childrenKey","rawData","listItem","activeTo","dataKey","matchPath","treeNode","searchPath","searchLevel","found","pop","i_1","i_2","computeWidth","contentWidth","CELL_SPACE","vScroll","vEnable","hScroll","hEnable","_contentHeight","_contentWidth","computeV","first","realClientHeight","shouldEnable","computeH","realClientWidth","dispHeight","lineData","isTree","tipKey","span","arrow","iconKey","prefixContent","prefixKey","prefixSpan","suffixContent","suffixKey","suffixSpan","moveLine","base","createLine","sortClass","vbar","newBuffer","reusable","_drawTimer","used","totalNoBorder","totalNoFixed","totalCompute","fixed","cssText","i_3","i_4","_column","nameKey","checkable","checkedValues","valueKey","checkedNames","selectAll","deselectAll","Input","textbox","onInput","placeholder","iconLeft","propertyName","BACK","marginLeft","marginRight","phText","showPh","findPopupToClose","bindElem","popStack","Popup","popIndex","referRect","checkInterval","refProc","childNodes_5","stopImmediatePropagation","refer","SyntaxError","newRect","closeSelf","ww","wh","ew","eh","compute","L","R","T","B","Menu","activeItem","hasChildItem","addChild","menuItem","icon","shortcut","addChildren","data_1","findMenuItemDiv","findDivIndex","activeLine","ie8hack","deactiveLine","mousemove","openSubMenuTimer","openSubMenu","mouseleave","data_2","it","findItem","from","stopEvent","div_1","itemIndex_1","childItems","subMenu","Navigator","_activeItem","naviItem","checkScroll","up","down","findLine","scrollbarWidth","onscroll","$elem","active","next","rc","drawItems","items_3","$line","space","subArea","_activeBy","prev","activeBy","Scrollbar","dir","btnThumb","thumbLen","offsetY","layerY","offsetX","layerX","posToValue","beginLeft","beginTop","dragThumb","dragEnd","valueToPos","minSize","vertical","scale","Select","LIST_LINE_HEIGHT","updateTextByValue","selection","getSelection","multiSelect","showCount","count","canSearch","changeSize","textKey","selectedItems_1","selectedItem_1","selected","reduce","searchbar","searchBox","rowData","searchValue","minWidth","checkButtons","DialogSelect","dialog","Textarea","oldHeight","_lastTextHeight","showTooltip","show","_tooltip","_tooltipTarget","whiteSpace","hasAttribute","closeTooltip","whetherShowTooltip","_tooltipTimer","whetherCloseTooltip","_hoverElement"],"mappings":"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","file":"tui2.min.js","sourcesContent":["var __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function () {\n    var lastTime = 0;\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\n    for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n        window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n            window[vendors[x] + 'CancelRequestAnimationFrame'];\n    }\n    if (!window.requestAnimationFrame)\n        window.requestAnimationFrame = function (callback) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(function () {\n                callback(currTime + timeToCall);\n            }, timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n    if (!window.cancelAnimationFrame)\n        window.cancelAnimationFrame = function (id) {\n            clearTimeout(id);\n        };\n}());\n/// <reference path=\"jquery.d.ts\" />\n/// <reference path=\"animation.ts\" />\nvar tui;\n(function (tui) {\n    \"use strict\";\n    tui.UNDEFINED = (function (undefined) {\n        return typeof undefined;\n    })();\n    // Used to decide which language should be used to display UI control\n    tui.lang = (function () {\n        return (navigator.language || navigator.browserLanguage || navigator.userLanguage).toLowerCase();\n    })();\n    var _dict = {};\n    function dict(lang, translator) {\n        if (!lang)\n            return;\n        if (typeof lang === \"string\")\n            lang = lang.toLowerCase();\n        if (typeof translator === \"function\")\n            _dict[lang] = translator;\n        else if (typeof translator === \"object\" && translator !== null) {\n            _dict[lang] = function (str) {\n                return translator[(str + \"\").toLowerCase()] || str;\n            };\n        }\n    }\n    tui.dict = dict;\n    /**\n     * Multi-language support, translate source text to specified language(default use tui.lang setting)\n     * @param str {string} source text\n     * @param lang {string} if specified then use this parameter as objective language otherwise use tui.lang as objective language\n     */\n    function str(str, lang) {\n        if (!lang) {\n            if (!tui.lang)\n                lang = \"en-us\";\n            else\n                lang = tui.lang.toLowerCase();\n        }\n        var func = _dict[lang];\n        if (typeof func === \"function\") {\n            return func(str);\n        }\n        else {\n            func = _dict[\"en-us\"];\n            if (typeof func === \"function\")\n                return func(str);\n            else\n                return str;\n        }\n    }\n    tui.str = str;\n    tui.tuid = (function () {\n        var id = 0;\n        return function () {\n            return ('tuid-' + id++);\n        };\n    })();\n    /**\n     * Base object, all other control extended from this base class.\n     */\n    var EventObject = (function () {\n        function EventObject() {\n            this._events = {};\n        }\n        /**\n         * Register event handler.\n         * @param {string} eventName\n         * @param {EventHandler} handler Which handler to be registered\n         * @param {boolean} atFirst If true then handler will be triggered firstly\n         */\n        EventObject.prototype.bind = function (eventName, handler, atFirst) {\n            if (!eventName)\n                return this;\n            if (!this._events[eventName]) {\n                this._events[eventName] = [];\n            }\n            var handlers = this._events[eventName];\n            for (var i = 0; i < handlers.length; i++) {\n                if (handlers[i] === handler)\n                    return this;\n            }\n            if (atFirst)\n                handlers.splice(0, 0, handler);\n            else\n                handlers.push(handler);\n            return this;\n        };\n        /**\n         * Unregister event handler.\n         * @param eventName\n         * @param handler Which handler to be unregistered if don't specified then unregister all handler\n         */\n        EventObject.prototype.unbind = function (eventName, handler) {\n            if (!eventName)\n                return this;\n            var handlers = this._events[eventName];\n            if (handler) {\n                for (var i = 0; i < handlers.length; i++) {\n                    if (handler === handlers[i]) {\n                        handlers.splice(i, 1);\n                        return this;\n                    }\n                }\n            }\n            else {\n                handlers.length = 0;\n            }\n            return this;\n        };\n        /**\n         * Register event handler.\n         * @param {string} eventName\n         * @param {callback} callback Which handler to be registered\n         * @param {boolean} atFirst If true then handler will be triggered firstly\n         */\n        EventObject.prototype.on = function (eventName, callback, atFirst) {\n            if (atFirst === void 0) { atFirst = false; }\n            var envs = eventName.split(/\\s+/);\n            for (var i = 0; i < envs.length; i++) {\n                var v = envs[i];\n                this.bind(v, callback, atFirst);\n            }\n            return this;\n        };\n        /**\n         * Register event handler.\n         * @param eventName\n         * @param callback Which handler to be registered but event only can be trigered once\n         * @param atFirst If true then handler will be triggered firstly\n         */\n        EventObject.prototype.once = function (eventName, callback, atFirst) {\n            if (atFirst === void 0) { atFirst = false; }\n            callback.isOnce = true;\n            return this.on(eventName, callback, atFirst);\n        };\n        /**\n         * Unregister event handler.\n         * @param eventName\n         * @param callback Which handler to be unregistered if don't specified then unregister all handler\n         */\n        EventObject.prototype.off = function (eventName, callback) {\n            var envs = eventName.split(/\\s+/);\n            for (var i = 0; i < envs.length; i++) {\n                var v = envs[i];\n                this.unbind(v, callback);\n            }\n            return this;\n        };\n        EventObject.prototype.offAll = function () {\n            for (var key in this._events) {\n                this.off(key);\n            }\n        };\n        /**\n         * Fire event. If some handler process return false then cancel the event channe and return false either\n         * @param {string} eventName\n         * @param {any[]} param\n         * @return {boolean} If any handler return false then stop other processing and return false either, otherwise return true\n         */\n        EventObject.prototype.fire = function (eventName, data) {\n            var handlers = this._events[eventName];\n            if (!(handlers instanceof Array)) {\n                handlers = [];\n            }\n            var wildcardHandlers = this._events['*'];\n            if (wildcardHandlers instanceof Array)\n                handlers = handlers.concat(wildcardHandlers);\n            if (handlers.length === 0)\n                return true;\n            var eventInfo = {\n                \"event\": eventName,\n                \"data\": data\n            };\n            var removeArray = [];\n            for (var i = 0; i < handlers.length; i++) {\n                var handler = handlers[i];\n                if (handler.isOnce)\n                    removeArray.push(handler);\n                var val = handler.call(this, eventInfo);\n                if (typeof val === \"boolean\" && !val)\n                    return false;\n            }\n            for (var i = 0; i < removeArray.length; i++) {\n                this.off(eventName, removeArray[i]);\n            }\n            return true;\n        };\n        return EventObject;\n    }());\n    tui.EventObject = EventObject;\n    tui.event = new EventObject();\n    function cloneInternal(obj, excludeProperties) {\n        if (obj === null)\n            return null;\n        else if (typeof obj === tui.UNDEFINED)\n            return undefined;\n        else if (obj instanceof Array) {\n            var newArray = [];\n            for (var idx in obj) {\n                if (obj.hasOwnProperty(idx) && excludeProperties.indexOf(idx) < 0) {\n                    newArray.push(cloneInternal(obj[idx], excludeProperties));\n                }\n            }\n            return newArray;\n        }\n        else if (typeof obj === \"number\")\n            return obj;\n        else if (typeof obj === \"string\")\n            return obj;\n        else if (typeof obj === \"boolean\")\n            return obj;\n        else if (typeof obj === \"function\")\n            return obj;\n        else {\n            var newObj = {};\n            for (var idx in obj) {\n                if (obj.hasOwnProperty(idx) && excludeProperties.indexOf(idx) < 0) {\n                    newObj[idx] = cloneInternal(obj[idx], excludeProperties);\n                }\n            }\n            return newObj;\n        }\n    }\n    /**\n     * Deeply copy an object to an other object, but only contain properties without methods\n     */\n    function clone(obj, excludeProperties) {\n        if (typeof excludeProperties === \"string\" && $.trim(excludeProperties).length > 0) {\n            return cloneInternal(obj, [excludeProperties]);\n        }\n        else if (excludeProperties instanceof Array) {\n            return cloneInternal(obj, excludeProperties);\n        }\n        else\n            return JSON.parse(JSON.stringify(obj));\n    }\n    tui.clone = clone;\n    /**\n     * Get IE version\n     * @return {Number}\n     */\n    tui.ieVer = (function () {\n        var rv = -1; // Return value assumes failure.\n        if (navigator.appName === \"Microsoft Internet Explorer\" ||\n            navigator.appName === \"Netscape\") {\n            var ua = navigator.userAgent;\n            var re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n            if (re.exec(ua) !== null)\n                rv = parseFloat(RegExp.$1);\n        }\n        if (rv === -1 && navigator.appName === \"Netscape\") {\n            var ua = navigator.userAgent;\n            var re = new RegExp(\"Trident/([0-9]{1,}[\\.0-9]{0,})\");\n            if (re.exec(ua) !== null)\n                rv = parseFloat(RegExp.$1);\n            if (rv >= 7.0)\n                rv = 11.0;\n        }\n        return rv;\n    })();\n    /**\n     * Get Firefox version\n     * @return {Number}\n     */\n    tui.ffVer = (function () {\n        var rv = -1; // Return value assumes failure.\n        if (navigator.appName === \"Netscape\") {\n            var ua = navigator.userAgent;\n            var re = new RegExp(\"Firefox/([0-9]{1,}[\\.0-9]{0,})\");\n            if (re.exec(ua) !== null)\n                rv = parseFloat(RegExp.$1);\n        }\n        return rv;\n    })();\n})(tui || (tui = {}));\n/// <reference path=\"core.ts\" />\ntui.dict(\"en-us\", {\n    \"success\": \"SUCCESS\",\n    \"notmodified\": \"Request's content has not been modified!\",\n    \"error\": \"ERROR\",\n    \"timeout\": \"Request timeout!\",\n    \"abort\": \"Operating has been aborted!\",\n    \"parsererror\": \"Server response invalid content!\",\n    \"ok\": \"OK\",\n    \"close\": \"CLOSE\",\n    \"cancel\": \"CANCEL\",\n    \"accept\": \"ACCEPT\",\n    \"agree\": \"AGREE\",\n    \"reject\": \"REJECT\",\n    \"yes\": \"YES\",\n    \"no\": \"NO\"\n});\n/// <reference path=\"../core.ts\" />\nvar tui;\n(function (tui) {\n    var text;\n    (function (text) {\n        \"use strict\";\n        /**\n         * Convert anything to boolean\n         */\n        function parseBoolean(value) {\n            if (typeof value === tui.UNDEFINED)\n                return false;\n            if (typeof value === \"number\")\n                return isNaN(value) && value != 0;\n            switch (String(tui.str).toLowerCase()) {\n                case \"true\":\n                case \"1\":\n                case \"yes\":\n                case \"y\":\n                    return true;\n                default:\n                    return false;\n            }\n        }\n        text.parseBoolean = parseBoolean;\n        /**\n         * Format a string use a set of parameters\n         */\n        function format(token) {\n            var params = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                params[_i - 1] = arguments[_i];\n            }\n            var formatrg = /\\{(\\d+)\\}/g;\n            token && (typeof token === \"string\") && params.length && (token = token.replace(formatrg, function (str, i) {\n                return params[i] === null ? \"\" : params[i];\n            }));\n            return token ? token : \"\";\n        }\n        text.format = format;\n        /**\n         * Convert 'aaaBbbCcc' to 'aaa-bbb-ccc'\n         */\n        function toDashSplit(word) {\n            var buffer = '';\n            for (var i = 0; i < word.length; i++) {\n                var c = word.charAt(i);\n                var code = c.charCodeAt(0);\n                if (code >= 65 && code <= 90) {\n                    if (i > 0)\n                        buffer += '-';\n                    buffer += c.toLowerCase();\n                }\n                else\n                    buffer += c;\n            }\n            return buffer;\n        }\n        text.toDashSplit = toDashSplit;\n        /**\n         * Convert 'aaa-bbb-ccc' or 'aaa_bbb_ccc' to 'aaaBbbCcc'\n         */\n        function toCamel(word, strict) {\n            if (strict === void 0) { strict = false; }\n            var buffer = '';\n            if (strict)\n                word = word.toLowerCase();\n            var upperFlag = false;\n            for (var i = 0; i < word.length; i++) {\n                var c = word.charAt(i);\n                if (c === '-' || c === '_') {\n                    upperFlag = true;\n                }\n                else {\n                    buffer += upperFlag ? c.toUpperCase() : c;\n                    upperFlag = false;\n                }\n            }\n            return buffer;\n        }\n        text.toCamel = toCamel;\n        /**\n         * Format a number that padding it with '0'\n         */\n        function paddingNumber(v, min, max, alignLeft) {\n            if (alignLeft === void 0) { alignLeft = false; }\n            var result = Math.abs(v) + \"\";\n            while (result.length < min) {\n                result = \"0\" + result;\n            }\n            if (typeof max === \"number\" && result.length > max) {\n                if (alignLeft)\n                    result = result.substr(0, max);\n                else\n                    result = result.substr(result.length - max, max);\n            }\n            if (v < 0)\n                result = \"-\" + result;\n            return result;\n        }\n        text.paddingNumber = paddingNumber;\n        /**\n         * Get the parameter of the URL query string.\n         * @param {String} url\n         * @param {String} key Parameter name\n         */\n        function getUrlParam(url, key) {\n            key = key.replace(/[\\[]/, \"\\\\\\[\").replace(/[\\]]/, \"\\\\\\]\");\n            var regex = new RegExp(\"[\\\\?&]\" + key + \"=([^&#]*)\"), results = regex.exec(url);\n            return results === null ? null : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n        }\n        text.getUrlParam = getUrlParam;\n        /**\n         * Get the anchor of the URL query string.\n         * @param {String} url\n         */\n        function getUrlAnchor(url) {\n            var anchor = url.match(\"(#.+)(?:\\\\?.*)?\");\n            if (anchor)\n                anchor = anchor[1];\n            return anchor;\n        }\n        text.getUrlAnchor = getUrlAnchor;\n        function isAbsUrl(url) {\n            if (!url)\n                return false;\n            return !!url.match(/^(([a-z0-9]+:)?\\/\\/|\\/)/i);\n        }\n        text.isAbsUrl = isAbsUrl;\n        function getBaseUrl(url) {\n            var matcher = url.match(/^(?:[a-z0-9]+:)?\\/\\//i);\n            var prefix = \"\";\n            if (matcher) {\n                prefix = matcher[0];\n                url = url.substr(matcher[0].length);\n            }\n            var pos = url.indexOf(\"#\");\n            if (pos >= 0) {\n                url = url.substring(0, pos);\n            }\n            var pos = url.lastIndexOf(\"/\");\n            if (pos >= 0) {\n                url = url.substring(0, pos + 1);\n            }\n            return prefix + url;\n        }\n        text.getBaseUrl = getBaseUrl;\n        function joinUrl() {\n            var urls = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                urls[_i - 0] = arguments[_i];\n            }\n            var result = null;\n            for (var _a = 0, urls_1 = urls; _a < urls_1.length; _a++) {\n                var u = urls_1[_a];\n                if (!result)\n                    result = u;\n                else {\n                    if (u[0] == \"/\")\n                        u = u.substr(1);\n                    if (result[result.length - 1] == \"/\") {\n                        result += u;\n                    }\n                    else\n                        result += \"/\" + u;\n                }\n            }\n            return result;\n        }\n        text.joinUrl = joinUrl;\n    })(text = tui.text || (tui.text = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\n/// <reference path=\"../ajax/ajax.ts\" />\nvar tui;\n(function (tui) {\n    var service;\n    (function (service_1) {\n        \"use strict\";\n        function parseParameters(fn, desc) {\n            var params = \"\";\n            if (desc)\n                params = desc + \"\";\n            else {\n                var matched = fn.toString().match(/^\\s*function\\s*[a-zA-Z0-9_]*\\s*\\(([\\sa-zA-Z0-9,_\\$]*)\\)/);\n                if (matched) {\n                    params = matched[1];\n                }\n                else {\n                    matched = fn.toString().match(/^\\s*\\(([\\sa-zA-Z0-9,_\\$]*)\\)\\s*=>/);\n                    if (matched)\n                        params = matched[1];\n                }\n            }\n            return (params || \"\");\n        }\n        service_1.parseParameters = parseParameters;\n        var Service = (function (_super) {\n            __extends(Service, _super);\n            function Service() {\n                _super.apply(this, arguments);\n            }\n            Service.prototype.use = function (fn, desc) {\n                service.use.call(this, fn, desc);\n            };\n            return Service;\n        }(tui.EventObject));\n        var _services = {};\n        var _serviceReady = true;\n        var _readyCallbacks = [];\n        function use(fn, desc) {\n            if (typeof fn === \"function\") {\n                var params = parseParameters(fn, desc);\n                var argv = params.split(\",\").map(function (s) {\n                    if (!s)\n                        return null;\n                    else if (s[0] === '$') {\n                        return tui.service.get(s.substr(1));\n                    }\n                    else {\n                        return null;\n                    }\n                });\n                fn.apply(this, argv);\n            }\n        }\n        service_1.use = use;\n        function getName(path) {\n            var begin = path.lastIndexOf(\"/\");\n            if (begin >= 0)\n                path = path.substr(begin + 1);\n            var end = path.lastIndexOf(\".\");\n            if (end >= 0)\n                path = path.substring(0, end);\n            return tui.text.toCamel(path.replace(/[\\-\\s\\.\\/]/g, \"_\"));\n        }\n        function load(services, names) {\n            _serviceReady = false;\n            var tasks = [];\n            for (var i = 0; i < services.length; i++) {\n                var s = services[i];\n                var name = names && names[i] || getName(s);\n                tasks.push(tui.ajax.getFunction(s, name));\n            }\n            $.when.apply(null, tasks).done(function () {\n                for (var i = 0; i < arguments.length; i++) {\n                    var p = arguments[i];\n                    register(p[1], p[0]);\n                }\n                ready();\n            }).fail(function () {\n                _serviceReady = true;\n            });\n        }\n        service_1.load = load;\n        function register(name, fn) {\n            var service = new Service();\n            service._constructor = fn;\n            _services[name] = service;\n        }\n        service_1.register = register;\n        function ready() {\n            for (var name_1 in _services) {\n                if (_services.hasOwnProperty(name_1)) {\n                    var service_2 = _services[name_1];\n                    service_2._constructor.call(service_2);\n                }\n            }\n            _serviceReady = true;\n            for (var _i = 0, _readyCallbacks_1 = _readyCallbacks; _i < _readyCallbacks_1.length; _i++) {\n                var cb = _readyCallbacks_1[_i];\n                cb();\n            }\n        }\n        service_1.ready = ready;\n        function get(name) {\n            return _services[name];\n        }\n        service_1.get = get;\n        function onReady(fn) {\n            if (_serviceReady) {\n                fn();\n            }\n            else {\n                _readyCallbacks.push(fn);\n            }\n        }\n        service_1.onReady = onReady;\n    })(service = tui.service || (tui.service = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var _maskOpened = false;\n        var _mask = document.createElement(\"div\");\n        _mask.setAttribute(\"unselectable\", \"on\");\n        _mask.onselectstart = function () { return false; };\n        var mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\n        $(_mask).on(mousewheelevt, function (ev) {\n            ev.stopPropagation();\n            ev.preventDefault();\n        });\n        function getEventPosition(e) {\n            var positions = [];\n            var event = e.originalEvent || e;\n            if (event.changedTouches) {\n                for (var i = 0; i < event.changedTouches.length; i++) {\n                    var touch = event.changedTouches[i];\n                    positions.push({ x: touch.clientX, y: touch.clientY });\n                }\n            }\n            else {\n                positions.push({ x: event.clientX, y: event.clientY });\n            }\n            return positions;\n        }\n        widget.getEventPosition = getEventPosition;\n        /**\n         * Show a mask layer to prevent user drag or select document elements which don't want to be affected.\n         * It's very useful when user perform a dragging operation.\n         */\n        function openDragMask(onMove, onClose) {\n            if (onClose === void 0) { onClose = null; }\n            if (_maskOpened)\n                return null;\n            _mask.innerHTML = \"\";\n            _mask.className = \"tui-mask\";\n            _mask.style.cursor = \"\";\n            _mask.removeAttribute(\"tabIndex\");\n            _mask.removeAttribute(\"tooltip\");\n            _mask.removeAttribute(\"fixed-tooltip\");\n            document.body.appendChild(_mask);\n            // _dragMoveFunc = onMove;\n            function closeDragMask(e) {\n                _maskOpened = false;\n                if (_mask.setCapture)\n                    $(_mask).off();\n                else {\n                    $(document).off(\"mousemove touchmove\", onMove);\n                    $(document).off(\"mouseup touchend\", closeDragMask);\n                }\n                tui.browser.removeNode(_mask);\n                if (typeof onClose === \"function\") {\n                    onClose(e);\n                }\n                e.preventDefault();\n            }\n            if (_mask.setCapture) {\n                _mask.setCapture();\n                $(_mask).on(\"mousemove touchmove\", onMove);\n                $(_mask).on(\"mouseup touchend\", closeDragMask);\n            }\n            else {\n                $(document).on(\"mousemove touchmove\", onMove);\n                $(document).on(\"mouseup touchend\", closeDragMask);\n            }\n            _maskOpened = true;\n            return _mask;\n        }\n        widget.openDragMask = openDragMask;\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\n/// <reference path=\"../text/text.ts\" />\n/// <reference path=\"../ajax/ajax.ts\" />\n/// <reference path=\"../service/service.ts\" />\n/// <reference path=\"mask.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget_1) {\n        \"use strict\";\n        function parseValue(value) {\n            if (value === null || value.length === 0)\n                return null;\n            if (/^\\{(.|\\r|\\n)+\\}$/m.test(value)) {\n                value = value.substring(1, value.length - 1);\n                try {\n                    return eval(\"(\" + value + \")\");\n                }\n                catch (e) {\n                    console && console.error(\"Bad attribute: \" + e);\n                    return null;\n                }\n            }\n            else\n                return value;\n        }\n        var WidgetBase = (function (_super) {\n            __extends(WidgetBase, _super);\n            function WidgetBase() {\n                _super.apply(this, arguments);\n                this._data = undefined;\n                this._rs = {};\n            }\n            //restrict\n            WidgetBase.prototype.setRestriction = function (key, propCtrl) {\n                if (propCtrl === null)\n                    delete this._rs[key];\n                else\n                    this._rs[key] = propCtrl;\n            };\n            WidgetBase.prototype.setRestrictions = function (restrictions) {\n                for (var key in restrictions) {\n                    this.setRestriction(key, restrictions[key]);\n                }\n            };\n            WidgetBase.prototype.refresh = function () {\n                if (this.get(\"autoRefresh\") === true) {\n                    this.render();\n                }\n                return this;\n            };\n            WidgetBase.prototype.load = function () {\n                if (typeof this._data !== tui.UNDEFINED) {\n                    return;\n                }\n                this._data = {};\n                var elem = this.getComponent();\n                if (elem != null) {\n                    var dataStr = elem.getAttribute(\"props\");\n                    try {\n                        var tmpData = eval(\"(\" + dataStr + \")\");\n                        if (tmpData instanceof Object) {\n                            for (var key in tmpData) {\n                                if (tmpData.hasOwnProperty(key)) {\n                                    this._set(key, tmpData[key]);\n                                }\n                            }\n                        }\n                    }\n                    catch (e) {\n                        console && console.error(\"Bad props: \" + e);\n                    }\n                    var names = [];\n                    for (var i = 0; i < elem.attributes.length; i++) {\n                        var attr = elem.attributes[i];\n                        if (/^(style|class|tooltip|follow-tooltip|__widget__|jquery[\\d]+)$/.test(attr.name.toLowerCase()))\n                            continue;\n                        var v = parseValue(attr.value);\n                        if (v !== null)\n                            this._set(tui.text.toCamel(attr.name), v);\n                        if (!/^(id|name)$/i.test(attr.name.toLowerCase()))\n                            names.push(attr.name);\n                    }\n                    for (var _i = 0, names_1 = names; _i < names_1.length; _i++) {\n                        var name_2 = names_1[_i];\n                        elem.attributes.removeNamedItem(name_2);\n                        if (/^(onclick|onmousedown|onmouseup|onmousemove|ondblclick|onkeydown|onkeyup|onkeypress)$/i.test(name_2))\n                            elem[name_2.toLowerCase()] = null;\n                    }\n                }\n            };\n            WidgetBase.prototype.get = function (key, defaultValue) {\n                var value;\n                if (typeof key === tui.UNDEFINED || key === null) {\n                    value = this._data;\n                }\n                else if (typeof key === \"string\") {\n                    if (this._rs[key] && typeof this._rs[key].get === \"function\") {\n                        value = this._rs[key].get();\n                    }\n                    else {\n                        if (typeof this._data === \"object\")\n                            value = this._data[key];\n                        else\n                            value = null;\n                    }\n                }\n                if (typeof value === tui.UNDEFINED)\n                    value = null;\n                if (value === null && typeof defaultValue !== tui.UNDEFINED)\n                    return defaultValue;\n                else\n                    return value;\n            };\n            WidgetBase.prototype.set = function (p1, p2) {\n                this._set(p1, p2);\n                this.refresh();\n                return this;\n            };\n            WidgetBase.prototype._set = function (p1, p2) {\n                if (typeof p2 === tui.UNDEFINED && p1 instanceof Object) {\n                    for (var key in p1) {\n                        if (p1.hasOwnProperty(key))\n                            this._set(key, p1[key]);\n                    }\n                }\n                else if (typeof p1 === \"string\" && typeof p2 !== tui.UNDEFINED) {\n                    if (this._rs[p1] && typeof this._rs[p1].set === \"function\") {\n                        this._rs[p1].set(p2);\n                    }\n                    else {\n                        if (p2 === null) {\n                            this._data && delete this._data[p1];\n                        }\n                        else {\n                            if (typeof this._data === \"object\")\n                                this._data[p1] = p2;\n                        }\n                    }\n                }\n                return this;\n            };\n            WidgetBase.prototype.setInit = function (p1, p2) {\n                if (typeof p2 === tui.UNDEFINED) {\n                    if (p1 instanceof Object) {\n                        for (var key in p1) {\n                            if (p1.hasOwnProperty(key) && this.get(key) === null)\n                                this._set(key, p1[key]);\n                        }\n                    }\n                }\n                else {\n                    if (this.get(p1) === null)\n                        this._set(p1, p2);\n                }\n                return this;\n            };\n            return WidgetBase;\n        }(tui.EventObject));\n        widget_1.WidgetBase = WidgetBase; // End of class WidgetBase\n        var namedWidgets = {};\n        var Widget = (function (_super) {\n            __extends(Widget, _super);\n            function Widget(root, initParam) {\n                _super.call(this);\n                this._lastWidth = null;\n                this._lastHeight = null;\n                this._components = {};\n                // if (getFullName(root) !== \"tui:\" + this.getNodeName()) {\n                // \tthrow new TypeError(\"Node type unmatched!\");\n                // }\n                this._components[''] = root;\n                this._ = root;\n                root.__widget__ = this;\n                this.initRestriction(); // install restrictor\n                this.load(); // load initial properties\n                // Obtain all child nodes\n                var childNodes = [];\n                for (var i = 0; i < root.childNodes.length; i++) {\n                    var node = root.childNodes[i];\n                    childNodes.push(node);\n                }\n                for (var _i = 0, childNodes_1 = childNodes; _i < childNodes_1.length; _i++) {\n                    var removeNode = childNodes_1[_i];\n                    tui.browser.removeNode(removeNode);\n                }\n                this.initChildren(childNodes);\n                if (typeof initParam !== tui.UNDEFINED) {\n                    this._set(initParam);\n                }\n                this.init();\n                // Any widget which has ID property will be registered in namedWidgets\n                var id = this.get(\"id\");\n                if (typeof id === \"string\" && id.length > 0)\n                    namedWidgets[id] = this;\n            }\n            Widget.prototype.init = function () { };\n            ;\n            Widget.prototype.appendTo = function (parent, refresh) {\n                if (refresh === void 0) { refresh = true; }\n                if (typeof parent === \"string\") {\n                    parent = document.getElementById(parent);\n                }\n                if (parent && typeof parent === \"object\" && parent.appendChild) {\n                    parent.appendChild(this._);\n                    refresh && this.set(\"autoRefresh\", true);\n                }\n                return this;\n            };\n            Widget.prototype.detach = function () {\n                tui.browser.removeNode(this._);\n            };\n            Widget.prototype.initChildren = function (childNodes) {\n                // Default do nothing ...\n            };\n            Widget.prototype.initRestriction = function () {\n                var _this = this;\n                this.setRestrictions({\n                    \"id\": {\n                        \"set\": function (value) {\n                            var oldId = _this._.getAttribute(\"id\");\n                            if (oldId) {\n                                delete namedWidgets[oldId];\n                            }\n                            if (typeof value === \"string\" && value.length > 0) {\n                                namedWidgets[value] = _this;\n                                _this._.setAttribute(\"id\", value);\n                            }\n                            else\n                                _this._.removeAttribute(\"id\");\n                        },\n                        \"get\": function () {\n                            return _this._.getAttribute(\"id\");\n                        }\n                    },\n                    \"name\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"string\" && value.length > 0) {\n                                _this._.setAttribute(\"name\", value);\n                            }\n                            else\n                                _this._.removeAttribute(\"name\");\n                        },\n                        \"get\": function () {\n                            return _this._.getAttribute(\"name\");\n                        }\n                    },\n                    \"parent\": {\n                        \"get\": function () {\n                            var elem = _this._.parentNode;\n                            while (elem) {\n                                if (elem.__widget__) {\n                                    return elem.__widget__;\n                                }\n                                else {\n                                    elem = elem.parentNode;\n                                }\n                            }\n                            return null;\n                        },\n                        \"set\": function (value) { }\n                    },\n                    \"disable\": {\n                        \"get\": function () {\n                            var v = _this._data[\"disable\"];\n                            if (v === null || typeof v === tui.UNDEFINED) {\n                                var parent_1 = _this.get(\"parent\");\n                                if (parent_1)\n                                    v = parent_1.get(\"disable\");\n                                return v === null ? false : !!v;\n                            }\n                            else\n                                return v;\n                        }\n                    },\n                    \"group\": {\n                        \"get\": function () {\n                            if (_this.get(\"inner\") === true)\n                                return null;\n                            if (_this._data[\"group\"])\n                                return _this._data[\"group\"];\n                            var parent = _this.get(\"parent\");\n                            if (parent && parent instanceof widget_1.Group && parent.get(\"name\"))\n                                return parent.get(\"name\");\n                            return null;\n                        }\n                    },\n                    \"tooltip\": {\n                        \"set\": function (value) {\n                            if (value)\n                                _this._.setAttribute(\"tooltip\", value);\n                            else\n                                _this._.removeAttribute(\"tooltip\");\n                        },\n                        \"get\": function () {\n                            return _this._.getAttribute(\"tooltip\");\n                        }\n                    },\n                    \"follow-tooltip\": {\n                        \"set\": function (value) {\n                            if (value)\n                                _this._.setAttribute(\"follow-tooltip\", value);\n                            else\n                                _this._.removeAttribute(\"follow-tooltip\");\n                        },\n                        \"get\": function () {\n                            return _this._.getAttribute(\"follow-tooltip\");\n                        }\n                    }\n                });\n            };\n            Widget.prototype.testResize = function () {\n                if (!tui.browser.isInDoc(this._))\n                    return;\n                if (this._.offsetWidth != this._lastWidth) {\n                    this._lastWidth = this._.offsetWidth;\n                    this.fire(\"resize\");\n                }\n                else if (this._.offsetHeight != this._lastHeight) {\n                    this._lastHeight = this._.offsetHeight;\n                    this.fire(\"resize\");\n                }\n            };\n            Widget.prototype.getComponent = function (name) {\n                if (arguments.length > 0) {\n                    return this._components[name];\n                }\n                else {\n                    return this._components[''];\n                }\n            };\n            // getNodeName(): string {\n            // \treturn text.toDashSplit(getClassName(this.constructor));\n            // }\n            Widget.prototype.focus = function () {\n                this._.focus();\n            };\n            return Widget;\n        }(WidgetBase));\n        widget_1.Widget = Widget; // End of class Widget\n        /**\n         * Any config element can extends from this class.\n         */\n        var Item = (function (_super) {\n            __extends(Item, _super);\n            function Item(root) {\n                _super.call(this);\n                this._ = root;\n                this.load();\n            }\n            Item.prototype.getComponent = function (name) {\n                if (arguments.length > 0) {\n                    return null;\n                }\n                else {\n                    return this._;\n                }\n            };\n            Item.prototype.render = function () { };\n            return Item;\n        }(WidgetBase));\n        widget_1.Item = Item; // End of ConfigNode\n        var widgetRegistration = {};\n        function register(constructor, nodeName) {\n            if (typeof nodeName === \"string\")\n                widgetRegistration[\"tui:\" + nodeName.toLowerCase()] = constructor;\n            else {\n                widgetRegistration[\"tui:\" + tui.text.toDashSplit(getClassName(constructor))] = constructor;\n            }\n        }\n        widget_1.register = register;\n        function get(id) {\n            if (typeof id === \"object\" && id.nodeName) {\n                if (id.__widget__)\n                    return id.__widget__;\n                else\n                    return null;\n            }\n            var elem = document.getElementById(id);\n            if (elem === null) {\n                if (namedWidgets[id])\n                    return namedWidgets[id];\n                else\n                    return null;\n            }\n            if (elem.__widget__)\n                return elem.__widget__;\n            else\n                return null;\n        }\n        widget_1.get = get;\n        window[\"$$\"] = get;\n        function create(type, initParam) {\n            if (typeof type !== \"string\")\n                throw new TypeError(\"Invalid parameters.\");\n            var constructor = widgetRegistration[\"tui:\" + type.toLowerCase()];\n            if (typeof constructor !== \"function\")\n                throw new Error(\"Undefined type: \" + type);\n            var element = document.createElement(\"tui:\" + type);\n            var obj;\n            if (typeof initParam !== tui.UNDEFINED)\n                obj = new constructor(element, initParam);\n            else\n                obj = new constructor(element);\n            obj.set(\"autoRefresh\", true);\n            return obj;\n        }\n        widget_1.create = create;\n        window[\"$new\"] = create;\n        function getClassName(func) {\n            var results = /function\\s+([^\\s]+)\\s*\\(/.exec(func.toString());\n            return (results && results.length > 1) ? results[1] : \"\";\n        }\n        widget_1.getClassName = getClassName;\n        function getFullName(targetElem) {\n            if (targetElem.scopeName && targetElem.scopeName.toLowerCase() === \"tui\") {\n                if (targetElem.nodeName.toLowerCase().match(\"^\" + targetElem.scopeName + \":\") !== null)\n                    return targetElem.nodeName.toLowerCase();\n                else\n                    return targetElem.scopeName + \":\" + targetElem.nodeName.toLowerCase();\n            }\n            else {\n                return targetElem.nodeName.toLowerCase();\n            }\n        }\n        widget_1.getFullName = getFullName;\n        function init(parent, initFunc) {\n            var initSet = [];\n            function searchInitCtrls(parent) {\n                for (var i = 0; i < parent.childNodes.length; i++) {\n                    var node = parent.childNodes[i];\n                    if (node.nodeType === 1) {\n                        var elem = node;\n                        var constructor = widgetRegistration[getFullName(elem)];\n                        if (constructor) {\n                            var item = [elem, constructor];\n                            initSet.push(item);\n                        }\n                        else\n                            searchInitCtrls(elem);\n                    }\n                }\n            }\n            searchInitCtrls(parent);\n            for (var _i = 0, initSet_1 = initSet; _i < initSet_1.length; _i++) {\n                var item = initSet_1[_i];\n                var elem = item[0];\n                var constructor = item[1];\n                // try {\n                if (!elem.__widget__) {\n                    var widget_2 = new constructor(elem);\n                    if (typeof initFunc === \"function\") {\n                        if (initFunc(widget_2))\n                            widget_2.set(\"autoRefresh\", true);\n                    }\n                    else\n                        widget_2.set(\"autoRefresh\", true);\n                }\n                else {\n                    var widget_3 = elem.__widget__;\n                    widget_3.refresh();\n                }\n            }\n        }\n        widget_1.init = init;\n        function search(p1, p2) {\n            var searchArea = null;\n            var filter = null;\n            if (typeof p2 === tui.UNDEFINED) {\n                if (typeof p1 === \"function\")\n                    filter = p1;\n                else if (typeof p1 === \"object\" && p1.nodeName)\n                    searchArea = p1;\n            }\n            else if (typeof p2 === \"function\") {\n                searchArea = p1;\n                filter = p2;\n            }\n            var result = [];\n            if (searchArea === null) {\n                searchArea = document.body;\n            }\n            function searchElem(parent) {\n                for (var i = 0; i < parent.childNodes.length; i++) {\n                    var node = parent.childNodes[i];\n                    if (node.nodeType !== 1) {\n                        continue;\n                    }\n                    var widget_4 = node.__widget__;\n                    if (widget_4 && (filter && filter(widget_4) || filter === null)) {\n                        result.push(widget_4);\n                    }\n                    else\n                        searchElem(node);\n                }\n            }\n            searchElem(searchArea);\n            return result;\n        }\n        widget_1.search = search;\n        // Detecting which widgets was resied.\n        var resizeRegistration = [];\n        function registerResize(nodeName) {\n            resizeRegistration.push(\"tui:\" + nodeName);\n        }\n        widget_1.registerResize = registerResize;\n        var detectResize;\n        $(window.document).ready(function () {\n            tui.service.onReady(function () {\n                init(document.body);\n                tui.event.fire(\"initialized\");\n            });\n            if (typeof document.body.scopeName === \"string\" && tui.ieVer < 9) {\n                detectResize = function () {\n                    for (var i = 0; i < resizeRegistration.length; i++) {\n                        var nodes = document.getElementsByTagName(resizeRegistration[i].substr(4));\n                        for (var j = 0; j < nodes.length; j++) {\n                            var node = nodes[j];\n                            if (node.scopeName.toUpperCase() === \"TUI\" && node.__widget__) {\n                                node.__widget__.testResize();\n                            }\n                        }\n                    }\n                    requestAnimationFrame(detectResize);\n                };\n            }\n            else {\n                detectResize = function () {\n                    for (var i = 0; i < resizeRegistration.length; i++) {\n                        var nodes = document.getElementsByTagName(resizeRegistration[i]);\n                        for (var j = 0; j < nodes.length; j++) {\n                            var node = nodes[j];\n                            if (node.__widget__) {\n                                node.__widget__.testResize();\n                            }\n                        }\n                    }\n                    requestAnimationFrame(detectResize);\n                };\n            }\n            requestAnimationFrame(detectResize);\n        });\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\nvar tui;\n(function (tui) {\n    tui.get = tui.widget.get;\n    tui.create = tui.widget.create;\n    tui.search = tui.widget.search;\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        widget.dialogStack = [];\n        var _mask = document.createElement(\"div\");\n        _mask.className = \"tui-dialog-mask\";\n        _mask.setAttribute(\"unselectable\", \"on\");\n        var mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\n        $(_mask).on(mousewheelevt + \" selectstart\", function (ev) {\n            ev.stopPropagation();\n            ev.preventDefault();\n        });\n        function reorder() {\n            tui.browser.removeNode(_mask);\n            if (widget.dialogStack.length > 0) {\n                document.body.insertBefore(_mask, widget.dialogStack[widget.dialogStack.length - 1]._);\n            }\n        }\n        function push(dlg) {\n            widget.dialogStack.push(dlg);\n            document.body.appendChild(dlg._);\n            reorder();\n        }\n        function remove(dlg) {\n            var index = widget.dialogStack.indexOf(dlg);\n            if (index >= 0) {\n                widget.dialogStack.splice(index, 1);\n            }\n            document.body.removeChild(dlg._);\n            reorder();\n        }\n        function getParent(dlg) {\n            var index = widget.dialogStack.indexOf(dlg);\n            if (index > 0) {\n                widget.dialogStack[index - 1];\n            }\n            else\n                return null;\n        }\n        function disableSelect() {\n            return false;\n        }\n        /**\n         * <dialog>\n         * Attributes: content(element or html), opened(boolean), title, buttons(button array), esc(boolean)\n         * Method: open(buttonDef: string = null), close()\n         * Events: open, close, click-<button name>\n         */\n        var Dialog = (function (_super) {\n            __extends(Dialog, _super);\n            function Dialog() {\n                _super.apply(this, arguments);\n                this._sizeTimer = null;\n                this._contentSize = null;\n                this._moved = false;\n                this._init = true;\n            }\n            Dialog.prototype.initChildren = function (childNodes) {\n                if (childNodes.length > 0) {\n                    var div = document.createElement(\"div\");\n                    for (var _i = 0, childNodes_2 = childNodes; _i < childNodes_2.length; _i++) {\n                        var node = childNodes_2[_i];\n                        div.appendChild(node);\n                    }\n                    this._set(\"content\", div);\n                }\n            };\n            Dialog.prototype.init = function () {\n                var _this = this;\n                var root$ = $(this._);\n                root$.attr(\"tabIndex\", \"-1\");\n                root$.html(\"<div class='tui-title-bar' unselectable='on'><span class='tui-text'></span><span class='tui-close'></span></div>\" +\n                    \"<div class='tui-content'></div><div class='tui-button-bar'></div>\");\n                var titleBar = this._components[\"titleBar\"] = root$.children(\".tui-title-bar\")[0];\n                var contentDiv = this._components[\"content\"] = root$.children(\".tui-content\")[0];\n                var buttonBar = this._components[\"buttonBar\"] = root$.children(\".tui-button-bar\")[0];\n                var closeIcon = this._components[\"closeIcon\"] = $(titleBar).children(\".tui-close\")[0];\n                titleBar.onselectstart = disableSelect;\n                buttonBar.onselectstart = disableSelect;\n                var content = this.get(\"content\");\n                if (typeof content === \"object\" && content && content.nodeName)\n                    contentDiv.appendChild(content);\n                else if (typeof content === \"string\") {\n                    contentDiv.innerHTML = content;\n                }\n                this.setInit(\"esc\", true);\n                widget.init(contentDiv); // Convert all child elements into tui controls\n                closeIcon.onclick = function () {\n                    _this.close();\n                };\n                tui.browser.removeNode(this._);\n                $(titleBar).on(\"mousedown\", function (e) {\n                    var o = (e.target || e.srcElement);\n                    if (o === closeIcon)\n                        return;\n                    var dialogX = _this._.offsetLeft;\n                    var dialogY = _this._.offsetTop;\n                    var beginX = e.clientX;\n                    var beginY = e.clientY;\n                    var winSize = { width: _mask.offsetWidth, height: _mask.offsetHeight };\n                    var mask = tui.widget.openDragMask(function (e) {\n                        var l = dialogX + e.clientX - beginX;\n                        var t = dialogY + e.clientY - beginY;\n                        if (l > winSize.width - _this._.offsetWidth)\n                            l = winSize.width - _this._.offsetWidth;\n                        if (l < 0)\n                            l = 0;\n                        if (t > winSize.height - _this._.offsetHeight)\n                            t = winSize.height - _this._.offsetHeight;\n                        if (t < 0)\n                            t = 0;\n                        _this._.style.left = l + \"px\";\n                        _this._.style.top = t + \"px\";\n                        _this._moved = true;\n                    }, function (e) {\n                        _this.render();\n                    });\n                });\n                root$.on(mousewheelevt, function (ev) {\n                    ev.stopPropagation();\n                });\n            };\n            Dialog.prototype.setContent = function (content) {\n                var contentDiv = this._components[\"content\"];\n                contentDiv.innerHTML = \"\";\n                if (typeof content === \"object\" && content.nodeName) {\n                    content.style.display = \"block\";\n                    contentDiv.appendChild(content);\n                }\n                else if (typeof content === \"string\") {\n                    contentDiv.innerHTML = content;\n                }\n                this.render();\n            };\n            Dialog.prototype.setButtons = function (buttonDef) {\n                var _this = this;\n                if (buttonDef === void 0) { buttonDef = null; }\n                var buttonBar = this._components[\"buttonBar\"];\n                buttonBar.innerHTML = \"\";\n                if (typeof buttonDef === \"string\" && buttonDef.length > 0) {\n                    var names = buttonDef.split(\",\");\n                    var _loop_1 = function(name_3) {\n                        var pair = name_3.split(\"#\");\n                        var btn = widget.create(\"button\", { text: tui.str($.trim(pair[0])) });\n                        if (pair.length > 1 && $.trim(pair[1]).length > 0)\n                            btn._.className = pair[1];\n                        btn.on(\"click\", function (e) {\n                            _this.fire(\"btnclick\", { e: e, button: $.trim(pair[0]) });\n                        });\n                        btn.appendTo(buttonBar);\n                    };\n                    for (var _i = 0, names_2 = names; _i < names_2.length; _i++) {\n                        var name_3 = names_2[_i];\n                        _loop_1(name_3);\n                    }\n                    buttonBar.style.display = \"block\";\n                }\n                else {\n                    buttonBar.style.display = \"none\";\n                }\n                this.render();\n            };\n            Dialog.prototype.open = function (buttonDef) {\n                var _this = this;\n                if (buttonDef === void 0) { buttonDef = null; }\n                if (this.get(\"opened\"))\n                    return;\n                var contentDiv = this._components[\"content\"];\n                widget.init(contentDiv);\n                this._init = true;\n                this._moved = false;\n                $(this._).css({\n                    \"display\": \"block\",\n                    \"position\": \"fixed\"\n                });\n                this._set(\"opened\", true);\n                push(this);\n                this.setButtons(buttonDef);\n                this._.focus();\n                this.fire(\"open\");\n                this._sizeTimer = setInterval(function () {\n                    if (_this._contentSize == null)\n                        return;\n                    if (contentDiv.scrollHeight !== _this._contentSize.height ||\n                        contentDiv.scrollWidth !== _this._contentSize.width) {\n                        _this.refresh();\n                    }\n                }, 50);\n            };\n            Dialog.prototype.close = function () {\n                if (!this.get(\"opened\"))\n                    return;\n                clearInterval(this._sizeTimer);\n                this._sizeTimer = null;\n                this._moved = false;\n                this._contentSize = null;\n                remove(this);\n                this._set(\"opened\", false);\n                this.fire(\"close\");\n            };\n            Dialog.prototype.render = function () {\n                if (!this.get(\"opened\"))\n                    return;\n                var titleBar = this._components[\"titleBar\"];\n                var buttonBar = this._components[\"buttonBar\"];\n                var contentDiv = this._components[\"content\"];\n                var closeIcon = this._components[\"closeIcon\"];\n                // Adjust title bar\n                if (this.get(\"title\") === null && !this.get(\"esc\")) {\n                    titleBar.style.display = \"none\";\n                }\n                else {\n                    titleBar.style.display = \"block\";\n                    if (this.get(\"esc\")) {\n                        closeIcon.style.display = \"inline-block\";\n                    }\n                    else\n                        closeIcon.style.display = \"none\";\n                    var titleText = $(titleBar).children(\".tui-text\")[0];\n                    titleText.innerHTML = this.get(\"title\") !== null ? this.get(\"title\") : \"\";\n                    if (tui.ieVer >= 7 && tui.ieVer < 9) {\n                        titleText.style.width = \"\";\n                        titleText.style.width = titleText.offsetWidth + \"px\";\n                    }\n                }\n                // Change position\n                var winSize = { width: _mask.offsetWidth, height: _mask.offsetHeight };\n                var root = this._;\n                var root$ = $(root);\n                // Limit content size\n                contentDiv.style.maxHeight = \"\";\n                root$.css({\n                    \"maxWidth\": winSize.width + \"px\",\n                    \"maxHeight\": winSize.height + \"px\"\n                });\n                $(contentDiv).css({\n                    //\"maxWidth\": winSize.width - $(contentDiv).outerWidth() + $(contentDiv).width() + \"px\",\n                    \"maxWidth\": winSize.width - 80 + \"px\",\n                    \"maxHeight\": winSize.height - titleBar.offsetHeight - buttonBar.offsetHeight - $(contentDiv).outerHeight() + $(contentDiv).height() + \"px\"\n                });\n                var box = {\n                    left: root.offsetLeft,\n                    top: root.offsetTop,\n                    width: root.offsetWidth,\n                    height: root.offsetHeight\n                };\n                if (this._init) {\n                    var parent = getParent(this);\n                    var centX, centY;\n                    if (parent) {\n                        var e = parent._;\n                        centX = e.offsetLeft + e.offsetWidth / 2;\n                        centY = e.offsetTop + e.offsetHeight / 2;\n                        this._moved = true;\n                    }\n                    else {\n                        centX = winSize.width / 2;\n                        centY = winSize.height / 2;\n                        this._moved = false;\n                    }\n                    box.left = centX - box.width / 2;\n                    box.top = centY - box.height / 2;\n                    this._init = false;\n                }\n                else {\n                    if (!this._moved) {\n                        box.left = (winSize.width - box.width) / 2;\n                        box.top = (winSize.height - box.height) / 2;\n                    }\n                }\n                if (box.left + box.width > winSize.width)\n                    box.left = winSize.width - box.width;\n                if (box.top + box.height > winSize.height)\n                    box.top = winSize.height - box.height;\n                if (box.left < 0)\n                    box.left = 0;\n                if (box.top < 0)\n                    box.top = 0;\n                this._.style.left = box.left + \"px\";\n                this._.style.top = box.top + \"px\";\n                this._contentSize = { width: contentDiv.scrollWidth, height: contentDiv.scrollHeight };\n            };\n            return Dialog;\n        }(widget.Widget));\n        widget.Dialog = Dialog; // End of Dialog class\n        widget.register(Dialog, \"dialog\");\n        $(document).on(\"keydown\", function (e) {\n            var k = e.keyCode;\n            if (widget.dialogStack.length <= 0)\n                return;\n            var dlg = widget.dialogStack[widget.dialogStack.length - 1];\n            if (k === tui.browser.KeyCode.ESCAPE) {\n                dlg.get(\"esc\") && dlg.close();\n            }\n            else if (k === tui.browser.KeyCode.TAB) {\n                setTimeout(function () {\n                    if (!tui.browser.isPosterity(dlg._, document.activeElement)) {\n                        dlg._.focus();\n                    }\n                });\n            }\n        });\n        $(window).resize(function () {\n            for (var i = 0; i < widget.dialogStack.length; i++) {\n                widget.dialogStack[i].refresh();\n            }\n        });\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\nvar tui;\n(function (tui) {\n    \"use strict\";\n    function makeContent(message) {\n        // return text.format( \n        // \t\"<table align='center' class='tui-msg-container'><tr><td class='{1}'><span></span></td><td>{0}</td></tr></table>\", \n        // \tmessage, className);\n        if (message) {\n            return tui.text.format(\"<div class='tui-msg-container'><span></span><div>{0}</div></div>\", message);\n        }\n        else {\n            return tui.text.format(\"<div class='tui-msg-container'><span></span></div>\");\n        }\n    }\n    function makeDialog(message, className, title, btn, callback, esc) {\n        if (btn === void 0) { btn = \"ok#tui-primary\"; }\n        if (callback === void 0) { callback = null; }\n        if (esc === void 0) { esc = true; }\n        var dlg = tui.widget.create(\"dialog\", {\n            \"content\": makeContent(message),\n            \"title\": title,\n            \"esc\": esc\n        });\n        $(dlg._).addClass(className);\n        dlg.on(\"btnclick\", function (e) {\n            dlg.close();\n            if (callback)\n                callback(e.data.button);\n        });\n        dlg.open(btn);\n        return dlg;\n    }\n    function msgbox(message, title) {\n        if (title === void 0) { title = null; }\n        return makeDialog(message, \"tui-msg-box\", title);\n    }\n    tui.msgbox = msgbox;\n    function infobox(message, title) {\n        if (title === void 0) { title = \"\"; }\n        var titleText = \"<i class='tui-dialog-title-info'></i>\";\n        if (title)\n            titleText += title;\n        return makeDialog(message, \"tui-info-box\", titleText);\n    }\n    tui.infobox = infobox;\n    function okbox(message, title) {\n        if (title === void 0) { title = \"\"; }\n        var titleText = \"<i class='tui-dialog-title-ok'></i>\";\n        if (title)\n            titleText += title;\n        return makeDialog(message, \"tui-ok-box\", titleText);\n    }\n    tui.okbox = okbox;\n    function errbox(message, title) {\n        if (title === void 0) { title = \"\"; }\n        var titleText = \"<i class='tui-dialog-title-error'></i>\";\n        if (title)\n            titleText += title;\n        return makeDialog(message, \"tui-err-box\", titleText);\n    }\n    tui.errbox = errbox;\n    function warnbox(message, title) {\n        if (title === void 0) { title = \"\"; }\n        var titleText = \"<i class='tui-dialog-title-warning'></i>\";\n        if (title)\n            titleText += title;\n        return makeDialog(message, \"tui-warn-box\", titleText);\n    }\n    tui.warnbox = warnbox;\n    function askbox(message, title, callback) {\n        if (title === void 0) { title = \"\"; }\n        if (typeof title === \"function\") {\n            callback = title;\n            title = null;\n        }\n        var titleText = \"<i class='tui-dialog-title-ask'></i>\";\n        if (title)\n            titleText += title;\n        return makeDialog(message, \"tui-ask-box\", titleText, \"cancel#tui-flat,ok#tui-primary\", function (buttonName) {\n            if (typeof callback === \"function\")\n                callback(buttonName === \"ok\");\n        });\n    }\n    tui.askbox = askbox;\n    var refCount = 0;\n    var waitDlg = null;\n    var waitMsg = null;\n    function waitbox(message) {\n        if (waitDlg == null) {\n            refCount = 0;\n            waitMsg = [message];\n            waitDlg = makeDialog(message, \"tui-wait-box\", null, null, null, false);\n        }\n        else {\n            waitMsg.push(message);\n            waitDlg.setContent(makeContent(message));\n            setTimeout(function () {\n                waitDlg.refresh();\n            });\n        }\n        var index = waitMsg.length - 1;\n        refCount++;\n        var closed = false;\n        return {\n            close: function () {\n                if (!closed) {\n                    refCount--;\n                    closed = true;\n                    waitMsg[index] = null;\n                    for (var i = index - 1; i >= 0; i--) {\n                        if (waitMsg[i] != null) {\n                            waitDlg.setContent(makeContent(waitMsg[i]));\n                            break;\n                        }\n                    }\n                    if (refCount === 0) {\n                        waitDlg.close();\n                        waitDlg = null;\n                        waitMsg = null;\n                    }\n                }\n            },\n            setMessage: function (message) {\n                if (!closed) {\n                    waitMsg[index] = message;\n                    if (index === waitMsg.length - 1)\n                        waitDlg.setContent(makeContent(message));\n                }\n            }\n        };\n    }\n    tui.waitbox = waitbox;\n    function progressbox(message, cancelProc) {\n        if (cancelProc === void 0) { cancelProc = null; }\n        // TODO: NOT FINISHED\n        return null;\n    }\n    tui.progressbox = progressbox;\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\n/// <reference path=\"../widget/dialog.ts\" />\nvar tui;\n(function (tui) {\n    var ajax;\n    (function (ajax) {\n        $.ajaxSetup({\n            \"timeout\": 30000,\n            \"xhrFields\": {\n                'withCredentials': true\n            }\n        });\n        function send(url, method, data, options) {\n            var deffered = $.Deferred();\n            var waitbox = null;\n            if (!options || !options[\"silent\"])\n                waitbox = tui.waitbox(tui.str(\"Processing...\"));\n            var ajaxData = {\n                \"type\": method.toUpperCase(),\n                \"url\": url,\n                \"contentType\": \"application/json\",\n                \"data\": (method.toUpperCase() === \"GET\" ? data : JSON.stringify(data)),\n                \"complete\": function (jqXHR, status) {\n                    waitbox && waitbox.close();\n                    if (status === \"success\") {\n                        var respJson = /^\\s*application\\/json\\s*(;.+)?/i.test(jqXHR.getResponseHeader(\"content-type\"));\n                        var respVal = (respJson ? jqXHR.responseJSON : jqXHR.responseText);\n                        deffered.resolve(respVal, jqXHR);\n                    }\n                    else {\n                        var plainType = /^\\s*text\\/plain\\s*(;.+)?/i.test(jqXHR.getResponseHeader(\"content-type\"));\n                        var respText;\n                        if (plainType && jqXHR.responseText)\n                            respText = tui.str(jqXHR.responseText);\n                        else {\n                            if (jqXHR.status != 0)\n                                respText = tui.str(status) + \" (\" + jqXHR.status + \")\";\n                            else\n                                respText = \"Operation was canceled!\";\n                        }\n                        if ((!options || !options[\"silent\"]) && jqXHR.status != 0)\n                            tui.errbox(respText);\n                        deffered.reject(jqXHR.status, respText, jqXHR);\n                    }\n                },\n                \"processData\": false\n            };\n            if (options) {\n                for (var k in options) {\n                    if (options.hasOwnProperty(k)) {\n                        ajaxData[k] = options[k];\n                    }\n                }\n            }\n            $.ajax(ajaxData);\n            return deffered;\n        }\n        ajax.send = send;\n        function post(url, data, options) {\n            return send(url, \"post\", data, options);\n        }\n        ajax.post = post;\n        function post_(url, data, options) {\n            if (!options)\n                options = { \"silent\": true };\n            else\n                options[\"silent\"] = true;\n            return send(url, \"post\", data, options);\n        }\n        ajax.post_ = post_;\n        function get(url, options) {\n            return send(url, \"get\", null, options);\n        }\n        ajax.get = get;\n        function get_(url, options) {\n            if (!options)\n                options = { \"silent\": true };\n            else\n                options[\"silent\"] = true;\n            return send(url, \"get\", null, options);\n        }\n        ajax.get_ = get_;\n        function getScript(url) {\n            var deffered = $.Deferred();\n            var xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState == 4) {\n                    if (xhr.status == 200)\n                        deffered.resolve(xhr.responseText, xhr);\n                    else\n                        deffered.reject(xhr.status, xhr.responseText, xhr);\n                }\n            };\n            xhr.open(\"GET\", url, true);\n            xhr.send(null);\n            return deffered;\n        }\n        ajax.getScript = getScript;\n        var TAG = /<(\\/?[a-z0-9_\\-:]+)(\\s+[a-z0-9_\\-]+(\\s*=('[^']*'|\"[^\"]*\"|[^\\s>]+)))*\\/?>/img;\n        var SCRIPT_END = /<\\/\\s*script(\\s+[a-z0-9_\\-]+(\\s*=('[^']*'|\"[^\"]*\"|[^\\s>]+)))*>/img;\n        function getHtmlBody(result) {\n            // To compatible IE 8~9 I must parse html by myself!\n            if (result == null || result.length == 0)\n                return document.createElement(\"body\");\n            TAG.lastIndex = 0;\n            var len = result.length;\n            var m;\n            var bodyStart = null;\n            var bodyEnd = null;\n            while ((m = TAG.exec(result)) != null) {\n                var tag = m[1].toLowerCase();\n                if (tag === \"script\") {\n                    SCRIPT_END.lastIndex = TAG.lastIndex;\n                    var scriptEnd = SCRIPT_END.exec(result);\n                    if (scriptEnd == null)\n                        break;\n                    TAG.lastIndex = SCRIPT_END.lastIndex;\n                }\n                else if (tag === \"body\") {\n                    bodyStart = TAG.lastIndex;\n                }\n                else if (tag === \"/body\") {\n                    bodyEnd = m.index;\n                }\n                else if (tag === \"/html\") {\n                    if (bodyEnd == null)\n                        bodyEnd = m.index;\n                }\n            }\n            if (bodyStart != null) {\n                if (bodyEnd != null && bodyEnd >= bodyStart) {\n                    result = result.substring(bodyStart, bodyEnd);\n                }\n                else {\n                    result = result.substring(bodyStart);\n                }\n            }\n            var body = document.createElement(\"body\");\n            body.innerHTML = result;\n            return body;\n        }\n        function getBody(url) {\n            var deffered = $.Deferred();\n            getScript(url).done(function (result) {\n                deffered.resolve(getHtmlBody(result).innerHTML);\n            }).fail(function (status, responseText, xhr) {\n                deffered.reject(status, responseText, xhr);\n            });\n            return deffered;\n        }\n        ajax.getBody = getBody;\n        function getComponent(url) {\n            var deffered = $.Deferred();\n            getScript(url).done(function (result) {\n                var body = getHtmlBody(result);\n                for (var i = 0; i < body.children.length; i++) {\n                    var child = body.children[i];\n                    if (tui.widget.getFullName(child) === \"tui:component\") {\n                        var handler = child.getAttribute(\"handler\");\n                        if (handler && handler.trim()) {\n                            if (!tui.text.isAbsUrl(handler)) {\n                                handler = tui.text.joinUrl(tui.text.getBaseUrl(url), handler);\n                            }\n                        }\n                        deffered.resolve(child.innerHTML, handler ? handler : null);\n                        return;\n                    }\n                }\n                deffered.resolve(body.innerHTML);\n            }).fail(function (status, responseText, xhr) {\n                deffered.reject(status, responseText, xhr);\n            });\n            return deffered;\n        }\n        ajax.getComponent = getComponent;\n        function getFunction(url, param) {\n            var deffered = $.Deferred();\n            getScript(url).done(function (result) {\n                var fn = eval(\"(0,function(){\\n\" + result + \"})\"\n                    + \"\\n//# sourceURL=\" + url);\n                deffered.resolve(fn, param);\n            }).fail(function (status, responseText, xhr) {\n                deffered.reject(status, responseText, xhr);\n            });\n            return deffered;\n        }\n        ajax.getFunction = getFunction;\n        window.$ajax = send;\n        window.$post = post;\n        window.$post_ = post_; // silent mode\n        window.$get = get;\n        window.$get_ = get_; // silent mode\n    })(ajax = tui.ajax || (tui.ajax = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\nvar tui;\n(function (tui) {\n    var browser;\n    (function (browser) {\n        \"use strict\";\n        var BackupedScrollPosition = (function () {\n            function BackupedScrollPosition(target) {\n                this.backupInfo = [];\n                var obj = target;\n                while (obj && obj !== document.body) {\n                    obj = obj.parentElement;\n                    if (obj)\n                        this.backupInfo.push({ obj: obj, left: obj.scrollLeft, top: obj.scrollTop });\n                }\n            }\n            BackupedScrollPosition.prototype.restore = function () {\n                for (var i = 0; i < this.backupInfo.length; i++) {\n                    var item = this.backupInfo[i];\n                    item.obj.scrollLeft = item.left;\n                    item.obj.scrollTop = item.top;\n                }\n            };\n            return BackupedScrollPosition;\n        }());\n        browser.BackupedScrollPosition = BackupedScrollPosition;\n        function backupScrollPosition(target) {\n            return new BackupedScrollPosition(target);\n        }\n        browser.backupScrollPosition = backupScrollPosition;\n        function focusWithoutScroll(target) {\n            setTimeout(function () {\n                if (tui.ieVer > 0) {\n                    target.setActive();\n                }\n                else if (tui.ffVer > 0)\n                    target.focus();\n                else {\n                    var backup = tui.browser.backupScrollPosition(target);\n                    target.focus();\n                    backup.restore();\n                }\n            }, 0);\n        }\n        browser.focusWithoutScroll = focusWithoutScroll;\n        function scrollToElement(elem) {\n            var param = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                param[_i - 1] = arguments[_i];\n            }\n            var distance = 0;\n            var cb = null;\n            var useAnimation = true;\n            for (var _a = 0, param_1 = param; _a < param_1.length; _a++) {\n                var p = param_1[_a];\n                if (typeof p === \"number\")\n                    distance = p;\n                else if (typeof p === \"boolean\")\n                    useAnimation = p;\n                else if (typeof p === \"function\")\n                    cb = p;\n            }\n            if (useAnimation) {\n                $(getWindowScrollElement()).animate({ scrollTop: $(elem).offset().top - distance }, 150, cb);\n            }\n            else {\n                getWindowScrollElement().scrollTop = $(elem).offset().top - distance;\n                cb && cb();\n            }\n        }\n        browser.scrollToElement = scrollToElement;\n        function toElement(html, withParentDiv) {\n            if (withParentDiv === void 0) { withParentDiv = false; }\n            var div = document.createElement(\"div\");\n            div.innerHTML = $.trim(html);\n            if (withParentDiv)\n                return div;\n            var el = div.firstChild;\n            return div.removeChild(el);\n        }\n        browser.toElement = toElement;\n        function toHTML(node) {\n            var elem = document.createElement(\"span\");\n            if (typeof node.nodeName === \"string\") {\n                elem.appendChild(node);\n            }\n            else if (typeof node.length === \"number\") {\n                for (var i = 0; i < node.length; i++) {\n                    elem.appendChild(node[i]);\n                }\n            }\n            return elem.innerHTML;\n        }\n        browser.toHTML = toHTML;\n        function removeNode(node) {\n            node.parentNode && node.parentNode.removeChild(node);\n        }\n        browser.removeNode = removeNode;\n        function toSafeText(text) {\n            return text.replace(/<|>|&/g, function (str) {\n                var args = [];\n                for (var _i = 1; _i < arguments.length; _i++) {\n                    args[_i - 1] = arguments[_i];\n                }\n                if (str === \"<\")\n                    return \"&lt;\";\n                else if (str === \"<\")\n                    return \"&gt;\";\n                else if (str === \"&\")\n                    return \"&amp;\";\n                else\n                    return str;\n            });\n        }\n        browser.toSafeText = toSafeText;\n        /**\n         * Get or set a HTMLElement's text content, return Element's text content.\n         * @param elem {HTMLElement or ID of the element} Objective element\n         * @param text {string or boolean}\n         */\n        function nodeText(elem, text) {\n            if (typeof elem === \"string\")\n                elem = document.getElementById(elem);\n            if (elem) {\n                if (typeof text === \"string\") {\n                    elem.innerHTML = \"\";\n                    elem.appendChild(document.createTextNode(text));\n                    return text;\n                }\n                if (typeof text !== \"boolean\")\n                    text = true;\n                var buf = \"\";\n                for (var i = 0; i < elem.childNodes.length; i++) {\n                    var c = elem.childNodes[i];\n                    if (c.nodeName.toLowerCase() === \"#text\") {\n                        buf += c.nodeValue;\n                    }\n                    else if (text)\n                        buf += nodeText(c);\n                }\n                return buf;\n            }\n            else\n                return null;\n        }\n        function getNodeText(elem) {\n            return nodeText(elem);\n        }\n        browser.getNodeText = getNodeText;\n        function setNodeText(elem, text) {\n            nodeText(elem, text);\n        }\n        browser.setNodeText = setNodeText;\n        function getNodeOwnText(elem) {\n            return nodeText(elem, false);\n        }\n        browser.getNodeOwnText = getNodeOwnText;\n        function getRectOfParent(elem) {\n            if (elem === null)\n                return null;\n            return {\n                left: elem.offsetLeft,\n                top: elem.offsetTop,\n                width: elem.offsetWidth,\n                height: elem.offsetHeight\n            };\n        }\n        browser.getRectOfParent = getRectOfParent;\n        function getRectOfPage(elem) {\n            if (elem === null)\n                return null;\n            var offset = $(elem).offset();\n            return {\n                left: offset.left,\n                top: offset.top,\n                width: elem.offsetWidth,\n                height: elem.offsetHeight\n            };\n        }\n        browser.getRectOfPage = getRectOfPage;\n        function getRectOfScreen(elem) {\n            if (elem === null)\n                return null;\n            var offset = $(elem).offset();\n            var $doc = $(document);\n            return {\n                left: offset.left - $doc.scrollLeft(),\n                top: offset.top - $doc.scrollTop(),\n                width: elem.offsetWidth,\n                height: elem.offsetHeight\n            };\n        }\n        browser.getRectOfScreen = getRectOfScreen;\n        /**\n         * Get top window's body element\n         */\n        function getTopBody() {\n            return top.document.body || top.document.getElementsByTagName(\"BODY\")[0];\n        }\n        browser.getTopBody = getTopBody;\n        /**\n         * Get element's owner window\n         */\n        function getWindow(elem) {\n            return elem.ownerDocument.defaultView || elem.ownerDocument.parentWindow;\n        }\n        browser.getWindow = getWindow;\n        function getWindowScrollElement() {\n            if (tui.ieVer > 0 || tui.ffVer > 0) {\n                return window.document.documentElement;\n            }\n            else {\n                return window.document.body;\n            }\n        }\n        browser.getWindowScrollElement = getWindowScrollElement;\n        var keepTopList = [];\n        function keepTopProc() {\n            var scrollWindow = browser.getWindowScrollElement();\n            for (var _i = 0, keepTopList_1 = keepTopList; _i < keepTopList_1.length; _i++) {\n                var item = keepTopList_1[_i];\n                var rect = browser.getRectOfScreen(item.elem);\n                if (rect.top < item.top) {\n                    item.oldPosition = item.elem.style.position;\n                    item.oldTop = item.elem.style.top;\n                    item.oldLeft = item.elem.style.left;\n                    item.oldWidth = item.elem.style.width;\n                    item.oldZIndex = item.elem.style.zIndex;\n                    item.scrollTop = scrollWindow.scrollTop;\n                    item.scrollLeft = scrollWindow.scrollLeft;\n                    item.elem.style.zIndex = \"1000\";\n                    item.elem.style.width = item.elem.clientWidth + \"px\";\n                    item.elem.style.position = \"fixed\";\n                    item.elem.style.top = item.top + \"px\";\n                    item.elem.style.left = rect.left + \"px\";\n                    item.itemLeft = rect.left;\n                    item.keepTop = true;\n                }\n                else if (scrollWindow.scrollTop < item.scrollTop) {\n                    item.elem.style.position = item.oldPosition;\n                    item.elem.style.top = item.oldTop;\n                    item.elem.style.left = item.oldLeft;\n                    item.elem.style.width = item.oldWidth;\n                    item.keepTop = false;\n                }\n                else if (item.keepTop) {\n                    item.elem.style.left = (item.itemLeft - scrollWindow.scrollLeft + item.scrollLeft) + \"px\";\n                }\n            }\n        }\n        $(window).scroll(keepTopProc);\n        function keepToTop(elem, top) {\n            if (top === void 0) { top = 0; }\n            keepTopList.push({ keepTop: false, elem: elem, top: top });\n        }\n        browser.keepToTop = keepToTop;\n        function cancelKeepToTop(elem) {\n            var newList = [];\n            for (var _i = 0, keepTopList_2 = keepTopList; _i < keepTopList_2.length; _i++) {\n                var item = keepTopList_2[_i];\n                if (item.elem !== elem) {\n                    newList.push(item);\n                }\n                else {\n                    item.elem.style.position = item.oldPosition;\n                    item.elem.style.top = item.oldTop;\n                    item.elem.style.left = item.oldLeft;\n                    item.elem.style.width = item.oldWidth;\n                    item.keepTop = false;\n                }\n            }\n            keepTopList = newList;\n        }\n        browser.cancelKeepToTop = cancelKeepToTop;\n        function getCurrentStyle(elem) {\n            if (elem.currentStyle)\n                return elem.currentStyle;\n            else if (window.getComputedStyle) {\n                return window.getComputedStyle(elem);\n            }\n            else\n                return elem.style;\n        }\n        browser.getCurrentStyle = getCurrentStyle;\n        /**\n         * Test whether the button code is indecated that the event is triggered by a left mouse button.\n         */\n        function isLButton(e) {\n            var button = (typeof e.which !== \"undefined\") ? e.which : e.button;\n            if (button == 1) {\n                return true;\n            }\n            else\n                return false;\n        }\n        browser.isLButton = isLButton;\n        /**\n         * Prevent user press backspace key to go back to previous page\n         */\n        function banBackspace() {\n            function ban(e) {\n                var ev = e || window.event;\n                var obj = ev.target || ev.srcElement;\n                var t = obj.type || obj.getAttribute('type');\n                var vReadOnly = obj.readOnly;\n                var vDisabled = obj.disabled;\n                vReadOnly = (typeof vReadOnly === tui.UNDEFINED) ? false : vReadOnly;\n                vDisabled = (typeof vDisabled === tui.UNDEFINED) ? true : vDisabled;\n                var flag1 = ev.keyCode === 8 && (t === \"password\" || t === \"text\" || t === \"textarea\") && (vReadOnly || vDisabled);\n                var flag2 = ev.keyCode === 8 && t !== \"password\" && t !== \"text\" && t !== \"textarea\";\n                if (flag2 || flag1)\n                    return false;\n            }\n            $(document).bind(\"keypress\", ban);\n            $(document).bind(\"keydown\", ban);\n        }\n        browser.banBackspace = banBackspace;\n        function cancelDefault(event) {\n            if (event.preventDefault) {\n                event.preventDefault();\n            }\n            else {\n                event.returnValue = false;\n            }\n            return false;\n        }\n        browser.cancelDefault = cancelDefault;\n        function cancelBubble(event) {\n            if (event && event.stopPropagation)\n                event.stopPropagation();\n            else\n                window.event.cancelBubble = true;\n            return false;\n        }\n        browser.cancelBubble = cancelBubble;\n        /**\n         * Detect whether the given parent element is the real ancestry element\n         * @param elem\n         * @param parent\n         */\n        function isAncestry(elem, parent) {\n            while (elem) {\n                if (elem === parent)\n                    return true;\n                else\n                    elem = elem.parentNode;\n            }\n            return false;\n        }\n        browser.isAncestry = isAncestry;\n        /**\n         * Detect whether the given child element is the real posterity element\n         * @param elem\n         * @param child\n         */\n        function isPosterity(elem, child) {\n            return isAncestry(child, elem);\n        }\n        browser.isPosterity = isPosterity;\n        function isFireInside(elem, event) {\n            var target = event.target || event.srcElement;\n            return isPosterity(elem, target);\n        }\n        browser.isFireInside = isFireInside;\n        /**\n         * Detect whether the element is inside the document\n         * @param {type} elem\n         */\n        function isInDoc(elem) {\n            var obj = elem;\n            while (obj) {\n                if (obj.nodeName.toUpperCase() === \"HTML\")\n                    return true;\n                obj = obj.parentElement;\n            }\n            return false;\n        }\n        browser.isInDoc = isInDoc;\n        /**\n         * Set cookie value\n         * @param name\n         * @param value\n         * @param expires valid days\n         */\n        function saveCookie(name, value, expires, path, domain, secure) {\n            if (secure === void 0) { secure = false; }\n            // set time, it's in milliseconds\n            var today = new Date();\n            today.setTime(today.getTime());\n            /*\n            if the expires variable is set, make the correct\n            expires time, the current script below will set\n            it for x number of days, to make it for hours,\n            delete * 24, for minutes, delete * 60 * 24\n            */\n            if (expires) {\n                expires = expires * 1000 * 60 * 60 * 24;\n            }\n            var expires_date = new Date(today.getTime() + (expires));\n            document.cookie = name + \"=\" + encodeURIComponent(JSON.stringify(value)) +\n                ((expires) ? \";expires=\" + expires_date.toUTCString() : \"\") +\n                ((path) ? \";path=\" + path : \"\") +\n                ((domain) ? \";domain=\" + domain : \"\") +\n                ((secure) ? \";secure\" : \"\");\n        }\n        browser.saveCookie = saveCookie;\n        /**\n         * Get cookie value\n         * @param name\n         */\n        function loadCookie(name) {\n            var arr = document.cookie.match(new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\"));\n            if (arr !== null)\n                return JSON.parse(decodeURIComponent(arr[2]));\n            else\n                return null;\n        }\n        browser.loadCookie = loadCookie;\n        /**\n         * Delete cookie\n         * @param name\n         */\n        function deleteCookie(name, path, domain) {\n            if (loadCookie(name))\n                document.cookie = name + \"=\" +\n                    ((path) ? \";path=\" + path : \"\") +\n                    ((domain) ? \";domain=\" + domain : \"\") +\n                    \";expires=Thu, 01-Jan-1970 00:00:01 GMT\";\n        }\n        browser.deleteCookie = deleteCookie;\n        /**\n         * Save key value into local storage, if local storage doesn't usable then use local cookie instead.\n         * @param {String} key\n         * @param {String} value\n         * @param {Boolean} sessionOnly If true data only be keeped in this session\n         */\n        function saveData(key, value, sessionOnly) {\n            if (sessionOnly === void 0) { sessionOnly = false; }\n            try {\n                var storage = (sessionOnly === true ? window.sessionStorage : window.localStorage);\n                if (storage) {\n                    storage.setItem(key, JSON.stringify(value));\n                }\n                else\n                    saveCookie(key, value, 365);\n            }\n            catch (e) {\n            }\n        }\n        browser.saveData = saveData;\n        /**\n         * Load value from local storage, if local storage doesn't usable then use local cookie instead.\n         * @param {String} key\n         * @param {Boolean} sessionOnly If true data only be keeped in this session\n         */\n        function loadData(key, sessionOnly) {\n            if (sessionOnly === void 0) { sessionOnly = false; }\n            try {\n                var storage = (sessionOnly === true ? window.sessionStorage : window.localStorage);\n                if (storage)\n                    return JSON.parse(storage.getItem(key));\n                else\n                    return loadCookie(key);\n            }\n            catch (e) {\n                return null;\n            }\n        }\n        browser.loadData = loadData;\n        /**\n         * Remove value from local storage, if local storage doesn't usable then use local cookie instead.\n         * @param key\n         * @param {Boolean} sessionOnly If true data only be keeped in this session\n         */\n        function deleteData(key, sessionOnly) {\n            if (sessionOnly === void 0) { sessionOnly = false; }\n            try {\n                var storage = (sessionOnly === true ? window.sessionStorage : window.localStorage);\n                if (storage)\n                    storage.removeItem(key);\n                else\n                    deleteCookie(key);\n            }\n            catch (e) {\n            }\n        }\n        browser.deleteData = deleteData;\n        var _accMap = {};\n        function accelerate(e) {\n            var k = browser.KeyCode[e.keyCode];\n            if (!k) {\n                return;\n            }\n            k = k.toUpperCase();\n            var key = (e.ctrlKey ? \"CTRL\" : \"\");\n            if (e.altKey) {\n                if (key.length > 0)\n                    key += \"+\";\n                key += \"ALT\";\n            }\n            if (e.shiftKey) {\n                if (key.length > 0)\n                    key += \"+\";\n                key += \"SHIFT\";\n            }\n            if (e.metaKey) {\n                if (key.length > 0)\n                    key += \"+\";\n                key += \"META\";\n            }\n            if (key.length > 0)\n                key += \"+\";\n            key += k;\n            var l = _accMap[key];\n            if (l) {\n                for (var i = 0; i < l.length; i++) {\n                    if (tui.event.fire(\"accelerate\", { name: l[i], event: e }) === false)\n                        return;\n                }\n            }\n        }\n        function addAccelerate(key, actionId) {\n            key = key.toUpperCase();\n            var l = null;\n            if (_accMap.hasOwnProperty(key))\n                l = _accMap[key];\n            else {\n                l = [];\n                _accMap[key] = l;\n            }\n            if (l.indexOf(actionId) < 0)\n                l.push(actionId);\n        }\n        browser.addAccelerate = addAccelerate;\n        function deleteAccelerate(key, actionId) {\n            key = key.toUpperCase();\n            if (!_accMap.hasOwnProperty(key))\n                return;\n            var l = _accMap[key];\n            var pos = l.indexOf(actionId);\n            if (pos >= 0) {\n                l.splice(pos, 1);\n                if (l.length <= 0)\n                    delete _accMap[key];\n            }\n        }\n        browser.deleteAccelerate = deleteAccelerate;\n        $(document).keydown(accelerate);\n        function getUrlParam(key) {\n            var reg = new RegExp(\"(^|&)\" + key + \"=([^&]*)(&|$)\");\n            var r = window.location.search.substr(1).match(reg);\n            if (r != null)\n                return decodeURIComponent(r[2]);\n            return null;\n        }\n        browser.getUrlParam = getUrlParam;\n        function getEventPosition(e, allFingers) {\n            if (allFingers === void 0) { allFingers = false; }\n            var positions = [];\n            var event = e.originalEvent || e;\n            if (event.touches) {\n                var touchList = (allFingers ? event.touches : event.changedTouches);\n                for (var i = 0; i < touchList.length; i++) {\n                    var touch = touchList[i];\n                    positions.push({ x: touch.clientX, y: touch.clientY, id: touch.identifier });\n                }\n            }\n            else {\n                positions.push({ x: event.clientX, y: event.clientY });\n            }\n            return positions;\n        }\n        browser.getEventPosition = getEventPosition;\n        function setInnerHtml(elem, content) {\n            if (tui.ieVer > 0 && tui.ieVer < 9) {\n                elem.innerHTML = \"\";\n                var d = document.createElement(\"div\");\n                d.innerHTML = content;\n                while (d.children.length > 0)\n                    elem.appendChild(d.children[0]);\n            }\n            else {\n                elem && (elem.innerHTML = content);\n            }\n        }\n        browser.setInnerHtml = setInnerHtml;\n        window.$text = toSafeText;\n    })(browser = tui.browser || (tui.browser = {}));\n})(tui || (tui = {}));\nvar tui;\n(function (tui) {\n    var browser;\n    (function (browser) {\n        \"use strict\";\n        (function (KeyCode) {\n            KeyCode[KeyCode[\"BACK\"] = 8] = \"BACK\";\n            KeyCode[KeyCode[\"TAB\"] = 9] = \"TAB\";\n            KeyCode[KeyCode[\"ENTER\"] = 13] = \"ENTER\";\n            KeyCode[KeyCode[\"SHIFT\"] = 16] = \"SHIFT\";\n            KeyCode[KeyCode[\"CTRL\"] = 17] = \"CTRL\";\n            KeyCode[KeyCode[\"ALT\"] = 18] = \"ALT\";\n            KeyCode[KeyCode[\"PAUSE\"] = 19] = \"PAUSE\";\n            KeyCode[KeyCode[\"CAPS\"] = 20] = \"CAPS\";\n            KeyCode[KeyCode[\"ESCAPE\"] = 27] = \"ESCAPE\";\n            KeyCode[KeyCode[\"SPACE\"] = 32] = \"SPACE\";\n            KeyCode[KeyCode[\"PRIOR\"] = 33] = \"PRIOR\";\n            KeyCode[KeyCode[\"NEXT\"] = 34] = \"NEXT\";\n            KeyCode[KeyCode[\"END\"] = 35] = \"END\";\n            KeyCode[KeyCode[\"HOME\"] = 36] = \"HOME\";\n            KeyCode[KeyCode[\"LEFT\"] = 37] = \"LEFT\";\n            KeyCode[KeyCode[\"UP\"] = 38] = \"UP\";\n            KeyCode[KeyCode[\"RIGHT\"] = 39] = \"RIGHT\";\n            KeyCode[KeyCode[\"DOWN\"] = 40] = \"DOWN\";\n            KeyCode[KeyCode[\"PRINT\"] = 44] = \"PRINT\";\n            KeyCode[KeyCode[\"INSERT\"] = 45] = \"INSERT\";\n            KeyCode[KeyCode[\"DELETE\"] = 46] = \"DELETE\";\n            KeyCode[KeyCode[\"KEY_0\"] = 48] = \"KEY_0\";\n            KeyCode[KeyCode[\"KEY_1\"] = 49] = \"KEY_1\";\n            KeyCode[KeyCode[\"KEY_2\"] = 50] = \"KEY_2\";\n            KeyCode[KeyCode[\"KEY_3\"] = 51] = \"KEY_3\";\n            KeyCode[KeyCode[\"KEY_4\"] = 52] = \"KEY_4\";\n            KeyCode[KeyCode[\"KEY_5\"] = 53] = \"KEY_5\";\n            KeyCode[KeyCode[\"KEY_6\"] = 54] = \"KEY_6\";\n            KeyCode[KeyCode[\"KEY_7\"] = 55] = \"KEY_7\";\n            KeyCode[KeyCode[\"KEY_8\"] = 56] = \"KEY_8\";\n            KeyCode[KeyCode[\"KEY_9\"] = 57] = \"KEY_9\";\n            KeyCode[KeyCode[\"SEMICOLON\"] = 59] = \"SEMICOLON\";\n            KeyCode[KeyCode[\"EQUALS\"] = 61] = \"EQUALS\";\n            KeyCode[KeyCode[\"A\"] = 65] = \"A\";\n            KeyCode[KeyCode[\"B\"] = 66] = \"B\";\n            KeyCode[KeyCode[\"C\"] = 67] = \"C\";\n            KeyCode[KeyCode[\"D\"] = 68] = \"D\";\n            KeyCode[KeyCode[\"E\"] = 69] = \"E\";\n            KeyCode[KeyCode[\"F\"] = 70] = \"F\";\n            KeyCode[KeyCode[\"G\"] = 71] = \"G\";\n            KeyCode[KeyCode[\"H\"] = 72] = \"H\";\n            KeyCode[KeyCode[\"I\"] = 73] = \"I\";\n            KeyCode[KeyCode[\"J\"] = 74] = \"J\";\n            KeyCode[KeyCode[\"K\"] = 75] = \"K\";\n            KeyCode[KeyCode[\"L\"] = 76] = \"L\";\n            KeyCode[KeyCode[\"M\"] = 77] = \"M\";\n            KeyCode[KeyCode[\"N\"] = 78] = \"N\";\n            KeyCode[KeyCode[\"O\"] = 79] = \"O\";\n            KeyCode[KeyCode[\"P\"] = 80] = \"P\";\n            KeyCode[KeyCode[\"Q\"] = 81] = \"Q\";\n            KeyCode[KeyCode[\"R\"] = 82] = \"R\";\n            KeyCode[KeyCode[\"S\"] = 83] = \"S\";\n            KeyCode[KeyCode[\"T\"] = 84] = \"T\";\n            KeyCode[KeyCode[\"U\"] = 85] = \"U\";\n            KeyCode[KeyCode[\"V\"] = 86] = \"V\";\n            KeyCode[KeyCode[\"W\"] = 87] = \"W\";\n            KeyCode[KeyCode[\"X\"] = 88] = \"X\";\n            KeyCode[KeyCode[\"Y\"] = 89] = \"Y\";\n            KeyCode[KeyCode[\"Z\"] = 90] = \"Z\";\n            KeyCode[KeyCode[\"WINDOWS\"] = 91] = \"WINDOWS\";\n            KeyCode[KeyCode[\"NUM_0\"] = 96] = \"NUM_0\";\n            KeyCode[KeyCode[\"NUM_1\"] = 97] = \"NUM_1\";\n            KeyCode[KeyCode[\"NUM_2\"] = 98] = \"NUM_2\";\n            KeyCode[KeyCode[\"NUM_3\"] = 99] = \"NUM_3\";\n            KeyCode[KeyCode[\"NUM_4\"] = 100] = \"NUM_4\";\n            KeyCode[KeyCode[\"NUM_5\"] = 101] = \"NUM_5\";\n            KeyCode[KeyCode[\"NUM_6\"] = 102] = \"NUM_6\";\n            KeyCode[KeyCode[\"NUM_7\"] = 103] = \"NUM_7\";\n            KeyCode[KeyCode[\"NUM_8\"] = 104] = \"NUM_8\";\n            KeyCode[KeyCode[\"NUM_9\"] = 105] = \"NUM_9\";\n            KeyCode[KeyCode[\"NUM_MUL\"] = 106] = \"NUM_MUL\";\n            KeyCode[KeyCode[\"NUM_PLUS\"] = 107] = \"NUM_PLUS\";\n            KeyCode[KeyCode[\"NUM_MINUS\"] = 109] = \"NUM_MINUS\";\n            KeyCode[KeyCode[\"NUM_DOT\"] = 110] = \"NUM_DOT\";\n            KeyCode[KeyCode[\"NUM_DIV\"] = 111] = \"NUM_DIV\";\n            KeyCode[KeyCode[\"F1\"] = 112] = \"F1\";\n            KeyCode[KeyCode[\"F2\"] = 113] = \"F2\";\n            KeyCode[KeyCode[\"F3\"] = 114] = \"F3\";\n            KeyCode[KeyCode[\"F4\"] = 115] = \"F4\";\n            KeyCode[KeyCode[\"F5\"] = 116] = \"F5\";\n            KeyCode[KeyCode[\"F6\"] = 117] = \"F6\";\n            KeyCode[KeyCode[\"F7\"] = 118] = \"F7\";\n            KeyCode[KeyCode[\"F8\"] = 119] = \"F8\";\n            KeyCode[KeyCode[\"F9\"] = 120] = \"F9\";\n            KeyCode[KeyCode[\"F10\"] = 121] = \"F10\";\n            KeyCode[KeyCode[\"F11\"] = 122] = \"F11\";\n            KeyCode[KeyCode[\"F12\"] = 123] = \"F12\";\n            KeyCode[KeyCode[\"DASH\"] = 173] = \"DASH\";\n            KeyCode[KeyCode[\"COMMA\"] = 188] = \"COMMA\";\n            KeyCode[KeyCode[\"PERIOD\"] = 190] = \"PERIOD\";\n            KeyCode[KeyCode[\"SLASH\"] = 191] = \"SLASH\";\n            KeyCode[KeyCode[\"GRAVE\"] = 192] = \"GRAVE\";\n            KeyCode[KeyCode[\"LEFT_BRACKET\"] = 219] = \"LEFT_BRACKET\";\n            KeyCode[KeyCode[\"BACKSLASH\"] = 220] = \"BACKSLASH\";\n            KeyCode[KeyCode[\"RIGHT_BRACKET\"] = 221] = \"RIGHT_BRACKET\";\n            KeyCode[KeyCode[\"QUOTE\"] = 222] = \"QUOTE\";\n        })(browser.KeyCode || (browser.KeyCode = {}));\n        var KeyCode = browser.KeyCode;\n    })(browser = tui.browser || (tui.browser = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\n/// <reference path=\"browser.ts\" />\nvar tui;\n(function (tui) {\n    var browser;\n    (function (browser) {\n        \"use strict\";\n        var _rules;\n        var _handler;\n        function hashChange() {\n            var hash = location.hash;\n            var state = null;\n            if (hash) {\n                var p = hash.indexOf(\"?\");\n                if (p >= 0)\n                    state = hash.substring(1, p);\n                else\n                    state = hash.substring(1);\n            }\n            if (_rules) {\n                var matchRule = null;\n                for (var _i = 0, _rules_1 = _rules; _i < _rules_1.length; _i++) {\n                    var r = _rules_1[_i];\n                    if (r.state === state) {\n                        matchRule = r;\n                        break;\n                    }\n                }\n                if (matchRule == null) {\n                    for (var _a = 0, _rules_2 = _rules; _a < _rules_2.length; _a++) {\n                        var r = _rules_2[_a];\n                        if (r.state === \"/\") {\n                            matchRule = r;\n                            break;\n                        }\n                    }\n                }\n                if (matchRule) {\n                    if (matchRule.handler && matchRule.handler(matchRule.state, hash, matchRule.url) === false) {\n                        return;\n                    }\n                    _handler && _handler(matchRule.state, hash, matchRule.url);\n                }\n            }\n        }\n        function startRouter(rules, handler) {\n            _rules = rules;\n            _handler = handler;\n            $(window).on(\"hashchange\", hashChange);\n            tui.event.on(\"initialized\", function () {\n                hashChange();\n            });\n        }\n        browser.startRouter = startRouter;\n        function stopRouter() {\n            $(window).off(\"hashchange\", hashChange);\n        }\n        browser.stopRouter = stopRouter;\n    })(browser = tui.browser || (tui.browser = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\n/// <reference path=\"browser.ts\" />\nvar tui;\n(function (tui) {\n    var browser;\n    (function (browser) {\n        \"use strict\";\n        function fileFromPath(file) {\n            return file.replace(/.*(\\/|\\\\)/, \"\");\n        }\n        function getExt(file) {\n            return (-1 !== file.indexOf('.')) ? file.replace(/.*[.]/, '') : '';\n        }\n        function preventDefault(e) {\n            return e.preventDefault();\n        }\n        var Uploader = (function (_super) {\n            __extends(Uploader, _super);\n            function Uploader(container, options) {\n                _super.call(this);\n                this._settings = {\n                    action: \"upload\",\n                    name: \"file\",\n                    multiple: false,\n                    autoSubmit: true\n                };\n                this._container = null;\n                this._input = null;\n                this.setOptions(options);\n                if (!container || container.nodeType !== 1) {\n                    throw new Error(\"Please make sure that you're passing a valid element\");\n                }\n                if (container.nodeName.toLowerCase() === 'a') {\n                    // disable link\n                    $(container).on('click', function (e) { e.preventDefault(); });\n                }\n                // DOM element\n                this._container = container;\n                // DOM element                 \n                this._input = null;\n            }\n            Uploader.prototype.setOptions = function (options) {\n                if (options) {\n                    for (var i in options) {\n                        if (options.hasOwnProperty(i)) {\n                            this._settings[i] = options[i];\n                        }\n                    }\n                }\n            };\n            Uploader.prototype.getOptions = function () {\n                return this._settings;\n            };\n            Uploader.prototype.createIframe = function () {\n                var id = tui.tuid();\n                var iframe = browser.toElement('<iframe src=\"javascript:false;\" name=\"' + id + '\" />');\n                iframe.setAttribute('id', id);\n                iframe.style.display = 'none';\n                document.body.appendChild(iframe);\n                var doc = iframe.contentDocument ? iframe.contentDocument : window.frames[iframe.id].document;\n                try {\n                    doc.charset = \"utf-8\";\n                }\n                catch (e) { }\n                return iframe;\n            };\n            Uploader.prototype.createForm = function (iframe) {\n                var settings = this._settings;\n                var form = browser.toElement('<form method=\"post\" enctype=\"multipart/form-data\" accept-charset=\"UTF-8\"></form>');\n                form.setAttribute('accept-charset', 'UTF-8');\n                if (settings.action)\n                    form.setAttribute('action', settings.action);\n                form.setAttribute('target', iframe.name);\n                form.style.display = 'none';\n                document.body.appendChild(form);\n                // Create hidden input element for each data key\n                return form;\n            };\n            Uploader.prototype.createInput = function () {\n                var _this = this;\n                if (this._input) {\n                    return;\n                }\n                var input = document.createElement(\"input\");\n                input.setAttribute('type', 'file');\n                if (this._settings.accept)\n                    input.setAttribute('accept', this._settings.accept);\n                input.setAttribute('name', this._settings.name);\n                if (this._settings.multiple)\n                    input.setAttribute('multiple', 'multiple');\n                if (tui.ieVer > 0)\n                    input.title = \"\";\n                else\n                    input.title = \" \";\n                $(input).css({\n                    'position': 'absolute',\n                    'right': 0,\n                    'top': 0,\n                    'height': '1000px',\n                    'width': '2000px',\n                    'margin': 0,\n                    'padding': 0,\n                    'opacity': 0,\n                    'filter': 'alpha(opacity=0)',\n                    'fontSize': '10000px',\n                    'fontFamily': 'sans-serif',\n                    'cursor': 'pointer'\n                });\n                $(input).on('change', function (e) {\n                    if (!input || input.value === '') {\n                        return;\n                    }\n                    // Get filename from input, required                \n                    // as some browsers have path instead of it\n                    var file = fileFromPath(input.value);\n                    var fileExt = getExt(file);\n                    if (_this.fire(\"change\", { e: e, \"file\": file, \"ext\": fileExt }) === false) {\n                        _this.clearInput();\n                        return;\n                    }\n                    // Submit form when value is changed\n                    if (_this._settings.autoSubmit) {\n                        _this.submit();\n                    }\n                });\n                var style = browser.getCurrentStyle(this._container);\n                if (style.position === \"static\") {\n                    this._container.style.position = \"relative\";\n                }\n                this._container.style.overflow = \"hidden\";\n                this._container.appendChild(input);\n                this._input = input;\n                $(this._input).focus(function () {\n                    _this.fire(\"focus\");\n                });\n                $(this._input).blur(function () {\n                    _this.fire(\"blur\");\n                });\n            };\n            Uploader.prototype.deleteInput = function () {\n                if (!this._input) {\n                    return;\n                }\n                browser.removeNode(this._input);\n                this._input = null;\n            };\n            Uploader.prototype.getInput = function () {\n                return this._input;\n            };\n            Uploader.prototype.clearInput = function () {\n                this.deleteInput();\n                this.createInput();\n            };\n            /**\n            * Gets response from iframe and fires onComplete event when ready\n            * @param iframe\n            * @param file Filename to use in onComplete callback\n            */\n            Uploader.prototype.processResponse = function (iframe, file) {\n                var _this = this;\n                // getting response\n                var waitbox = tui.waitbox(tui.str(\"Uploading...\"));\n                var toDeleteFlag = false, settings = this._settings;\n                $(iframe).on('load', function () {\n                    if (iframe.src === \"javascript:'%3Chtml%3E%3C/html%3E';\" ||\n                        // For FF, IE\n                        iframe.src === \"javascript:'<html></html>';\") {\n                        // First time around, do not delete.\n                        // We reload to blank page, so that reloading main page\n                        // does not re-submit the post.\n                        if (toDeleteFlag) {\n                            // Fix busy state in FF3\n                            setTimeout(function () {\n                                browser.removeNode(iframe);\n                            }, 0);\n                        }\n                        return;\n                    }\n                    var doc = iframe.contentDocument ? iframe.contentDocument : window.frames[iframe.id].document;\n                    // fixing Opera 9.26,10.00\n                    if (doc.readyState && doc.readyState !== 'complete') {\n                        waitbox.close();\n                        return;\n                    }\n                    // fixing Opera 9.64\n                    if (doc.body && doc.body.innerHTML === \"false\") {\n                        waitbox.close();\n                        return;\n                    }\n                    waitbox.close();\n                    var response;\n                    if (doc.body) {\n                        // response is html document or plain text\n                        response = doc.body.innerHTML;\n                        try {\n                            if (doc.body.firstChild && doc.body.firstChild.nodeName.toUpperCase() === 'PRE') {\n                                doc.normalize && doc.normalize();\n                                response = doc.body.firstChild.firstChild.nodeValue;\n                            }\n                            if (response) {\n                                var responseObj = eval(\"(\" + response + \")\");\n                                if (!responseObj) {\n                                    _this.fireError();\n                                }\n                                else if (responseObj.error) {\n                                    _this.fireError(responseObj.error);\n                                }\n                                else if (responseObj.fileId && responseObj.fileName)\n                                    _this.fire(\"success\", { \"file\": file, \"ext\": getExt(file), \"response\": responseObj });\n                                else\n                                    _this.fireError();\n                            }\n                            else {\n                                _this.fireError();\n                            }\n                        }\n                        catch (e) {\n                            _this.fireError();\n                        }\n                    }\n                    else {\n                        _this.fireError();\n                    }\n                    // Reload blank page, so that reloading main page\n                    // does not re-submit the post. Also, remember to\n                    // delete the frame\n                    toDeleteFlag = true;\n                    // Fix IE mixed content issue\n                    iframe.src = \"javascript:'<html></html>';\";\n                    browser.removeNode(iframe);\n                });\n            };\n            Uploader.prototype.fireInvalidError = function () {\n                this.fire(\"error\", { \"response\": { error: tui.str(\"Upload failed: invalid response content!\") } });\n            };\n            Uploader.prototype.fireError = function (errorMessage) {\n                this.fire(\"error\", { \"response\": {\n                        error: tui.str(\"Upload failed!\") + (errorMessage ? errorMessage : \"\")\n                    } });\n            };\n            Uploader.prototype.submitV5 = function (file, extraData) {\n                var _this = this;\n                var waitbox = tui.waitbox(tui.str(\"Uploading...\"));\n                var fd = new FormData();\n                for (var i = 0; i < this._input.files.length; i++)\n                    fd.append(this._settings.name, this._input.files[i]);\n                var xhr = new XMLHttpRequest();\n                xhr.upload.addEventListener(\"progress\", function (e) {\n                    if (e.lengthComputable) {\n                        var percentComplete = Math.round(e.loaded * 100 / e.total);\n                        waitbox.setMessage(tui.str(\"Uploading... \") + percentComplete.toString() + '%');\n                    }\n                }, false);\n                xhr.addEventListener(\"load\", function (e) {\n                    waitbox.close();\n                    if (e.target.status != 200) {\n                        _this.fire(\"error\", { \"file\": file, \"ext\": getExt(file), \"response\": {\n                                error: tui.str(e.target.response || e.target.statusText || e.target.status)\n                            } });\n                    }\n                    else {\n                        try {\n                            var result = JSON.parse(e.target.responseText);\n                            if (result.fileId && result.fileName)\n                                _this.fire(\"success\", { \"file\": file, \"ext\": getExt(file), \"response\": result });\n                            else\n                                _this.fireError();\n                        }\n                        catch (e) {\n                            _this.fireInvalidError();\n                        }\n                    }\n                }, false);\n                xhr.addEventListener(\"error\", function (e) {\n                    waitbox.close();\n                    _this.fireError();\n                }, false);\n                xhr.addEventListener(\"abort\", function (e) {\n                    waitbox.close();\n                    _this.fireError();\n                }, false);\n                xhr.open(\"POST\", this._settings.action);\n                xhr.send(fd);\n                this.clearInput();\n            };\n            Uploader.prototype.submitV4 = function (file, extraData) {\n                // sending request    \n                var iframe = this.createIframe();\n                var form = this.createForm(iframe);\n                // assuming following structure\n                // div -> input type='file'\n                form.appendChild(this._input);\n                if (extraData) {\n                    for (var prop in extraData) {\n                        if (extraData.hasOwnProperty(prop)) {\n                            var el = document.createElement(\"input\");\n                            el.setAttribute('type', 'hidden');\n                            el.setAttribute('name', prop);\n                            el.setAttribute('value', extraData[prop]);\n                            form.appendChild(el);\n                        }\n                    }\n                }\n                this.processResponse(iframe, file);\n                form.submit();\n                // request set, clean up\n                browser.removeNode(form);\n                form = null;\n                this.clearInput();\n            };\n            Uploader.prototype.submit = function (extraData) {\n                if (!this._input || this._input.value === '') {\n                    return;\n                }\n                var file = fileFromPath(this._input.value);\n                // user returned false to cancel upload\n                if (this.fire(\"submit\", { \"file\": file, \"ext\": getExt(file) }) === false) {\n                    this.clearInput();\n                    this.fire(\"blur\");\n                    return;\n                }\n                this.fire(\"blur\");\n                if (typeof FormData === \"function\") {\n                    this.submitV5(file, extraData);\n                }\n                else\n                    this.submitV4(file, extraData);\n            };\n            return Uploader;\n        }(tui.EventObject));\n        browser.Uploader = Uploader;\n        function createUploader(container, options) {\n            return new Uploader(container, options);\n        }\n        browser.createUploader = createUploader;\n    })(browser = tui.browser || (tui.browser = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\nvar tui;\n(function (tui) {\n    var ds;\n    (function (ds) {\n        \"use strict\";\n        var DSBase = (function (_super) {\n            __extends(DSBase, _super);\n            function DSBase() {\n                _super.apply(this, arguments);\n                this._finalData = null;\n                this._order = null;\n                this._filter = null;\n            }\n            DSBase.prototype.setOrder = function (order) {\n                this._order = order;\n                this.build();\n            };\n            DSBase.prototype.getOrder = function () {\n                return this._order;\n            };\n            DSBase.prototype.setFilter = function (filter) {\n                this._filter = filter;\n                this.build();\n            };\n            DSBase.prototype.getFilter = function () {\n                return this._filter;\n            };\n            return DSBase;\n        }(tui.EventObject));\n        ds.DSBase = DSBase;\n        function filter(value, filter) {\n            if (filter) {\n                for (var _i = 0, filter_1 = filter; _i < filter_1.length; _i++) {\n                    var f = filter_1[_i];\n                    var v = value[f.key];\n                    if (v == null) {\n                        if (f.value == null)\n                            continue;\n                        else\n                            return false;\n                    }\n                    try {\n                        var regex = new RegExp(f.value);\n                        if (v.toString().match(regex) == null)\n                            return false;\n                    }\n                    catch (e) {\n                        if (v.indexOf(f.value) < 0)\n                            return false;\n                    }\n                }\n            }\n            return true;\n        }\n        function sort(data, order, treeData) {\n            if (order && order.length > 0) {\n                data.sort(function (a, b) {\n                    for (var _i = 0, order_1 = order; _i < order_1.length; _i++) {\n                        var s = order_1[_i];\n                        var aVal = treeData ? a.item[s.key] : a[s.key];\n                        var bVal = treeData ? b.item[s.key] : b[s.key];\n                        if (aVal == bVal)\n                            continue;\n                        if (s.desc) {\n                            return aVal > bVal ? -1 : 1;\n                        }\n                        else\n                            return aVal < bVal ? -1 : 1;\n                    }\n                    return 0;\n                });\n            }\n        }\n        var List = (function (_super) {\n            __extends(List, _super);\n            function List(data, filter, order) {\n                if (filter === void 0) { filter = null; }\n                if (order === void 0) { order = null; }\n                _super.call(this);\n                this._data = data;\n                this._filter = filter;\n                this._order = order;\n                this.build();\n            }\n            List.prototype.length = function () {\n                if (this._finalData == null)\n                    return this._data.length;\n                else\n                    return this._finalData.length;\n            };\n            List.prototype.get = function (index) {\n                if (this._finalData == null)\n                    return this._data[index];\n                else\n                    return this._finalData[index];\n            };\n            List.prototype.build = function () {\n                var _this = this;\n                if (this._data == null) {\n                    this._finalData = null;\n                    return;\n                }\n                if ((this._filter == null || this._filter.length == 0) &&\n                    (this._order == null || this._order.length == 0))\n                    this._finalData = null;\n                else {\n                    this._finalData = this._data.filter(function (value, index, array) {\n                        return filter(value, _this._filter);\n                    });\n                    sort(this._finalData, this._order, false);\n                }\n                this.fire(\"update\", { \"completely\": true });\n            };\n            return List;\n        }(DSBase));\n        ds.List = List;\n        var RemoteList = (function (_super) {\n            __extends(RemoteList, _super);\n            function RemoteList(cacheSize, filter, order) {\n                if (cacheSize === void 0) { cacheSize = 50; }\n                if (filter === void 0) { filter = null; }\n                if (order === void 0) { order = null; }\n                _super.call(this);\n                this._cache1 = null;\n                this._cache2 = null;\n                this._length = null;\n                this._cacheSize = cacheSize;\n                this.reset();\n                this._filter = filter;\n                this._order = order;\n            }\n            RemoteList.prototype.length = function () {\n                if (this._length === null) {\n                    this.fire(\"query\", {\n                        begin: 0,\n                        size: this._cacheSize,\n                        filter: this._filter,\n                        order: this._order\n                    });\n                    return 0;\n                }\n                else\n                    return this._length;\n            };\n            RemoteList.prototype.get = function (index) {\n                if (index >= 0 && index < this.length()) {\n                    var item = this.getFromCache(index, this._cache1);\n                    if (item === null)\n                        item = this.getFromCache(index, this._cache2);\n                    if (item === null) {\n                        var page = this.getIndexPage(index);\n                        if (this._cache1 === null) {\n                            this._fillCache = 1;\n                        }\n                        else if (this._cache2 === null)\n                            this._fillCache = 2;\n                        else {\n                            this._fillCache = Math.abs(page - this._cache1.page) > Math.abs(page - this._cache2.page) ? 1 : 2;\n                        }\n                        this.fire(\"query\", {\n                            begin: page * this._cacheSize,\n                            size: this._cacheSize,\n                            filter: this._filter,\n                            rder: this._order\n                        });\n                    }\n                }\n                else\n                    return null;\n            };\n            RemoteList.prototype.getIndexPage = function (index) {\n                return Math.ceil((index + 1) / this._cacheSize - 1);\n            };\n            RemoteList.prototype.getFromCache = function (index, cache) {\n                if (cache === null)\n                    return null;\n                var begin = cache.page * this._cacheSize;\n                var end = begin + cache.data.length;\n                if (index >= begin && index < end)\n                    return cache.data[index - begin];\n                else\n                    return null;\n            };\n            RemoteList.prototype.update = function (result) {\n                var completely = this._length != result.length;\n                this._length = result.length;\n                if (this._fillCache === 1) {\n                    this._cache1 = { page: this.getIndexPage(result.begin), data: result.data };\n                }\n                else if (this._fillCache === 2) {\n                    this._cache2 = { page: this.getIndexPage(result.begin), data: result.data };\n                }\n                this.fire(\"update\", { \"completely\": completely });\n            };\n            RemoteList.prototype.reset = function () {\n                this._length = null;\n                this._cache1 = this._cache2 = null;\n                this._fillCache = 1;\n            };\n            RemoteList.prototype.build = function () {\n                this.reset();\n                this.fire(\"query\", {\n                    begin: 0,\n                    size: this._cacheSize,\n                    filter: this._filter,\n                    order: this._order\n                });\n            };\n            return RemoteList;\n        }(DSBase));\n        ds.RemoteList = RemoteList; // End of RemoteListSource\n        var TreeBase = (function (_super) {\n            __extends(TreeBase, _super);\n            function TreeBase() {\n                _super.apply(this, arguments);\n                this._index = null;\n                this._rawData = null;\n            }\n            TreeBase.prototype.getConfig = function () {\n                return this._config;\n            };\n            TreeBase.prototype.length = function () {\n                if (this._finalData)\n                    return this._finalData.length;\n                else if (this._index)\n                    return this._index.length;\n                else\n                    return 0;\n            };\n            TreeBase.prototype.getRawData = function () {\n                return this._rawData;\n            };\n            TreeBase.prototype.get = function (index) {\n                if (this._finalData) {\n                    if (index >= 0 && index < this._finalData.length)\n                        return this._finalData[index];\n                    else\n                        return null;\n                }\n                else if (index >= 0 && index < this.length()) {\n                    return this._index[index];\n                }\n                else\n                    return null;\n            };\n            TreeBase.prototype.findNodeIndex = function (node) {\n                for (var i = 0; i < this._index.length; i++) {\n                    if (this._index[i] === node)\n                        return i;\n                }\n                return -1;\n            };\n            TreeBase.prototype.expandItems = function (parent, items, index, level, init) {\n                if (init === void 0) { init = false; }\n                if (typeof items === tui.UNDEFINED || items === null)\n                    items = [];\n                for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n                    var item = items_1[_i];\n                    var children = item[this._config.children];\n                    var expand = void 0;\n                    if (init) {\n                        expand = false;\n                        item[this._config.expand] = false;\n                    }\n                    else\n                        expand = item[this._config.expand] && children && children.length > 0;\n                    var hasChild = void 0;\n                    if (children && children.length > 0)\n                        hasChild = true;\n                    else\n                        hasChild = !!item[this._config.hasChild];\n                    var node = {\n                        parent: parent,\n                        hasChild: hasChild,\n                        item: item,\n                        level: level,\n                        expand: expand\n                    };\n                    index && index.push(node);\n                    if (expand) {\n                        this.expandItems(node, children, index, level + 1);\n                    }\n                }\n            };\n            TreeBase.prototype.getExpandCount = function (children) {\n                if (!children)\n                    return 0;\n                var delCount = children.length;\n                for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n                    var child = children_1[_i];\n                    if (child.children && child.children.length > 0 && child[this._config.expand]) {\n                        delCount += this.getExpandCount(child.children);\n                    }\n                }\n                return delCount;\n            };\n            TreeBase.prototype.expand = function (index) {\n                if (index >= 0 && index < this._index.length) {\n                    var node = this._index[index];\n                    if (node.hasChild && !node.expand) {\n                        node.expand = true;\n                        node.item[this._config.expand] = true;\n                        var appendNodes = [];\n                        this.expandItems(node, node.item[this._config.children], appendNodes, node.level + 1);\n                        (_a = this._index).splice.apply(_a, [index + 1, 0].concat(appendNodes));\n                    }\n                }\n                var _a;\n            };\n            TreeBase.prototype.collapse = function (index) {\n                if (index >= 0 && index < this._index.length) {\n                    var node = this._index[index];\n                    if (node.hasChild && node.expand) {\n                        node.expand = false;\n                        node.item[this._config.expand] = false;\n                        var delCount = this.getExpandCount(node.item[this._config.children]);\n                        this._index.splice(index + 1, delCount);\n                    }\n                }\n            };\n            return TreeBase;\n        }(DSBase));\n        ds.TreeBase = TreeBase;\n        var Tree = (function (_super) {\n            __extends(Tree, _super);\n            function Tree(data, config, filter, order) {\n                if (config === void 0) { config = { children: \"children\", expand: \"expand\" }; }\n                if (filter === void 0) { filter = null; }\n                if (order === void 0) { order = null; }\n                _super.call(this);\n                this._config = config;\n                this._filter = filter;\n                this._order = order;\n                this.update(data);\n            }\n            Tree.prototype.update = function (data) {\n                var config = this._config;\n                this._index = [];\n                this._rawData = data;\n                this.expandItems(null, data, this._index, 0);\n                this.build();\n            };\n            Tree.prototype.build = function () {\n                var _this = this;\n                if (this._rawData == null) {\n                    this._finalData = null;\n                    return;\n                }\n                if ((this._filter == null || this._filter.length == 0) &&\n                    (this._order == null || this._order.length == 0))\n                    this._finalData = null;\n                else {\n                    this._finalData = [];\n                    var iterate_1 = function (items) {\n                        if (typeof items === tui.UNDEFINED || items === null)\n                            items = [];\n                        for (var _i = 0, items_2 = items; _i < items_2.length; _i++) {\n                            var item = items_2[_i];\n                            if (filter(item, _this._filter)) {\n                                var node = {\n                                    parent: null,\n                                    hasChild: false,\n                                    item: item,\n                                    level: 0,\n                                    expand: false\n                                };\n                                _this._finalData.push(node);\n                            }\n                            var children = item[_this._config.children];\n                            children && iterate_1(children);\n                        }\n                    };\n                    iterate_1(this._rawData);\n                    sort(this._finalData, this._order, true);\n                }\n                this.fire(\"update\", { \"completely\": true });\n            };\n            return Tree;\n        }(TreeBase));\n        ds.Tree = Tree;\n        var RemoteTree = (function (_super) {\n            __extends(RemoteTree, _super);\n            function RemoteTree(config, filter, order) {\n                if (config === void 0) { config = { children: \"children\", expand: \"expand\", hasChild: \"hasChild\" }; }\n                if (filter === void 0) { filter = null; }\n                if (order === void 0) { order = null; }\n                _super.call(this);\n                this._querying = false;\n                this._config = config;\n                this._filter = filter;\n                this._order = order;\n            }\n            RemoteTree.prototype.length = function () {\n                if (this._index)\n                    return this._index.length;\n                else {\n                    if (!this._querying) {\n                        this._querying = true;\n                        this.fire(\"query\", { parent: null, filter: this._filter, order: this._order });\n                    }\n                    return 0;\n                }\n            };\n            RemoteTree.prototype.expand = function (index) {\n                if (index >= 0 && index < this._index.length) {\n                    var node = this._index[index];\n                    if (node.hasChild && !node.expand) {\n                        node.expand = true;\n                        node.item[this._config.expand] = true;\n                        var children = node.item[this._config.children];\n                        if (children) {\n                            var appendNodes = [];\n                            this.expandItems(node, children, appendNodes, node.level + 1);\n                            (_a = this._index).splice.apply(_a, [index + 1, 0].concat(appendNodes));\n                        }\n                        else {\n                            this.fire(\"query\", { parent: node, filter: this._filter, order: this._order });\n                            this._querying = true;\n                        }\n                    }\n                }\n                var _a;\n            };\n            RemoteTree.prototype.update = function (result) {\n                this._querying = false;\n                if (result.parent === null) {\n                    this._index = [];\n                    this._rawData = result.data;\n                    this.expandItems(null, result.data, this._index, 0, true);\n                }\n                else {\n                    var index = this.findNodeIndex(result.parent);\n                    if (index >= 0) {\n                        this.collapse(index);\n                    }\n                    result.parent.item[this._config.children] = result.data;\n                    if (index >= 0) {\n                        this.expand(index);\n                    }\n                }\n                this.fire(\"update\", { \"completely\": true });\n            };\n            RemoteTree.prototype.build = function () {\n                this._index = null;\n                this._rawData = null;\n                this._finalData = null;\n                this.fire(\"query\", { parent: null, filter: this._filter, order: this._order });\n            };\n            return RemoteTree;\n        }(TreeBase));\n        ds.RemoteTree = RemoteTree;\n    })(ds = tui.ds || (tui.ds = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\n/// <reference path=\"../text/text.ts\" />\nvar tui;\n(function (tui) {\n    var time;\n    (function (time) {\n        time.shortWeeks = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n        time.weeks = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n        time.shortMonths = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n        time.months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n        /**\n         * Get today\n         */\n        function now() {\n            return new Date();\n        }\n        time.now = now;\n        /**\n         * Input seconds and get a time description\n         * @param seconds Tims distance of seconds\n         * @param lang Display language\n         */\n        function timespan(seconds, lang) {\n            var desc = [\"day\", \"hour\", \"minute\", \"second\"];\n            var val = [];\n            var beg = \"\", end = \"\";\n            var d = Math.floor(seconds / 86400);\n            val.push(d);\n            seconds = seconds % 86400;\n            var h = Math.floor(seconds / 3600);\n            val.push(h);\n            seconds = seconds % 3600;\n            var m = Math.floor(seconds / 60);\n            val.push(m);\n            val.push(seconds % 60);\n            var i = 0, j = 3;\n            while (i < 4) {\n                if (val[i] > 0) {\n                    beg.length && (beg += \" \");\n                    beg += val[i] + \" \" + tui.str(val[i] > 1 ? desc[i] + \"s\" : desc[i], lang);\n                    break;\n                }\n                i++;\n            }\n            while (i < j) {\n                if (val[j] > 0) {\n                    end.length && (end += \" \");\n                    end += val[j] + \" \" + tui.str(val[j] > 1 ? desc[j] + \"s\" : desc[j], lang);\n                    break;\n                }\n                j--;\n            }\n            i++;\n            while (i < j) {\n                beg.length && (beg += \" \");\n                beg += val[i] + \" \" + tui.str(val[i] > 1 ? desc[i] + \"s\" : desc[i], lang);\n                i++;\n            }\n            return beg + (beg.length ? \" \" : \"\") + end;\n        }\n        time.timespan = timespan;\n        /**\n         * Get the distance of dt2 compare to dt1 (dt2 - dt1) return in specified unit (d: day, h: hours, m: minutes, s: seconds, ms: milliseconds)\n         * @param dt1\n         * @param dt2\n         * @param unit \"d\", \"h\", \"m\", \"s\" or \"ms\"\n         */\n        function dateDiff(dt1, dt2, unit) {\n            if (unit === void 0) { unit = \"d\"; }\n            var d1 = dt1.getTime();\n            var d2 = dt2.getTime();\n            var diff = d2 - d1;\n            var symbol = diff < 0 ? -1 : 1;\n            diff = Math.abs(diff);\n            unit = unit.toLocaleLowerCase();\n            if (unit === \"d\") {\n                return Math.floor(diff / 86400000) * symbol;\n            }\n            else if (unit === \"h\") {\n                return Math.floor(diff / 3600000) * symbol;\n            }\n            else if (unit === \"m\") {\n                return Math.floor(diff / 60000) * symbol;\n            }\n            else if (unit === \"s\") {\n                return Math.floor(diff / 1000) * symbol;\n            }\n            else if (unit === \"ms\") {\n                return diff * symbol;\n            }\n            else\n                return NaN;\n        }\n        time.dateDiff = dateDiff;\n        /**\n         * Get new date of dt add specified unit of values.\n         * @param dt The day of the target\n         * @param val Increased value\n         * @param unit \"y\", \"M\", \"d\", \"h\", \"m\", \"s\" or \"ms\"\n         */\n        function dateAdd(dt, val, unit) {\n            if (unit === void 0) { unit = \"d\"; }\n            var tm = dt.getTime();\n            if (unit === \"y\") {\n                var y = dt.getFullYear(), m = dt.getMonth(), d = dt.getDate();\n                var h = dt.getHours(), mi = dt.getMinutes(), s = dt.getSeconds(), ms = dt.getMilliseconds();\n                var totalMonth = y * 12 + m + (val * 12);\n                y = Math.floor(totalMonth / 12);\n                m = totalMonth % 12;\n                var newDate = new Date(y, m, 1);\n                if (d > totalDaysOfMonth(newDate))\n                    d = totalDaysOfMonth(newDate);\n                return new Date(y, m, d, h, mi, s, ms);\n            }\n            else if (unit === \"M\") {\n                var y = dt.getFullYear(), m = dt.getMonth(), d = dt.getDate();\n                var h = dt.getHours(), mi = dt.getMinutes(), s = dt.getSeconds(), ms = dt.getMilliseconds();\n                var totalMonth = y * 12 + m + val;\n                y = Math.floor(totalMonth / 12);\n                m = totalMonth % 12;\n                var newDate = new Date(y, m, 1);\n                if (d > totalDaysOfMonth(newDate))\n                    d = totalDaysOfMonth(newDate);\n                return new Date(y, m, d, h, mi, s, ms);\n            }\n            else if (unit === \"d\") {\n                return new Date(tm + val * 86400000);\n            }\n            else if (unit === \"h\") {\n                return new Date(tm + val * 3600000);\n            }\n            else if (unit === \"m\") {\n                return new Date(tm + val * 60000);\n            }\n            else if (unit === \"s\") {\n                return new Date(tm + val * 1000);\n            }\n            else if (unit === \"ms\") {\n                return new Date(tm + val);\n            }\n            else\n                return null;\n        }\n        time.dateAdd = dateAdd;\n        /**\n         * Get day in year\n         * @param dt The day of the target\n         */\n        function dayOfYear(dt) {\n            var y = dt.getFullYear();\n            var d1 = new Date(y, 0, 1);\n            return dateDiff(d1, dt, \"d\");\n        }\n        time.dayOfYear = dayOfYear;\n        /**\n         * Get total days of month\n         * @param dt The day of the target\n         */\n        function totalDaysOfMonth(dt) {\n            var y = dt.getFullYear();\n            var m = dt.getMonth();\n            var d1 = new Date(y, m, 1);\n            if (m === 11) {\n                y++;\n                m = 0;\n            }\n            else {\n                m++;\n            }\n            var d2 = new Date(y, m, 1);\n            return dateDiff(d1, d2, \"d\");\n        }\n        time.totalDaysOfMonth = totalDaysOfMonth;\n        function parseDateInternal(dtStr, format) {\n            if (!dtStr || !format)\n                return null;\n            var mapping = {};\n            var gcount = 0;\n            var isUTC = false;\n            var values = {};\n            function matchEnum(v, key, enumArray) {\n                var m = dtStr.match(new RegExp(\"^\" + enumArray.join(\"|\"), \"i\"));\n                if (m === null)\n                    return false;\n                v = m[0].toLowerCase();\n                v = v.substr(0, 1).toUpperCase() + v.substr(1);\n                values[key] = enumArray.indexOf(v);\n                dtStr = dtStr.substr(v.length);\n                return true;\n            }\n            function matchNumber(v, key, min, max) {\n                var len = v.length;\n                var m = dtStr.match(\"^[0-9]{1,\" + len + \"}\");\n                if (m === null)\n                    return false;\n                v = m[0];\n                var num = parseInt(v);\n                if (num < min || num > max)\n                    return false;\n                key && (values[key] = num);\n                dtStr = dtStr.substr(v.length);\n                return true;\n            }\n            var rule = {\n                \"y+\": function (v) {\n                    if (!matchNumber(v, \"year\"))\n                        return false;\n                    if (values[\"year\"] < 100)\n                        values[\"year\"] += 1900;\n                    return true;\n                },\n                \"M+\": function (v) {\n                    var len = v.length;\n                    if (len < 3) {\n                        if (!matchNumber(v, \"month\", 1, 12))\n                            return false;\n                        values[\"month\"] -= 1;\n                        return true;\n                    }\n                    else if (len === 3) {\n                        return matchEnum(v, \"month\", time.shortMonths);\n                    }\n                    else {\n                        return matchEnum(v, \"month\", time.months);\n                    }\n                },\n                \"d+\": function (v) {\n                    return matchNumber(v, \"date\", 1, 31);\n                },\n                \"D+\": matchNumber,\n                \"h+\": function (v) {\n                    return matchNumber(v, \"12hour\", 1, 12);\n                },\n                \"H+\": function (v) {\n                    return matchNumber(v, \"hour\", 0, 24);\n                },\n                \"m+\": function (v) {\n                    return matchNumber(v, \"minute\", 0, 59);\n                },\n                \"s+\": function (v) {\n                    return matchNumber(v, \"second\", 0, 59);\n                },\n                \"[qQ]+\": function (v) {\n                    return matchNumber(v, null, 1, 4);\n                },\n                \"S+\": function (v) {\n                    return matchNumber(v, \"millisecond\", 0, 999);\n                },\n                \"E+\": function (v) {\n                    var len = v.length;\n                    if (len < 3) {\n                        if (!matchNumber(v, null, 0, 6))\n                            return false;\n                        return true;\n                    }\n                    else if (len === 3) {\n                        return matchEnum(v, null, time.shortWeeks);\n                    }\n                    else {\n                        return matchEnum(v, null, time.weeks);\n                    }\n                },\n                \"a|A\": function matchNumber(v) {\n                    var len = v.length;\n                    var m = dtStr.match(/^(am|pm)/i);\n                    if (m === null)\n                        return false;\n                    v = m[0];\n                    values[\"ampm\"] = v.toLowerCase();\n                    dtStr = dtStr.substr(v.length);\n                    return true;\n                },\n                \"z+\": function (v) {\n                    var len = v.length;\n                    var m;\n                    if (len <= 2)\n                        m = dtStr.match(/^([\\-+][0-9]{2})/i);\n                    else if (len === 3)\n                        m = dtStr.match(/^([\\-+][0-9]{2})([0-9]{2})/i);\n                    else\n                        m = dtStr.match(/^([\\-+][0-9]{2}):([0-9]{2})/i);\n                    if (m === null)\n                        return false;\n                    v = m[0];\n                    var tz = parseInt(m[1]);\n                    if (Math.abs(tz) < -11 || Math.abs(tz) > 11)\n                        return false;\n                    tz *= 60;\n                    if (typeof m[2] !== tui.UNDEFINED) {\n                        if (tz > 0)\n                            tz += parseInt(m[2]);\n                        else\n                            tz -= parseInt(m[2]);\n                    }\n                    values[\"tz\"] = -tz;\n                    dtStr = dtStr.substr(v.length);\n                    return true;\n                },\n                \"Z\": function (v) {\n                    if (dtStr.substr(0, 1) !== \"Z\")\n                        return false;\n                    isUTC = true;\n                    dtStr = dtStr.substr(1);\n                    return true;\n                },\n                \"\\\"[^\\\"]*\\\"|'[^']*'\": function (v) {\n                    v = v.substr(1, v.length - 2);\n                    if (dtStr.substr(0, v.length).toLowerCase() !== v.toLowerCase())\n                        return false;\n                    dtStr = dtStr.substr(v.length);\n                    return true;\n                },\n                \"[^yMmdDhHsSqEaAzZ'\\\"]+\": function (v) {\n                    v = v.replace(/(.)/g, '\\\\$1');\n                    var m = dtStr.match(new RegExp(\"^\" + v));\n                    if (m === null)\n                        return false;\n                    v = m[0];\n                    dtStr = dtStr.substr(v.length);\n                    return true;\n                }\n            };\n            var regex = \"\";\n            for (var k in rule) {\n                if (!rule.hasOwnProperty(k))\n                    continue;\n                if (regex.length > 0)\n                    regex += \"|\";\n                regex += \"(^\" + k + \")\";\n                mapping[k] = ++gcount;\n            }\n            var result;\n            while ((result = format.match(regex)) !== null) {\n                for (var k in mapping) {\n                    var v = result[mapping[k]];\n                    if (typeof v !== tui.UNDEFINED) {\n                        if (rule[k](v) === false)\n                            return null;\n                        break;\n                    }\n                }\n                format = format.substr(result[0].length);\n            }\n            if (format.length > 0 || dtStr.length > 0)\n                return null;\n            var parseCount = 0;\n            for (var k in values) {\n                if (!values.hasOwnProperty(k))\n                    continue;\n                parseCount++;\n            }\n            if (parseCount <= 0)\n                return null;\n            var now = new Date();\n            var year = values.hasOwnProperty(\"year\") ? values[\"year\"] : (isUTC ? now.getUTCFullYear() : now.getFullYear());\n            var month = values.hasOwnProperty(\"month\") ? values[\"month\"] : (isUTC ? now.getUTCMonth() : now.getMonth());\n            var date = values.hasOwnProperty(\"date\") ? values[\"date\"] : (isUTC ? now.getUTCDate() : now.getDate());\n            var ampm = values.hasOwnProperty(\"ampm\") ? values[\"ampm\"] : \"am\";\n            var hour;\n            if (values.hasOwnProperty(\"hour\"))\n                hour = values[\"hour\"];\n            else if (values.hasOwnProperty(\"12hour\")) {\n                var h12 = values[\"12hour\"];\n                if (ampm === \"am\") {\n                    if (h12 >= 1 && h12 <= 11) {\n                        hour = h12;\n                    }\n                    else if (h12 === 12) {\n                        hour = h12 - 12;\n                    }\n                    else\n                        return null;\n                }\n                else {\n                    if (h12 === 12)\n                        hour = h12;\n                    else if (h12 >= 1 && h12 <= 11)\n                        hour = h12 + 12;\n                    else\n                        return null;\n                }\n            }\n            else\n                hour = 0;\n            var minute = values.hasOwnProperty(\"minute\") ? values[\"minute\"] : 0;\n            var second = values.hasOwnProperty(\"second\") ? values[\"second\"] : 0;\n            var millisecond = values.hasOwnProperty(\"millisecond\") ? values[\"millisecond\"] : 0;\n            var tz = values.hasOwnProperty(\"tz\") ? values[\"tz\"] : now.getTimezoneOffset();\n            now.setUTCFullYear(year);\n            now.setUTCMonth(month);\n            now.setUTCDate(date);\n            now.setUTCHours(hour);\n            now.setUTCMinutes(minute);\n            now.setUTCSeconds(second);\n            now.setUTCMilliseconds(millisecond);\n            if (!isUTC) {\n                now.setTime(now.getTime() + tz * 60 * 1000);\n            }\n            return now;\n        }\n        /**\n         * Parse string get date instance (\n         * try to parse format:\n         *\t\tyyyy-MM-dd HH:mm:ss，\n         *\t\tyyyy-MM-dd,\n         *\t\tdd MMM yyyy,\n         *\t\tMMM dd, yyyy,\n         *\t\tISO8601 format)\n         * @param {String} dtStr Data string\n         */\n        function parseDate(dtStr, format) {\n            if (typeof format === \"string\")\n                return parseDateInternal(dtStr, format);\n            else if (typeof format === tui.UNDEFINED) {\n                var dt = new Date(dtStr);\n                if (!isNaN(dt.getTime()))\n                    return dt;\n                dt = parseDateInternal(dtStr, \"yyyy-MM-dd\");\n                if (dt !== null)\n                    return dt;\n                dt = parseDateInternal(dtStr, \"yyyy-MM-dd HH:mm:ss\");\n                if (dt !== null)\n                    return dt;\n                dt = parseDateInternal(dtStr, \"MMM dd, yyyy HH:mm:ss\");\n                if (dt !== null)\n                    return dt;\n                dt = parseDateInternal(dtStr, \"MMM dd, yyyy\");\n                if (dt !== null)\n                    return dt;\n                dt = parseDateInternal(dtStr, \"dd MMM yyyy HH:mm:ss\");\n                if (dt !== null)\n                    return dt;\n                dt = parseDateInternal(dtStr, \"dd MMM yyyy\");\n                if (dt !== null)\n                    return dt;\n            }\n            return null;\n        }\n        time.parseDate = parseDate;\n        /**\n         * Convert date to string and output can be formated to ISO8601, RFC2822, RFC3339 or other customized format\n         * @param dt {Date} Date object to be convert\n         * @param dateFmt {String} which format should be apply, default use ISO8601 standard format\n         */\n        function formatDate(dt, dateFmt) {\n            if (dateFmt === void 0) { dateFmt = \"yyyy-MM-ddTHH:mm:sszzz\"; }\n            var isUTC = (dateFmt.indexOf(\"Z\") >= 0 ? true : false);\n            var fullYear = isUTC ? dt.getUTCFullYear() : dt.getFullYear();\n            var month = isUTC ? dt.getUTCMonth() : dt.getMonth();\n            var date = isUTC ? dt.getUTCDate() : dt.getDate();\n            var hours = isUTC ? dt.getUTCHours() : dt.getHours();\n            var minutes = isUTC ? dt.getUTCMinutes() : dt.getMinutes();\n            var seconds = isUTC ? dt.getUTCSeconds() : dt.getSeconds();\n            var milliseconds = isUTC ? dt.getUTCMilliseconds() : dt.getMilliseconds();\n            var day = isUTC ? dt.getUTCDay() : dt.getDay();\n            var rule = {\n                \"y+\": fullYear,\n                \"M+\": month + 1,\n                \"d+\": date,\n                \"D+\": dayOfYear(dt) + 1,\n                \"h+\": (function (h) {\n                    if (h === 0)\n                        return h + 12;\n                    else if (h >= 1 && h <= 12)\n                        return h;\n                    else if (h >= 13 && h <= 23)\n                        return h - 12;\n                })(hours),\n                \"H+\": hours,\n                \"m+\": minutes,\n                \"s+\": seconds,\n                \"q+\": Math.floor((month + 3) / 3),\n                \"S+\": milliseconds,\n                \"E+\": day,\n                \"a\": (function (h) {\n                    if (h >= 0 && h <= 11)\n                        return \"am\";\n                    else\n                        return \"pm\";\n                })(isUTC ? dt.getUTCHours() : dt.getHours()),\n                \"A\": (function (h) {\n                    if (h >= 0 && h <= 11)\n                        return \"AM\";\n                    else\n                        return \"PM\";\n                })(hours),\n                \"z+\": dt.getTimezoneOffset()\n            };\n            var regex = \"\";\n            for (var k in rule) {\n                if (!rule.hasOwnProperty(k))\n                    continue;\n                if (regex.length > 0)\n                    regex += \"|\";\n                regex += k;\n            }\n            var regexp = new RegExp(regex, \"g\");\n            return dateFmt.replace(regexp, function (str, pos, source) {\n                for (var k in rule) {\n                    if (str.match(k) !== null) {\n                        if (k === \"y+\") {\n                            return tui.text.paddingNumber(rule[k], str.length, str.length);\n                        }\n                        else if (k === \"a\" || k === \"A\") {\n                            return rule[k];\n                        }\n                        else if (k === \"z+\") {\n                            var z = \"\";\n                            if (rule[k] >= 0) {\n                                z += \"-\";\n                            }\n                            else {\n                                z += \"+\";\n                            }\n                            if (str.length < 2)\n                                z += Math.abs(Math.floor(rule[k] / 60));\n                            else\n                                z += tui.text.paddingNumber(Math.abs(Math.floor(rule[k] / 60)), 2);\n                            if (str.length === 3)\n                                z += tui.text.paddingNumber(Math.abs(Math.floor(rule[k] % 60)), 2);\n                            else if (str.length > 3)\n                                z += (\":\" + tui.text.paddingNumber(Math.abs(Math.floor(rule[k] % 60)), 2));\n                            return z;\n                        }\n                        else if (k === \"E+\") {\n                            if (str.length < 3)\n                                return tui.text.paddingNumber(rule[k], str.length);\n                            else if (str.length === 3)\n                                return time.shortWeeks[rule[k]];\n                            else\n                                return time.weeks[rule[k]];\n                        }\n                        else if (k === \"M+\") {\n                            if (str.length < 3)\n                                return tui.text.paddingNumber(rule[k], str.length);\n                            else if (str.length === 3)\n                                return time.shortMonths[rule[k] - 1];\n                            else\n                                return time.months[rule[k] - 1];\n                        }\n                        else if (k === \"S+\") {\n                            return tui.text.paddingNumber(rule[k], str.length, str.length, true);\n                        }\n                        else {\n                            return tui.text.paddingNumber(rule[k], str.length);\n                        }\n                    }\n                }\n                return str;\n            });\n        }\n        time.formatDate = formatDate;\n    })(time = tui.time || (tui.time = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <button>\n         * Attributes: value, text, type, checked, group, disable\n         * Events: click, mousedown, mouseup, keydown, keyup\n         */\n        var Button = (function (_super) {\n            __extends(Button, _super);\n            function Button() {\n                _super.apply(this, arguments);\n            }\n            Button.prototype.initChildren = function (childNodes) {\n                if (childNodes && childNodes.length > 0)\n                    this._set(\"text\", tui.browser.toHTML(childNodes));\n            };\n            Button.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"type\": {\n                        \"get\": function () {\n                            if (_this._data[\"type\"])\n                                return _this._data[\"type\"];\n                            var parent = _this.get(\"parent\");\n                            if (parent && parent instanceof widget.Group && parent.get(\"type\"))\n                                return parent.get(\"type\");\n                            return null;\n                        }\n                    },\n                    \"value\": {\n                        \"get\": function () {\n                            if (_this._data[\"value\"])\n                                return _this._data[\"value\"];\n                            return _this.get(\"text\");\n                        }\n                    },\n                    \"checked\": {\n                        \"set\": function (value) {\n                            _this._data[\"checked\"] = !!value;\n                            if (!value)\n                                _this._data[\"tristate\"] = false;\n                        }\n                    },\n                    \"tristate\": {\n                        \"set\": function (value) {\n                            _this._data[\"tristate\"] = !!value;\n                            if (value)\n                                _this._data[\"checked\"] = true;\n                        }\n                    }\n                });\n            };\n            Button.prototype.init = function () {\n                var _this = this;\n                var $root = $(this._);\n                $root.attr({\n                    \"unselectable\": \"on\"\n                });\n                $root.mousedown(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    $root.focus();\n                    _this.fire(\"mousedown\", e);\n                });\n                $root.mouseup(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    _this.fire(\"mouseup\", e);\n                });\n                $root.keydown(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    _this.fire(\"keydown\", e);\n                });\n                $root.keyup(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    _this.fire(\"keyup\", e);\n                });\n                var onClick = function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    if (_this.get(\"type\") === \"toggle\" || _this.get(\"type\") === \"toggle-radio\") {\n                        _this.set(\"checked\", !_this.get(\"checked\"));\n                    }\n                    else if (_this.get(\"type\") === \"radio\")\n                        _this.set(\"checked\", true);\n                    var parent = _this.get(\"parent\");\n                    var groupName = _this.get(\"group\");\n                    if (_this.get(\"type\") === \"radio\" ||\n                        _this.get(\"type\") === \"toggle-radio\" && _this.get(\"checked\")) {\n                        var result = void 0;\n                        if (parent && parent instanceof widget.Group) {\n                            result = widget.search(parent._, function (elem) {\n                                if ((elem.get(\"type\") === \"radio\" || elem.get(\"type\") === \"toggle-radio\")\n                                    && elem !== _this)\n                                    return true;\n                                else\n                                    return false;\n                            });\n                        }\n                        else {\n                            result = widget.search(function (elem) {\n                                if (groupName && elem.get(\"group\") === groupName\n                                    && (elem.get(\"type\") === \"radio\" || elem.get(\"type\") === \"toggle-radio\")\n                                    && elem !== _this)\n                                    return true;\n                                else\n                                    return false;\n                            });\n                        }\n                        for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {\n                            var elem = result_1[_i];\n                            elem.set(\"checked\", false);\n                        }\n                    }\n                    var onclick = _this.get(\"onclick\");\n                    if (onclick) {\n                        eval.call(window, onclick);\n                    }\n                    _this.fire(\"click\", e);\n                    if (parent && parent instanceof widget.Group)\n                        parent.fire(\"click\", { e: e, button: _this });\n                };\n                $root.click(onClick);\n                $root.keydown(function (e) {\n                    if (e.keyCode === 13 || e.keyCode === 32) {\n                        e.preventDefault();\n                        onClick(e);\n                    }\n                });\n            };\n            Button.prototype.render = function () {\n                var $root = $(this._);\n                if (this.get(\"checked\")) {\n                    $root.addClass(\"tui-checked\");\n                }\n                else {\n                    $root.removeClass(\"tui-checked\");\n                }\n                if (this.get(\"disable\")) {\n                    $root.addClass(\"tui-disable\");\n                    $root.removeAttr(\"tabIndex\");\n                }\n                else {\n                    $root.removeClass(\"tui-disable\");\n                    $root.attr(\"tabIndex\", \"0\");\n                }\n                if (this.get(\"checked\") && this.get(\"tristate\")) {\n                    $root.addClass(\"tui-tristate\");\n                }\n                else\n                    $root.removeClass(\"tui-tristate\");\n                var text = this.get(\"text\");\n                if (typeof text !== \"string\")\n                    text = \"\";\n                $root.html(text);\n            };\n            return Button;\n        }(widget.Widget));\n        widget.Button = Button;\n        var Check = (function (_super) {\n            __extends(Check, _super);\n            function Check() {\n                _super.apply(this, arguments);\n            }\n            Check.prototype.init = function () {\n                _super.prototype.init.call(this);\n                this._set(\"type\", \"toggle\");\n            };\n            return Check;\n        }(Button));\n        widget.Check = Check;\n        var Radio = (function (_super) {\n            __extends(Radio, _super);\n            function Radio() {\n                _super.apply(this, arguments);\n            }\n            Radio.prototype.init = function () {\n                _super.prototype.init.call(this);\n                this._set(\"type\", \"radio\");\n            };\n            return Radio;\n        }(Button));\n        widget.Radio = Radio;\n        widget.register(Button, \"button\");\n        widget.register(Check, \"check\");\n        widget.register(Radio, \"radio\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\n/// <reference path=\"../time/time.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        function formatNumber(v, maxValue) {\n            if (v < 0)\n                v = 0;\n            if (v > maxValue)\n                v = maxValue;\n            if (v < 10)\n                return \"0\" + v;\n            else\n                return v + \"\";\n        }\n        function setText(tb, line, column, content) {\n            var cell = (tb.rows[line].cells[column]);\n            if (tui.ieVer > 0 && tui.ieVer < 9) {\n                cell.innerText = content;\n            }\n            else\n                cell.innerHTML = content;\n        }\n        var Calendar = (function (_super) {\n            __extends(Calendar, _super);\n            function Calendar() {\n                _super.apply(this, arguments);\n            }\n            Calendar.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"time\": {\n                        \"set\": function (value) {\n                            if (value instanceof Date)\n                                _this._data[\"time\"] = value;\n                            else if (typeof value === \"string\") {\n                                value = tui.time.parseDate(value);\n                                _this._data[\"time\"] = value;\n                            }\n                        },\n                        \"get\": function () {\n                            var tm = _this._data[\"time\"];\n                            if (typeof tm === tui.UNDEFINED || tm === null) {\n                                return _this._data[\"time\"] = tui.time.now();\n                            }\n                            else\n                                return tm;\n                        }\n                    },\n                    \"value\": {\n                        \"set\": function (value) {\n                            _this._set(\"time\", value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\");\n                        }\n                    },\n                    \"year\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value))\n                                _this.get(\"time\").setFullYear(value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\").getFullYear();\n                        }\n                    },\n                    \"month\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value))\n                                _this.get(\"time\").setMonth(value - 1);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\").getMonth() + 1;\n                        }\n                    },\n                    \"day\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value))\n                                _this.get(\"time\").setDate(value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\").getDate();\n                        }\n                    },\n                    \"hour\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value))\n                                _this.get(\"time\").setHours(value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\").getHours();\n                        }\n                    },\n                    \"minute\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value))\n                                _this.get(\"time\").setMinutes(value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\").getMinutes();\n                        }\n                    },\n                    \"second\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value))\n                                _this.get(\"time\").setSeconds(value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"time\").getSeconds();\n                        }\n                    }\n                });\n            };\n            Calendar.prototype.init = function () {\n                var _this = this;\n                $(this._).attr({ \"tabIndex\": \"0\", \"unselectable\": \"on\" });\n                var tb = this._components[\"table\"] = tui.browser.toElement(\"<table cellPadding='0' cellspacing='0' border='0'>\" +\n                    \"<tr class='tui-yearbar'><td class='tui-pm'></td><td class='tui-py'>\" +\n                    \"</td><td colspan='3' class='tui-ym'></td>\" +\n                    \"<td class='tui-ny'></td><td class='tui-nm'></td></tr></table>\");\n                var yearLine = tb.rows[0];\n                for (var i = 0; i < 7; i++) {\n                    var line = tb.insertRow(-1);\n                    for (var j = 0; j < 7; j++) {\n                        var cell = line.insertCell(-1);\n                        if (j === 0 || j === 6)\n                            cell.className = \"tui-week-end\";\n                        if (i === 0) {\n                            cell.className = \"tui-week\";\n                            setText(tb, i + 1, j, tui.str(tui.time.shortWeeks[j]));\n                        }\n                    }\n                }\n                this._.appendChild(tb);\n                var timebar = this._components[\"timeBar\"] = tui.browser.toElement(\"<div>\" + tui.str(\"Choose Time\") + \":<input name='hours' maxLength='2'>:<input name='minutes' maxLength='2'>:<input name='seconds' maxLength='2'>\" +\n                    \"<a class='tui-update'></a></div>\");\n                this._.appendChild(timebar);\n                function getMaxValue(name) {\n                    if (name === \"hours\")\n                        return 23;\n                    else\n                        return 59;\n                }\n                var getInputTime = function () {\n                    function getInput(index) {\n                        return $(timebar).children(\"input\")[index];\n                    }\n                    var tm = _this.get(\"time\");\n                    tm.setHours(parseInt(getInput(0).value));\n                    tm.setMinutes(parseInt(getInput(1).value));\n                    tm.setSeconds(parseInt(getInput(2).value));\n                    _this.set(\"time\", tm);\n                };\n                var timebar$ = $(timebar);\n                timebar$.keydown(function (e) {\n                    var o = (e.srcElement || e.target);\n                    var o$ = $(o);\n                    var k = e.keyCode;\n                    if (o.nodeName.toUpperCase() === \"INPUT\") {\n                        if (k === tui.browser.KeyCode.TAB)\n                            return;\n                        e.preventDefault();\n                        tui.browser.cancelBubble(e);\n                        var input = o;\n                        if (k === tui.browser.KeyCode.LEFT) {\n                            if (o$.attr(\"name\") === \"seconds\")\n                                timebar$.children(\"input[name=minutes]\").focus();\n                            else if (o$.attr(\"name\") === \"minutes\")\n                                timebar$.children(\"input[name=hours]\").focus();\n                        }\n                        else if (k === tui.browser.KeyCode.RIGHT) {\n                            if (o$.attr(\"name\") === \"hours\")\n                                timebar$.children(\"input[name=minutes]\").focus();\n                            else if (o$.attr(\"name\") === \"minutes\")\n                                timebar$.children(\"input[name=seconds]\").focus();\n                        }\n                        else if (k === tui.browser.KeyCode.UP) {\n                            var max = getMaxValue(o$.attr(\"name\"));\n                            var v = parseInt(input.value) + 1;\n                            if (v > max)\n                                v = 0;\n                            input.value = formatNumber(v, max);\n                            getInputTime();\n                            input.select();\n                        }\n                        else if (k === tui.browser.KeyCode.DOWN) {\n                            var max = getMaxValue(o$.attr(\"name\"));\n                            var v = parseInt(input.value) - 1;\n                            if (v < 0)\n                                v = max;\n                            input.value = formatNumber(v, max);\n                            getInputTime();\n                            input.select();\n                        }\n                        else if (k >= tui.browser.KeyCode.KEY_0 && k <= tui.browser.KeyCode.KEY_9) {\n                            var max = getMaxValue(o$.attr(\"name\"));\n                            var v = k - tui.browser.KeyCode.KEY_0;\n                            var now = tui.time.now().getTime();\n                            if (o._lastInputTime && (now - o._lastInputTime) < 1000)\n                                o.value = formatNumber(parseInt(o.value.substr(1, 1)) * 10 + v, max);\n                            else\n                                o.value = formatNumber(v, max);\n                            o._lastInputTime = now;\n                            getInputTime();\n                            o.select();\n                        }\n                        else if (k == 13)\n                            _this.fire(\"click\", { e: e, \"time\": _this.get(\"time\"), \"type\": \"pick\" });\n                    }\n                });\n                timebar$.children(\"input\").on(\"focus mousedown mouseup\", function (e) {\n                    var o = (e.srcElement || e.target);\n                    setTimeout(function () {\n                        o.select();\n                    }, 0);\n                }).on(\"contextmenu\", tui.browser.cancelDefault);\n                timebar$.children(\"a\").mousedown(function (e) {\n                    var now = tui.time.now();\n                    var newTime = new Date(_this.get(\"year\"), _this.get(\"month\") - 1, _this.get(\"day\"), now.getHours(), now.getMinutes(), now.getSeconds());\n                    _this.set(\"time\", newTime);\n                    setTimeout(function () { _this._.focus(); });\n                    return tui.browser.cancelBubble(e);\n                }).click(function (e) {\n                    _this.fire(\"click\", { e: e, \"time\": _this.get(\"time\"), \"type\": \"refresh\" });\n                });\n                $(tb).mousedown(function (e) {\n                    if (tui.ffVer > 0) {\n                        setTimeout(function () { _this._.focus(); });\n                    }\n                    var cell = (e.target || e.srcElement);\n                    if (cell.nodeName.toLowerCase() !== \"td\")\n                        return;\n                    if ($(cell).hasClass(\"tui-pm\")) {\n                        _this.prevMonth();\n                    }\n                    else if ($(cell).hasClass(\"tui-py\")) {\n                        _this.prevYear();\n                    }\n                    else if ($(cell).hasClass(\"tui-ny\")) {\n                        _this.nextYear();\n                    }\n                    else if ($(cell).hasClass(\"tui-nm\")) {\n                        _this.nextMonth();\n                    }\n                    else if (typeof cell[\"offsetMonth\"] === \"number\") {\n                        var d = parseInt(cell.innerHTML, 10);\n                        var y = _this.get(\"year\"), m = _this.get(\"month\");\n                        var offset = cell[\"offsetMonth\"];\n                        if (offset < 0) {\n                            if (m === 1) {\n                                y--;\n                                m = 12;\n                            }\n                            else {\n                                m--;\n                            }\n                            _this.onPicked(y, m, d);\n                        }\n                        else if (offset > 0) {\n                            if (m === 12) {\n                                y++;\n                                m = 1;\n                            }\n                            else {\n                                m++;\n                            }\n                            _this.onPicked(y, m, d);\n                        }\n                        else if (offset === 0) {\n                            _this.onPicked(y, m, d);\n                        }\n                    }\n                }).click(function (e) {\n                    var cell = (e.target || e.srcElement);\n                    if (cell.nodeName.toLowerCase() !== \"td\")\n                        return;\n                    if (typeof cell[\"offsetMonth\"] === \"number\")\n                        _this.fire(\"click\", { e: e, \"time\": _this.get(\"time\"), \"type\": \"pick\" });\n                    else if (/^(tui-pm|tui-py|tui-nm|tui-ny)$/.test(cell.className))\n                        _this.fire(\"click\", { e: e, \"time\": _this.get(\"time\"), \"type\": \"change\" });\n                }).dblclick(function (e) {\n                    var cell = (e.target || e.srcElement);\n                    if (cell.nodeName.toLowerCase() !== \"td\")\n                        return;\n                    if (typeof cell[\"offsetMonth\"] === \"number\")\n                        _this.fire(\"dblclick\", { e: e, \"time\": _this.get(\"time\") });\n                });\n                $(this._).keydown(function (e) {\n                    var k = e.keyCode;\n                    if ([13, 33, 34, 37, 38, 39, 40].indexOf(k) >= 0) {\n                        if (k === 37) {\n                            var tm = tui.time.dateAdd(_this.get(\"time\"), -1);\n                            _this.set(\"time\", tm);\n                        }\n                        else if (k === 38) {\n                            var tm = tui.time.dateAdd(_this.get(\"time\"), -7);\n                            _this.set(\"time\", tm);\n                        }\n                        else if (k === 39) {\n                            var tm = tui.time.dateAdd(_this.get(\"time\"), 1);\n                            _this.set(\"time\", tm);\n                        }\n                        else if (k === 40) {\n                            var tm = tui.time.dateAdd(_this.get(\"time\"), 7);\n                            _this.set(\"time\", tm);\n                        }\n                        else if (k === 33) {\n                            _this.prevMonth();\n                        }\n                        else if (k === 34) {\n                            _this.nextMonth();\n                        }\n                        else if (k === 13) {\n                            _this.fire(\"click\", { e: e, \"time\": _this.get(\"time\"), \"type\": \"pick\" });\n                        }\n                        return e.preventDefault();\n                    }\n                });\n            };\n            Calendar.prototype.onPicked = function (y, m, d) {\n                var oldTime = this.get(\"time\");\n                var newTime = new Date(y, m - 1, d, oldTime.getHours(), oldTime.getMinutes(), oldTime.getSeconds());\n                this.set(\"time\", newTime);\n            };\n            Calendar.prototype.makeTime = function (proc) {\n                var t = { y: this.get(\"year\"), m: this.get(\"month\"), d: this.get(\"day\") };\n                proc(t);\n                var newDate = new Date(t.y, t.m - 1, 1);\n                if (t.d > tui.time.totalDaysOfMonth(newDate))\n                    t.d = tui.time.totalDaysOfMonth(newDate);\n                this.onPicked(t.y, t.m, t.d);\n            };\n            Calendar.prototype.prevMonth = function () {\n                this.makeTime(function (t) {\n                    if (t.m === 1) {\n                        t.y--;\n                        t.m = 12;\n                    }\n                    else {\n                        t.m--;\n                    }\n                });\n            };\n            Calendar.prototype.nextMonth = function () {\n                this.makeTime(function (t) {\n                    if (t.m === 12) {\n                        t.y++;\n                        t.m = 1;\n                    }\n                    else {\n                        t.m++;\n                    }\n                });\n            };\n            Calendar.prototype.prevYear = function () {\n                this.makeTime(function (t) {\n                    t.y--;\n                });\n            };\n            Calendar.prototype.nextYear = function () {\n                this.makeTime(function (t) {\n                    t.y++;\n                });\n            };\n            Calendar.prototype.render = function () {\n                function firstDay(date) {\n                    var y = date.getFullYear();\n                    var m = date.getMonth();\n                    return new Date(y, m, 1);\n                }\n                var tb = this._components[\"table\"];\n                var tm = this.get(\"time\");\n                var today = tui.time.now();\n                var firstWeek = firstDay(tm).getDay();\n                var daysOfMonth = tui.time.totalDaysOfMonth(tm);\n                var day = 0;\n                tb.rows[0].cells[2].innerHTML = tm.getFullYear() + \" - \" + this.get(\"month\");\n                for (var i = 0; i < 6; i++) {\n                    for (var j = 0; j < 7; j++) {\n                        var cell = tb.rows[i + 2].cells[j];\n                        cell.className = \"\";\n                        if (day === 0) {\n                            if (j === firstWeek) {\n                                day = 1;\n                                cell.innerHTML = day + \"\";\n                                cell.offsetMonth = 0;\n                            }\n                            else {\n                                var preMonthDay = new Date(firstDay(tm).valueOf() - ((firstWeek - j) * 1000 * 24 * 60 * 60));\n                                cell.innerHTML = preMonthDay.getDate() + \"\";\n                                cell.offsetMonth = -1;\n                                $(cell).addClass(\"tui-before\");\n                            }\n                        }\n                        else {\n                            day++;\n                            if (day <= daysOfMonth) {\n                                cell.innerHTML = day + \"\";\n                                cell.offsetMonth = 0;\n                            }\n                            else {\n                                cell.innerHTML = (day - daysOfMonth) + \"\";\n                                cell.offsetMonth = 1;\n                                $(cell).addClass(\"tui-after\");\n                            }\n                        }\n                        if (day === this.get(\"day\"))\n                            $(cell).addClass(\"tui-actived\");\n                        if (j === 0 || j === 6)\n                            $(cell).addClass(\"tui-weekend\");\n                        if (this.get(\"year\") === today.getFullYear() && this.get(\"month\") === (today.getMonth() + 1) && day === today.getDate()) {\n                            $(cell).addClass(\"tui-today\");\n                        }\n                    }\n                }\n                var timebar = this._components[\"timeBar\"];\n                if (this.get(\"timeBar\")) {\n                    timebar.style.display = \"\";\n                    $(timebar).children(\"input[name=hours]\").val(formatNumber(tm.getHours(), 23));\n                    $(timebar).children(\"input[name=minutes]\").val(formatNumber(tm.getMinutes(), 59));\n                    $(timebar).children(\"input[name=seconds]\").val(formatNumber(tm.getSeconds(), 59));\n                }\n                else {\n                    timebar.style.display = \"none\";\n                }\n            };\n            return Calendar;\n        }(widget.Widget));\n        widget.Calendar = Calendar;\n        widget.register(Calendar, \"calendar\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <group>\n         * Attributes: name, type(check,radio,toggle)\n         * Events:\n         */\n        var Group = (function (_super) {\n            __extends(Group, _super);\n            function Group() {\n                _super.apply(this, arguments);\n            }\n            Group.prototype.initChildren = function (childNodes) {\n                for (var _i = 0, childNodes_3 = childNodes; _i < childNodes_3.length; _i++) {\n                    var node = childNodes_3[_i];\n                    this._.appendChild(node);\n                }\n            };\n            Group.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"value\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"object\" && value !== null) {\n                                var children = widget.search(_this._);\n                                for (var _i = 0, children_2 = children; _i < children_2.length; _i++) {\n                                    var item = children_2[_i];\n                                    var key = item.get(\"name\");\n                                    if (key !== null) {\n                                        item.set(\"value\", value[key]);\n                                    }\n                                }\n                            }\n                        },\n                        \"get\": function () {\n                            var value = {};\n                            var children = widget.search(_this._);\n                            for (var _i = 0, children_3 = children; _i < children_3.length; _i++) {\n                                var item = children_3[_i];\n                                var key = item.get(\"name\");\n                                if (key !== null) {\n                                    value[key] = item.get(\"value\");\n                                }\n                            }\n                            return value;\n                        }\n                    }\n                });\n            };\n            Group.prototype.init = function () {\n                widget.init(this._);\n            };\n            Group.prototype.render = function () {\n                var root = this._;\n                var result = widget.search(root);\n                for (var _i = 0, result_2 = result; _i < result_2.length; _i++) {\n                    var child = result_2[_i];\n                    child.render();\n                }\n            };\n            return Group;\n        }(widget.Widget));\n        widget.Group = Group;\n        var ButtonGroup = (function (_super) {\n            __extends(ButtonGroup, _super);\n            function ButtonGroup() {\n                _super.apply(this, arguments);\n            }\n            ButtonGroup.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"value\": {\n                        \"set\": function (value) {\n                            var children = widget.search(_this._, function (elem) {\n                                if (elem.get(\"parent\") === _this && elem instanceof widget.Button)\n                                    return true;\n                                else\n                                    return false;\n                            });\n                            function check(v) {\n                                if (value instanceof Array) {\n                                    return value.indexOf(v) >= 0;\n                                }\n                                else {\n                                    return value === v;\n                                }\n                            }\n                            for (var _i = 0, children_4 = children; _i < children_4.length; _i++) {\n                                var button = children_4[_i];\n                                if (check(button.get(\"value\"))) {\n                                    button.set(\"checked\", true);\n                                }\n                                else\n                                    button.set(\"checked\", false);\n                            }\n                        },\n                        \"get\": function () {\n                            var values = [];\n                            var children = widget.search(_this._, function (elem) {\n                                if (elem.get(\"parent\") === _this && elem instanceof widget.Button)\n                                    return true;\n                                else\n                                    return false;\n                            });\n                            for (var _i = 0, children_5 = children; _i < children_5.length; _i++) {\n                                var button = children_5[_i];\n                                if (button.get(\"checked\"))\n                                    values.push(button.get(\"value\"));\n                            }\n                            if (_this.get(\"type\") === \"radio\" || _this.get(\"type\") === \"toggle-radio\") {\n                                if (values.length > 0)\n                                    return values[0];\n                                else\n                                    return null;\n                            }\n                            else\n                                return values;\n                        }\n                    },\n                    \"text\": {\n                        \"get\": function () {\n                            var values = [];\n                            var children = widget.search(_this._, function (elem) {\n                                if (elem.get(\"parent\") === _this && elem instanceof widget.Button)\n                                    return true;\n                                else\n                                    return false;\n                            });\n                            for (var _i = 0, children_6 = children; _i < children_6.length; _i++) {\n                                var button = children_6[_i];\n                                if (button.get(\"checked\"))\n                                    values.push(button.get(\"text\"));\n                            }\n                            return values.join(\",\");\n                        }\n                    }\n                });\n            };\n            return ButtonGroup;\n        }(Group));\n        widget.ButtonGroup = ButtonGroup;\n        widget.register(Group, \"group\");\n        widget.register(ButtonGroup, \"button-group\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\n/// <reference path=\"group.ts\" />\n/// <reference path=\"../ajax/ajax.ts\" />\n/// <reference path=\"../service/service.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget_5) {\n        \"use strict\";\n        var Component = (function (_super) {\n            __extends(Component, _super);\n            function Component() {\n                _super.apply(this, arguments);\n            }\n            Component.prototype.checkReady = function () {\n                var hasHandler = !!this.get(\"handler\");\n                var hasSrc = !!this.get(\"src\");\n                if ((!hasHandler || hasHandler && this._scriptReady)\n                    && (!hasSrc || hasSrc && this._htmlReady)\n                    && this._changed\n                    && this._childrenInit\n                    && this._noReadyCount <= 0) {\n                    this._changed = false;\n                    if (this._fn) {\n                        try {\n                            this._fn.call(this);\n                        }\n                        finally {\n                            this._fn = null;\n                        }\n                    }\n                    this.fire(\"load\");\n                    var parent = this.get(\"parent\");\n                    parent && parent.fire(\"componentReady\", { name: this.get(\"name\") });\n                }\n            };\n            Component.prototype.initRestriction = function () {\n                var _this = this;\n                this._fn = null;\n                this._changed = true;\n                this._noReadyCount = 0;\n                this._childrenInit = false;\n                this._scriptReady = false;\n                this._htmlReady = false;\n                this.on(\"componentReady\", function (e) {\n                    _this._noReadyCount--;\n                    _this.checkReady();\n                });\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"handler\": {\n                        \"set\": function (value) {\n                            var oldValue = _this._data[\"handler\"];\n                            if (value && (value + \"\").trim().length > 0) {\n                                value = (value + \"\").trim();\n                                if (oldValue != value)\n                                    _this._changed = true;\n                                _this._data[\"handler\"] = value;\n                                _this._fn = null;\n                                _this._scriptReady = false;\n                                tui.ajax.getFunction(value).done(function (result) {\n                                    _this._fn = result;\n                                    _this._scriptReady = true;\n                                    _this.checkReady();\n                                }).fail(function () {\n                                    _this._scriptReady = true;\n                                    _this.checkReady();\n                                });\n                            }\n                            else {\n                                if (oldValue)\n                                    _this._changed = true;\n                                delete _this._data[\"handler\"];\n                                _this._scriptReady = true;\n                                _this._fn = null;\n                                _this.checkReady();\n                            }\n                        }\n                    }, \"src\": {\n                        \"set\": function (value) {\n                            var oldValue = _this._data[\"src\"];\n                            if (value == oldValue)\n                                return;\n                            if (value && (value + \"\").trim().length > 0) {\n                                value = (value + \"\").trim();\n                                _this._data[\"src\"] = value;\n                                _this._htmlReady = false;\n                                _this._childrenInit = false;\n                                tui.ajax.getComponent(_this.get(\"url\")).done(function (result, handler) {\n                                    _this._htmlReady = true;\n                                    tui.browser.setInnerHtml(_this._, result);\n                                    _this.loadComponents();\n                                    handler && _this.set(\"handler\", handler);\n                                    _this.render();\n                                    _this.checkReady();\n                                }).fail(function () {\n                                    _this._htmlReady = true;\n                                    _this.checkReady();\n                                });\n                            }\n                            else {\n                                if (oldValue) {\n                                    _this._changed = true;\n                                    _this._.innerHTML = \"\";\n                                }\n                                delete _this._data[\"src\"];\n                                _this._htmlReady = true;\n                                _this.checkReady();\n                            }\n                        }\n                    }, \"url\": {\n                        \"get\": function () {\n                            var parentUrl = _this.getParentUrl();\n                            var path = _this.get(\"src\");\n                            if (!path)\n                                return parentUrl;\n                            else {\n                                if (tui.text.isAbsUrl(path))\n                                    return path;\n                                else\n                                    return tui.text.joinUrl(tui.text.getBaseUrl(parentUrl), path);\n                            }\n                        }\n                    }\n                });\n            };\n            Component.prototype.getParentUrl = function () {\n                var elem = this._.parentNode;\n                while (elem) {\n                    if (elem.__widget__ && elem.__widget__.getNodeName() === \"component\") {\n                        return elem.__widget__.get(\"url\");\n                    }\n                    else {\n                        elem = elem.parentNode;\n                    }\n                }\n                return location.href;\n            };\n            Component.prototype.loadComponents = function () {\n                var _this = this;\n                var searchElem = function (parent) {\n                    for (var i = 0; i < parent.childNodes.length; i++) {\n                        var node = parent.childNodes[i];\n                        if (node.nodeType !== 1) {\n                            continue;\n                        }\n                        var elem = node;\n                        var widget_6 = elem.__widget__;\n                        var name_4 = void 0;\n                        var fullName = widget_5.getFullName(elem);\n                        if (fullName === \"tui:component\")\n                            _this._noReadyCount++;\n                        if (widget_6) {\n                            name_4 = tui.get(elem).get(\"name\");\n                            if (typeof name_4 === \"string\" && name_4.trim().length > 0)\n                                _this._components[name_4] = elem;\n                        }\n                        else {\n                            name_4 = elem.getAttribute(\"name\");\n                            if (typeof name_4 === \"string\" && name_4.trim().length > 0)\n                                _this._components[name_4] = elem;\n                            if (!fullName.match(/^tui:/i) || fullName.match(/^tui:(dialog-select|input-group|group|button-group)$/))\n                                searchElem(node);\n                        }\n                    }\n                };\n                this._components = { '': this._ };\n                this._noReadyCount = 0;\n                searchElem(this._);\n                this._childrenInit = true;\n            };\n            Component.prototype.initChildren = function (childNodes) {\n                var _this = this;\n                if (this.get(\"src\") == null) {\n                    childNodes.forEach(function (n) { return _this._.appendChild(n); });\n                    this.loadComponents();\n                    this.checkReady();\n                }\n            };\n            Component.prototype.use = function (fn, desc) {\n                var _this = this;\n                if (typeof fn === \"function\") {\n                    var params = tui.service.parseParameters(fn, desc);\n                    var argv = params.split(\",\").map(function (s) {\n                        if (!s)\n                            return null;\n                        else if (s[0] === '$') {\n                            return tui.service.get(s.substr(1));\n                        }\n                        else {\n                            var c = _this.getComponent(s.trim());\n                            if (c && c.__widget__)\n                                c = c.__widget__;\n                            return c;\n                        }\n                    });\n                    fn.apply(this, argv);\n                }\n            };\n            Component.prototype.render = function () {\n                widget_5.init(this._);\n            };\n            return Component;\n        }(widget_5.Group));\n        widget_5.Component = Component;\n        widget_5.register(Component, \"component\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var VALIDATORS = {\n            \"*email\": \"^(\\\\w+([-+.]\\\\w+)*@\\\\w+([-.]\\\\w+)*\\\\.\\\\w+([-.]\\\\w+)*)?$\",\n            \"*chinese\": \"^[\\\\u4e00-\\\\u9fa5]*$\",\n            \"*url\": \"^(https?://([\\\\w-_]+:[^@/]+@)?[\\\\w-]+(\\\\.[\\\\w-]+)*(:[0-9]+)?(/[\\\\w-./?%&=]*)?)?$\",\n            \"*digital\": \"^\\\\d*$\",\n            \"*integer\": \"^([+\\\\-]?\\\\d+)?$\",\n            \"*float\": \"^([+\\\\-]?\\\\d*\\\\.\\\\d+)?$\",\n            \"*number\": \"^([+\\\\-]?\\\\d+|(\\\\d*\\\\.\\\\d+))?$\",\n            \"*currency\": \"^(-?\\\\d{1,3}(,\\\\d{3})*\\\\.\\\\d{2,3})?$\",\n            \"*date\": \"^([0-9]{4}-1[0-2]|0?[1-9]-0?[1-9]|[12][0-9]|3[01])?$\",\n            \"*key\": \"^([_a-zA-Z][a-zA-Z0-9_]*)?$\",\n            \"*any\": \"\\\\S+\"\n        };\n        var InputBase = (function (_super) {\n            __extends(InputBase, _super);\n            function InputBase() {\n                _super.apply(this, arguments);\n                this._valid = true;\n                this._invalidMessage = null;\n            }\n            InputBase.prototype.initChildren = function (childNodes) {\n                var validators = [];\n                for (var _i = 0, childNodes_4 = childNodes; _i < childNodes_4.length; _i++) {\n                    var node = childNodes_4[_i];\n                    if (widget.getFullName(node) === \"tui:verify\") {\n                        var format = node.getAttribute(\"format\");\n                        if (format) {\n                            var validator = { format: format, message: node.innerHTML };\n                            validators.push(validator);\n                        }\n                    }\n                }\n                this._set(\"validate\", validators);\n            };\n            InputBase.prototype.reset = function () {\n                if (this._valid !== true) {\n                    this._valid = true;\n                    this._invalidMessage = null;\n                    this.render();\n                }\n            };\n            InputBase.prototype.updateEmptyState = function (empty) {\n                if (this._isEmpty !== empty) {\n                    this._isEmpty = empty;\n                    if (this._valid === true)\n                        this.render();\n                }\n            };\n            InputBase.prototype.validate = function (e) {\n                var text = this.get(\"text\");\n                if (text === null)\n                    text = \"\";\n                this._valid = true;\n                var validator = this.get(\"validate\");\n                if (text === \"\" && this.get(\"allowEmpty\")) {\n                    return true;\n                }\n                if (!(validator instanceof Array))\n                    return true;\n                for (var _i = 0, validator_1 = validator; _i < validator_1.length; _i++) {\n                    var item = validator_1[_i];\n                    var k = item.format;\n                    if (k === \"*password\") {\n                        if (!/[a-z]/.test(text) ||\n                            !/[A-Z]/.test(text) ||\n                            !/[0-9]/.test(text) ||\n                            !/[\\~\\`\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\_\\-\\+\\=\\\\\\]\\[\\{\\}\\:\\;\\\"\\'\\/\\?\\,\\.\\<\\>\\|]/.test(text) ||\n                            text.length < 6) {\n                            this._valid = false;\n                        }\n                    }\n                    else if (k.substr(0, 8) === \"*maxlen:\") {\n                        var imaxLen = parseFloat(k.substr(8));\n                        if (isNaN(imaxLen))\n                            throw new Error(\"Invalid validator: '*maxlen:...' must follow a number\");\n                        var ival = text.length;\n                        if (ival > imaxLen) {\n                            this._valid = false;\n                        }\n                    }\n                    else if (k.substr(0, 8) === \"*minlen:\") {\n                        var iminLen = parseFloat(k.substr(8));\n                        if (isNaN(iminLen))\n                            throw new Error(\"Invalid validator: '*minLen:...' must follow a number\");\n                        var ival = text.length;\n                        if (ival < iminLen) {\n                            this._valid = false;\n                        }\n                    }\n                    else if (k.substr(0, 5) === \"*max:\") {\n                        var imax = parseFloat(k.substr(5));\n                        if (isNaN(imax))\n                            throw new Error(\"Invalid validator: '*max:...' must follow a number\");\n                        var ival = parseFloat(text);\n                        if (isNaN(ival) || ival > imax) {\n                            this._valid = false;\n                        }\n                    }\n                    else if (k.substr(0, 5) === \"*min:\") {\n                        var imin = parseFloat(k.substr(5));\n                        if (isNaN(imin))\n                            throw new Error(\"Invalid validator: '*min:...' must follow a number\");\n                        var ival = parseFloat(text);\n                        if (isNaN(ival) || ival < imin) {\n                            this._valid = false;\n                        }\n                    }\n                    else if (k.substr(0, 6) === \"*same:\") {\n                        var other = k.substr(6);\n                        var o = widget.get(other);\n                        if (o) {\n                            var otherText = o.get(\"text\");\n                            if (otherText === null)\n                                otherText = \"\";\n                            if (text !== otherText)\n                                this._valid = false;\n                        }\n                        else {\n                            this._valid = false;\n                        }\n                    }\n                    else {\n                        var regexp;\n                        if (k.substr(0, 1) === \"*\") {\n                            var v = VALIDATORS[k];\n                            if (v)\n                                regexp = new RegExp(v);\n                            else\n                                throw new Error(\"Invalid validator: \" + k + \" is not a valid validator\");\n                        }\n                        else {\n                            regexp = new RegExp(k);\n                        }\n                        this._valid = regexp.test(text);\n                    }\n                    if (!this._valid) {\n                        this._invalidMessage = item.message;\n                        break;\n                    }\n                }\n                if (!this._valid && !this._invalidMessage) {\n                    this._invalidMessage = tui.str(\"Invalid input.\");\n                }\n                this.render();\n                if (e)\n                    this.fire(\"validate\", { e: e, valid: this._valid, message: this._invalidMessage });\n                return this._valid;\n            };\n            return InputBase;\n        }(widget.Widget));\n        widget.InputBase = InputBase;\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"inputBase.ts\" />\n/// <reference path=\"../browser/keyboard.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var SelectBase = (function (_super) {\n            __extends(SelectBase, _super);\n            function SelectBase() {\n                _super.apply(this, arguments);\n                this._inSelection = false;\n            }\n            SelectBase.prototype.closeSelect = function () {\n                var popup = widget.get(this._components[\"popup\"]);\n                popup && popup.close();\n            };\n            SelectBase.prototype.init = function () {\n                var _this = this;\n                var $root = $(this._);\n                var popup = this.createPopup();\n                this._components[\"popup\"] = popup._;\n                var label = this._components[\"label\"] = document.createElement(\"span\");\n                var iconRight = this._components[\"iconRight\"] = document.createElement(\"i\");\n                var iconInvalid = this._components[\"iconInvalid\"] = document.createElement(\"i\");\n                var clearButton = this._components[\"clearButton\"] = document.createElement(\"i\");\n                clearButton.className = \"tui-input-clear-button\";\n                iconInvalid.className = \"tui-invalid-icon\";\n                label.className = \"tui-input-label\";\n                label.setAttribute(\"unselectable\", \"on\");\n                this._.appendChild(label);\n                this._.appendChild(iconInvalid);\n                this._.appendChild(iconRight);\n                this._.appendChild(clearButton);\n                this._.setAttribute(\"tabIndex\", \"0\");\n                $(this._).focus(function () {\n                    $root.addClass(\"tui-active\");\n                });\n                $(this._).blur(function () {\n                    $root.removeClass(\"tui-active\");\n                    if (_this.get(\"disable\"))\n                        return;\n                    if (_this.get(\"autoValidate\")) {\n                        if (!_this._inSelection)\n                            _this.validate();\n                    }\n                });\n                $root.on(\"mousedown\", function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    _this._.focus();\n                    _this.reset();\n                    setTimeout(function () {\n                        _this._inSelection = true;\n                        _this.openSelect();\n                    }, 0);\n                });\n                $root.keypress(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    if (e.charCode === tui.browser.KeyCode.SPACE) {\n                        e.preventDefault();\n                        _this.reset();\n                        setTimeout(function () {\n                            _this._inSelection = true;\n                            _this.openSelect();\n                        }, 0);\n                    }\n                });\n                $(clearButton).on(\"mousedown\", function (e) {\n                    _this.set(\"value\", null);\n                    _this.set(\"text\", \"\");\n                    _this.reset();\n                    _this.fire(\"change\", e);\n                    e.stopPropagation();\n                });\n                popup.on(\"close\", function () {\n                    _this._inSelection = false;\n                    if (_this.get(\"autoValidate\")) {\n                        setTimeout(function () {\n                            if (document.activeElement !== _this._)\n                                _this.validate();\n                        });\n                    }\n                });\n            };\n            SelectBase.prototype.render = function () {\n                this._.scrollLeft = 0;\n                var $root = $(this._);\n                var label = this._components[\"label\"];\n                var iconRight = this._components[\"iconRight\"];\n                var iconInvalid = this._components[\"iconInvalid\"];\n                var clearButton = this._components[\"clearButton\"];\n                if (this.get(\"disable\")) {\n                    $root.addClass(\"tui-disable\");\n                }\n                else {\n                    $root.removeClass(\"tui-disable\");\n                }\n                var text = this.get(\"text\");\n                var noValue = false;\n                if (text === null || text === \"\") {\n                    noValue = true;\n                    text = this.get(\"placeholder\");\n                    $(label).addClass(\"tui-placeholder\");\n                }\n                else {\n                    $(label).removeClass(\"tui-placeholder\");\n                }\n                if (text === null)\n                    text = \"\";\n                $(label).text(text);\n                iconRight.className = this.get(\"iconRight\");\n                iconRight.style.display = \"\";\n                iconRight.style.right = \"0\";\n                if (!this._valid) {\n                    $root.addClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"\";\n                    iconInvalid.style.right = iconRight.offsetWidth + \"px\";\n                }\n                else {\n                    $root.removeClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"none\";\n                }\n                if (this.get(\"clearable\") && (!noValue)) {\n                    clearButton.style.display = \"\";\n                    clearButton.style.right = iconRight.offsetWidth + iconInvalid.offsetWidth + \"px\";\n                }\n                else {\n                    clearButton.style.display = \"none\";\n                }\n                if (!this._valid && this._invalidMessage) {\n                    this._set(\"follow-tooltip\", this._invalidMessage);\n                }\n                else {\n                    this._set(\"follow-tooltip\", null);\n                }\n            };\n            SelectBase.PADDING = 6;\n            return SelectBase;\n        }(widget.InputBase));\n        widget.SelectBase = SelectBase;\n        var SelectPopupBase = (function (_super) {\n            __extends(SelectPopupBase, _super);\n            function SelectPopupBase() {\n                _super.apply(this, arguments);\n            }\n            SelectPopupBase.prototype.createPopup = function () {\n                return widget.create(\"popup\");\n            };\n            return SelectPopupBase;\n        }(SelectBase));\n        widget.SelectPopupBase = SelectPopupBase;\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"selectBase.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <tui:date-picker>\n         * Attributes: value, text(value to string), format, timeBar\n         * Method: openSelect\n         * Events: change\n         */\n        var DatePicker = (function (_super) {\n            __extends(DatePicker, _super);\n            function DatePicker() {\n                _super.apply(this, arguments);\n            }\n            DatePicker.prototype.initRestriction = function () {\n                var _this = this;\n                var calendar = widget.create(\"calendar\");\n                this._components[\"calendar\"] = calendar._;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"timeBar\": {\n                        \"set\": function (value) {\n                            calendar._set(\"timeBar\", !!value);\n                        },\n                        \"get\": function () {\n                            return !!calendar.get(\"timeBar\");\n                        }\n                    },\n                    \"text\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            var value = _this.get(\"value\");\n                            if (value === null)\n                                return \"\";\n                            return tui.time.formatDate(value, _this.get(\"format\"));\n                        }\n                    }\n                });\n            };\n            DatePicker.prototype.init = function () {\n                var _this = this;\n                _super.prototype.init.call(this);\n                this.setInit(\"format\", \"yyyy-MM-dd\");\n                this.setInit(\"iconRight\", \"fa-calendar\");\n                var calendar = widget.get(this._components[\"calendar\"]);\n                var container = document.createElement(\"div\");\n                var toolbar = container.appendChild(document.createElement(\"div\"));\n                toolbar.className = \"tui-select-toolbar\";\n                container.insertBefore(calendar._, container.firstChild);\n                var popup = widget.get(this._components[\"popup\"]);\n                popup._set(\"content\", container);\n                this._components[\"toolbar\"] = toolbar;\n                calendar._.style.display = \"block\";\n                calendar._.style.borderWidth = \"0\";\n                calendar.on(\"click\", function (e) {\n                    _this.set(\"value\", calendar.get(\"value\"));\n                    _this.fire(\"change\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                    if (e.data.type === \"pick\") {\n                        _this.closeSelect();\n                        _this._.focus();\n                    }\n                });\n                $(toolbar).click(function (e) {\n                    var obj = (e.target || e.srcElement);\n                    var name = obj.getAttribute(\"name\");\n                    if (name === \"today\") {\n                        _this.set(\"value\", tui.time.now());\n                        _this.fire(\"change\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                        _this.closeSelect();\n                        _this._.focus();\n                    }\n                    else if (name === \"clear\") {\n                        _this.set(\"value\", null);\n                        _this.fire(\"change\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                        _this.closeSelect();\n                        _this._.focus();\n                    }\n                });\n            };\n            DatePicker.prototype.openSelect = function () {\n                var _this = this;\n                var calendar = widget.get(this._components[\"calendar\"]);\n                var popup = widget.get(this._components[\"popup\"]);\n                //popup._set(\"content\", list._);\n                var toolbar = this._components[\"toolbar\"];\n                var todayButton = \"<a name='today'>\" + tui.str(\"Today\") + \"</a>\";\n                var clearButton = \" | <a name='clear'><i class='fa fa-trash-o'></i> \" + tui.str(\"Clear\") + \"</a>\";\n                var clearable = this.get(\"clearable\");\n                calendar._.style.outline = \"none\";\n                toolbar.style.display = \"\";\n                if (clearable)\n                    toolbar.innerHTML = todayButton + clearButton;\n                else\n                    toolbar.innerHTML = todayButton;\n                popup.open(this._, \"Lb\");\n                setTimeout(function () {\n                    calendar._.focus();\n                    calendar.set(\"value\", _this.get(\"value\"));\n                });\n            };\n            return DatePicker;\n        }(widget.SelectPopupBase));\n        widget.DatePicker = DatePicker;\n        widget.register(DatePicker, \"date-picker\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"inputBase.ts\" />\n/// <reference path=\"../browser/upload.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var File = (function (_super) {\n            __extends(File, _super);\n            function File() {\n                _super.apply(this, arguments);\n            }\n            File.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this._uploader = tui.browser.createUploader(this._);\n                this.setRestrictions({\n                    \"action\": {\n                        \"set\": function (value) {\n                            _this._uploader.getOptions().action = value;\n                        },\n                        \"get\": function () {\n                            return _this._uploader.getOptions().action;\n                        }\n                    },\n                    \"accept\": {\n                        \"set\": function (value) {\n                            _this._uploader.getOptions().accept = value;\n                            if (_this._uploader.getInput()) {\n                                _this._uploader.deleteInput();\n                                _this._uploader.createInput();\n                            }\n                        },\n                        \"get\": function () {\n                            return _this._uploader.getOptions().accept;\n                        }\n                    },\n                    \"value\": {\n                        \"set\": function (value) {\n                            _this._data[\"value\"] = value;\n                            if (value === null || typeof value === tui.UNDEFINED) {\n                                _this._set(\"text\", \"\");\n                            }\n                        }\n                    }\n                });\n            };\n            File.prototype.init = function () {\n                var _this = this;\n                this.setInit(\"iconRight\", \"fa-file-o\");\n                var $root = $(this._);\n                var label = this._components[\"label\"] = document.createElement(\"span\");\n                var iconRight = this._components[\"iconRight\"] = document.createElement(\"i\");\n                var iconInvalid = this._components[\"iconInvalid\"] = document.createElement(\"i\");\n                iconInvalid.className = \"tui-invalid-icon\";\n                label.className = \"tui-input-label\";\n                label.setAttribute(\"unselectable\", \"on\");\n                this._.appendChild(label);\n                this._.appendChild(iconInvalid);\n                this._.appendChild(iconRight);\n                this._.setAttribute(\"tabIndex\", \"0\");\n                $(this._).focus(function () {\n                    $root.addClass(\"tui-active\");\n                });\n                var onblur = function () {\n                    if (document.activeElement === _this._ || document.activeElement === _this._uploader.getInput())\n                        return;\n                    $root.removeClass(\"tui-active\");\n                    if (_this.get(\"disable\"))\n                        return;\n                    if (_this.get(\"autoValidate\")) {\n                        _this.validate();\n                    }\n                };\n                $(this._).blur(function () {\n                    setTimeout(function () {\n                        onblur();\n                    });\n                });\n                this._uploader.on(\"focus\", function () {\n                    $root.addClass(\"tui-active\");\n                });\n                this._uploader.on(\"blur\", function () {\n                    setTimeout(function () {\n                        onblur();\n                    });\n                });\n                this._uploader.on(\"change\", function (e) {\n                    return _this.fire(\"change\", e);\n                });\n                this._uploader.on(\"success\", function (e) {\n                    _this._set(\"value\", e.data.response.fileId);\n                    _this.set(\"text\", e.data.response.fileName);\n                });\n                this._uploader.on(\"error\", function (e) {\n                    tui.errbox(e.data.response.error, tui.str(\"Error\"));\n                });\n            };\n            File.prototype.render = function () {\n                this._.scrollLeft = 0;\n                var $root = $(this._);\n                var label = this._components[\"label\"];\n                var iconRight = this._components[\"iconRight\"];\n                var iconInvalid = this._components[\"iconInvalid\"];\n                if (this.get(\"disable\")) {\n                    $root.addClass(\"tui-disable\");\n                    this._uploader.deleteInput();\n                    this._.setAttribute(\"tabIndex\", \"0\");\n                }\n                else {\n                    $root.removeClass(\"tui-disable\");\n                    this._uploader.createInput();\n                    this._.removeAttribute(\"tabIndex\");\n                }\n                var text = this.get(\"text\");\n                if (text === null || text === \"\") {\n                    text = this.get(\"placeholder\");\n                    $(label).addClass(\"tui-placeholder\");\n                }\n                else {\n                    $(label).removeClass(\"tui-placeholder\");\n                }\n                if (text === null)\n                    text = \"\";\n                $(label).text(text);\n                iconRight.className = this.get(\"iconRight\");\n                iconRight.style.display = \"\";\n                iconRight.style.right = \"0\";\n                if (!this._valid) {\n                    $root.addClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"\";\n                    iconInvalid.style.right = iconRight.offsetWidth + \"px\";\n                }\n                else {\n                    $root.removeClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"none\";\n                }\n                if (!this._valid && this._invalidMessage) {\n                    this._set(\"follow-tooltip\", this._invalidMessage);\n                }\n                else {\n                    this._set(\"follow-tooltip\", null);\n                }\n            };\n            File.PADDING = 6;\n            return File;\n        }(widget.InputBase));\n        widget.File = File;\n        widget.register(File, \"file\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var Frame = (function (_super) {\n            __extends(Frame, _super);\n            function Frame() {\n                _super.apply(this, arguments);\n            }\n            Frame.prototype.initRestriction = function () {\n                var _this = this;\n                this._cache = {};\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"src\": {\n                        \"set\": function (value) {\n                            _this._go(value);\n                        }\n                    }\n                });\n            };\n            Frame.prototype._go = function (src, cache, name) {\n                var _this = this;\n                if (cache === void 0) { cache = true; }\n                this._data[\"src\"] = src;\n                if (typeof name === tui.UNDEFINED || name == null) {\n                    name = \"\";\n                }\n                var key = name + \":\" + src;\n                if (cache && this._cache.hasOwnProperty(key)) {\n                    if (tui.ieVer > 0)\n                        while (this._.children.length > 0) {\n                            this._.removeChild(this._.children[0]);\n                        }\n                    else\n                        this._.innerHTML = \"\";\n                    var page = this._cache[key];\n                    this._.appendChild(page);\n                }\n                else {\n                    tui.ajax.getBody(src).done(function (content) {\n                        var page = tui.browser.toElement(content, true);\n                        if (tui.ieVer > 0)\n                            while (_this._.children.length > 0) {\n                                _this._.removeChild(_this._.children[0]);\n                            }\n                        else\n                            _this._.innerHTML = \"\";\n                        _this._.appendChild(page);\n                        if (cache) {\n                            _this._cache[key] = page;\n                        }\n                        _this.render();\n                    });\n                }\n            };\n            Frame.prototype.go = function (src, cache, name) {\n                if (cache === void 0) { cache = true; }\n                this._go(src, cache, name);\n                this.render();\n            };\n            Frame.prototype.render = function () {\n                widget.init(this._);\n            };\n            return Frame;\n        }(widget.Widget));\n        widget.Frame = Frame;\n        widget.register(Frame, \"frame\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\n/// <reference path=\"../browser/keyboard.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        function vval(v) {\n            if (isNaN(v))\n                return 0;\n            else\n                return v;\n        }\n        /**\n         * <tui:gird>\n         * Attributes: data, list(array type data), tree(tree type data),\n         * columns, sortColumn, sortType, scrollTop, scrollLeft, activeRow,\n         * activeColumn\n         * Method: scrollTo, setSortFlag\n         * Events: sort, rowclick, rowdblclick, rowcheck, keyselect\n         */\n        var Grid = (function (_super) {\n            __extends(Grid, _super);\n            function Grid() {\n                _super.apply(this, arguments);\n                this._setupHeadMoveListener = false;\n                this._columnWidths = [];\n                this._vLines = [];\n                this._handlers = [];\n            }\n            Grid.prototype.initRestriction = function () {\n                var _this = this;\n                // Register update callback routine\n                var updateCallback = (function () {\n                    var me = _this;\n                    return function (data) {\n                        if (data.data[\"completely\"]) {\n                            me.render();\n                            me.fire(\"update\");\n                        }\n                        else {\n                            me.drawContent();\n                            me.fire(\"update\");\n                        }\n                    };\n                })();\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"selectable\": {\n                        \"get\": function () {\n                            var val = _this._data[\"selectable\"];\n                            if (typeof val === tui.UNDEFINED || val === null)\n                                return true;\n                            else\n                                return !!val;\n                        }\n                    },\n                    \"lineHeight\": {\n                        \"get\": function () {\n                            var val = _this._data[\"lineHeight\"];\n                            if (typeof val !== \"number\" || isNaN(val))\n                                return Grid.LINE_HEIGHT;\n                            else\n                                return val;\n                        }\n                    },\n                    \"dataType\": {\n                        \"set\": function (value) { }\n                    },\n                    \"data\": {\n                        \"set\": function (value) {\n                            if (_this._data[\"data\"] && typeof _this._data[\"data\"].off === \"function\") {\n                                _this._data[\"data\"].off(\"update\", updateCallback);\n                            }\n                            if (value instanceof tui.ds.List ||\n                                value instanceof tui.ds.RemoteList) {\n                                _this._data[\"data\"] = value;\n                                _this._data[\"dataType\"] = \"list\";\n                            }\n                            else if (value instanceof tui.ds.Tree ||\n                                value instanceof tui.ds.RemoteTree) {\n                                _this._data[\"data\"] = value;\n                                _this._data[\"dataType\"] = \"tree\";\n                            }\n                            else if (value instanceof Array) {\n                                _this._data[\"data\"] = new tui.ds.List(value);\n                            }\n                            else if (value === null) {\n                                _this._data[\"data\"] = new tui.ds.List([]);\n                            }\n                            if (_this._data[\"data\"] && typeof _this._data[\"data\"].on === \"function\") {\n                                _this._data[\"data\"].on(\"update\", updateCallback);\n                            }\n                            _this._vbar && _this._vbar._set(\"value\", 0);\n                            _this._vbar && _this._hbar._set(\"value\", 0);\n                            _this._set(\"activeRow\", null);\n                        },\n                        \"get\": function () {\n                            var data = _this._data[\"data\"];\n                            if (data)\n                                return data;\n                            else\n                                return new tui.ds.List([]);\n                        }\n                    },\n                    \"list\": {\n                        \"set\": function (value) {\n                            if (value instanceof tui.ds.List ||\n                                value instanceof tui.ds.RemoteList)\n                                _this._set(\"data\", value);\n                            else if (value instanceof Array) {\n                                _this._set(\"data\", new tui.ds.List(value));\n                            }\n                            else if (value === null) {\n                                _this._set(\"data\", null);\n                            }\n                        },\n                        \"get\": function () { }\n                    },\n                    \"tree\": {\n                        \"set\": function (value) {\n                            if (value instanceof tui.ds.Tree ||\n                                value instanceof tui.ds.RemoteTree)\n                                _this._set(\"data\", value);\n                            else if (value instanceof Array) {\n                                _this._set(\"data\", new tui.ds.Tree(value));\n                            }\n                            else if (value === null) {\n                                _this._set(\"data\", null);\n                            }\n                        },\n                        \"get\": function () { }\n                    },\n                    \"columns\": {\n                        \"set\": function (value) {\n                            if (value instanceof Array) {\n                                _this._data[\"columns\"] = value;\n                                _this.clearBuffer();\n                                _this._columnWidths = [];\n                            }\n                        },\n                        \"get\": function () {\n                            if (_this._data[\"columns\"])\n                                return _this._data[\"columns\"];\n                            else\n                                return [];\n                        }\n                    },\n                    \"scrollTop\": {\n                        \"set\": function (value) {\n                            _this._vbar._set(\"value\", value);\n                        },\n                        \"get\": function () {\n                            return _this._vbar.get(\"value\");\n                        }\n                    },\n                    \"scrollLeft\": {\n                        \"set\": function (value) {\n                            _this._hbar._set(\"value\", value);\n                        },\n                        \"get\": function () {\n                            return _this._hbar.get(\"value\");\n                        }\n                    },\n                    \"activeRow\": {\n                        \"set\": function (value) {\n                            if (typeof value === \"number\" && !isNaN(value) || value === null) {\n                                if (value < 0)\n                                    value = 0;\n                                if (value > _this.get(\"data\").length() - 1)\n                                    value = _this.get(\"data\").length() - 1;\n                                if (_this._data[\"activeRow\"] != null && _this._buffer)\n                                    $(_this._buffer.lines[_this._data[\"activeRow\"] - _this._buffer.begin]).removeClass(\"tui-actived\");\n                                _this._data[\"activeRow\"] = value;\n                                if (value != null && _this._buffer)\n                                    $(_this._buffer.lines[value - _this._buffer.begin]).addClass(\"tui-actived\");\n                            }\n                        },\n                        \"get\": function () {\n                            var row = _this._data[\"activeRow\"];\n                            if (row === null)\n                                return null;\n                            if (row >= 0 && row < _this.get(\"data\").length())\n                                return row;\n                            else\n                                return null;\n                        }\n                    },\n                    \"activeRowData\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            var r = _this.get(\"activeRow\");\n                            if (r != null) {\n                                return _this.get(\"data\").get(r);\n                            }\n                            else\n                                return r;\n                        }\n                    }\n                });\n            };\n            Grid.prototype.init = function () {\n                var _this = this;\n                this._tuid = tui.tuid();\n                $(this._).attr({ \"tabIndex\": 0, \"unselectable\": \"on\" });\n                tui.browser.setInnerHtml(this._, \"<div class='tui-grid-head'></div><div class='tui-content'></div>\");\n                var head = this._components[\"head\"] = $(this._).children(\".tui-grid-head\")[0];\n                var content = this._components[\"content\"] = $(this._).children(\".tui-content\")[0];\n                this._hbar = tui.create(\"scrollbar\", { direction: \"horizontal\" });\n                this._components[\"hScroll\"] = this._hbar.appendTo(this._, false)._;\n                this._vbar = tui.create(\"scrollbar\");\n                this._components[\"vScroll\"] = this._vbar.appendTo(this._, false)._;\n                //this._lineHeight = Grid.LINE_HEIGHT;\n                if (document.createStyleSheet) {\n                    this._gridStyle = document.createStyleSheet();\n                }\n                else {\n                    this._gridStyle = document.createElement(\"style\");\n                    document.head.appendChild(this._gridStyle);\n                }\n                this._buffer = { begin: 0, end: 0, lines: [] };\n                this.setInit(\"header\", true);\n                this.on(\"resize\", function () {\n                    _this.render();\n                });\n                this._vbar.on(\"scroll\", function () {\n                    _this.drawContent();\n                });\n                this._hbar.on(\"scroll\", function () {\n                    //this.drawContent();\n                    _this.computeHOffset();\n                });\n                var mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\n                $(this._).on(mousewheelevt, function (ev) {\n                    if (_this.get(\"autoHeight\"))\n                        return;\n                    var e = ev.originalEvent;\n                    var delta = e.detail ? e.detail * (-1) : e.wheelDelta;\n                    var step = _this.get(\"lineHeight\");\n                    //delta returns +120 when wheel is scrolled up, -120 when scrolled down\n                    var scrollSize = step > 1 ? step : 1;\n                    if (delta <= 0) {\n                        // console.log(this._vbar.get(\"value\") + \" : \" + this._vbar.get(\"totle\"));\n                        if (_this._vbar.get(\"value\") < _this._vbar.get(\"total\")) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            _this._vbar.set(\"value\", _this._vbar.get(\"value\") + scrollSize);\n                            _this.drawContent();\n                        }\n                        else if (_this.get(\"noMouseWheel\")) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                        }\n                    }\n                    else {\n                        if (_this._vbar.get(\"value\") > 0) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            _this._vbar.set(\"value\", _this._vbar.get(\"value\") - scrollSize);\n                            _this.drawContent();\n                        }\n                        else if (_this.get(\"noMouseWheel\")) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                        }\n                    }\n                });\n                var scrollX = function (distance) {\n                    var oldValue = _this._hbar.get(\"value\");\n                    _this._hbar.set(\"value\", oldValue - distance);\n                    _this.drawContent();\n                    _this.computeHOffset();\n                    if (_this._hbar.get(\"value\") !== oldValue && Math.abs(lastSpeed) > 0.02) {\n                        return true;\n                    }\n                    else {\n                        return false;\n                    }\n                };\n                var scrollY = function (distance) {\n                    var oldValue = _this._vbar.get(\"value\");\n                    _this._vbar.set(\"value\", oldValue - distance);\n                    _this.drawContent();\n                    if (_this._vbar.get(\"value\") !== oldValue && Math.abs(lastSpeed) > 0.02) {\n                        return true;\n                    }\n                    else {\n                        return false;\n                    }\n                };\n                var inTouched = false;\n                var lastSpeed = 0;\n                var lastPos;\n                var lastTime;\n                var direction = null;\n                $(this._).on(\"touchstart\", function (ev) {\n                    if (inTouched)\n                        return;\n                    var obj = (ev.target || ev.srcElement);\n                    if ($(obj).hasClass(\"tui-grid-handler\")) {\n                        return;\n                    }\n                    direction = null;\n                    inTouched = true;\n                    lastSpeed = 0;\n                    var e = ev.originalEvent;\n                    if (e.targetTouches.length != 1)\n                        return;\n                    var touch = e.targetTouches[0];\n                    lastPos = { x: touch.pageX, y: touch.pageY };\n                    lastTime = new Date().getMilliseconds();\n                });\n                $(this._).on(\"touchmove\", function (ev) {\n                    clearTimeout(hittestTimer);\n                    if (!inTouched)\n                        return;\n                    var e = ev.originalEvent;\n                    var touch = e.targetTouches[0];\n                    var movePos = { x: touch.pageX, y: touch.pageY };\n                    var moveX = movePos.x - lastPos.x;\n                    var moveY = movePos.y - lastPos.y;\n                    var currentTime = new Date().getMilliseconds();\n                    var spanTime = currentTime - lastTime;\n                    if (spanTime <= 0)\n                        return;\n                    lastPos = movePos;\n                    lastTime = currentTime;\n                    if (direction == null) {\n                        if (Math.abs(moveX) > 0 && Math.abs(moveY) > 0)\n                            direction = Math.abs(moveX) > Math.abs(moveY) ? \"x\" : \"y\";\n                        else if (Math.abs(moveX) > 0)\n                            direction = \"x\";\n                        else if (Math.abs(moveY) > 0)\n                            direction = \"y\";\n                    }\n                    if (direction === \"x\") {\n                        lastSpeed = moveX / spanTime;\n                        if (scrollX(moveX)) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                        }\n                    }\n                    else if (direction === \"y\") {\n                        lastSpeed = moveY / spanTime;\n                        if (scrollY(moveY)) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                        }\n                    }\n                });\n                $(this._).on(\"touchend\", function (ev) {\n                    clearTimeout(hittestTimer);\n                    requestAnimationFrame(function keepMove(timestamp) {\n                        if (Math.abs(lastSpeed) > 0.1) {\n                            if (direction === \"x\") {\n                                if (scrollX(lastSpeed * 20)) {\n                                    lastSpeed *= 0.95;\n                                    requestAnimationFrame(keepMove);\n                                }\n                            }\n                            else if (direction === \"y\") {\n                                if (scrollY(lastSpeed * 20)) {\n                                    lastSpeed *= 0.95;\n                                    requestAnimationFrame(keepMove);\n                                }\n                            }\n                            else {\n                                lastSpeed = 0;\n                            }\n                        }\n                    });\n                    inTouched = false;\n                    lastTime = null;\n                });\n                $(this._).on(\"mousedown touchstart\", function (ev) {\n                    var obj = (ev.target || ev.srcElement);\n                    if ($(obj).hasClass(\"tui-grid-handler\")) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        var idx = _this._handlers.indexOf(obj);\n                        var columns = _this.get(\"columns\");\n                        var l = obj.offsetLeft;\n                        var positions = tui.browser.getEventPosition(ev);\n                        var srcX = positions[0].x;\n                        obj.style.height = _this._.clientHeight + \"px\";\n                        $(obj).addClass(\"tui-handler-move\");\n                        var mask = widget.openDragMask(function (e) {\n                            var positions = tui.browser.getEventPosition(e);\n                            obj.style.left = l + positions[0].x - srcX + \"px\";\n                        }, function (e) {\n                            var positions = tui.browser.getEventPosition(e);\n                            obj.style.height = \"\";\n                            $(obj).removeClass(\"tui-handler-move\");\n                            columns[idx].width = columns[idx].width + positions[0].x - srcX;\n                            _this._columnWidths = [];\n                            _this.initColumnWidth();\n                            _this.computeScroll();\n                            _this.computeColumnWidth();\n                            _this.drawHeader();\n                            _this.computeHOffset();\n                        });\n                        mask.style.cursor = \"col-resize\";\n                    }\n                });\n                var hittest = function (obj) {\n                    var line = null;\n                    var col = null;\n                    var srcObj = obj;\n                    while (obj) {\n                        var parent = obj.parentNode;\n                        if (parent && $(parent).hasClass(\"tui-grid-line\")) {\n                            line = _this._buffer.begin + _this._buffer.lines.indexOf(parent);\n                            if (_this.get(\"selectable\") === true) {\n                                col = obj.col;\n                                _this._set(\"activeRow\", line);\n                                _this._set(\"activeColumn\", col);\n                            }\n                            break;\n                        }\n                        obj = parent;\n                    }\n                    return { line: line, col: col };\n                };\n                var hittestTimer = null;\n                var testLine = function (ev) {\n                    var obj = (ev.target || ev.srcElement);\n                    var target = hittest(obj);\n                    if (target.line === null)\n                        return;\n                    var data = _this.get(\"data\");\n                    if ($(obj).hasClass(\"tui-arrow-expand\")) {\n                        data.collapse(target.line);\n                        _this.render();\n                        ev.preventDefault();\n                        _this.fire(\"collapse\", { e: ev, line: target.line });\n                    }\n                    else if ($(obj).hasClass(\"tui-arrow-collapse\")) {\n                        data.expand(target.line);\n                        _this.render();\n                        ev.preventDefault();\n                        _this.fire(\"expand\", { e: ev, line: target.line });\n                    }\n                    else if ($(obj).hasClass(\"tui-grid-check\")) {\n                        var column = _this.get(\"columns\")[target.col];\n                        var checkKey = column.checkKey ? column.checkKey : \"checked\";\n                        var checked;\n                        if (_this.get(\"dataType\") === \"tree\") {\n                            checked = data.get(target.line).item[checkKey] = !data.get(target.line).item[checkKey];\n                        }\n                        else {\n                            checked = data.get(target.line)[checkKey] = !data.get(target.line)[checkKey];\n                        }\n                        _this.drawLine(_this._buffer.lines[target.line - _this._buffer.begin], target.line, _this.get(\"lineHeight\"), _this.get(\"columns\"), data.get(target.line));\n                        ev.preventDefault();\n                        _this.fire(\"rowcheck\", { e: ev, row: target.line, col: target.col, checked: checked });\n                    }\n                    else {\n                        _this.fire(\"rowmousedown\", { e: ev, row: target.line, col: target.col });\n                    }\n                };\n                $(this._).on(\"mousedown\", function (ev) {\n                    testLine(ev);\n                });\n                $(this._).on(\"mouseup\", function (ev) {\n                    var obj = (ev.target || ev.srcElement);\n                    var target = hittest(obj);\n                    if (target.line != null)\n                        _this.fire(\"rowmouseup\", { e: ev, row: target.line, col: target.col });\n                });\n                $(content).click(function (ev) {\n                    var obj = (ev.target || ev.srcElement);\n                    if ($(obj).hasClass(\"tui-arrow-expand\")) {\n                        return;\n                    }\n                    else if ($(obj).hasClass(\"tui-arrow-collapse\")) {\n                        return;\n                    }\n                    else if ($(obj).hasClass(\"tui-grid-check\")) {\n                        return;\n                    }\n                    var target = hittest(obj);\n                    if (target.line != null)\n                        _this.fire(\"rowclick\", { e: ev, row: target.line, col: target.col });\n                });\n                $(content).dblclick(function (ev) {\n                    var obj = (ev.target || ev.srcElement);\n                    if ($(obj).hasClass(\"tui-arrow-expand\")) {\n                        return;\n                    }\n                    else if ($(obj).hasClass(\"tui-arrow-collapse\")) {\n                        return;\n                    }\n                    else if ($(obj).hasClass(\"tui-grid-check\")) {\n                        return;\n                    }\n                    var target = hittest(obj);\n                    if (target.line != null)\n                        _this.fire(\"rowdblclick\", { e: ev, row: target.line, col: target.col });\n                });\n                $(this._).keyup(function (e) {\n                    var activeRow = _this.get(\"activeRow\");\n                    _this.fire(\"keyup\", { e: e, row: activeRow });\n                });\n                $(this._).keydown(function (e) {\n                    var k = e.keyCode;\n                    var activeRow = _this.get(\"activeRow\");\n                    _this.fire(\"keydown\", { e: e, row: activeRow });\n                    if (k >= 33 && k <= 40 || k == tui.browser.KeyCode.ENTER) {\n                        if (k === tui.browser.KeyCode.LEFT) {\n                            if (_this.get(\"dataType\") === \"tree\") {\n                                if (activeRow !== null) {\n                                    var node = _this.get(\"data\").get(activeRow);\n                                    if (node.hasChild && node.expand) {\n                                        _this.get(\"data\").collapse(activeRow);\n                                        _this.render();\n                                        _this.fire(\"collapse\", { e: e, line: activeRow });\n                                        return;\n                                    }\n                                }\n                            }\n                            if (!_this.get(\"autoWidth\")) {\n                                _this._hbar.set(\"value\", _this._hbar.get(\"value\") - 30);\n                                _this.computeHOffset();\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.UP) {\n                            if (!_this.get(\"selectable\")) {\n                                var t = _this.get(\"scrollTop\");\n                                _this._vbar.set(\"value\", t - 10);\n                                _this.drawContent();\n                            }\n                            else {\n                                if (_this.get(\"activeRow\") === null) {\n                                    _this._set(\"activeRow\", 0);\n                                }\n                                else {\n                                    _this._set(\"activeRow\", _this.get(\"activeRow\") - 1);\n                                }\n                                _this.scrollTo(_this.get(\"activeRow\"));\n                                _this.fire(\"keyselect\", { e: e, row: _this.get(\"activeRow\") });\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.RIGHT) {\n                            if (_this.get(\"dataType\") === \"tree\") {\n                                if (activeRow !== null) {\n                                    var node = _this.get(\"data\").get(activeRow);\n                                    if (node.hasChild && !node.expand) {\n                                        _this.get(\"data\").expand(activeRow);\n                                        _this.render();\n                                        _this.fire(\"collapse\", { e: e, line: activeRow });\n                                        return;\n                                    }\n                                }\n                            }\n                            if (!_this.get(\"autoWidth\")) {\n                                _this._hbar.set(\"value\", _this._hbar.get(\"value\") + 30);\n                                _this.computeHOffset();\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.DOWN) {\n                            if (!_this.get(\"selectable\")) {\n                                var t = _this.get(\"scrollTop\");\n                                _this._vbar.set(\"value\", t + 10);\n                                _this.drawContent();\n                            }\n                            else {\n                                if (_this.get(\"activeRow\") === null) {\n                                    _this._set(\"activeRow\", 0);\n                                }\n                                else {\n                                    _this._set(\"activeRow\", _this.get(\"activeRow\") + 1);\n                                }\n                                _this.scrollTo(_this.get(\"activeRow\"));\n                                _this.fire(\"keyselect\", { e: e, row: _this.get(\"activeRow\") });\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.PRIOR) {\n                            if (!_this.get(\"selectable\")) {\n                                var t = _this.get(\"scrollTop\");\n                                _this._vbar.set(\"value\", t - _this._vbar.get(\"page\"));\n                                _this.drawContent();\n                            }\n                            else {\n                                if (_this.get(\"activeRow\") === null) {\n                                    _this._set(\"activeRow\", 0);\n                                }\n                                else {\n                                    _this._set(\"activeRow\", _this.get(\"activeRow\") - _this._dispLines + 1);\n                                }\n                                _this.scrollTo(_this.get(\"activeRow\"));\n                                _this.fire(\"keyselect\", { e: e, row: _this.get(\"activeRow\") });\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.NEXT) {\n                            if (!_this.get(\"selectable\")) {\n                                var t = _this.get(\"scrollTop\");\n                                _this._vbar.set(\"value\", t + _this._vbar.get(\"page\"));\n                                _this.drawContent();\n                            }\n                            else {\n                                if (_this.get(\"activeRow\") === null) {\n                                    _this._set(\"activeRow\", 0);\n                                }\n                                else {\n                                    _this._set(\"activeRow\", _this.get(\"activeRow\") + _this._dispLines - 1);\n                                }\n                                _this.scrollTo(_this.get(\"activeRow\"));\n                                _this.fire(\"keyselect\", { e: e, row: _this.get(\"activeRow\") });\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.HOME) {\n                            if (!_this.get(\"selectable\")) {\n                                _this._vbar.set(\"value\", 0);\n                                _this.drawContent();\n                            }\n                            else {\n                                _this._set(\"activeRow\", 0);\n                                _this.scrollTo(_this.get(\"activeRow\"));\n                                _this.fire(\"keyselect\", { e: e, row: _this.get(\"activeRow\") });\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.END) {\n                            if (!_this.get(\"selectable\")) {\n                                _this._vbar.set(\"value\", _this._vbar.get(\"total\"));\n                                _this.drawContent();\n                            }\n                            else {\n                                var data = _this.get(\"data\");\n                                _this._set(\"activeRow\", data.length() - 1);\n                                _this.scrollTo(_this.get(\"activeRow\"));\n                                _this.fire(\"keyselect\", { e: e, row: _this.get(\"activeRow\") });\n                            }\n                        }\n                        else if (k === tui.browser.KeyCode.ENTER) {\n                            if (_this.get(\"selectable\")) {\n                                if (_this.get(\"activeRow\") != null) {\n                                    _this.fire(\"rowclick\", { e: e, row: _this.get(\"activeRow\"), col: _this.get(\"activeColumn\") });\n                                }\n                            }\n                        }\n                        e.preventDefault();\n                        e.stopPropagation();\n                    }\n                });\n                $(head).click(function (ev) {\n                    var obj = (ev.target || ev.srcElement);\n                    var columns = _this.get(\"columns\");\n                    while (obj) {\n                        if (obj.parentNode === head) {\n                            var col = obj.col;\n                            if (columns[col].sortable) {\n                                var sortType = \"asc\";\n                                if (_this.get(\"sortColumn\") == col) {\n                                    if (_this.get(\"sortType\") === \"asc\")\n                                        sortType = \"desc\";\n                                    else {\n                                        sortType = null;\n                                        col = null;\n                                    }\n                                }\n                                if (_this.fire(\"sort\", { e: ev, column: col === null ? null : columns[col], type: sortType }))\n                                    _this.setSortFlag(col, sortType);\n                                _this.drawHeader();\n                            }\n                            return;\n                        }\n                        else\n                            obj = obj.parentNode;\n                    }\n                });\n            };\n            Grid.prototype.setSortFlag = function (col, type) {\n                this._set(\"sortColumn\", col);\n                this._set(\"sortType\", type);\n                var columns = this.get(\"columns\");\n                var column = columns[col];\n                var ds = this.get(\"data\");\n                if (col === null || type === null)\n                    ds.setOrder(null);\n                else {\n                    ds.setOrder([\n                        {\n                            key: column.key,\n                            desc: (type === \"desc\")\n                        }\n                    ]);\n                }\n            };\n            Grid.prototype.scrollTo = function (index) {\n                if (typeof index !== \"number\" || isNaN(index) || index < 0 || index >= this.get(\"data\").length())\n                    return;\n                var v = this._vbar.get(\"value\");\n                var lineHeight = this.get(\"lineHeight\");\n                if (v > index * lineHeight) {\n                    this._vbar.set(\"value\", index * lineHeight);\n                    this.drawContent();\n                }\n                else {\n                    var h = (index - this._dispLines + 1) * lineHeight;\n                    var diff = (this._.clientHeight - this.getComponent(\"head\").offsetHeight\n                        - this._hbar._.offsetHeight - this._dispLines * lineHeight);\n                    if (v < h - diff) {\n                        this._vbar.set(\"value\", h - diff);\n                        this.drawContent();\n                    }\n                }\n            };\n            Grid.prototype.iterate = function (func) {\n                var data = this.get(\"data\");\n                var dataType = this.get(\"dataType\");\n                function iterateItem(treeItem, path) {\n                    if (func(treeItem, path, true) === false)\n                        return false;\n                    var children = treeItem[childrenKey];\n                    if (children) {\n                        for (var i = 0; i < children.length; i++) {\n                            if (iterateItem(children[i], path.concat(i)) === false)\n                                return false;\n                        }\n                    }\n                }\n                if (dataType === \"tree\" && data._finalData == null) {\n                    var tree = data;\n                    var childrenKey = tree.getConfig().children;\n                    var rawData = tree.getRawData();\n                    if (!rawData)\n                        return;\n                    for (var i = 0; i < rawData.length; i++) {\n                        if (iterateItem(rawData[i], [i]) === false)\n                            break;\n                    }\n                }\n                else {\n                    var list = data;\n                    for (var i = 0; i < list.length(); i++) {\n                        var listItem = dataType === \"tree\" ? list.get(i).item : list.get(i);\n                        if (func(listItem, [i], dataType === \"tree\") === false)\n                            break;\n                    }\n                }\n            };\n            /**\n             * Search a row by condition, get field value by 'dataKey' and compare to value, if match then active it.\n             * Should only used in local data type, e.g. List or Tree, if used in RemoteList or RemoteTree may not work correctly.\n             */\n            Grid.prototype.activeTo = function (dataKey, value) {\n                var data = this.get(\"data\");\n                var dataType = this.get(\"dataType\");\n                var path = [];\n                var childrenKey;\n                // If is a subset return 1, if equals return 2, otherwise return 0\n                function matchPath(p1, p2) {\n                    for (var i = 0; i < p1.length; i++) {\n                        if (i >= p2.length)\n                            return 0;\n                        else if (p1[i] !== p2[i])\n                            return 0;\n                    }\n                    return p1.length === p2.length ? 2 : 1;\n                }\n                if (dataType === \"tree\" && data._finalData == null) {\n                    var tree = data;\n                    this.iterate(function (item, p, treeNode) {\n                        if (item[dataKey] === value) {\n                            path = p;\n                            return false;\n                        }\n                    });\n                    if (path && path.length > 0) {\n                        var searchPath = [];\n                        var searchLevel = -1;\n                        var found = false;\n                        for (var i = 0; i < tree.length(); i++) {\n                            var node = tree.get(i);\n                            if (node.level === searchLevel) {\n                                searchPath[searchLevel]++;\n                            }\n                            else if (node.level < searchLevel) {\n                                for (var j = node.level; j < searchLevel; j++)\n                                    searchPath.pop();\n                                searchLevel = node.level;\n                                searchPath[searchLevel]++;\n                            }\n                            else {\n                                searchPath.push(0);\n                                searchLevel++;\n                            }\n                            var state = matchPath(searchPath, path);\n                            if (state === 2) {\n                                found = true;\n                                break;\n                            }\n                            else if (state === 1) {\n                                tree.expand(i);\n                            }\n                        }\n                        if (found) {\n                            this._set(\"activeRow\", i);\n                            this.computeScroll();\n                            this.scrollTo(i);\n                        }\n                    }\n                }\n                else if (dataType === \"tree\" && data._finalData) {\n                    var list = data;\n                    for (var i_1 = 0; i_1 < list.length(); i_1++) {\n                        if (list.get(i_1).item[dataKey] === value) {\n                            this._set(\"activeRow\", i_1);\n                            this.scrollTo(i_1);\n                            break;\n                        }\n                    }\n                }\n                else {\n                    var list = data;\n                    for (var i_2 = 0; i_2 < list.length(); i_2++) {\n                        if (list.get(i_2)[dataKey] === value) {\n                            this._set(\"activeRow\", i_2);\n                            this.scrollTo(i_2);\n                            break;\n                        }\n                    }\n                }\n            };\n            Grid.prototype.computeWidth = function () {\n                if (this.get(\"autoWidth\")) {\n                    return this._.clientWidth;\n                }\n                else {\n                    var contentWidth = 0;\n                    for (var i = 0; i < this._columnWidths.length; i++) {\n                        contentWidth += this._columnWidths[i] + Grid.CELL_SPACE * 2;\n                    }\n                    return contentWidth;\n                }\n            };\n            Grid.prototype.computeScroll = function () {\n                var _this = this;\n                var vScroll = this._vbar;\n                $(vScroll._).addClass(\"tui-hidden\");\n                var vEnable = false;\n                var hScroll = this._hbar;\n                $(hScroll._).addClass(\"tui-hidden\");\n                var hEnable = false;\n                var clientWidth = this._.clientWidth;\n                var clientHeight = this._.clientHeight;\n                var data = this.get(\"data\");\n                var lineHeight = this.get(\"lineHeight\");\n                this._contentHeight = (data.length() + (this.get(\"header\") ? 1 : 0)) * lineHeight;\n                this._contentWidth = this.computeWidth();\n                var head = this._components[\"head\"];\n                var content = this._components[\"content\"];\n                var computeV = function (first) {\n                    var realClientHeight = clientHeight - (hEnable ? hScroll._.offsetHeight : 0);\n                    var shouldEnable = (_this.get(\"autoHeight\") ? false : _this._contentHeight > realClientHeight);\n                    if (shouldEnable) {\n                        $(vScroll._).removeClass(\"tui-hidden\");\n                        vScroll._.style.height = realClientHeight + \"px\";\n                        vScroll._set(\"total\", _this._contentHeight - realClientHeight);\n                        if (_this._contentHeight > 0) {\n                            vScroll.set(\"page\", realClientHeight / _this._contentHeight * (_this._contentHeight - realClientHeight));\n                        }\n                        else\n                            vScroll.set(\"page\", 1);\n                    }\n                    else if (_this.get(\"autoHeight\")) {\n                        vScroll._set(\"value\", 0);\n                        vScroll._set(\"total\", 0);\n                        content.style.height = _this._contentHeight + \"px\";\n                        if (hEnable) {\n                            _this._.style.height = _this._contentHeight + hScroll._.offsetHeight + \"px\";\n                        }\n                        else {\n                            _this._.style.height = _this._contentHeight + \"px\";\n                        }\n                        clientHeight = _this._.clientHeight;\n                    }\n                    else {\n                        vScroll._set(\"value\", 0);\n                        vScroll._set(\"total\", 0);\n                    }\n                    if (vEnable !== shouldEnable) {\n                        vEnable = shouldEnable;\n                        if (!first)\n                            computeH();\n                    }\n                };\n                var computeH = function () {\n                    var realClientWidth = clientWidth - (vEnable ? vScroll._.offsetWidth : 0);\n                    var shouldEnable = (_this.get(\"autoWidth\") ? false : _this._contentWidth > realClientWidth);\n                    if (shouldEnable) {\n                        $(hScroll._).removeClass(\"tui-hidden\");\n                        hScroll._.style.width = realClientWidth + \"px\";\n                        hScroll._set(\"total\", _this._contentWidth - realClientWidth);\n                        if (_this._contentWidth > 0)\n                            hScroll.set(\"page\", realClientWidth / _this._contentWidth * (_this._contentWidth - realClientWidth));\n                        else\n                            hScroll.set(\"page\", 1);\n                    }\n                    else {\n                        hScroll._set(\"total\", 0);\n                        hScroll.set(\"value\", 0);\n                    }\n                    if (hEnable !== shouldEnable) {\n                        hEnable = shouldEnable;\n                        computeV(false);\n                    }\n                };\n                computeV(true);\n                computeH();\n                if (this.get(\"header\")) {\n                    head.style.display = \"block\";\n                    var width = (vEnable ? clientWidth - vScroll._.offsetWidth : clientWidth);\n                    width = (width >= 0 ? width : 0);\n                    head.style.width = width + \"px\";\n                }\n                else {\n                    head.style.display = \"none\";\n                }\n                var width = (vEnable ? clientWidth - vScroll._.offsetWidth : clientWidth);\n                width = (width >= 0 ? width : 0);\n                content.style.width = width + \"px\";\n                var dispHeight = (hEnable ? clientHeight - hScroll._.offsetHeight : clientHeight);\n                dispHeight = (dispHeight >= 0 ? dispHeight : 0);\n                content.style.height = dispHeight + \"px\";\n                this._dispLines = Math.ceil((dispHeight - (this.get(\"header\") ? lineHeight : 0)) / lineHeight);\n            };\n            Grid.prototype.drawLine = function (line, index, lineHeight, columns, lineData) {\n                var isTree = this.get(\"dataType\") === \"tree\";\n                var item = isTree ? lineData.item : lineData;\n                var tipKey = this.get(\"rowTooltipKey\");\n                if (item[tipKey]) {\n                    line.setAttribute(\"tooltip\", item[tipKey]);\n                }\n                line.style.height = lineHeight + \"px\";\n                line.style.lineHeight = lineHeight + \"px\";\n                if (line.childNodes.length != columns.length) {\n                    line.innerHTML = \"\";\n                    for (var i = 0; i < columns.length; i++) {\n                        var span = document.createElement(\"span\");\n                        span.className = \"tui-grid-\" + this._tuid + \"-\" + i;\n                        span.setAttribute(\"unselectable\", \"on\");\n                        span.col = i;\n                        line.appendChild(span);\n                    }\n                }\n                for (var i = 0; i < columns.length; i++) {\n                    var col = columns[i];\n                    var prefix = \"\";\n                    if (col.arrow === true && isTree) {\n                        for (var j = 0; j < lineData.level; j++) {\n                            prefix += \"<i class='tui-space'></i>\";\n                        }\n                        if (lineData.hasChild) {\n                            if (lineData.expand)\n                                prefix += \"<i class='tui-arrow-expand'></i>\";\n                            else\n                                prefix += \"<i class='tui-arrow-collapse'></i>\";\n                        }\n                        else {\n                            prefix += \"<i class='tui-arrow'></i>\";\n                        }\n                    }\n                    if (col.type === \"check\") {\n                        var k = (col.checkKey ? col.checkKey : \"checked\");\n                        if (item[k] === true)\n                            prefix += \"<i class='fa fa-check-square tui-grid-check'></i>\";\n                        else if (item[k] === false)\n                            prefix += \"<i class='fa fa-square-o tui-grid-check'></i>\";\n                        else\n                            prefix += \"<i class='tui-grid-no-check'></i>\";\n                    }\n                    else if (col.type === \"tristate\") {\n                        var k = (col.checkKey ? col.checkKey : \"checked\");\n                        if (item[k] === true)\n                            prefix += \"<i class='fa-check-square tui-grid-check'></i>\";\n                        else if (item[k] === false)\n                            prefix += \"<i class='fa-square-o tui-grid-check'></i>\";\n                        else if (item[k] === \"tristate\")\n                            prefix += \"<i class='fa-check-square tui-grid-check'></i>\";\n                        else\n                            prefix += \"<i class='tui-grid-no-check'></i>\";\n                    }\n                    else if (col.type === \"select\") {\n                        prefix += \"<i class='fa fa-caret-down tui-grid-select'></i>\";\n                    }\n                    else if (col.type === \"edit\") {\n                        prefix += \"<i class='fa fa-edit tui-grid-edit'></i>\";\n                    }\n                    if (col.iconKey && item[col.iconKey]) {\n                        prefix += \"<i class='fa \" + item[col.iconKey] + \" tui-grid-icon'></i>\";\n                    }\n                    var cell = line.childNodes[i];\n                    cell.style.height = lineHeight + \"px\";\n                    cell.style.lineHeight = lineHeight + \"px\";\n                    tui.browser.setInnerHtml(cell, prefix);\n                    var prefixContent = columns[i].prefixKey !== null ? item[columns[i].prefixKey] : null;\n                    if (prefixContent) {\n                        var prefixSpan = document.createElement(\"span\");\n                        tui.browser.setInnerHtml(prefixSpan, prefixContent);\n                        cell.appendChild(prefixSpan);\n                    }\n                    cell.appendChild(document.createTextNode(item[columns[i].key]));\n                    var suffixContent = columns[i].suffixKey !== null ? item[columns[i].suffixKey] : null;\n                    if (suffixContent) {\n                        var suffixSpan = document.createElement(\"span\");\n                        tui.browser.setInnerHtml(suffixSpan, suffixContent);\n                        cell.appendChild(suffixSpan);\n                    }\n                }\n            };\n            Grid.prototype.moveLine = function (line, index, base, lineHeight) {\n                line.style.top = (base + index * lineHeight) + \"px\";\n                line.style.width = this._contentWidth + \"px\";\n            };\n            Grid.prototype.createLine = function (parent) {\n                var columns = this.get(\"columns\");\n                var line = document.createElement(\"div\");\n                line.className = \"tui-grid-line\";\n                line.setAttribute(\"unselectable\", \"on\");\n                return parent.appendChild(line);\n            };\n            Grid.prototype.clearBuffer = function () {\n                if (!this._buffer) {\n                    return;\n                }\n                var content = this._components[\"content\"];\n                for (var i = 0; i < this._buffer.lines.length; i++) {\n                    content.removeChild(this._buffer.lines[i]);\n                }\n                this._buffer.begin = 0;\n                this._buffer.end = 0;\n                this._buffer.lines = [];\n            };\n            Grid.prototype.drawHeader = function () {\n                if (!this.get(\"header\"))\n                    return;\n                var head = this._components[\"head\"];\n                head.innerHTML = \"\";\n                var columns = this.get(\"columns\");\n                for (var i = 0; i < columns.length; i++) {\n                    var prefix = \"<i class='tui-grid-no-sort'></i>\";\n                    var sortClass = \"\";\n                    if (columns[i].sortable) {\n                        prefix = \"<i class='tui-grid-sortable'></i>\";\n                        if (this.get(\"sortColumn\") == i) {\n                            if (this.get(\"sortType\") === \"desc\") {\n                                prefix = \"<i class='tui-grid-desc'></i>\";\n                                sortClass = \"tui-desc\";\n                            }\n                            else {\n                                prefix = \"<i class='tui-grid-asc'></i>\";\n                                sortClass = \"tui-asc\";\n                            }\n                        }\n                        sortClass += \" tui-sortable\";\n                    }\n                    var span = document.createElement(\"span\");\n                    span.setAttribute(\"unselectable\", \"on\");\n                    span.className = \"tui-grid-\" + this._tuid + \"-\" + i + \" \" + sortClass;\n                    span.col = i;\n                    head.appendChild(span);\n                    tui.browser.setInnerHtml(span, prefix);\n                    span.appendChild(document.createTextNode(columns[i].name));\n                }\n            };\n            Grid.prototype.drawContent = function () {\n                var _this = this;\n                var vbar = widget.get(this._components[\"vScroll\"]);\n                var content = this._components[\"content\"];\n                var lineHeight = this.get(\"lineHeight\");\n                var base = (this.get(\"header\") ? lineHeight : 0) - vbar.get(\"value\") % lineHeight;\n                var begin = Math.floor(vbar.get(\"value\") / lineHeight);\n                var end = begin + this._dispLines + 1;\n                var data = this.get(\"data\");\n                var columns = this.get(\"columns\");\n                var length = data.length();\n                var newBuffer = [];\n                var reusable = [];\n                for (var i = this._buffer.begin; i < this._buffer.end; i++) {\n                    if (i < begin || i >= end || i >= length) {\n                        reusable.push(this._buffer.lines[i - this._buffer.begin]);\n                    }\n                }\n                for (var i = begin; i < end && i < length; i++) {\n                    var line;\n                    if (i >= this._buffer.begin && i < this._buffer.end) {\n                        line = this._buffer.lines[i - this._buffer.begin];\n                    }\n                    else {\n                        if (reusable.length > 0) {\n                            line = reusable.pop();\n                            line.innerHTML = \"\";\n                            line.removeAttribute(\"tooltip\");\n                        }\n                        else {\n                            line = this.createLine(content);\n                        }\n                        if (i === this.get(\"activeRow\")) {\n                            $(line).addClass(\"tui-actived\");\n                        }\n                        else {\n                            $(line).removeClass(\"tui-actived\");\n                        }\n                    }\n                    this.moveLine(line, i - begin, base, lineHeight);\n                    newBuffer.push(line);\n                }\n                clearTimeout(this._drawTimer);\n                this._drawTimer = setTimeout(function () {\n                    var begin = Math.floor(vbar.get(\"value\") / lineHeight);\n                    var end = begin + _this._dispLines + 1;\n                    for (var i = _this._buffer.begin; i < _this._buffer.end; i++) {\n                        if (i >= begin && i < end)\n                            _this.drawLine(_this._buffer.lines[i - _this._buffer.begin], i, _this.get(\"lineHeight\"), columns, data.get(i));\n                    }\n                }, 32);\n                for (var i = 0; i < reusable.length; i++) {\n                    content.removeChild(reusable[i]);\n                }\n                this._buffer.lines = newBuffer;\n                this._buffer.begin = begin;\n                this._buffer.end = this._buffer.begin + this._buffer.lines.length;\n            };\n            Grid.prototype.initColumnWidth = function () {\n                var columns = this.get(\"columns\");\n                for (var i = 0; i < columns.length; i++) {\n                    if (typeof this._columnWidths[i] !== \"number\" || isNaN(this._columnWidths[i])) {\n                        if (typeof columns[i].width === \"number\" && !isNaN(columns[i].width))\n                            this._columnWidths[i] = columns[i].width;\n                        else\n                            this._columnWidths[i] = 150;\n                    }\n                    if (this._columnWidths[i] < 0)\n                        this._columnWidths[i] = 0;\n                }\n            };\n            Grid.prototype.computeHOffset = function () {\n                //var widths: number[] = [];\n                var head = this._components[\"head\"];\n                var content = this._components[\"content\"];\n                var scrollLeft = this._hbar.get(\"value\");\n                var columns = this.get(\"columns\");\n                head.scrollLeft = scrollLeft;\n                content.scrollLeft = scrollLeft;\n                var used = 0;\n                for (var i = 0; i < columns.length; i++) {\n                    this._vLines[i].style.left = used + vval(columns[i].width) +\n                        (Grid.CELL_SPACE * 2) - scrollLeft + \"px\";\n                    used += vval(columns[i].width) + (Grid.CELL_SPACE * 2);\n                }\n                if (this.get(\"header\")) {\n                    used = 0;\n                    for (var i = 0; i < columns.length; i++) {\n                        this._handlers[i].style.left = used + vval(columns[i].width) +\n                            (Grid.CELL_SPACE) - this._hbar.get(\"value\") + \"px\";\n                        used += vval(columns[i].width) + (Grid.CELL_SPACE * 2);\n                    }\n                }\n            };\n            Grid.prototype.computeColumnWidth = function () {\n                //var widths: number[] = [];\n                var columns = this.get(\"columns\");\n                if (this.get(\"autoWidth\")) {\n                    var total = this._contentWidth;\n                    var totalNoBorder = total - (Grid.CELL_SPACE * 2) * columns.length;\n                    var totalNoFixed = totalNoBorder;\n                    var totalCompute = 0;\n                    // Exclude all fixed columns\n                    for (var i = 0; i < columns.length; i++) {\n                        if (columns[i].fixed) {\n                            totalNoFixed -= this._columnWidths[i];\n                        }\n                        else {\n                            totalCompute += this._columnWidths[i];\n                        }\n                    }\n                    for (var i = 0; i < columns.length; i++) {\n                        if (!columns[i].fixed) {\n                            if (totalCompute <= 0)\n                                this._columnWidths[i] = NaN;\n                            else\n                                this._columnWidths[i] = (this._columnWidths[i] * 1.0) / totalCompute * totalNoFixed;\n                        }\n                    }\n                }\n                for (var i = 0; i < this._columnWidths.length; i++) {\n                    var val = Math.round(this._columnWidths[i]);\n                    //widths.push(val);\n                    columns[i].width = val;\n                }\n                // Add V lines\n                for (var i = 0; i < this._vLines.length; i++) {\n                    if (this._vLines[i].parentNode)\n                        this._.removeChild(this._vLines[i]);\n                }\n                var used = 0;\n                for (var i = 0; i < columns.length; i++) {\n                    if (i >= this._vLines.length) {\n                        this._vLines[i] = document.createElement(\"div\");\n                        this._vLines[i].className = \"tui-grid-vline\";\n                    }\n                    this._vLines[i].style.left = used + vval(columns[i].width) + (Grid.CELL_SPACE * 2) - this._hbar.get(\"value\") + \"px\";\n                    used += vval(columns[i].width) + (Grid.CELL_SPACE * 2);\n                    this._vLines[i].style.height = Math.min(this._contentHeight, this._.clientHeight) + \"px\";\n                    this._.appendChild(this._vLines[i]);\n                }\n                // Add Handlers\n                for (var i = 0; i < this._handlers.length; i++) {\n                    if (this._handlers[i].parentNode)\n                        this._.removeChild(this._handlers[i]);\n                }\n                if (this.get(\"header\")) {\n                    used = 0;\n                    for (var i = 0; i < columns.length; i++) {\n                        if (i >= this._handlers.length) {\n                            this._handlers[i] = document.createElement(\"div\");\n                            this._handlers[i].className = \"tui-grid-handler\";\n                        }\n                        this._handlers[i].style.left = used + vval(columns[i].width) + (Grid.CELL_SPACE) - this._hbar.get(\"value\") + \"px\";\n                        used += vval(columns[i].width) + (Grid.CELL_SPACE * 2);\n                        this._.appendChild(this._handlers[i]);\n                    }\n                }\n                var cssText = \"\";\n                for (var i_3 = 0; i_3 < columns.length; i_3++) {\n                    cssText += (\".tui-grid-\" + this._tuid + \"-\" + i_3 + \"{width:\" + vval(columns[i_3].width) + \"px;}\");\n                }\n                if (document.createStyleSheet)\n                    this._gridStyle.cssText = cssText;\n                else\n                    this._gridStyle.innerHTML = cssText;\n                for (var i_4 = 0; i_4 < this._buffer.lines.length; i_4++) {\n                    var line = this._buffer.lines[i_4];\n                    line.style.width = this._contentWidth + \"px\";\n                }\n            };\n            Grid.prototype.render = function () {\n                this.initColumnWidth();\n                this.computeScroll();\n                this.computeColumnWidth();\n                this.drawHeader();\n                this.drawContent();\n                this.computeHOffset();\n            };\n            Grid.CELL_SPACE = 4;\n            Grid.LINE_HEIGHT = 31;\n            return Grid;\n        }(widget.Widget));\n        widget.Grid = Grid;\n        widget.register(Grid, \"grid\");\n        widget.registerResize(\"grid\");\n        /**\n         * <tui:list>\n         */\n        var List = (function (_super) {\n            __extends(List, _super);\n            function List() {\n                _super.apply(this, arguments);\n            }\n            List.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this._column = {\n                    name: \"\",\n                    key: \"name\",\n                    checkKey: \"check\",\n                    iconKey: \"icon\",\n                    prefixKey: \"prefix\",\n                    suffixKey: \"suffix\",\n                    arrow: true\n                };\n                this.setRestrictions({\n                    \"lineHeight\": {\n                        \"get\": function () {\n                            var val = _this._data[\"lineHeight\"];\n                            if (typeof val !== \"number\" || isNaN(val))\n                                return List.LINE_HEIGHT;\n                            else\n                                return val;\n                        }\n                    },\n                    \"columns\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            return [_this._column];\n                        }\n                    },\n                    \"checkKey\": {\n                        \"set\": function (value) {\n                            _this._column.checkKey = value;\n                            _this.clearBuffer();\n                        },\n                        \"get\": function () {\n                            return _this._column.checkKey;\n                        }\n                    },\n                    \"nameKey\": {\n                        \"set\": function (value) {\n                            _this._column.key = value;\n                            _this.clearBuffer();\n                        },\n                        \"get\": function () {\n                            return _this._column.key;\n                        }\n                    },\n                    \"iconKey\": {\n                        \"set\": function (value) {\n                            _this._column.iconKey = value;\n                            _this.clearBuffer();\n                        },\n                        \"get\": function () {\n                            return _this._column.iconKey;\n                        }\n                    },\n                    \"prefixKey\": {\n                        \"set\": function (value) {\n                            _this._column.prefixKey = value;\n                            _this.clearBuffer();\n                        },\n                        \"get\": function () {\n                            return _this._column.prefixKey;\n                        }\n                    },\n                    \"suffixKey\": {\n                        \"set\": function (value) {\n                            _this._column.suffixKey = value;\n                            _this.clearBuffer();\n                        },\n                        \"get\": function () {\n                            return _this._column.suffixKey;\n                        }\n                    },\n                    \"checkable\": {\n                        \"set\": function (value) {\n                            _this._column.type = value ? \"check\" : null;\n                            _this.clearBuffer();\n                        },\n                        \"get\": function () {\n                            return _this._column.type === \"check\";\n                        }\n                    },\n                    \"checkedValues\": {\n                        \"set\": function (value) {\n                            var valueKey = _this.get(\"valueKey\");\n                            var checkKey = _this.get(\"checkKey\");\n                            if (value === null)\n                                value = [];\n                            if (!(value instanceof Array))\n                                value = [value];\n                            _this.iterate(function (item, path, treeNode) {\n                                if (typeof item[checkKey] === \"boolean\") {\n                                    if (value.indexOf(item[valueKey]) >= 0)\n                                        item[checkKey] = true;\n                                    else\n                                        item[checkKey] = false;\n                                }\n                                return true;\n                            });\n                        },\n                        \"get\": function () {\n                            var value = [];\n                            var valueKey = _this.get(\"valueKey\");\n                            var checkKey = _this.get(\"checkKey\");\n                            _this.iterate(function (item, path) {\n                                if (item[checkKey] === true)\n                                    value.push(item[valueKey]);\n                                return true;\n                            });\n                            return value;\n                        }\n                    },\n                    \"checkedNames\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            var names = [];\n                            var nameKey = _this.get(\"nameKey\");\n                            var checkKey = _this.get(\"checkKey\");\n                            _this.iterate(function (item, path) {\n                                if (item[checkKey] === true)\n                                    names.push(item[nameKey]);\n                                return true;\n                            });\n                            return names;\n                        }\n                    }\n                });\n            };\n            List.prototype.init = function () {\n                _super.prototype.init.call(this);\n                this._set(\"header\", false);\n                this.setInit(\"autoWidth\", true);\n                this.setInit(\"valueKey\", \"value\");\n            };\n            List.prototype.selectAll = function () {\n                var checkKey = this.get(\"checkKey\");\n                this.iterate(function (item, path) {\n                    if (typeof item[checkKey] === \"boolean\") {\n                        item[checkKey] = true;\n                    }\n                    return true;\n                });\n                this.render();\n            };\n            List.prototype.deselectAll = function () {\n                var checkKey = this.get(\"checkKey\");\n                this.iterate(function (item, path) {\n                    if (typeof item[checkKey] === \"boolean\") {\n                        item[checkKey] = false;\n                    }\n                    return true;\n                });\n                this.render();\n            };\n            List.LINE_HEIGHT = 30;\n            return List;\n        }(Grid));\n        widget.List = List;\n        widget.register(List, \"list\");\n        widget.registerResize(\"list\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"inputBase.ts\" />\n/// <reference path=\"../browser/keyboard.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <input>\n         * Attributes: value, text, type, iconLeft, iconRight, autoValidate\n         * Events: input, change, left-icon-mousedown, right-icon-mousedown, left-icon-click, right-icon-click\n         */\n        var Input = (function (_super) {\n            __extends(Input, _super);\n            function Input() {\n                _super.apply(this, arguments);\n            }\n            Input.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                var textbox = this._components[\"textbox\"] = document.createElement(\"input\");\n                this.setRestrictions({\n                    \"value\": {\n                        \"set\": function (value) {\n                            textbox.value = value;\n                            _this._isEmpty = (textbox.value === \"\");\n                        },\n                        \"get\": function () {\n                            return textbox.value;\n                        }\n                    },\n                    \"text\": {\n                        \"set\": function (value) {\n                            _this._set(\"value\", value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"value\");\n                        }\n                    },\n                    \"type\": {\n                        \"set\": function (value) {\n                            value = value.toLowerCase();\n                            if ([\"text\", \"password\", \"email\", \"url\", \"number\"].indexOf(value) < 0)\n                                return;\n                            textbox.setAttribute(\"type\", value);\n                        },\n                        \"get\": function () {\n                            return textbox.getAttribute(\"type\");\n                        }\n                    }\n                });\n            };\n            Input.prototype.onInput = function (textbox, e) {\n                this.updateEmptyState(textbox.value === \"\");\n                this.reset();\n                this.fire(\"input\", e);\n            };\n            Input.prototype.init = function () {\n                var _this = this;\n                var $root = $(this._);\n                var placeholder = this._components[\"placeholder\"] = document.createElement(\"span\");\n                var textbox = this._components[\"textbox\"];\n                var iconLeft = this._components[\"iconLeft\"] = document.createElement(\"i\");\n                var iconRight = this._components[\"iconRight\"] = document.createElement(\"i\");\n                var iconInvalid = this._components[\"iconInvalid\"] = document.createElement(\"i\");\n                var clearButton = this._components[\"clearButton\"] = document.createElement(\"i\");\n                iconInvalid.className = \"tui-invalid-icon\";\n                clearButton.className = \"tui-input-clear-button\";\n                placeholder.className = \"tui-placeholder\";\n                placeholder.setAttribute(\"unselectable\", \"on\");\n                this._.appendChild(placeholder);\n                this._.appendChild(iconLeft);\n                this._.appendChild(textbox);\n                this._.appendChild(iconInvalid);\n                this._.appendChild(iconRight);\n                this._.appendChild(clearButton);\n                $(textbox).focus(function () {\n                    $root.addClass(\"tui-active\");\n                });\n                $(textbox).blur(function () {\n                    $root.removeClass(\"tui-active\");\n                    if (_this.get(\"disable\"))\n                        return;\n                    if (_this.get(\"autoValidate\")) {\n                        _this.validate();\n                    }\n                });\n                if (tui.ieVer > 0 && tui.ieVer < 9) {\n                    $(textbox).on(\"propertychange\", function (e) {\n                        if (e.originalEvent.propertyName !== 'value')\n                            return;\n                        _this.onInput(textbox, e);\n                    });\n                }\n                else {\n                    if (tui.ieVer === 9) {\n                        $(textbox).on(\"keyup\", function (e) {\n                            if (e.keyCode = tui.browser.KeyCode.BACK)\n                                _this.onInput(textbox, e);\n                        });\n                    }\n                    $(textbox).on(\"input\", function (e) {\n                        _this.onInput(textbox, e);\n                    });\n                }\n                $(textbox).on(\"keydown\", function (e) {\n                    if (e.keyCode === tui.browser.KeyCode.ENTER) {\n                        _this.fire(\"enter\", e);\n                    }\n                });\n                $(textbox).on(\"change\", function (e) {\n                    _this.fire(\"change\", e);\n                });\n                $(clearButton).on(\"mousedown\", function (e) {\n                    _this.set(\"value\", \"\");\n                    _this.reset();\n                    _this.fire(\"change\", e);\n                    e.stopPropagation();\n                });\n                $root.mousedown(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    var obj = e.target || e.srcElement;\n                    if (obj === textbox) {\n                        return;\n                    }\n                    setTimeout(function () {\n                        textbox.focus();\n                        if (obj === iconLeft) {\n                            _this.fire(\"left-icon-mousedown\", e);\n                        }\n                        if (obj === iconRight) {\n                            _this.fire(\"right-icon-mousedown\", e);\n                        }\n                    }, 0);\n                });\n                $root.click(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    var obj = e.target || e.srcElement;\n                    if (obj === textbox) {\n                        return;\n                    }\n                    if (obj === iconLeft) {\n                        _this.fire(\"left-icon-click\", e);\n                    }\n                    if (obj === iconRight) {\n                        _this.fire(\"right-icon-click\", e);\n                    }\n                });\n                this.on(\"resize\", function () {\n                    _this.render();\n                });\n            };\n            Input.prototype.focus = function () {\n                var textbox = this._components[\"textbox\"];\n                textbox.focus();\n            };\n            Input.prototype.render = function () {\n                this._.scrollLeft = 0;\n                var $root = $(this._);\n                var textbox = this._components[\"textbox\"];\n                var iconLeft = this._components[\"iconLeft\"];\n                var iconRight = this._components[\"iconRight\"];\n                var iconInvalid = this._components[\"iconInvalid\"];\n                var placeholder = this._components[\"placeholder\"];\n                var clearButton = this._components[\"clearButton\"];\n                if (this.get(\"disable\")) {\n                    $root.addClass(\"tui-disable\");\n                    textbox.setAttribute(\"readonly\", \"readonly\");\n                }\n                else {\n                    $root.removeClass(\"tui-disable\");\n                    textbox.removeAttribute(\"readonly\");\n                }\n                var marginLeft = 0;\n                if (this.get(\"iconLeft\")) {\n                    iconLeft.className = this.get(\"iconLeft\");\n                    iconLeft.style.display = \"\";\n                    iconLeft.style.left = \"0\";\n                }\n                else {\n                    iconLeft.className = \"\";\n                    iconLeft.style.display = \"none\";\n                    marginLeft = Input.PADDING;\n                }\n                var marginRight = 0;\n                if (this.get(\"iconRight\")) {\n                    iconRight.className = this.get(\"iconRight\");\n                    iconRight.style.display = \"\";\n                    iconRight.style.right = \"0\";\n                }\n                else {\n                    iconRight.className = \"\";\n                    iconRight.style.display = \"none\";\n                    marginRight = Input.PADDING;\n                }\n                if (!this._valid) {\n                    $root.addClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"\";\n                    iconInvalid.style.right = iconRight.offsetWidth + \"px\";\n                }\n                else {\n                    $root.removeClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"none\";\n                    if (marginRight === 0)\n                        marginRight = Input.PADDING;\n                }\n                if (this.get(\"clearable\") && this.get(\"value\").length > 0) {\n                    clearButton.style.display = \"\";\n                    clearButton.style.right = iconRight.offsetWidth + iconInvalid.offsetWidth + \"px\";\n                }\n                else {\n                    clearButton.style.display = \"none\";\n                }\n                textbox.style.left = iconLeft.offsetWidth + marginLeft + \"px\";\n                var width = this._.clientWidth -\n                    iconLeft.offsetWidth -\n                    iconInvalid.offsetWidth -\n                    iconRight.offsetWidth -\n                    clearButton.offsetWidth -\n                    marginLeft - marginRight;\n                if (width < 0)\n                    width = 0;\n                textbox.style.width = width + \"px\";\n                var phText = this.get(\"placeholder\");\n                var showPh = phText && !this.get(\"value\");\n                if (showPh) {\n                    $(placeholder).text(phText);\n                    placeholder.style.left = iconLeft.offsetWidth + marginLeft + \"px\";\n                    placeholder.style.width = textbox.style.width;\n                    placeholder.style.display = \"\";\n                }\n                else {\n                    placeholder.style.display = \"none\";\n                }\n                if (!this._valid && this._invalidMessage) {\n                    this._set(\"follow-tooltip\", this._invalidMessage);\n                }\n                else {\n                    this._set(\"follow-tooltip\", null);\n                }\n            };\n            Input.PADDING = 6;\n            return Input;\n        }(widget.InputBase));\n        widget.Input = Input;\n        widget.register(Input, \"input\");\n        widget.registerResize(\"input\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\n/// <reference path=\"../browser/keyboard.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        widget.popStack = [];\n        function findPopupToClose(bindElem) {\n            var index = 0;\n            if (bindElem && bindElem.nodeName) {\n                for (var i = 0; i < widget.popStack.length; i++) {\n                    var item = widget.popStack[i];\n                    if (tui.browser.isAncestry(bindElem, item._)) {\n                        index = i + 1;\n                        break;\n                    }\n                }\n            }\n            if (index < widget.popStack.length)\n                widget.popStack[index].close();\n        }\n        setInterval(function () {\n            findPopupToClose(document.activeElement);\n        }, 50);\n        // $(window).on(\"mousedown\", function(){\n        // \tpopStack[0] && popStack[0].close();\n        // });\n        /**\n         * <popup>\n         * Attributes: content, direction, referPos, referElement, opened\n         * Method: open(), close()\n         * Events: open, close\n         */\n        var Popup = (function (_super) {\n            __extends(Popup, _super);\n            function Popup() {\n                var _this = this;\n                _super.apply(this, arguments);\n                this.popIndex = null;\n                this.referRect = null;\n                this.checkInterval = null;\n                this.refProc = function () {\n                    _this.render();\n                };\n            }\n            Popup.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"content\": {\n                        \"set\": function (value) {\n                            _this._data[\"content\"] = value;\n                            if (typeof value === \"string\")\n                                _this._.innerHTML = value;\n                            else if (value && value.nodeName)\n                                _this._.appendChild(value);\n                        }\n                    }\n                });\n            };\n            Popup.prototype.initChildren = function (childNodes) {\n                if (childNodes.length > 0) {\n                    var div = document.createElement(\"div\");\n                    for (var _i = 0, childNodes_5 = childNodes; _i < childNodes_5.length; _i++) {\n                        var node = childNodes_5[_i];\n                        div.appendChild(node);\n                    }\n                    this._set(\"content\", div);\n                }\n            };\n            Popup.prototype.init = function () {\n                var _this = this;\n                var $root = $(this._);\n                $root.attr(\"tabIndex\", \"-1\");\n                $root.css(\"display\", \"none\");\n                var content = this.get(\"content\");\n                if (typeof content === \"string\")\n                    $root.html(content);\n                else if (content && content.nodeName)\n                    $root.append(content);\n                widget.init(this._);\n                tui.browser.removeNode(this._);\n                $root.keydown(function (e) {\n                    var c = e.keyCode;\n                    if (c === tui.browser.KeyCode.ESCAPE) {\n                        _this.close();\n                        if (_this.get(\"referElement\")) {\n                            _this.get(\"referElement\").focus();\n                        }\n                    }\n                });\n                $(this._).mousedown(function (e) {\n                    e.stopImmediatePropagation();\n                });\n            };\n            Popup.prototype.open = function (refer, direction) {\n                var _this = this;\n                if (this.get(\"opened\"))\n                    return;\n                if (typeof refer === \"string\")\n                    refer = document.getElementById(refer);\n                if (typeof direction === tui.UNDEFINED)\n                    direction = \"Lb\";\n                if (typeof direction !== \"string\" || !/^[lLrR][tTbB]$/.test(direction)) {\n                    throw new SyntaxError(\"Invalid popup direction value\");\n                }\n                if (typeof refer === \"object\" && refer.nodeName) {\n                    this._set(\"referElement\", refer);\n                    findPopupToClose(refer);\n                    this.referRect = tui.browser.getRectOfScreen(refer);\n                    this.checkInterval = setInterval(function () {\n                        var newRect = tui.browser.getRectOfScreen(refer);\n                        if (newRect.left !== _this.referRect.left ||\n                            newRect.top !== _this.referRect.top ||\n                            newRect.width !== _this.referRect.width ||\n                            newRect.height !== _this.referRect.height) {\n                            _this.referRect = newRect;\n                            _this.render();\n                        }\n                    }, 16);\n                    $(window).on(\"resize scroll\", this.refProc);\n                }\n                else if (typeof refer === \"object\" && typeof refer.left === \"number\" && typeof refer.top === \"number\") {\n                    this._set(\"referPos\", refer);\n                    findPopupToClose();\n                }\n                else\n                    throw new SyntaxError(\"Invalid popup refer value, must be an element or position\");\n                this.popIndex = widget.popStack.push(this) - 1;\n                this._set(\"direction\", direction);\n                this._set(\"opened\", true);\n                $(this._).css({\n                    \"display\": \"block\",\n                    \"position\": \"fixed\"\n                });\n                this.appendTo(document.body); // Will cause refresh\n                widget.init(this._); // refresh children\n                this.render(); // refresh self again\n                this._.focus();\n                this.fire(\"open\");\n            };\n            Popup.prototype.closeSelf = function () {\n                tui.browser.removeNode(this._);\n                this._set(\"opened\", false);\n                if (this.checkInterval != null) {\n                    clearInterval(this.checkInterval);\n                    this.checkInterval = null;\n                }\n                $(window).off(\"resize scroll\", this.refProc);\n                this.fire(\"close\");\n            };\n            Popup.prototype.close = function () {\n                if (!this.get(\"opened\"))\n                    return;\n                for (var i = this.popIndex; i < widget.popStack.length; i++) {\n                    var item = widget.popStack[i];\n                    item.closeSelf();\n                }\n                widget.popStack.splice(this.popIndex, widget.popStack.length - this.popIndex + 1);\n            };\n            Popup.prototype.render = function () {\n                if (!this.get(\"opened\"))\n                    return;\n                var root = this._;\n                var ww = $(window).width();\n                var wh = $(window).height();\n                root.style.left = \"0px\";\n                root.style.top = \"0px\";\n                root.style.width = \"\";\n                //root.style.width = browser.getCurrentStyle(root).width;\n                var ew = root.offsetWidth;\n                var eh = root.offsetHeight;\n                var box = { left: 0, top: 0, width: 0, height: 0 };\n                var pos = { left: 0, top: 0 };\n                if (this.get(\"referPos\")) {\n                    box = this.get(\"referPos\");\n                    box.width = 0;\n                    box.height = 0;\n                }\n                else if (this.get(\"referElement\")) {\n                    box = tui.browser.getRectOfScreen(this.get(\"referElement\"));\n                }\n                // lower case letter means 'next to', upper case letter means 'align to'\n                var compute = {\n                    \"l\": function () {\n                        pos.left = box.left - ew;\n                        if (pos.left < 2)\n                            pos.left = box.left + box.width;\n                    },\n                    \"r\": function () {\n                        pos.left = box.left + box.width;\n                        if (pos.left + ew > ww - 2)\n                            pos.left = box.left - ew;\n                    },\n                    \"t\": function () {\n                        pos.top = box.top - eh;\n                        if (pos.top < 2)\n                            pos.top = box.top + box.height;\n                    },\n                    \"b\": function () {\n                        pos.top = box.top + box.height;\n                        if (pos.top + eh > wh - 2)\n                            pos.top = box.top - eh;\n                    },\n                    \"L\": function () {\n                        pos.left = box.left;\n                        if (pos.left + ew > ww - 2)\n                            pos.left = box.left + box.width - ew;\n                    },\n                    \"R\": function () {\n                        pos.left = box.left + box.width - ew;\n                        if (pos.left < 2)\n                            pos.left = box.left;\n                    },\n                    \"T\": function () {\n                        pos.top = box.top;\n                        if (pos.top + eh > wh - 2)\n                            pos.top = box.top + box.height - eh;\n                    },\n                    \"B\": function () {\n                        pos.top = box.top + box.height - eh;\n                        if (pos.top < 2)\n                            pos.top = box.top;\n                    }\n                };\n                var direction = this.get(\"direction\");\n                compute[direction.substring(0, 1)](); // parse left\n                compute[direction.substring(1, 2)](); // parse top\n                if (pos.left > ww - 2)\n                    pos.left = ww - 2;\n                if (pos.left < 2)\n                    pos.left = 2;\n                if (pos.top > wh - 2)\n                    pos.top = wh - 2;\n                if (pos.top < 2)\n                    pos.top = 2;\n                root.style.left = pos.left + \"px\";\n                root.style.top = pos.top + \"px\";\n            };\n            return Popup;\n        }(widget.Widget));\n        widget.Popup = Popup;\n        widget.register(Popup, \"popup\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"popup.ts\" />\n/// <reference path=\"../browser/keyboard.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <menu>\n         * Attributes: content, direction, referPos, referElement, opened\n         * Method: open(), close()\n         * Events: open, close, click\n         */\n        var Menu = (function (_super) {\n            __extends(Menu, _super);\n            function Menu() {\n                _super.apply(this, arguments);\n                this.activeItem = null;\n            }\n            Menu.prototype.initChildren = function (childNodes) {\n                var data = [];\n                function hasChildItem(node) {\n                    for (var i = 0; i < node.childNodes.length; i++) {\n                        var child = node.childNodes[i];\n                        if (widget.getFullName(child) === \"tui:item\")\n                            return true;\n                    }\n                    return false;\n                }\n                function addChild(node, items) {\n                    var item = new widget.Item(node);\n                    var text = item.get(\"text\");\n                    if (text === null)\n                        text = $.trim(tui.browser.getNodeOwnText(node));\n                    var menuItem = {\n                        \"text\": text\n                    };\n                    var type = item.get(\"type\");\n                    if (type && /^(button|check|radio|menu|line)$/.test(type))\n                        menuItem.type = type;\n                    if (hasChildItem(node) && (typeof menuItem.type === tui.UNDEFINED || menuItem.type === null))\n                        menuItem.type = \"menu\";\n                    var icon = item.get(\"icon\");\n                    if (typeof icon === \"string\" && icon.trim().length > 0)\n                        menuItem.icon = icon;\n                    var shortcut = item.get(\"shortcut\");\n                    if (typeof shortcut === \"string\" && shortcut.trim().length > 0)\n                        menuItem.shortcut = shortcut;\n                    var checked = item.get(\"checked\");\n                    if (typeof checked === \"boolean\")\n                        menuItem.checked = checked;\n                    var disable = item.get(\"disable\");\n                    if (typeof disable === \"boolean\")\n                        menuItem.disable = disable;\n                    if (menuItem.type === \"radio\") {\n                        var group = item.get(\"group\");\n                        if (typeof group === \"string\" && group.length > 0)\n                            menuItem.group = group;\n                        else\n                            menuItem.group = \"\";\n                    }\n                    var value = item.get(\"value\");\n                    if (value !== null && typeof value !== tui.UNDEFINED)\n                        menuItem.value = value;\n                    if (menuItem.type === \"menu\") {\n                        menuItem.children = [];\n                        addChildren(node.childNodes, menuItem.children);\n                    }\n                    items.push(menuItem);\n                }\n                function addChildren(childNodes, items) {\n                    for (var i = 0; i < childNodes.length; i++) {\n                        var node = childNodes[i];\n                        if (widget.getFullName(node) === \"tui:item\") {\n                            addChild(node, items);\n                        }\n                    }\n                }\n                addChildren(childNodes, data);\n                if (data.length > 0)\n                    this._set(\"items\", data);\n            };\n            Menu.prototype.open = function (refer, direction) {\n                var data = this.get(\"items\");\n                if (data == null)\n                    data = [];\n                this._.innerHTML = \"\";\n                for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n                    var item = data_1[_i];\n                    var div = void 0;\n                    if (item.type !== \"line\") {\n                        div = tui.browser.toElement(\"<div tabIndex='-1' unselectable='on'><span class='tui-icon'></span>\" +\n                            \"<span class='tui-arrow'></span><span class='tui-label'></span><span class='tui-shortcut'></span></div>\");\n                        if (item.disable) {\n                            $(div).addClass(\"tui-disabled\");\n                        }\n                        if (item.type === \"check\" || item.type === \"radio\") {\n                            if (item.checked) {\n                                $(div).children(\".tui-icon\").addClass(\"fa-check\");\n                            }\n                        }\n                        else if (item.icon) {\n                            $(div).children(\".tui-icon\").addClass(item.icon);\n                        }\n                        $(div).children(\".tui-label\").text(item.text);\n                        if (typeof item.shortcut === \"string\")\n                            $(div).children(\".tui-shortcut\").text(item.shortcut);\n                        if (item.type === \"menu\")\n                            $(div).children(\".tui-arrow\").addClass(\"fa-caret-right\");\n                        if (item.disable)\n                            $(div).addClass(\"tui-disabled\");\n                    }\n                    else\n                        div = tui.browser.toElement(\"<div class='tui-line'></div>\");\n                    this._.appendChild(div);\n                }\n                _super.prototype.open.call(this, refer, direction);\n                if (this.activeItem != null) {\n                    $(this._).children(\"div\").removeClass(\"tui-active\");\n                    this.activeItem = null;\n                }\n            };\n            Menu.prototype.init = function () {\n                var _this = this;\n                var $root = $(this._);\n                $root.attr(\"tabIndex\", \"-1\");\n                $root.css(\"display\", \"none\");\n                tui.browser.removeNode(this._);\n                $(this._).mousedown(function (e) {\n                    e.stopImmediatePropagation();\n                });\n                function findMenuItemDiv(elem) {\n                    var children = $root.children(\"div\");\n                    for (var i = 0; i < children.length; i++) {\n                        var div = children[i];\n                        if ((typeof elem === \"number\" && elem === i) ||\n                            (typeof elem === \"object\" && tui.browser.isAncestry(elem, div))) {\n                            return div;\n                        }\n                    }\n                    return null;\n                }\n                ;\n                function findDivIndex(elem) {\n                    var children = $root.children(\"div\");\n                    for (var i = 0; i < children.length; i++) {\n                        var div = children[i];\n                        if (div === elem) {\n                            return i;\n                        }\n                    }\n                    return null;\n                }\n                ;\n                var ie8hack = function (div, index) {\n                    if (tui.ieVer >= 7 && tui.ieVer < 9) {\n                        var data = _this.get(\"items\");\n                        var item = data[index];\n                        var icon = $(div).children(\".tui-icon\")[0];\n                        if (item.type === \"check\" || item.type === \"radio\") {\n                            if (item.checked) {\n                                $(icon).removeClass(\"fa-check\");\n                                setTimeout(function () {\n                                    $(icon).addClass(\"fa-check\");\n                                });\n                            }\n                        }\n                        else if (item.icon) {\n                            $(icon).removeClass(item.icon);\n                            setTimeout(function () {\n                                $(icon).addClass(item.icon);\n                            });\n                        }\n                        if (item.type === \"menu\") {\n                            var arrow = $(div).children(\".tui-arrow\")[0];\n                            $(arrow).removeClass(\"fa-caret-right\");\n                            setTimeout(function () {\n                                $(arrow).addClass(\"fa-caret-right\");\n                            });\n                        }\n                    }\n                };\n                function activeLine(index) {\n                    var div = findMenuItemDiv(index);\n                    $(div).addClass(\"tui-actived\");\n                    ie8hack(div, index);\n                }\n                ;\n                function deactiveLine(index) {\n                    var div = findMenuItemDiv(index);\n                    $(div).removeClass(\"tui-actived\");\n                    ie8hack(div, index);\n                }\n                ;\n                $root.mousemove(function (e) {\n                    var elem = e.target || e.srcElement;\n                    var div = findMenuItemDiv(elem);\n                    if (div !== null) {\n                        var found = findDivIndex(div);\n                        if (found !== _this.activeItem) {\n                            if (_this.activeItem !== null) {\n                                deactiveLine(_this.activeItem);\n                            }\n                            if ($(div).hasClass(\"tui-disabled\")) {\n                                clearTimeout(openSubMenuTimer);\n                                _this.activeItem = null;\n                                _this._.focus();\n                                return;\n                            }\n                            _this.activeItem = found;\n                            activeLine(_this.activeItem);\n                            if (!$(div).hasClass(\"tui-sub\")) {\n                                _this._.focus();\n                                openSubMenu();\n                            }\n                        }\n                    }\n                });\n                $root.on(\"touchstart\", function (e) {\n                    var elem = e.target || e.srcElement;\n                    var div = findMenuItemDiv(elem);\n                    if (div !== null) {\n                        var found = findDivIndex(div);\n                        if (found !== _this.activeItem) {\n                            if (_this.activeItem !== null) {\n                                deactiveLine(_this.activeItem);\n                            }\n                            if ($(div).hasClass(\"tui-disabled\")) {\n                                clearTimeout(openSubMenuTimer);\n                                _this.activeItem = null;\n                                _this._.focus();\n                                return;\n                            }\n                            _this.activeItem = found;\n                            activeLine(_this.activeItem);\n                            if (_this.activeItem !== null) {\n                                var data = _this.get(\"items\");\n                                var item = data[_this.activeItem];\n                                if (item.children && item.children.length > 0) {\n                                    _this._.focus();\n                                    openSubMenu();\n                                    e.preventDefault();\n                                }\n                            }\n                        }\n                    }\n                });\n                $root.mouseleave(function (e) {\n                    if (_this.activeItem != null) {\n                        deactiveLine(_this.activeItem);\n                        _this.activeItem = null;\n                    }\n                    clearTimeout(openSubMenuTimer);\n                });\n                $root.click(function (e) {\n                    if (_this.activeItem != null) {\n                        var data = _this.get(\"items\");\n                        var item = data[_this.activeItem];\n                        if (item.type === \"check\") {\n                            item.checked = !item.checked;\n                        }\n                        else if (item.type === \"radio\") {\n                            if (typeof item.group === \"string\") {\n                                for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\n                                    var it = data_2[_i];\n                                    if (it.type === \"radio\" && it.group == item.group) {\n                                        it.checked = false;\n                                    }\n                                }\n                            }\n                            item.checked = true;\n                        }\n                        if (!item.children || item.children.length == 0) {\n                            _this.fire(\"click\", { e: e, item: item });\n                            _this.close();\n                        }\n                    }\n                });\n                var findItem = function (from, step) {\n                    var data = _this.get(\"items\");\n                    for (var i = from; i < data.length && i >= 0; i = i + step) {\n                        if (data[i].type !== \"line\" && !data[i].disable)\n                            return i;\n                    }\n                    return null;\n                };\n                $root.keydown(function (e) {\n                    var c = e.keyCode;\n                    var data = _this.get(\"items\");\n                    function stopEvent() {\n                        e.stopPropagation();\n                        e.preventDefault();\n                    }\n                    if (c === tui.browser.KeyCode.ESCAPE) {\n                        stopEvent();\n                        _this.close();\n                        if (_this.get(\"referElement\")) {\n                            _this.get(\"referElement\").focus();\n                        }\n                    }\n                    else if (c === tui.browser.KeyCode.LEFT) {\n                        stopEvent();\n                        if (widget.popStack.length < 2 || !(widget.popStack[widget.popStack.length - 2] instanceof Menu))\n                            return;\n                        widget.popStack[widget.popStack.length - 2]._.focus();\n                    }\n                    if (data.length === 0) {\n                        _this.activeItem = null;\n                        return;\n                    }\n                    if (c === tui.browser.KeyCode.DOWN || c === tui.browser.KeyCode.TAB) {\n                        stopEvent();\n                        if (_this.activeItem === null) {\n                            _this.activeItem = findItem(0, 1);\n                        }\n                        else {\n                            deactiveLine(_this.activeItem);\n                            _this.activeItem = findItem(_this.activeItem + 1, 1);\n                            if (_this.activeItem === null)\n                                _this.activeItem = 0;\n                        }\n                        activeLine(_this.activeItem);\n                    }\n                    else if (c === tui.browser.KeyCode.UP) {\n                        stopEvent();\n                        if (_this.activeItem === null) {\n                            _this.activeItem = findItem(data.length - 1, -1);\n                        }\n                        else {\n                            deactiveLine(_this.activeItem);\n                            _this.activeItem = findItem(_this.activeItem - 1, -1);\n                            if (_this.activeItem === null)\n                                _this.activeItem = data.length - 1;\n                        }\n                        activeLine(_this.activeItem);\n                    }\n                    else if (c === tui.browser.KeyCode.RIGHT) {\n                        stopEvent();\n                        openSubMenu();\n                    }\n                    else if (c === tui.browser.KeyCode.ENTER) {\n                        stopEvent();\n                        if (_this.activeItem !== null) {\n                            var item = data[_this.activeItem];\n                            _this.fire(\"click\", { e: e, item: item });\n                            _this.close();\n                        }\n                    }\n                });\n                var openSubMenuTimer = null;\n                var openSubMenu = function () {\n                    var data = _this.get(\"items\");\n                    if (_this.activeItem !== null) {\n                        clearTimeout(openSubMenuTimer);\n                        var item = data[_this.activeItem];\n                        if (item.type !== \"menu\")\n                            return;\n                        var div_1 = findMenuItemDiv(_this.activeItem);\n                        if ($(div_1).hasClass(\"tui-sub\"))\n                            return;\n                        var itemIndex_1 = _this.activeItem;\n                        openSubMenuTimer = setTimeout(function () {\n                            var childItems = item.children;\n                            var subMenu = widget.create(\"menu\", { \"items\": childItems });\n                            if ($(_this._).hasClass(\"tui-big\"))\n                                $(subMenu._).addClass(\"tui-big\");\n                            $(div_1).addClass(\"tui-sub\");\n                            ie8hack(div_1, itemIndex_1);\n                            subMenu.open(div_1, \"rT\");\n                            subMenu.on(\"close\", function () {\n                                $(div_1).removeClass(\"tui-sub\");\n                                ie8hack(div_1, itemIndex_1);\n                            });\n                            subMenu.on(\"click\", function (e) {\n                                _this.fire(\"click\", e.data);\n                                _this.close();\n                            });\n                        }, 200);\n                    }\n                };\n            };\n            return Menu;\n        }(widget.Popup));\n        widget.Menu = Menu;\n        widget.register(Menu, \"menu\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var Navigator = (function (_super) {\n            __extends(Navigator, _super);\n            function Navigator() {\n                _super.apply(this, arguments);\n            }\n            Navigator.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"items\": {\n                        \"get\": function () {\n                            var items = _this._data[\"items\"];\n                            return items ? items : [];\n                        }\n                    },\n                    \"activeItem\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            if (_this._activeItem != null) {\n                                return _this._activeItem.item;\n                            }\n                        }\n                    }\n                });\n            };\n            Navigator.prototype.initChildren = function (childNodes) {\n                var data = [];\n                function addChild(node, items) {\n                    var item = new widget.Item(node);\n                    var text = item.get(\"text\");\n                    if (text === null)\n                        text = $.trim(tui.browser.getNodeOwnText(node));\n                    var naviItem = {\n                        \"text\": text\n                    };\n                    naviItem.name = item.get(\"name\");\n                    naviItem.path = item.get(\"path\");\n                    naviItem.icon = item.get(\"icon\");\n                    naviItem.expand = item.get(\"expand\");\n                    var children = [];\n                    addChildren(node.childNodes, children);\n                    if (children.length > 0)\n                        naviItem.children = children;\n                    items.push(naviItem);\n                }\n                function addChildren(childNodes, data) {\n                    for (var i = 0; i < childNodes.length; i++) {\n                        var node = childNodes[i];\n                        if (widget.getFullName(node) === \"tui:item\") {\n                            addChild(node, data);\n                        }\n                    }\n                }\n                addChildren(childNodes, data);\n                if (data.length > 0)\n                    this._set(\"items\", data);\n            };\n            Navigator.prototype.checkScroll = function () {\n                var container = this._components[\"container\"];\n                var up = this._components[\"up\"];\n                var down = this._components[\"down\"];\n                if (container.scrollTop == 0) {\n                    up.style.display = \"none\";\n                }\n                else {\n                    up.style.display = \"block\";\n                }\n                if (container.scrollTop == container.scrollHeight - container.clientHeight) {\n                    down.style.display = \"none\";\n                }\n                else {\n                    down.style.display = \"block\";\n                }\n            };\n            Navigator.prototype.init = function () {\n                var _this = this;\n                var container = this._components[\"container\"] = document.createElement(\"div\");\n                var up = this._components[\"up\"] = document.createElement(\"div\");\n                var down = this._components[\"down\"] = document.createElement(\"div\");\n                container.className = \"tui-container\";\n                up.className = \"tui-up\";\n                down.className = \"tui-down\";\n                this._.appendChild(container);\n                this._.appendChild(up);\n                this._.appendChild(down);\n                var mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\n                $(this._).on(mousewheelevt, function (ev) {\n                    var e = ev.originalEvent;\n                    var delta = e.detail ? e.detail * (-1) : e.wheelDelta;\n                    if (delta <= 0) {\n                        if (container.scrollTop + container.clientHeight >= container.scrollHeight) {\n                            ev.preventDefault();\n                        }\n                    }\n                    else {\n                        if (container.scrollTop <= 0) {\n                            ev.preventDefault();\n                        }\n                    }\n                    ev.stopPropagation();\n                    ev.stopImmediatePropagation();\n                });\n                this.on(\"resize\", function () {\n                    var scrollbarWidth = container.offsetWidth - container.clientWidth;\n                    container.style.width = _this._.offsetWidth + scrollbarWidth + \"px\";\n                    _this.checkScroll();\n                });\n                container.onscroll = function (e) {\n                    _this.checkScroll();\n                };\n                function findLine(elem) {\n                    if (!elem)\n                        return null;\n                    if ($(elem).hasClass(\"tui-line\"))\n                        return elem;\n                    else\n                        return findLine(elem.parentElement);\n                }\n                $(container).on(\"click keydown\", function (e) {\n                    var elem = e.target || e.srcElement;\n                    elem = findLine(elem);\n                    if (e.type === \"keydown\" && e.keyCode != tui.browser.KeyCode.ENTER)\n                        return;\n                    if (elem) {\n                        var $elem = $(elem);\n                        if ($elem.hasClass(\"tui-expand\")) {\n                            _this.collapse(elem);\n                        }\n                        else if ($elem.hasClass(\"tui-collapse\")) {\n                            _this.expand(elem);\n                        }\n                        else {\n                            _this.active(elem);\n                            if (_this.fire(\"select\", elem.item) === false)\n                                return;\n                            if (_this.get(\"openPath\")) {\n                                var item = elem.item;\n                                if (item && item.path) {\n                                    window.location.href = item.path;\n                                }\n                            }\n                        }\n                    }\n                });\n            };\n            Navigator.prototype.collapse = function (elem) {\n                var _this = this;\n                var $elem = $(elem);\n                elem.item.expand = false;\n                if (!$elem.hasClass(\"tui-collapse\")) {\n                    $elem.removeClass(\"tui-expand\");\n                    $elem.addClass(\"tui-collapse\");\n                    $elem.next().animate({ height: \"toggle\" }, function () {\n                        _this.checkScroll();\n                    });\n                }\n            };\n            Navigator.prototype.expand = function (elem) {\n                var _this = this;\n                var $elem = $(elem);\n                elem.item.expand = true;\n                if (!$elem.hasClass(\"tui-expand\")) {\n                    $elem.removeClass(\"tui-collapse\");\n                    $elem.addClass(\"tui-expand\");\n                    $elem.next().animate({ height: \"toggle\" }, function () {\n                        _this.checkScroll();\n                    });\n                }\n            };\n            Navigator.prototype.active = function (elem) {\n                var container = this._components[\"container\"];\n                var rc = tui.browser.getRectOfParent(elem);\n                if (rc.top >= container.scrollTop && rc.top + rc.height <= container.scrollTop + container.clientHeight) {\n                }\n                else if (rc.top < container.scrollTop) {\n                    container.scrollTop = rc.top;\n                }\n                else if (rc.top + rc.height > container.scrollTop + container.clientHeight) {\n                    container.scrollTop = (rc.top + rc.height - container.clientHeight);\n                }\n                if (this._activeItem)\n                    $(this._activeItem).removeClass(\"tui-active\");\n                if (this.get(\"selectable\")) {\n                    $(elem).addClass(\"tui-active\");\n                    this._activeItem = elem;\n                }\n            };\n            Navigator.prototype.drawItems = function (parent, items, level) {\n                for (var _i = 0, items_3 = items; _i < items_3.length; _i++) {\n                    var item = items_3[_i];\n                    var line = document.createElement(\"div\");\n                    line.item = item;\n                    var $line = $(line);\n                    $line.attr(\"unselectable\", \"on\");\n                    $line.attr(\"tabIndex\", \"0\");\n                    $line.addClass(\"tui-line\");\n                    $line.text(item.text);\n                    if (level > 0)\n                        $line.addClass(\"tui-child\");\n                    if (item.icon) {\n                        var icon = document.createElement(\"i\");\n                        icon.className = item.icon;\n                        line.insertBefore(icon, line.firstChild);\n                    }\n                    if (item.path)\n                        line.setAttribute(\"path\", item.path);\n                    if (item.name)\n                        line.setAttribute(\"name\", item.name);\n                    var space = document.createElement(\"span\");\n                    space.style.display = \"inline-block\";\n                    space.style.width = 20 * level + \"px\";\n                    line.insertBefore(space, line.firstChild);\n                    parent.appendChild(line);\n                    if (item.children && item.children.length > 0) {\n                        var subArea = document.createElement(\"div\");\n                        subArea.className = \"tui-sub\";\n                        if (item.expand) {\n                            $line.addClass(\"tui-expand\");\n                            subArea.style.display = \"block\";\n                        }\n                        else {\n                            $line.addClass(\"tui-collapse\");\n                            subArea.style.display = \"none\";\n                        }\n                        this.drawItems(subArea, item.children, level + 1);\n                        parent.appendChild(subArea);\n                    }\n                }\n            };\n            Navigator.prototype._activeBy = function (parent, key, value) {\n                for (var i = 0; i < parent.children.length; i++) {\n                    var node = parent.children[i];\n                    if ($(node).hasClass(\"tui-line\")) {\n                        if (node.item[key] === value) {\n                            this.active(node);\n                            return true;\n                        }\n                    }\n                    else if ($(node).hasClass(\"tui-sub\")) {\n                        if (this._activeBy(node, key, value)) {\n                            this.expand($(node).prev()[0]);\n                            return true;\n                        }\n                    }\n                }\n                return false;\n            };\n            Navigator.prototype.activeBy = function (key, value) {\n                var container = this._components[\"container\"];\n                this._activeBy(container, key, value);\n            };\n            Navigator.prototype.render = function () {\n                var items = this.get(\"items\");\n                var container = this._components[\"container\"];\n                container.innerHTML = \"\";\n                this.drawItems(container, items, 0);\n                this.checkScroll();\n            };\n            return Navigator;\n        }(widget.Widget));\n        widget.Navigator = Navigator;\n        widget.register(Navigator, \"navigator\");\n        widget.registerResize(\"navigator\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"base.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var Scrollbar = (function (_super) {\n            __extends(Scrollbar, _super);\n            function Scrollbar() {\n                _super.apply(this, arguments);\n            }\n            Scrollbar.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"total\": {\n                        \"get\": function () {\n                            var value = _this._data[\"total\"];\n                            if (typeof value !== \"number\" || isNaN(value) || value < 0)\n                                return 0;\n                            else\n                                return value;\n                        },\n                        \"set\": function (value) {\n                            if (typeof value !== \"number\" || isNaN(value))\n                                value = 0;\n                            if (value < 0)\n                                value = 0;\n                            value = Math.round(value);\n                            _this._data[\"total\"] = value;\n                            if (_this.get(\"value\") > value)\n                                _this._set(\"value\", value);\n                            if (_this.get(\"page\") > value)\n                                _this._set(\"page\", value);\n                        }\n                    },\n                    \"page\": {\n                        \"get\": function () {\n                            var value = _this._data[\"page\"];\n                            if (typeof value !== \"number\" || isNaN(value) || value < 1)\n                                return 1;\n                            else\n                                return value;\n                        },\n                        \"set\": function (value) {\n                            if (typeof value !== \"number\" || isNaN(value))\n                                value = 1;\n                            value = Math.round(value);\n                            if (value < 1)\n                                value = 1;\n                            if (value > _this.get(\"total\"))\n                                value = _this.get(\"total\");\n                            _this._data[\"page\"] = value;\n                        }\n                    },\n                    \"value\": {\n                        \"get\": function () {\n                            var value = _this._data[\"value\"];\n                            if (typeof value !== \"number\" || isNaN(value) || value < 0)\n                                return 0;\n                            else\n                                return value;\n                        },\n                        \"set\": function (value) {\n                            if (typeof value !== \"number\" || isNaN(value))\n                                value = 0;\n                            value = Math.round(value);\n                            if (value < 0)\n                                value = 0;\n                            if (value > _this.get(\"total\"))\n                                value = _this.get(\"total\");\n                            _this._data[\"value\"] = value;\n                        }\n                    },\n                    \"direction\": {\n                        \"get\": function () {\n                            var dir = _this._data[\"direction\"];\n                            if (dir !== \"vertical\" && dir !== \"horizontal\")\n                                return \"vertical\";\n                            else\n                                return dir;\n                        },\n                        \"set\": function (value) {\n                            if (value !== \"vertical\" && value !== \"horizontal\")\n                                return;\n                            _this._data[\"direction\"] = value;\n                        }\n                    }\n                });\n            };\n            Scrollbar.prototype.init = function () {\n                var _this = this;\n                var root$ = $(this._);\n                this._.innerHTML = \"<span class='tui-scroll-thumb'></span>\";\n                var btnThumb = this._components[\"thumb\"] = root$.children(\".tui-scroll-thumb\")[0];\n                root$.attr(\"unselectable\", \"on\");\n                $(this._).mousedown(function (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    var obj = e.target || e.srcElement;\n                    if (obj !== _this._) {\n                        return;\n                    }\n                    if (_this.get(\"total\") <= 0)\n                        return;\n                    var dir = _this.get(\"direction\");\n                    var pos, thumbLen;\n                    if (dir === \"vertical\") {\n                        pos = (typeof e.offsetY === \"number\" ? e.offsetY : e[\"originalEvent\"].layerY);\n                        thumbLen = btnThumb.offsetHeight;\n                    }\n                    else {\n                        pos = (typeof e.offsetX === \"number\" ? e.offsetX : e[\"originalEvent\"].layerX);\n                        thumbLen = btnThumb.offsetWidth;\n                    }\n                    var v = _this.posToValue(pos - thumbLen / 2);\n                    _this.set(\"value\", v);\n                    _this.fire(\"scroll\", { e: e, value: _this.get(\"value\"), type: \"mousedown\" });\n                    return false;\n                });\n                var mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\n                $(this._).on(mousewheelevt, function (e) {\n                    var ev = e.originalEvent;\n                    var delta = ev.detail ? ev.detail * (-1) : ev.wheelDelta;\n                    var page = _this.get(\"page\");\n                    //delta returns +120 when wheel is scrolled up, -120 when scrolled down\n                    var scrollSize = (Math.round(page / 2) > 1 ? Math.round(page / 2) : 1);\n                    var oldValue = _this.get(\"value\");\n                    if (delta <= -0) {\n                        _this.set(\"value\", oldValue + scrollSize);\n                    }\n                    else {\n                        _this.set(\"value\", oldValue - scrollSize);\n                    }\n                    if (oldValue !== _this.get(\"value\"))\n                        _this.fire(\"scroll\", { e: e, value: _this.get(\"value\"), type: \"mousewheel\" });\n                    e.stopPropagation();\n                    e.preventDefault();\n                });\n                var beginX = 0, beginY = 0, beginLeft = 0, beginTop = 0;\n                var dragThumb = function (e) {\n                    var diff = 0;\n                    var oldValue = _this.get(\"value\");\n                    var pos;\n                    var positions = tui.browser.getEventPosition(e);\n                    if (_this.get(\"direction\") === \"vertical\") {\n                        diff = positions[0].y - beginY;\n                        pos = beginTop + diff;\n                    }\n                    else {\n                        diff = positions[0].x - beginX;\n                        pos = beginLeft + diff;\n                    }\n                    _this.set(\"value\", _this.posToValue(pos));\n                    if (oldValue !== _this.get(\"value\")) {\n                        _this.fire(\"scroll\", { e: e, value: _this.get(\"value\"), type: \"drag\" });\n                    }\n                };\n                var dragEnd = function (e) {\n                    $(_this._).removeClass(\"tui-actived\");\n                    _this.fire(\"dragend\", { e: e, value: _this.get(\"value\") });\n                };\n                $(btnThumb).on(\"mousedown touchstart\", function (e) {\n                    if (e.which !== 1 && e.type !== \"touchstart\")\n                        return;\n                    var positions = tui.browser.getEventPosition(e);\n                    if (positions.length > 1)\n                        return;\n                    e.preventDefault();\n                    beginX = positions[0].x;\n                    beginY = positions[0].y;\n                    beginLeft = btnThumb.offsetLeft;\n                    beginTop = btnThumb.offsetTop;\n                    $(_this._).addClass(\"tui-actived\");\n                    widget.openDragMask(dragThumb, dragEnd);\n                    _this.fire(\"dragstart\", { e: e, value: _this.get(\"value\") });\n                });\n                this.on(\"resize\", function () {\n                    _this.render();\n                });\n                this.refresh();\n            };\n            Scrollbar.prototype.posToValue = function (pos) {\n                var btnThumb = this._components[\"thumb\"];\n                var total = this.get(\"total\");\n                if (total <= 0) {\n                    return 0;\n                }\n                var len = 0;\n                var val = 0;\n                if (this.get(\"direction\") === \"vertical\") {\n                    len = this._.clientHeight - btnThumb.offsetHeight;\n                    if (len <= 0)\n                        val = 0;\n                    else\n                        val = pos / len * total;\n                }\n                else {\n                    len = this._.clientWidth - btnThumb.offsetWidth;\n                    if (len <= 0)\n                        val = 0;\n                    else\n                        val = pos / len * total;\n                }\n                val = Math.round(val);\n                return val;\n            };\n            Scrollbar.prototype.valueToPos = function (value) {\n                var minSize = 20;\n                var total = this.get(\"total\");\n                var page = this.get(\"page\");\n                var vertical = (this.get(\"direction\") === \"vertical\");\n                if (total <= 0) {\n                    return { pos: 0, thumbLen: 0 };\n                }\n                var len = (vertical ? this._.clientHeight : this._.clientWidth);\n                var thumbLen = Math.round(page / total * len);\n                if (thumbLen < minSize)\n                    thumbLen = minSize;\n                if (thumbLen > len - 10)\n                    thumbLen = len - 10;\n                var scale = (value / total);\n                if (scale < 0)\n                    scale = 0;\n                if (scale > 1)\n                    scale = 1;\n                var pos = Math.round(scale * (len - thumbLen));\n                return {\n                    \"pos\": pos, \"thumbLen\": thumbLen\n                };\n            };\n            Scrollbar.prototype.render = function () {\n                var pos = this.valueToPos(this.get(\"value\"));\n                var vertical = (this.get(\"direction\") === \"vertical\");\n                var btnThumb = this._components[\"thumb\"];\n                if (vertical) {\n                    $(this._).removeClass(\"tui-horizontal\");\n                    $(this._).addClass(\"tui-vertical\");\n                    btnThumb.style.height = (pos.thumbLen > 0 ? pos.thumbLen : 0) + \"px\";\n                    btnThumb.style.top = pos.pos + \"px\";\n                    btnThumb.style.left = \"\";\n                    btnThumb.style.width = \"\";\n                }\n                else {\n                    $(this._).addClass(\"tui-horizontal\");\n                    $(this._).removeClass(\"tui-vertical\");\n                    btnThumb.style.width = (pos.thumbLen > 0 ? pos.thumbLen : 0) + \"px\";\n                    btnThumb.style.left = pos.pos + \"px\";\n                    btnThumb.style.top = \"\";\n                    btnThumb.style.height = \"\";\n                }\n            };\n            return Scrollbar;\n        }(widget.Widget));\n        widget.Scrollbar = Scrollbar;\n        widget.register(Scrollbar, \"scrollbar\");\n        widget.registerResize(\"scrollbar\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"selectBase.ts\" />\n/// <reference path=\"dialog.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <tui:select>\n         * Attributes: data, list, tree, multiSelect, checkKey, nameKey, canSearch, search\n         * iconKey, valueKey\n         * Method: openSelect\n         * Events: change, click\n         */\n        var Select = (function (_super) {\n            __extends(Select, _super);\n            function Select() {\n                _super.apply(this, arguments);\n            }\n            Select.prototype.initRestriction = function () {\n                var _this = this;\n                var list = widget.create(\"list\");\n                list._set(\"noMouseWheel\", true);\n                list.set(\"lineHeight\", Select.LIST_LINE_HEIGHT);\n                this._components[\"list\"] = list._;\n                _super.prototype.initRestriction.call(this);\n                this.setRestrictions({\n                    \"value\": {\n                        \"set\": function (value) {\n                            _this._data[\"value\"] = value;\n                            _this.updateTextByValue(list);\n                        }\n                    },\n                    \"data\": {\n                        \"set\": function (value) {\n                            list._set(\"data\", value);\n                            _this.updateTextByValue(list);\n                        },\n                        \"get\": function () {\n                            return list.get(\"data\");\n                        }\n                    },\n                    \"list\": {\n                        \"set\": function (value) {\n                            list._set(\"list\", value);\n                            _this.updateTextByValue(list);\n                        },\n                        \"get\": function () {\n                            return list.get(\"list\");\n                        }\n                    },\n                    \"tree\": {\n                        \"set\": function (value) {\n                            list._set(\"tree\", value);\n                            _this.updateTextByValue(list);\n                        },\n                        \"get\": function () {\n                            return list.get(\"tree\");\n                        }\n                    },\n                    \"activeRow\": {\n                        \"set\": function (value) {\n                            list.set(\"activeRow\", value);\n                            _this.updateTextByValue(list);\n                        },\n                        \"get\": function () {\n                            return list.get(\"activeRow\");\n                        }\n                    },\n                    \"selection\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            return _this.getSelection(list);\n                        }\n                    },\n                    \"activeRowData\": {\n                        \"set\": function (value) { },\n                        \"get\": function () {\n                            return list.get(\"activeRowData\");\n                        }\n                    },\n                    \"multiSelect\": {\n                        \"set\": function (value) {\n                            list._set(\"checkable\", value);\n                        },\n                        \"get\": function () {\n                            return list.get(\"checkable\");\n                        }\n                    },\n                    \"checkKey\": {\n                        \"set\": function (value) {\n                            list._set(\"checkKey\", value);\n                        },\n                        \"get\": function () {\n                            return list.get(\"checkKey\");\n                        }\n                    },\n                    \"nameKey\": {\n                        \"set\": function (value) {\n                            list._set(\"nameKey\", value);\n                        },\n                        \"get\": function () {\n                            return list.get(\"nameKey\");\n                        }\n                    },\n                    \"iconKey\": {\n                        \"set\": function (value) {\n                            list._set(\"iconKey\", value);\n                        },\n                        \"get\": function () {\n                            return list.get(\"iconKey\");\n                        }\n                    },\n                    \"valueKey\": {\n                        \"set\": function (value) {\n                            list._set(\"valueKey\", value);\n                        },\n                        \"get\": function () {\n                            return list.get(\"valueKey\");\n                        }\n                    },\n                    \"showCount\": {\n                        \"get\": function () {\n                            var count = _this._data[\"showCount\"];\n                            if (typeof count === \"number\" && !isNaN(count))\n                                return count;\n                            else\n                                return 8;\n                        }\n                    },\n                    \"canSearch\": {\n                        \"get\": function () {\n                            var value = _this._data[\"canSearch\"];\n                            if (typeof value === tui.UNDEFINED || value === null)\n                                return false;\n                            else\n                                return !!value;\n                        },\n                        \"set\": function (value) {\n                            _this._data[\"canSearch\"] = !!value;\n                        }\n                    }\n                });\n            };\n            Select.prototype.changeSize = function () {\n                var list = widget.get(this._components[\"list\"]);\n                var popup = widget.get(this._components[\"popup\"]);\n                var count = list.get(\"data\").length();\n                if (count > this.get(\"showCount\"))\n                    count = this.get(\"showCount\");\n                list._.style.height = count * Select.LIST_LINE_HEIGHT + \"px\";\n                popup.render();\n            };\n            ;\n            Select.prototype.getSelection = function (list) {\n                var textKey = this.get(\"textKey\");\n                if (textKey === null)\n                    textKey = this.get(\"nameKey\");\n                var valueKey = this.get(\"valueKey\");\n                var val = this.get(\"value\");\n                if (val === null)\n                    return null;\n                if (!this.get(\"multiSelect\")) {\n                    var selectedItem_1 = null;\n                    list.iterate(function (item, path, treeNode) {\n                        var nodeValue = item[valueKey];\n                        if (nodeValue === val) {\n                            selectedItem_1 = item;\n                            return false;\n                        }\n                        return true;\n                    });\n                    return selectedItem_1;\n                }\n                else {\n                    if (!(val instanceof Array))\n                        val = [val];\n                    var selectedItems_1 = [];\n                    list.iterate(function (item, path, treeNode) {\n                        var nodeValue = item[valueKey];\n                        if (val.indexOf(nodeValue) >= 0) {\n                            selectedItems_1.push(item);\n                        }\n                        return true;\n                    });\n                    return selectedItems_1;\n                }\n            };\n            Select.prototype.updateTextByValue = function (list) {\n                var textKey = this.get(\"textKey\");\n                if (textKey === null)\n                    textKey = this.get(\"nameKey\");\n                var selected = this.getSelection(list);\n                if (selected == null)\n                    this._set(\"text\", null);\n                else if (selected instanceof Array)\n                    this._set(\"text\", selected.reduce(function (s, v, i) {\n                        return i > 0 ? s + \", \" + v[textKey] : v[textKey];\n                    }, \"\"));\n                else\n                    this._set(\"text\", selected[textKey]);\n            };\n            Select.prototype.init = function () {\n                var _this = this;\n                _super.prototype.init.call(this);\n                this.setInit(\"iconRight\", \"fa-caret-down\");\n                var list = widget.get(this._components[\"list\"]);\n                var container = document.createElement(\"div\");\n                var searchbar = container.appendChild(document.createElement(\"div\"));\n                searchbar.className = \"tui-select-searchbar\";\n                var searchBox = widget.create(\"input\");\n                searchBox._set(\"clearable\", true);\n                searchBox._set(\"iconLeft\", \"fa-search\");\n                searchbar.appendChild(searchBox._);\n                container.appendChild(list._);\n                var toolbar = container.appendChild(document.createElement(\"div\"));\n                toolbar.className = \"tui-select-toolbar\";\n                var popup = widget.get(this._components[\"popup\"]);\n                popup._set(\"content\", container);\n                this._components[\"searchbar\"] = searchbar;\n                this._components[\"toolbar\"] = toolbar;\n                this._components[\"searchBox\"] = searchBox._;\n                list._.style.width = \"inherit\";\n                list._.style.display = \"block\";\n                list._.style.borderWidth = \"0\";\n                list.on(\"expand collapse update\", function () {\n                    _this.changeSize();\n                });\n                list.on(\"rowclick keyselect\", function (e) {\n                    var rowData = list.get(\"activeRowData\");\n                    if (!_this.get(\"multiSelect\")) {\n                        var item;\n                        if (list.get(\"dataType\") === \"tree\")\n                            item = rowData.item;\n                        else\n                            item = rowData;\n                        // this._set(\"text\", item[list.get(\"nameKey\")]);\n                        _this.set(\"value\", item[list.get(\"valueKey\")]);\n                        _this.fire(\"change\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                        if (e.event === \"rowclick\") {\n                            _this.closeSelect();\n                            _this._.focus();\n                            _this.fire(\"click\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                        }\n                    }\n                });\n                searchBox.on(\"enter change\", function (e) {\n                    var searchValue = searchBox.get(\"value\");\n                    if (searchValue == null || searchValue.length == 0) {\n                        list.get(\"data\").setFilter(null);\n                    }\n                    else {\n                        list.get(\"data\").setFilter([{\n                                key: _this.get(\"nameKey\"),\n                                value: searchValue\n                            }]);\n                    }\n                    list._set(\"activeRow\", null);\n                    list.scrollTo(0);\n                    if (!_this.get(\"multiSelect\") && _this.get(\"value\") !== null) {\n                        list.activeTo(_this.get(\"valueKey\"), _this.get(\"value\"));\n                    }\n                });\n                $(toolbar).click(function (e) {\n                    var obj = (e.target || e.srcElement);\n                    var name = obj.getAttribute(\"name\");\n                    if (name === \"selectAll\") {\n                        list.selectAll();\n                    }\n                    else if (name === \"deselectAll\") {\n                        list.deselectAll();\n                    }\n                    else if (name === \"ok\") {\n                        _this.set(\"value\", list.get(\"checkedValues\"));\n                        // this.set(\"text\", list.get(\"checkedNames\").join(\", \"));\n                        _this.fire(\"change\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                        _this.closeSelect();\n                        _this._.focus();\n                        _this.fire(\"click\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                    }\n                    else if (name === \"clear\") {\n                        // this._set(\"text\", null);\n                        _this.set(\"value\", null);\n                        _this.fire(\"change\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                        _this.closeSelect();\n                        _this._.focus();\n                        _this.fire(\"click\", { e: e, value: _this.get(\"value\"), text: _this.get(\"text\") });\n                    }\n                });\n            };\n            Select.prototype.openSelect = function () {\n                var _this = this;\n                var list = widget.get(this._components[\"list\"]);\n                var popup = widget.get(this._components[\"popup\"]);\n                var minWidth = this._.offsetWidth - 2;\n                if (minWidth < 250)\n                    minWidth = 250;\n                popup._.style.minWidth = minWidth + \"px\";\n                //popup._set(\"content\", list._);\n                var toolbar = this._components[\"toolbar\"];\n                var searchbar = this._components[\"searchbar\"];\n                var searchBox = widget.get(this._components[\"searchBox\"]);\n                if (this.get(\"canSearch\")) {\n                    searchbar.style.display = \"block\";\n                }\n                else\n                    searchbar.style.display = \"none\";\n                var checkButtons = \"<a name='selectAll'>\" + tui.str(\"Select all\") + \"</a> | \" +\n                    \"<a name='deselectAll'>\" + tui.str(\"Deselect all\") +\n                    \"</a> | <a name='ok'><i class='fa fa-check'></i> \" + tui.str(\"OK\") + \"</a>\";\n                var clearButton = \"<a name='clear'><i class='fa fa-trash-o'></i> \" + tui.str(\"Clear\") + \"</a>\";\n                var multiSelect = this.get(\"multiSelect\");\n                var clearable = !multiSelect && this.get(\"clearable\");\n                toolbar.style.display = \"\";\n                if (multiSelect)\n                    toolbar.innerHTML = checkButtons;\n                else if (clearable)\n                    toolbar.innerHTML = clearButton;\n                else\n                    toolbar.style.display = \"none\";\n                popup.open(this._);\n                setTimeout(function () {\n                    if (_this.get(\"canSearch\"))\n                        searchBox.render();\n                    list._.focus();\n                    list.render();\n                    if (tui.ieVer > 0 && tui.ieVer <= 9) {\n                        // FIX ie bug.\n                        setTimeout(function () {\n                            list.render();\n                        });\n                    }\n                    if (!_this.get(\"multiSelect\")) {\n                        if (_this.get(\"value\") !== null) {\n                            list.activeTo(_this.get(\"valueKey\"), _this.get(\"value\"));\n                        }\n                        else {\n                            list._set(\"activeRow\", null);\n                            list.scrollTo(0);\n                        }\n                    }\n                    else {\n                        var value = _this.get(\"value\");\n                        list.set(\"checkedValues\", value);\n                    }\n                    _this.changeSize();\n                });\n            };\n            Select.LIST_LINE_HEIGHT = 28;\n            return Select;\n        }(widget.SelectPopupBase));\n        widget.Select = Select;\n        widget.register(Select, \"select\");\n        var DialogSelect = (function (_super) {\n            __extends(DialogSelect, _super);\n            function DialogSelect() {\n                _super.apply(this, arguments);\n            }\n            DialogSelect.prototype.openSelect = function () {\n                this.fire(\"open\", this.dialog);\n                this.dialog.set(\"title\", this.get(\"title\"));\n                this.dialog.open(\"ok#tui-primary\");\n            };\n            DialogSelect.prototype.initChildren = function (childNodes) {\n                var _this = this;\n                _super.prototype.initChildren.call(this, childNodes);\n                this.dialog = widget.create(\"dialog\");\n                this.content = document.createElement(\"div\");\n                childNodes.forEach(function (n) {\n                    if (widget.getFullName(n) !== \"tui:verify\")\n                        _this.content.appendChild(n);\n                });\n                this.dialog.setContent(this.content);\n                widget.init(this.content);\n            };\n            DialogSelect.prototype.createPopup = function () {\n                var _this = this;\n                this.dialog.on(\"btnclick\", function () {\n                    _this.fire(\"close\");\n                    _this.dialog.close();\n                });\n                return this.dialog;\n            };\n            DialogSelect.prototype.init = function () {\n                _super.prototype.init.call(this);\n                this.setInit(\"iconRight\", \"fa-pencil\");\n            };\n            return DialogSelect;\n        }(widget.SelectBase));\n        widget.DialogSelect = DialogSelect;\n        widget.register(DialogSelect, \"dialog-select\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"inputBase.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        /**\n         * <input>\n         * Attributes: value, text, type, iconLeft, iconRight, autoValidate\n         * Events: input, change, left-icon-mousedown, right-icon-mousedown, left-icon-click, right-icon-click\n         */\n        var Textarea = (function (_super) {\n            __extends(Textarea, _super);\n            function Textarea() {\n                _super.apply(this, arguments);\n            }\n            Textarea.prototype.initRestriction = function () {\n                var _this = this;\n                _super.prototype.initRestriction.call(this);\n                var textbox = this._components[\"textbox\"] = document.createElement(\"textarea\");\n                textbox.setAttribute(\"wrap\", \"physical\");\n                this.setRestrictions({\n                    \"value\": {\n                        \"set\": function (value) {\n                            textbox.value = value;\n                            _this._isEmpty = (textbox.value === \"\");\n                        },\n                        \"get\": function () {\n                            return textbox.value;\n                        }\n                    },\n                    \"text\": {\n                        \"set\": function (value) {\n                            _this._set(\"value\", value);\n                        },\n                        \"get\": function () {\n                            return _this.get(\"value\");\n                        }\n                    }\n                });\n            };\n            Textarea.prototype.onInput = function (textbox, e) {\n                this.updateEmptyState(textbox.value === \"\");\n                var oldHeight = tui.browser.getCurrentStyle(textbox).height;\n                textbox.style.height = \"\";\n                if (this._valid && textbox.scrollHeight !== this._lastTextHeight)\n                    this.render();\n                else\n                    textbox.style.height = oldHeight;\n                this.reset();\n                this.fire(\"input\", e);\n            };\n            Textarea.prototype.init = function () {\n                var _this = this;\n                var $root = $(this._);\n                var placeholder = this._components[\"placeholder\"] = document.createElement(\"span\");\n                var textbox = this._components[\"textbox\"];\n                var iconInvalid = this._components[\"iconInvalid\"] = document.createElement(\"i\");\n                iconInvalid.className = \"tui-invalid-icon\";\n                placeholder.className = \"tui-placeholder\";\n                placeholder.setAttribute(\"unselectable\", \"on\");\n                this._.appendChild(placeholder);\n                this._.appendChild(textbox);\n                this._.appendChild(iconInvalid);\n                $(textbox).focus(function () {\n                    $root.addClass(\"tui-active\");\n                });\n                $(textbox).blur(function () {\n                    $root.removeClass(\"tui-active\");\n                    if (_this.get(\"disable\"))\n                        return;\n                    if (_this.get(\"autoValidate\")) {\n                        _this.validate();\n                    }\n                });\n                if (tui.ieVer > 0 && tui.ieVer < 9) {\n                    $(textbox).on(\"propertychange\", function (e) {\n                        if (e.originalEvent.propertyName !== 'value')\n                            return;\n                        _this.onInput(textbox, e);\n                    });\n                }\n                else {\n                    if (tui.ieVer === 9) {\n                        $(textbox).on(\"keyup\", function (e) {\n                            if (e.keyCode = tui.browser.KeyCode.BACK)\n                                _this.onInput(textbox, e);\n                        });\n                    }\n                    $(textbox).on(\"input\", function (e) {\n                        _this.onInput(textbox, e);\n                    });\n                }\n                $(textbox).on(\"change\", function (e) {\n                    _this.fire(\"change\", e);\n                });\n                $root.mousedown(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    var obj = e.target || e.srcElement;\n                    if (obj === textbox) {\n                        return;\n                    }\n                    setTimeout(function () {\n                        textbox.focus();\n                    }, 0);\n                });\n                $root.click(function (e) {\n                    if (_this.get(\"disable\"))\n                        return;\n                    var obj = e.target || e.srcElement;\n                    if (obj === textbox) {\n                        return;\n                    }\n                });\n                this.on(\"resize\", function () {\n                    _this.render();\n                });\n            };\n            Textarea.prototype.focus = function () {\n                var textbox = this._components[\"textbox\"];\n                textbox.focus();\n            };\n            Textarea.prototype.render = function () {\n                this._.scrollLeft = 0;\n                var $root = $(this._);\n                var textbox = this._components[\"textbox\"];\n                var iconInvalid = this._components[\"iconInvalid\"];\n                var placeholder = this._components[\"placeholder\"];\n                if (this.get(\"disable\")) {\n                    $root.addClass(\"tui-disable\");\n                    textbox.setAttribute(\"readonly\", \"readonly\");\n                }\n                else {\n                    $root.removeClass(\"tui-disable\");\n                    textbox.removeAttribute(\"readonly\");\n                }\n                var marginLeft = widget.Input.PADDING;\n                var marginRight = widget.Input.PADDING;\n                if (!this._valid) {\n                    $root.addClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"\";\n                    iconInvalid.style.right = \"0px\";\n                }\n                else {\n                    $root.removeClass(\"tui-invalid\");\n                    iconInvalid.style.display = \"none\";\n                }\n                textbox.style.height = \"\";\n                this._lastTextHeight = textbox.scrollHeight;\n                if (this._lastTextHeight < 46)\n                    this._lastTextHeight = 46;\n                textbox.style.height = this._lastTextHeight + 2 + \"px\";\n                this._.style.height = this._lastTextHeight + 4 + \"px\";\n                textbox.style.left = marginLeft + \"px\";\n                var width = this._.clientWidth - iconInvalid.offsetWidth - marginLeft - marginRight;\n                if (width < 0)\n                    width = 0;\n                textbox.style.width = width + \"px\";\n                var phText = this.get(\"placeholder\");\n                var showPh = phText && !this.get(\"value\");\n                if (showPh) {\n                    $(placeholder).text(phText);\n                    placeholder.style.left = marginLeft + \"px\";\n                    placeholder.style.width = textbox.style.width;\n                    placeholder.style.display = \"\";\n                }\n                else {\n                    placeholder.style.display = \"none\";\n                }\n                if (!this._valid && this._invalidMessage) {\n                    this._set(\"follow-tooltip\", this._invalidMessage);\n                }\n                else {\n                    this._set(\"follow-tooltip\", null);\n                }\n            };\n            return Textarea;\n        }(widget.InputBase));\n        widget.Textarea = Textarea;\n        widget.register(Textarea, \"textarea\");\n        widget.registerResize(\"textarea\");\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n/// <reference path=\"../core.ts\" />\nvar tui;\n(function (tui) {\n    var widget;\n    (function (widget) {\n        \"use strict\";\n        var _tooltip = document.createElement(\"span\");\n        _tooltip.className = \"tui-tooltip\";\n        _tooltip.setAttribute(\"unselectable\", \"on\");\n        var _tooltipTarget = null;\n        function showTooltip(target, tooltip, pos, update) {\n            function show() {\n                if (pos.x + _tooltip.offsetWidth > $(window).width()) {\n                    pos.x = $(window).width() - _tooltip.offsetWidth;\n                }\n                _tooltip.style.left = pos.x + \"px\";\n                _tooltip.style.top = pos.y + 25 + \"px\";\n            }\n            if (target === _tooltipTarget || target === _tooltip) {\n                if (update) {\n                    show();\n                }\n                return;\n            }\n            _tooltip.style.width = \"\";\n            _tooltip.style.whiteSpace = \"nowrap\";\n            if (target.hasAttribute(\"html-tooltip\"))\n                _tooltip.innerHTML = tooltip;\n            else\n                $(_tooltip).text(tooltip);\n            document.body.appendChild(_tooltip);\n            _tooltipTarget = target;\n            if (_tooltip.scrollWidth > _tooltip.clientWidth) {\n                _tooltip.style.whiteSpace = \"normal\";\n            }\n            else\n                _tooltip.style.whiteSpace = \"nowrap\";\n            _tooltip.style.width = $(_tooltip).width() + \"px\";\n            show();\n        }\n        widget.showTooltip = showTooltip;\n        function closeTooltip() {\n            if (_tooltip.parentNode)\n                _tooltip.parentNode.removeChild(_tooltip);\n            _tooltip.innerHTML = \"\";\n            _tooltip.style.width = \"\";\n            _tooltipTarget = null;\n        }\n        widget.closeTooltip = closeTooltip;\n        var _tooltipTimer = null;\n        function whetherShowTooltip(target, e) {\n            if (tui.browser.isAncestry(target, _tooltip))\n                return;\n            var obj = target;\n            while (obj) {\n                if (!obj.getAttribute) {\n                    obj = null;\n                    break;\n                }\n                var tooltip = obj.getAttribute(\"follow-tooltip\"); // high priority\n                if (tooltip) {\n                    showTooltip(obj, tooltip, { x: e.clientX, y: e.clientY }, true);\n                    return;\n                }\n                else {\n                    tooltip = obj.getAttribute(\"tooltip\");\n                    if (tooltip) {\n                        closeTooltip();\n                        _tooltipTimer = setTimeout(function () {\n                            showTooltip(obj, tooltip, { x: e.clientX, y: e.clientY }, false);\n                        }, 500);\n                        return;\n                    }\n                    else\n                        obj = obj.parentElement;\n                }\n            }\n            if (!obj)\n                closeTooltip();\n        }\n        widget.whetherShowTooltip = whetherShowTooltip;\n        function whetherCloseTooltip(target) {\n            if (target !== _tooltipTarget && target !== _tooltip) {\n                closeTooltip();\n            }\n        }\n        widget.whetherCloseTooltip = whetherCloseTooltip;\n        var _hoverElement;\n        $(window.document).mousemove(function (e) {\n            clearTimeout(_tooltipTimer);\n            _hoverElement = e.target || e.toElement;\n            if (e.button === 0 && (e.which === 1 || e.which === 0)) {\n                whetherShowTooltip(_hoverElement, e);\n            }\n        });\n        $(window).scroll(function () { closeTooltip(); });\n    })(widget = tui.widget || (tui.widget = {}));\n})(tui || (tui = {}));\n\n//# sourceMappingURL=tui2.js.map\n"]}