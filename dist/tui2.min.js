var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();!function(){for(var lastTime=0,vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!window.requestAnimationFrame;++x)window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(id){clearTimeout(id)})}();var tui;!function(tui){"use strict";function getEnv(key){return _tui_env[key]||""}function str(s,lang){lang||(lang=tui.lang?tui.lang.toLowerCase():"en-us");var translator=_dict[lang];return translator?translator.translate(s):(translator=_dict["en-us"])?translator.translate(s):s}function cloneInternal(obj,excludeProperties){if(null===obj)return null;if(typeof obj===tui.UNDEFINED)return undefined;if(obj instanceof Array){var newArray=[];for(var idx in obj)obj.hasOwnProperty(idx)&&excludeProperties.indexOf(idx)<0&&newArray.push(cloneInternal(obj[idx],excludeProperties));return newArray}if("number"==typeof obj)return obj;if("string"==typeof obj)return obj;if("boolean"==typeof obj)return obj;if("function"==typeof obj)return obj;var newObj={};for(var idx in obj)obj.hasOwnProperty(idx)&&excludeProperties.indexOf(idx)<0&&(newObj[idx]=cloneInternal(obj[idx],excludeProperties));return newObj}tui.UNDEFINED="undefined";var _tui_env={};tui.setEnv=function(key,value){_tui_env[key]=value},tui.getEnv=getEnv,tui.isEnvKey=function(key){return key&&/^%[a-z_][a-z0-9_]*%$/i.test(key)},tui.useEnv=function(str){return"string"==typeof str?str.replace(/%([a-z_][a-z0-9_]*)%/gi,function(substring){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return getEnv(args[0])}):str},tui.elem=function(nodeName){return document.createElement(nodeName)},tui.lang=(navigator.language||navigator.browserLanguage||navigator.userLanguage).toLowerCase();var Translator=function(){function Translator(){this.dictionary={}}return Translator.prototype.translate=function(str){return this.dictionary&&this.dictionary[(str+"").toLowerCase()]||str},Translator}(),_dict={};tui.dict=function(lang,dictionary,replace){if(void 0===replace&&(replace=!1),lang&&("string"==typeof lang&&(lang=lang.toLowerCase()),"object"==typeof dictionary&&null!==dictionary)){var translator=_dict[lang];if(translator||(translator=_dict[lang]=new Translator),replace)translator.dictionary=dictionary;else for(var k in dictionary)dictionary.hasOwnProperty(k)&&(translator.dictionary[k]=dictionary[k])}},tui.str=str,tui.strp=function(s){for(var params=[],_i=1;_i<arguments.length;_i++)params[_i-1]=arguments[_i];var s=str(s);return tui.text.format(s,params)},tui.tuid=function(){var id=0;return function(){return"tuid-"+id++}}();var EventObject=function(){function EventObject(){this._events={}}return EventObject.prototype.bind=function(eventName,handler,atFirst){if(!eventName)return this;this._events[eventName]||(this._events[eventName]=[]);for(var handlers=this._events[eventName],i=0;i<handlers.length;i++)if(handlers[i]===handler)return this;return atFirst?handlers.splice(0,0,handler):handlers.push(handler),this},EventObject.prototype.unbind=function(eventName,handler){if(!eventName)return this;var handlers=this._events[eventName];if(handler){for(var i=0;i<handlers.length;i++)if(handler===handlers[i])return handlers.splice(i,1),this}else handlers.length=0;return this},EventObject.prototype.on=function(eventName,callback,atFirst){void 0===atFirst&&(atFirst=!1);for(var envs=eventName.split(/\s+/),i=0;i<envs.length;i++){var v=envs[i];this.bind(v,callback,atFirst)}return this},EventObject.prototype.once=function(eventName,callback,atFirst){return void 0===atFirst&&(atFirst=!1),callback.isOnce=!0,this.on(eventName,callback,atFirst)},EventObject.prototype.off=function(eventName,callback){for(var envs=eventName.split(/\s+/),i=0;i<envs.length;i++){var v=envs[i];this.unbind(v,callback)}return this},EventObject.prototype.offAll=function(){for(var key in this._events)this.off(key)},EventObject.prototype.fire=function(eventName,data){var handlers=this._events[eventName];handlers instanceof Array||(handlers=[]);var wildcardHandlers=this._events["*"];if(wildcardHandlers instanceof Array&&(handlers=handlers.concat(wildcardHandlers)),0===handlers.length)return!0;for(var eventInfo={event:eventName,data:data},removeArray=[],i=0;i<handlers.length;i++){var handler=handlers[i];handler.isOnce&&removeArray.push(handler);var val=handler.call(this,eventInfo);if("boolean"==typeof val&&!val)return!1}for(i=0;i<removeArray.length;i++)this.off(eventName,removeArray[i]);return!0},EventObject}();tui.EventObject=EventObject,tui.event=new EventObject,tui.stringify=function(obj){return tui.ieVer>0&&tui.ieVer<=8?JSON.stringify(obj,function(k,v){return""===v?"":v}):JSON.stringify(obj)},tui.clone=function(obj,excludeProperties){return typeof obj===tui.UNDEFINED||null===obj?null:"string"==typeof excludeProperties&&$.trim(excludeProperties).length>0?cloneInternal(obj,[excludeProperties]):excludeProperties instanceof Array?cloneInternal(obj,excludeProperties):JSON.parse(tui.stringify(obj))},tui.ieVer=function(){var rv=-1;if("Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName){ua=navigator.userAgent;null!==(re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})")).exec(ua)&&(rv=parseFloat(RegExp.$1))}if(-1===rv&&"Netscape"===navigator.appName){var ua=navigator.userAgent,re=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})");null!==re.exec(ua)&&(rv=parseFloat(RegExp.$1)),rv>=7&&(rv=11)}return rv}(),tui.ffVer=function(){var rv=-1;if("Netscape"===navigator.appName){var ua=navigator.userAgent;null!==new RegExp("Firefox/([0-9]{1,}[.0-9]{0,})").exec(ua)&&(rv=parseFloat(RegExp.$1))}return rv}()}(tui||(tui={})),tui.dict("en-us",{all:"All","allow.append":"Allow Append","allow.delete":"Allow Delete","allow.edit":"Allow Edit","support.select.all":"Support Select All","auto.height":"Auto Height","auto.column.width":"Auto Column Width",success:"Success",warning:"Warning",confirm:"Confirm",normal:"Normal",note:"Note",notmodified:"Request's content has not been modified!",error:"Error",timeout:"Request timeout!",abort:"Operating has been aborted!",parsererror:"Server response invalid content!",ok:"OK",close:"Close",cancel:"Cancel",accept:"Accept",agree:"Agree",append:"Append","delete":"Delete",edit:"Edit",reject:"Reject",yes:"Yes",no:"No",finish:"Finish",select:"Select",vertical:"Vertical","please.select.point":"Please select a point of the map.",address:"Address","invalid.file.type":"Invalid file type!","geo.location.failed":"Get current location failed, please check your browser whether can use geo-location service.","form.grid.features":"Features","form.foldable":"Foldable","form.calendar":"Calendar","form.section":"Title","form.textbox":"Textbox","form.textarea":"Textarea","form.options":"Options","form.option.group":"Option Group","form.selection":"Selection","form.selection.desc":"Allow have multiple selection groups it can use condition expression to decide which group come into force.","form.datepicker":"Date","form.picture":"Picture","form.file":"File","form.files":"Files","form.link":"Link","form.grid":"Grid","form.address":"Address","form.common":"Common","form.field.name":"Field Name","form.precondition":"Precondition","form.validation":"Validation","form.format":"Format","form.message":"Message","form.required":"Required","form.disable":"Disabled","form.enable":"Enabled","form.use.search":"Enable Search","form.description":"Description","form.textbox.selection.desc":"A group predefined input content, separated with newline characters.","form.value.as.label":"Use value as label","message.upload.failed":"Upload failed!","message.cannot.be.empty":"Cannot be empty!","message.invalid.format":"Invalid format!","message.invalid.file":"Invalid file!","message.invalid.value":"Invalid value!","form.textview":"Text View","form.text.content":"Text Content","form.style.normal":"Normal","form.style.inline":"Inline","form.text.align":"Text Align","form.text.color":"Text Color","form.text.view.style":"Display Style","form.arrange":"Arrange","form.align":"Align","form.align.left":"Left","form.align.center":"Center","form.align.right":"Right","form.font.size":"Font Size","form.input.type":"Input Type","form.text":"Text","form.password":"Password","form.email":"EMail","form.url":"URL","form.number":"Number","form.at.least":"At Least","form.at.most":"At Most","form.at.least.p":"At Least select {0} item(s).","form.at.most.p":"At Most select {0} item(s).","file.count.p":"{0} file(s)","item.count.p":"{0} item(s)","form.option.group.desc":"Options separated by newline, option can be a key:value pair or a string.","form.value":"Value","form.display":"Display","form.invisible":"Invisible","form.visible":"Visible","form.min.height":"Min Height","form.max.height":"Max Height","form.date":"Date","form.date.time":"Date Time","form.time":"Time","form.month":"Year Month","form.custom.format":"Custom Format","form.date.desc":"e.g.: 'yyyy-MM-dd HH:mm:sszz' or 'dd MMM yy hh:mm:ss A', etc..","form.timezone":"Timezone","form.tz.utc":"UTC","form.tz.locale":"Locale","form.tz.none":"None","form.upload.url":"Upload URL","form.file.type":"File Type","message.must.be.image":"Must be valid image mime types.","form.newline":"Newline Only","form.height":"Height","form.design":"Design","form.app.key":"Map App Key","form.emphasize":"Emphasized","message.not.available":"Not Available","form.init.by.current.time":"Use Current Time as Init Value",apply:"应用",rerresh:"刷新",second:"秒",seconds:"秒",minute:"分",minutes:"分",hour:"小时",hours:"小时",day:"天",days:"天",week:"周",weeks:"周",month:"月",months:"月",year:"年",years:"年",previous:"上一页",next:"下一页",january:"一月",february:"二月",march:"三月",april:"四月",may:"五月",june:"六月",july:"七月",august:"八月",september:"九月",october:"十月",november:"十一月",december:"十二月",jan:"一月",feb:"二月",mar:"三月",apr:"四月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月",sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六",today:"今天",clear:"清除",Fill:"填充","New Line":"换行"});var tui;!function(tui){!function(text){"use strict";text.parseBoolean=function(value){if(typeof value===tui.UNDEFINED)return!1;if("number"==typeof value)return isNaN(value)&&0!=value;switch(String(value).toLowerCase()){case"true":case"t":case"yes":case"y":return!0;default:return!1}},text.format=function(token){for(var params=[],_i=1;_i<arguments.length;_i++)params[_i-1]=arguments[_i];if(null===token||typeof token===tui.UNDEFINED||"number"==typeof token&&isNaN(token))return"";var formatrg=/\{(\d+)\}/g;return"string"==typeof token&&params.length&&(token=token.replace(formatrg,function(str,i){return null===params[i]?"":params[i]})),token+""},text.toDashSplit=function(word){for(var buffer="",i=0;i<word.length;i++){var c=word.charAt(i),code=c.charCodeAt(0);code>=65&&code<=90?(i>0&&(buffer+="-"),buffer+=c.toLowerCase()):buffer+=c}return buffer},text.toCamel=function(word,strict){void 0===strict&&(strict=!1);var buffer="";strict&&(word=word.toLowerCase());for(var upperFlag=!1,i=0;i<word.length;i++){var c=word.charAt(i);"-"===c||"_"===c?upperFlag=!0:(buffer+=upperFlag?c.toUpperCase():c,upperFlag=!1)}return buffer},text.paddingNumber=function(v,min,max,alignLeft){void 0===alignLeft&&(alignLeft=!1);for(var result=Math.abs(v)+"";result.length<min;)result="0"+result;return"number"==typeof max&&result.length>max&&(result=alignLeft?result.substr(0,max):result.substr(result.length-max,max)),v<0&&(result="-"+result),result},text.getUrlParam=function(url,key){key=key.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var results=new RegExp("[\\?&]"+key+"=([^&#]*)").exec(url);return null===results?null:decodeURIComponent(results[1].replace(/\+/g," "))},text.getUrlAnchor=function(url){var anchor=url.match("(#.+)(?:\\?.*)?");return anchor&&(anchor=anchor[1]),anchor},text.isAbsUrl=function(url){return!!url&&!!url.match(/^(([a-z0-9]+:)?\/\/|\/)/i)},text.getBaseUrl=function(url){var matcher=url.match(/^(?:[a-z0-9]+:)?\/\//i),prefix="";matcher&&(prefix=matcher[0],url=url.substr(matcher[0].length));var pos=url.indexOf("#");return pos>=0&&(url=url.substring(0,pos)),(pos=url.lastIndexOf("/"))>=0&&(url=url.substring(0,pos+1)),prefix+url},text.joinUrl=function(){for(var urls=[],_i=0;_i<arguments.length;_i++)urls[_i]=arguments[_i];for(var result=null,_a=0,urls_1=urls;_a<urls_1.length;_a++){var u=urls_1[_a];result?("/"==u[0]&&(u=u.substr(1)),"/"==result[result.length-1]?result+=u:result+="/"+u):result=u}return result},text.arrayAdd=function(arr,value){arr&&arr.indexOf(value)<0&&arr.push(value)},text.arrayRemove=function(arr,value){if(arr){var pos=arr.indexOf(value);pos>=0&&arr.splice(pos,1)}}}(tui.text||(tui.text={}))}(tui||(tui={}));var tui;!function(tui){var browser;!function(browser){"use strict";function backupScrollPosition(target){return new BackupedScrollPosition(target)}function focusWithoutScroll(target){setTimeout(function(){if(tui.ieVer>0)target.setActive();else if(tui.ffVer>0)target.focus();else{var backup=tui.browser.backupScrollPosition(target);target.focus(),backup.restore()}},0)}function scrollToElement(elem){for(var param=[],_i=1;_i<arguments.length;_i++)param[_i-1]=arguments[_i];for(var distance=0,cb=null,useAnimation=!0,_a=0,param_1=param;_a<param_1.length;_a++){var p=param_1[_a];"number"==typeof p?distance=p:"boolean"==typeof p?useAnimation=p:"function"==typeof p&&(cb=p)}useAnimation?$(getWindowScrollElement()).animate({scrollTop:$(elem).offset().top-distance},150,cb):(getWindowScrollElement().scrollTop=$(elem).offset().top-distance,cb&&cb())}function toElement(html,withParentDiv){void 0===withParentDiv&&(withParentDiv=!1);var div=tui.elem("div");if(div.innerHTML=$.trim(html),withParentDiv)return div;var el=div.firstChild;return div.removeChild(el)}function toHTML(node){var elem=tui.elem("div");if("string"==typeof node.nodeName)elem.appendChild(node);else if("number"==typeof node.length)for(var i=0;i<node.length;i++)elem.appendChild(node[i]);return elem.innerHTML}function hasClass(elem,className){var oldClass=elem.className;if(oldClass&&oldClass.trim()&&className&&className.trim())for(var _i=0,oldNames_1=oldClass.trim().split(/\s+/);_i<oldNames_1.length;_i++)if(oldNames_1[_i]===className.trim())return!0;return!1}function addClass(elem,classNames){var oldClass=elem.className;if(oldClass&&oldClass.trim()){var oldNames=oldClass.trim().split(/\s+/);if(classNames&&classNames.trim()){for(var _i=0,names_1=classNames.trim().split(/\s+/);_i<names_1.length;_i++){var n=names_1[_i];oldNames.indexOf(n)<0&&oldNames.push(n)}elem.className=oldNames.join(" ")}}else elem.className=classNames}function removeClass(elem,classNames){var oldClass=elem.className;if(oldClass&&oldClass.trim()){var oldNames=oldClass.trim().split(/\s+/);if(classNames&&classNames.trim()){for(var names=classNames.trim().split(/\s+/),newClass="",_i=0,oldNames_2=oldNames;_i<oldNames_2.length;_i++){var n=oldNames_2[_i];names.indexOf(n)<0&&(newClass+=" "+n)}elem.className=newClass}}}function removeNode(node){node.parentNode&&node.parentNode.removeChild(node)}function toSafeText(text){return null===text||typeof text===tui.UNDEFINED?"":(text+="").replace(/<|>|&/g,function(str){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return"<"===str?"&lt;":"<"===str?"&gt;":"&"===str?"&amp;":str})}function nodeText(elem,text){if("string"==typeof elem&&(elem=document.getElementById(elem)),elem){if("string"==typeof text)return elem.innerHTML="",elem.appendChild(document.createTextNode(text)),text;"boolean"!=typeof text&&(text=!0);for(var buf="",i=0;i<elem.childNodes.length;i++){var c=elem.childNodes[i];"#text"===c.nodeName.toLowerCase()?buf+=c.nodeValue:text&&(buf+=nodeText(c))}return buf}return null}function getNodeText(elem){return nodeText(elem)}function setNodeText(elem,text){nodeText(elem,text)}function getNodeOwnText(elem){return nodeText(elem,!1)}function getRectOfParent(elem){return null===elem?null:{left:elem.offsetLeft,top:elem.offsetTop,width:elem.offsetWidth,height:elem.offsetHeight}}function getRectOfPage(elem){if(null===elem)return null;var offset=$(elem).offset();return{left:offset.left,top:offset.top,width:elem.offsetWidth,height:elem.offsetHeight}}function getRectOfScreen(elem){if(null===elem)return null;var offset=$(elem).offset(),$doc=$(document);return{left:offset.left-$doc.scrollLeft(),top:offset.top-$doc.scrollTop(),width:elem.offsetWidth,height:elem.offsetHeight}}function getTopBody(){return top.document.body||top.document.getElementsByTagName("BODY")[0]}function getWindow(elem){return elem.ownerDocument.defaultView||elem.ownerDocument.parentWindow}function getWindowScrollElement(){return document.scrollingElement?document.scrollingElement:tui.ieVer>0||tui.ffVer>0?window.document.documentElement:window.document.body}function keepTopProc(){for(var scrollWindow=browser.getWindowScrollElement(),_i=0,keepTopList_1=keepTopList;_i<keepTopList_1.length;_i++){var item=keepTopList_1[_i],rect=browser.getRectOfScreen(item.elem);rect.top<item.top?(item.oldPosition=item.elem.style.position,item.oldTop=item.elem.style.top,item.oldLeft=item.elem.style.left,item.oldWidth=item.elem.style.width,item.oldZIndex=item.elem.style.zIndex,item.scrollTop=scrollWindow.scrollTop,item.scrollLeft=scrollWindow.scrollLeft,item.elem.style.zIndex="1000",item.elem.style.width=item.elem.clientWidth+"px",item.elem.style.position="fixed",item.elem.style.top=item.top+"px",item.elem.style.left=rect.left+"px",item.itemLeft=rect.left,item.keepTop=!0):scrollWindow.scrollTop<item.scrollTop?(item.elem.style.position=item.oldPosition,item.elem.style.top=item.oldTop,item.elem.style.left=item.oldLeft,item.elem.style.width=item.oldWidth,item.keepTop=!1):item.keepTop&&(item.elem.style.left=item.itemLeft-scrollWindow.scrollLeft+item.scrollLeft+"px")}}function keepToTop(elem,top){void 0===top&&(top=0),keepTopList.push({keepTop:!1,elem:elem,top:top})}function cancelKeepToTop(elem){for(var newList=[],_i=0,keepTopList_2=keepTopList;_i<keepTopList_2.length;_i++){var item=keepTopList_2[_i];item.elem!==elem?newList.push(item):(item.elem.style.position=item.oldPosition,item.elem.style.top=item.oldTop,item.elem.style.left=item.oldLeft,item.elem.style.width=item.oldWidth,item.keepTop=!1)}keepTopList=newList}function getCurrentStyle(elem){return elem.currentStyle?elem.currentStyle:window.getComputedStyle?window.getComputedStyle(elem):elem.style}function isLButton(e){return 1==("undefined"!=typeof e.which?e.which:e.button)}function banBackspace(){function ban(e){var ev=e||window.event,obj=ev.target||ev.srcElement,t=obj.type||obj.getAttribute("type"),vReadOnly=obj.readOnly,vDisabled=obj.disabled;vReadOnly=typeof vReadOnly!==tui.UNDEFINED&&vReadOnly,vDisabled=typeof vDisabled===tui.UNDEFINED||vDisabled;var flag1=8===ev.keyCode&&("password"===t||"text"===t||"textarea"===t)&&(vReadOnly||vDisabled);if(8===ev.keyCode&&"password"!==t&&"text"!==t&&"textarea"!==t||flag1)return!1}$(document).bind("keypress",ban),$(document).bind("keydown",ban)}function isAncestry(elem,parent){for(;elem;){if(elem===parent)return!0;elem=elem.parentNode}return!1}function isPosterity(elem,child){return isAncestry(child,elem)}function isFireInside(elem,event){return isPosterity(elem,event.target||event.srcElement)}function isInDoc(elem){for(var obj=elem;obj;){if("HTML"===obj.nodeName.toUpperCase())return!0;obj=obj.parentElement}return!1}function saveCookie(name,value,expires,path,domain,secure){void 0===secure&&(secure=!1);var today=new Date;today.setTime(today.getTime()),expires&&(expires=1e3*expires*60*60*24);var expires_date=new Date(today.getTime()+expires);document.cookie=name+"="+encodeURIComponent(tui.stringify(value))+(expires?";expires="+expires_date.toUTCString():"")+(path?";path="+path:"")+(domain?";domain="+domain:"")+(secure?";secure":"")}function loadCookie(name){var arr=document.cookie.match(new RegExp("(^| )"+name+"=([^;]*)(;|$)"));return null!==arr?JSON.parse(decodeURIComponent(arr[2])):null}function deleteCookie(name,path,domain){loadCookie(name)&&(document.cookie=name+"="+(path?";path="+path:"")+(domain?";domain="+domain:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT")}function saveData(key,value,sessionOnly){void 0===sessionOnly&&(sessionOnly=!1);try{var storage=!0===sessionOnly?window.sessionStorage:window.localStorage;storage?storage.setItem(key,tui.stringify(value)):saveCookie(key,value,365)}catch(e){}}function loadData(key,sessionOnly){void 0===sessionOnly&&(sessionOnly=!1);try{var storage=!0===sessionOnly?window.sessionStorage:window.localStorage;return storage?JSON.parse(storage.getItem(key)):loadCookie(key)}catch(e){return null}}function deleteData(key,sessionOnly){void 0===sessionOnly&&(sessionOnly=!1);try{var storage=!0===sessionOnly?window.sessionStorage:window.localStorage;storage?storage.removeItem(key):deleteCookie(key)}catch(e){}}function accelerate(e){var k=browser.KeyCode[e.keyCode];if(k){k=k.toUpperCase();var key=e.ctrlKey?"CTRL":"";e.altKey&&(key.length>0&&(key+="+"),key+="ALT"),e.shiftKey&&(key.length>0&&(key+="+"),key+="SHIFT"),e.metaKey&&(key.length>0&&(key+="+"),key+="META"),key.length>0&&(key+="+");var l=_accMap[key+=k];if(l)for(var i=0;i<l.length;i++)if(!1===tui.event.fire("accelerate",{name:l[i],event:e}))return}}function addAccelerate(key,actionId){key=key.toUpperCase();var l=null;_accMap.hasOwnProperty(key)?l=_accMap[key]:(l=[],_accMap[key]=l),l.indexOf(actionId)<0&&l.push(actionId)}function deleteAccelerate(key,actionId){if(key=key.toUpperCase(),_accMap.hasOwnProperty(key)){var l=_accMap[key],pos=l.indexOf(actionId);pos>=0&&(l.splice(pos,1),l.length<=0&&delete _accMap[key])}}function getUrlParam(key){var reg=new RegExp("(^|&)"+key+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(reg);return null!=r?decodeURIComponent(r[2]):null}function getEventPosition(e,allFingers){void 0===allFingers&&(allFingers=!1);var positions=[],event=e.originalEvent||e;if(event.touches)for(var touchList=allFingers?event.touches:event.changedTouches,i=0;i<touchList.length;i++){var touch=touchList[i];positions.push({x:touch.clientX,y:touch.clientY,id:touch.identifier})}else positions.push({x:event.clientX,y:event.clientY});return positions}function setInnerHtml(elem,content){if(tui.ieVer>0&&tui.ieVer<9){elem.innerHTML="";var d=tui.elem("div");for(d.innerHTML=content;d.children.length>0;)elem.appendChild(d.children[0])}else elem&&(elem.innerHTML=content)}function safeExec(code,context){function exclude(){for(var keys=[],_i=0;_i<arguments.length;_i++)keys[_i]=arguments[_i];for(var _a=0,keys_1=keys;_a<keys_1.length;_a++){var k=keys_1[_a];!namePattern.test(k)||context&&context.hasOwnProperty(k)||(c&&(c+=","),c+=k)}}var c="",argv=[];if(context)for(var k in context)context.hasOwnProperty(k)&&(c&&(c+=","),c+=k,argv.push(context[k]));var namePattern=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/;for(var k in window)exclude(k);var source="(function ("+c+"){\n"+code+"\n})",func=eval(source);func.apply(null,argv)}var BackupedScrollPosition=function(){function BackupedScrollPosition(target){this.backupInfo=[];for(var obj=target;obj&&obj!==document.body;)(obj=obj.parentElement)&&this.backupInfo.push({obj:obj,left:obj.scrollLeft,top:obj.scrollTop})}return BackupedScrollPosition.prototype.restore=function(){for(var i=0;i<this.backupInfo.length;i++){var item=this.backupInfo[i];item.obj.scrollLeft=item.left,item.obj.scrollTop=item.top}},BackupedScrollPosition}();browser.BackupedScrollPosition=BackupedScrollPosition,browser.backupScrollPosition=backupScrollPosition,browser.focusWithoutScroll=focusWithoutScroll,browser.scrollToElement=scrollToElement,browser.toElement=toElement,browser.toHTML=toHTML,browser.hasClass=hasClass,browser.addClass=addClass,browser.removeClass=removeClass,browser.removeNode=removeNode,browser.toSafeText=toSafeText,browser.getNodeText=getNodeText,browser.setNodeText=setNodeText,browser.getNodeOwnText=getNodeOwnText,browser.getRectOfParent=getRectOfParent,browser.getRectOfPage=getRectOfPage,browser.getRectOfScreen=getRectOfScreen,browser.getTopBody=getTopBody,browser.getWindow=getWindow,browser.getWindowScrollElement=getWindowScrollElement;var keepTopList=[];$(window).scroll(keepTopProc),browser.keepToTop=keepToTop,browser.cancelKeepToTop=cancelKeepToTop,browser.getCurrentStyle=getCurrentStyle,browser.isLButton=isLButton,browser.banBackspace=banBackspace,browser.isAncestry=isAncestry,browser.isPosterity=isPosterity,browser.isFireInside=isFireInside,browser.isInDoc=isInDoc,browser.saveCookie=saveCookie,browser.loadCookie=loadCookie,browser.deleteCookie=deleteCookie,browser.saveData=saveData,browser.loadData=loadData,browser.deleteData=deleteData;var _accMap={};browser.addAccelerate=addAccelerate,browser.deleteAccelerate=deleteAccelerate,$(document).keydown(accelerate),browser.getUrlParam=getUrlParam,browser.getEventPosition=getEventPosition,browser.setInnerHtml=setInnerHtml,browser.safeExec=safeExec,window.$safe=toSafeText}(browser=tui.browser||(tui.browser={}))}(tui||(tui={}));var tui;!function(tui){!function(browser){"use strict";!function(KeyCode){KeyCode[KeyCode.BACK=8]="BACK",KeyCode[KeyCode.TAB=9]="TAB",KeyCode[KeyCode.ENTER=13]="ENTER",KeyCode[KeyCode.SHIFT=16]="SHIFT",KeyCode[KeyCode.CTRL=17]="CTRL",KeyCode[KeyCode.ALT=18]="ALT",KeyCode[KeyCode.PAUSE=19]="PAUSE",KeyCode[KeyCode.CAPS=20]="CAPS",KeyCode[KeyCode.ESCAPE=27]="ESCAPE",KeyCode[KeyCode.SPACE=32]="SPACE",KeyCode[KeyCode.PRIOR=33]="PRIOR",KeyCode[KeyCode.NEXT=34]="NEXT",KeyCode[KeyCode.END=35]="END",KeyCode[KeyCode.HOME=36]="HOME",KeyCode[KeyCode.LEFT=37]="LEFT",KeyCode[KeyCode.UP=38]="UP",KeyCode[KeyCode.RIGHT=39]="RIGHT",KeyCode[KeyCode.DOWN=40]="DOWN",KeyCode[KeyCode.PRINT=44]="PRINT",KeyCode[KeyCode.INSERT=45]="INSERT",KeyCode[KeyCode.DELETE=46]="DELETE",KeyCode[KeyCode.KEY_0=48]="KEY_0",KeyCode[KeyCode.KEY_1=49]="KEY_1",KeyCode[KeyCode.KEY_2=50]="KEY_2",KeyCode[KeyCode.KEY_3=51]="KEY_3",KeyCode[KeyCode.KEY_4=52]="KEY_4",KeyCode[KeyCode.KEY_5=53]="KEY_5",KeyCode[KeyCode.KEY_6=54]="KEY_6",KeyCode[KeyCode.KEY_7=55]="KEY_7",KeyCode[KeyCode.KEY_8=56]="KEY_8",KeyCode[KeyCode.KEY_9=57]="KEY_9",KeyCode[KeyCode.SEMICOLON=59]="SEMICOLON",KeyCode[KeyCode.EQUALS=61]="EQUALS",KeyCode[KeyCode.A=65]="A",KeyCode[KeyCode.B=66]="B",KeyCode[KeyCode.C=67]="C",KeyCode[KeyCode.D=68]="D",KeyCode[KeyCode.E=69]="E",KeyCode[KeyCode.F=70]="F",KeyCode[KeyCode.G=71]="G",KeyCode[KeyCode.H=72]="H",KeyCode[KeyCode.I=73]="I",KeyCode[KeyCode.J=74]="J",KeyCode[KeyCode.K=75]="K",KeyCode[KeyCode.L=76]="L",KeyCode[KeyCode.M=77]="M",KeyCode[KeyCode.N=78]="N",KeyCode[KeyCode.O=79]="O",KeyCode[KeyCode.P=80]="P",KeyCode[KeyCode.Q=81]="Q",KeyCode[KeyCode.R=82]="R",KeyCode[KeyCode.S=83]="S",KeyCode[KeyCode.T=84]="T",KeyCode[KeyCode.U=85]="U",KeyCode[KeyCode.V=86]="V",KeyCode[KeyCode.W=87]="W",KeyCode[KeyCode.X=88]="X",KeyCode[KeyCode.Y=89]="Y",KeyCode[KeyCode.Z=90]="Z",KeyCode[KeyCode.WINDOWS=91]="WINDOWS",KeyCode[KeyCode.NUM_0=96]="NUM_0",KeyCode[KeyCode.NUM_1=97]="NUM_1",KeyCode[KeyCode.NUM_2=98]="NUM_2",KeyCode[KeyCode.NUM_3=99]="NUM_3",KeyCode[KeyCode.NUM_4=100]="NUM_4",KeyCode[KeyCode.NUM_5=101]="NUM_5",KeyCode[KeyCode.NUM_6=102]="NUM_6",KeyCode[KeyCode.NUM_7=103]="NUM_7",KeyCode[KeyCode.NUM_8=104]="NUM_8",KeyCode[KeyCode.NUM_9=105]="NUM_9",KeyCode[KeyCode.NUM_MUL=106]="NUM_MUL",KeyCode[KeyCode.NUM_PLUS=107]="NUM_PLUS",KeyCode[KeyCode.NUM_MINUS=109]="NUM_MINUS",KeyCode[KeyCode.NUM_DOT=110]="NUM_DOT",KeyCode[KeyCode.NUM_DIV=111]="NUM_DIV",KeyCode[KeyCode.F1=112]="F1",KeyCode[KeyCode.F2=113]="F2",KeyCode[KeyCode.F3=114]="F3",KeyCode[KeyCode.F4=115]="F4",KeyCode[KeyCode.F5=116]="F5",KeyCode[KeyCode.F6=117]="F6",KeyCode[KeyCode.F7=118]="F7",KeyCode[KeyCode.F8=119]="F8",KeyCode[KeyCode.F9=120]="F9",KeyCode[KeyCode.F10=121]="F10",KeyCode[KeyCode.F11=122]="F11",KeyCode[KeyCode.F12=123]="F12",KeyCode[KeyCode.DASH=173]="DASH",KeyCode[KeyCode.COMMA=188]="COMMA",KeyCode[KeyCode.PERIOD=190]="PERIOD",KeyCode[KeyCode.SLASH=191]="SLASH",KeyCode[KeyCode.GRAVE=192]="GRAVE",KeyCode[KeyCode.LEFT_BRACKET=219]="LEFT_BRACKET",KeyCode[KeyCode.BACKSLASH=220]="BACKSLASH",KeyCode[KeyCode.RIGHT_BRACKET=221]="RIGHT_BRACKET",KeyCode[KeyCode.QUOTE=222]="QUOTE"}(browser.KeyCode||(browser.KeyCode={}))}(tui.browser||(tui.browser={}))}(tui||(tui={}));var tui;!function(tui){var service;!function(service_1){"use strict";function parseParameters(fn,desc){var params="";if(desc)params=desc+"";else{var matched=fn.toString().match(/^\s*function\s*[a-zA-Z0-9_]*\s*\(([\sa-zA-Z0-9,_\$]*)\)/);matched?params=matched[1]:(matched=fn.toString().match(/^\s*\(([\sa-zA-Z0-9,_\$]*)\)\s*=>/))&&(params=matched[1])}return params||""}function getName(path){var begin=path.lastIndexOf("/");begin>=0&&(path=path.substr(begin+1));var end=path.lastIndexOf(".");return end>=0&&(path=path.substring(0,end)),tui.text.toCamel(path.replace(/[\-\s\.\/]/g,"_"))}function register(name,fn){var service=new Service;return service._constructor=fn,_services[name]=service,service}function ready(){for(var name_1 in _services)if(_services.hasOwnProperty(name_1)){var service_2=_services[name_1];service_2._constructor.call(service_2)}_serviceReady=!0;for(var _i=0,_readyCallbacks_1=_readyCallbacks;_i<_readyCallbacks_1.length;_i++)(0,_readyCallbacks_1[_i])()}service_1.parseParameters=parseParameters;var Service=function(_super){function Service(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Service,_super),Service.prototype.use=function(fn,desc){service.use.call(this,fn,desc)},Service}(tui.EventObject);service_1.Service=Service;var _services={},_serviceReady=!0,_readyCallbacks=[];service_1.use=function(fn,desc){if("function"==typeof fn){var argv=parseParameters(fn,desc).split(",").map(function(s){return s&&"$"===s[0]?tui.service.get(s.substr(1)):null});fn.apply(this,argv)}},service_1.load=function(services,names){_serviceReady=!1;for(var tasks=[],i=0;i<services.length;i++){var s=services[i],name=names&&names[i]||getName(s);tasks.push(tui.ajax.getFunction(s,name))}$.when.apply(null,tasks).done(function(){if(2===arguments.length&&"function"==typeof arguments[0])register(arguments[1],arguments[0]);else for(var i=0;i<arguments.length;i++){var p=arguments[i];register(p[1],p[0])}ready()}).fail(function(){_serviceReady=!0})},service_1.register=register,service_1.unregister=function(name){delete _services[name]},service_1.ready=ready,service_1.get=function(name){return _services[name]},service_1.onReady=function(fn){_serviceReady?fn():_readyCallbacks.push(fn)}}(service=tui.service||(tui.service={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var _maskOpened=!1,_mask=tui.elem("div");_mask.setAttribute("unselectable","on"),_mask.onselectstart=function(){return!1};var mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";$(_mask).on(mousewheelevt,function(ev){ev.stopPropagation(),ev.preventDefault()}),widget.getEventPosition=function(e){var positions=[],event=e.originalEvent||e;if(event.changedTouches)for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];positions.push({x:touch.clientX,y:touch.clientY})}else positions.push({x:event.clientX,y:event.clientY});return positions},widget.openDragMask=function(onMove,onClose){function closeDragMask(e){_maskOpened=!1,_mask.setCapture?$(_mask).off():($(document).off("mousemove touchmove",onMove),$(document).off("mouseup touchend",closeDragMask)),tui.browser.removeNode(_mask),"function"==typeof onClose&&onClose(e),e.preventDefault()}return void 0===onClose&&(onClose=null),_maskOpened?null:(_mask.innerHTML="",_mask.className="tui-mask",_mask.style.cursor="",_mask.removeAttribute("tabIndex"),_mask.removeAttribute("tooltip"),_mask.removeAttribute("fixed-tooltip"),document.body.appendChild(_mask),_mask.setCapture?(_mask.setCapture(),$(_mask).on("mousemove touchmove",onMove),$(_mask).on("mouseup touchend",closeDragMask)):($(document).on("mousemove touchmove",onMove),$(document).on("mouseup touchend",closeDragMask)),_maskOpened=!0,_mask)}}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){var widget;!function(widget_1){"use strict";function parseValue(value){if(null===value||0===value.length)return null;if(!/^\{(.|\r|\n)+\}$/m.test(value))return value;value=value.substring(1,value.length-1);try{return eval("("+value+")")}catch(e){return console&&console.error("Bad attribute: "+e),null}}function register(constructor,nodeName){"string"==typeof nodeName?widgetRegistration["tui:"+nodeName.toLowerCase()]=constructor:widgetRegistration["tui:"+tui.text.toDashSplit(getClassName(constructor))]=constructor}function get(id){if("object"==typeof id&&id.nodeName)return id.__widget__?id.__widget__:null;var elem=document.getElementById(id);return null===elem?namedWidgets[id]?namedWidgets[id]:null:elem.__widget__?elem.__widget__:null}function create(type,initParam){if("string"!=typeof type)throw new TypeError("Invalid parameters.");var constructor=widgetRegistration["tui:"+type.toLowerCase()];if("function"!=typeof constructor)throw new Error("Undefined type: "+type);var obj,element=tui.elem("tui:"+type);return(obj=typeof initParam!==tui.UNDEFINED?new constructor(element,initParam):new constructor(element)).set("autoRefresh",!0),obj}function getClassName(func){var results=/function\s+([^\s]+)\s*\(/.exec(func.toString());return results&&results.length>1?results[1]:""}function getFullName(targetElem){return targetElem.scopeName&&"tui"===targetElem.scopeName.toLowerCase()?null!==targetElem.nodeName.toLowerCase().match("^"+targetElem.scopeName+":")?targetElem.nodeName.toLowerCase():targetElem.scopeName+":"+targetElem.nodeName.toLowerCase():targetElem.nodeName.toLowerCase()}function init(parent,initFunc){function searchInitCtrls(parent){for(var i=0;i<parent.childNodes.length;i++){var node=parent.childNodes[i];if(1===node.nodeType){var elem_1=node,constructor=widgetRegistration[getFullName(elem_1)];if(constructor){var item=[elem_1,constructor];initSet.push(item)}else searchInitCtrls(elem_1)}}}var initSet=[];searchInitCtrls(parent);for(var _i=0,initSet_1=initSet;_i<initSet_1.length;_i++){var item=initSet_1[_i],elem_2=item[0],constructor=item[1];if(elem_2.__widget__)elem_2.__widget__.refresh();else{var widget_2=new constructor(elem_2);"function"==typeof initFunc?initFunc(widget_2)&&widget_2.set("autoRefresh",!0):widget_2.set("autoRefresh",!0)}}}function search(p1,p2){function searchElem(parent){for(var i=0;i<parent.childNodes.length;i++){var node=parent.childNodes[i];if(1===node.nodeType){var widget_4=node.__widget__;widget_4&&(filter&&filter(widget_4)||null===filter)?result.push(widget_4):searchElem(node)}}}var searchArea=null,filter=null;typeof p2===tui.UNDEFINED?"function"==typeof p1?filter=p1:"object"==typeof p1&&p1.nodeName&&(searchArea=p1):"function"==typeof p2&&(searchArea=p1,filter=p2);var result=[];return null===searchArea&&(searchArea=document.body),searchElem(searchArea),result}function registerResize(nodeName){resizeRegistration.push("tui:"+nodeName)}function registerParentResize(nodeName){parentResizeRegistration.push("tui:"+nodeName)}var WidgetBase=function(_super){function WidgetBase(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._data=undefined,_this._rs={},_this}return __extends(WidgetBase,_super),WidgetBase.prototype.setRestriction=function(key,propCtrl){null===propCtrl?delete this._rs[key]:this._rs[key]=propCtrl},WidgetBase.prototype.setRestrictions=function(restrictions){for(var key in restrictions)this.setRestriction(key,restrictions[key])},WidgetBase.prototype.refresh=function(){return!0===this.get("autoRefresh")&&this.render(),this},WidgetBase.prototype.load=function(){if(typeof this._data===tui.UNDEFINED){this._data={};var elem=this.getComponent();if(null!=elem){var dataStr=elem.getAttribute("props");try{var tmpData=eval("("+dataStr+")");if(tmpData instanceof Object)for(var key in tmpData)tmpData.hasOwnProperty(key)&&this._set(key,tmpData[key])}catch(e){console&&console.error("Bad props: "+e)}for(var names=[],i=0;i<elem.attributes.length;i++){var attr=elem.attributes[i];if(!/^(style|class|tooltip|follow-tooltip|__widget__|jquery[\d]+)$/.test(attr.name.toLowerCase())){var v=parseValue(attr.value);null!==v&&this._set(tui.text.toCamel(attr.name),v),/^(id|name)$/i.test(attr.name.toLowerCase())||names.push(attr.name)}}for(var _i=0,names_2=names;_i<names_2.length;_i++){var name_2=names_2[_i];elem.attributes.removeNamedItem(name_2),/^(onclick|onmousedown|onmouseup|onmousemove|ondblclick|onkeydown|onkeyup|onkeypress)$/i.test(name_2)&&(elem[name_2.toLowerCase()]=null)}}}},WidgetBase.prototype.get=function(key,defaultValue){var value;return typeof key===tui.UNDEFINED||null===key?value=this._data:"string"==typeof key&&(value=this._rs[key]&&"function"==typeof this._rs[key].get?this._rs[key].get():"object"==typeof this._data?this._data[key]:null),typeof value===tui.UNDEFINED&&(value=null),null===value&&typeof defaultValue!==tui.UNDEFINED?defaultValue:value},WidgetBase.prototype.set=function(p1,p2){return this._set(p1,p2),this.refresh(),this},WidgetBase.prototype._set=function(p1,p2){if(typeof p2===tui.UNDEFINED&&p1 instanceof Object)for(var key in p1)p1.hasOwnProperty(key)&&this._set(key,p1[key]);else"string"==typeof p1&&typeof p2!==tui.UNDEFINED&&(this._rs[p1]&&"function"==typeof this._rs[p1].set?this._rs[p1].set(p2):null===p2?this._data&&delete this._data[p1]:"object"==typeof this._data&&(this._data[p1]=p2));return this},WidgetBase.prototype.setInit=function(p1,p2){if(typeof p2===tui.UNDEFINED){if(p1 instanceof Object)for(var key in p1)p1.hasOwnProperty(key)&&null===this.get(key)&&this._set(key,p1[key])}else null===this.get(p1)&&this._set(p1,p2);return this},WidgetBase}(tui.EventObject);widget_1.WidgetBase=WidgetBase;var namedWidgets={},Widget=function(_super){function Widget(root,initParam){var _this=_super.call(this)||this;_this._lastWidth=null,_this._lastHeight=null,_this._lastParentWidth=null,_this._lastParentHeight=null,_this._components={},_this._components[""]=root,_this._=root,root.__widget__=_this,_this.initRestriction(),_this.load();for(var childNodes=[],i=0;i<root.childNodes.length;i++){var node=root.childNodes[i];childNodes.push(node)}for(var _i=0,childNodes_1=childNodes;_i<childNodes_1.length;_i++){var removeNode=childNodes_1[_i];tui.browser.removeNode(removeNode)}_this.initChildren(childNodes),typeof initParam!==tui.UNDEFINED&&_this._set(initParam),_this.init();var id=_this.get("id");return"string"==typeof id&&id.length>0&&(namedWidgets[id]=_this),_this}return __extends(Widget,_super),Widget.prototype.init=function(){},Widget.prototype.appendTo=function(parent,refresh){return void 0===refresh&&(refresh=!0),"string"==typeof parent&&(parent=document.getElementById(parent)),parent&&"object"==typeof parent&&parent.appendChild&&(parent.appendChild(this._),refresh&&this.set("autoRefresh",!0)),this},Widget.prototype.addClass=function(className){tui.browser.addClass(this._,className)},Widget.prototype.removeClass=function(className){tui.browser.removeClass(this._,className)},Widget.prototype.detach=function(){tui.browser.removeNode(this._)},Widget.prototype.initChildren=function(childNodes){},Widget.prototype.initRestriction=function(){var _this=this;this.setRestrictions({id:{set:function(value){var oldId=_this._.getAttribute("id");oldId&&delete namedWidgets[oldId],"string"==typeof value&&value.length>0?(namedWidgets[value]=_this,_this._.setAttribute("id",value)):_this._.removeAttribute("id")},get:function(){return _this._.getAttribute("id")}},name:{set:function(value){"string"==typeof value&&value.length>0?_this._.setAttribute("name",value):_this._.removeAttribute("name")},get:function(){return _this._.getAttribute("name")}},parent:{get:function(){for(var elem=_this._.parentNode;elem;){if(elem.__widget__)return elem.__widget__;elem=elem.parentNode}return null},set:function(value){}},disable:{get:function(){var v=_this._data.disable;if(null===v||typeof v===tui.UNDEFINED){var parent_1=_this.get("parent");return parent_1&&(v=parent_1.get("disable")),null!==v&&!!v}return v}},group:{get:function(){if(!0===_this.get("inner"))return null;if(_this._data.group)return _this._data.group;var parent=_this.get("parent");return parent&&parent instanceof widget_1.Group&&parent.get("name")?parent.get("name"):null}},tooltip:{set:function(value){value?_this._.setAttribute("tooltip",value):_this._.removeAttribute("tooltip")},get:function(){return _this._.getAttribute("tooltip")}},"follow-tooltip":{set:function(value){value?_this._.setAttribute("follow-tooltip",value):_this._.removeAttribute("follow-tooltip")},get:function(){return _this._.getAttribute("follow-tooltip")}}})},Widget.prototype.testResize=function(){tui.browser.isInDoc(this._)&&(this._.offsetWidth!=this._lastWidth?(this._lastWidth=this._.offsetWidth,this._lastHeight=this._.offsetHeight,this.fire("resize")):this._.offsetHeight!=this._lastHeight&&(this._lastWidth=this._.offsetWidth,this._lastHeight=this._.offsetHeight,this.fire("resize")))},Widget.prototype.testParentResize=function(){if(tui.browser.isInDoc(this._)){var p=this._.parentElement,type=0;p.clientWidth!=this._lastParentWidth&&(this._lastParentWidth=p.clientWidth,type+=1),p.clientHeight!=this._lastParentHeight&&(this._lastParentHeight=p.clientHeight,type+=2),type&&this.fire("parentresize",{type:type,parentWidth:this._lastParentWidth,parentHeight:this._lastParentHeight})}},Widget.prototype.getComponent=function(name){return arguments.length>0?this._components[name]:this._components[""]},Widget.prototype.focus=function(){this._.focus()},Widget}(WidgetBase);widget_1.Widget=Widget;var Item=function(_super){function Item(root){var _this=_super.call(this)||this;return _this._=root,_this.load(),_this}return __extends(Item,_super),Item.prototype.getComponent=function(name){return arguments.length>0?null:this._},Item.prototype.render=function(){},Item}(WidgetBase);widget_1.Item=Item;var widgetRegistration={};widget_1.register=register,widget_1.get=get,window.$$=get,widget_1.create=create,window.$new=create,widget_1.getClassName=getClassName,widget_1.getFullName=getFullName,widget_1.init=init,widget_1.search=search;var resizeRegistration=[],parentResizeRegistration=[];widget_1.registerResize=registerResize,widget_1.registerParentResize=registerParentResize;var detectResize;$(window.document).ready(function(){tui.service.onReady(function(){init(document.body),tui.event.fire("initialized")}),detectResize="string"==typeof document.body.scopeName&&tui.ieVer<9?function(){for(i=0;i<parentResizeRegistration.length;i++)for(var nodes=document.getElementsByTagName(parentResizeRegistration[i].substr(4)),j=0;j<nodes.length;j++)"TUI"===(node=nodes[j]).scopeName.toUpperCase()&&node.__widget__&&node.__widget__.testParentResize();for(var i=0;i<resizeRegistration.length;i++)for(var nodes=document.getElementsByTagName(resizeRegistration[i].substr(4)),j=0;j<nodes.length;j++){var node=nodes[j];"TUI"===node.scopeName.toUpperCase()&&node.__widget__&&node.__widget__.testResize()}requestAnimationFrame(detectResize)}:function(){for(i=0;i<parentResizeRegistration.length;i++)for(var nodes=document.getElementsByTagName(parentResizeRegistration[i]),j=0;j<nodes.length;j++)(node=nodes[j]).__widget__&&node.__widget__.testParentResize();for(var i=0;i<resizeRegistration.length;i++)for(var nodes=document.getElementsByTagName(resizeRegistration[i]),j=0;j<nodes.length;j++){var node=nodes[j];node.__widget__&&node.__widget__.testResize()}requestAnimationFrame(detectResize)},requestAnimationFrame(detectResize)})}(widget=tui.widget||(tui.widget={}))}(tui||(tui={})),function(tui){tui.get=tui.widget.get,tui.create=tui.widget.create,tui.search=tui.widget.search}(tui||(tui={}));var tui;!function(tui){!function(exp){function getPredefined(key){var token=TEMPLATE[key];if(token){var ret={};for(var k in token)ret[k]=token[k];return ret}return null}function parseString(str){return(str=str.substr(1,str.length-2)).replace(/\\(.)/gm,function(s,w){switch(w){case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\x0B";case"f":return"\f";case"b":return"\b";default:return w}})}function formatMsg(match){var msg=match[0].substr(0,20);return"(pos: "+match.index+"): ----\x3e "+msg+" <----"}function addPos(token,pos){return token.pos=pos,token}function findIndex(match){for(var i=1;i<match.length;i++)if("string"==typeof match[i])return i-1}var OPType;!function(OPType){OPType[OPType.COMMA=0]="COMMA",OPType[OPType.AND=1]="AND",OPType[OPType.OR=2]="OR",OPType[OPType.NOT=3]="NOT",OPType[OPType.CP=4]="CP",OPType[OPType.PLUMIN=5]="PLUMIN",OPType[OPType.MULDIV=6]="MULDIV",OPType[OPType.SIGN=7]="SIGN",OPType[OPType.FN=8]="FN",OPType[OPType.LP=9]="LP",OPType[OPType.RP=10]="RP",OPType[OPType.EOF=11]="EOF"}(OPType=exp.OPType||(exp.OPType={}));var LexType,TEMPLATE={and:{type:"operator",operator:"and",operatorType:OPType.AND},or:{type:"operator",operator:"or",operatorType:OPType.OR},not:{type:"operator",operator:"not",operatorType:OPType.NOT},"true":{type:"constant",value:!0},"false":{type:"constant",value:!1},"null":{type:"constant",value:null},"=":{type:"operator",operator:"=",operatorType:OPType.CP},"!=":{type:"operator",operator:"!=",operatorType:OPType.CP},"~":{type:"operator",operator:"~",operatorType:OPType.CP},"!~":{type:"operator",operator:"!~",operatorType:OPType.CP},">":{type:"operator",operator:">",operatorType:OPType.CP},">=":{type:"operator",operator:">=",operatorType:OPType.CP},"<":{type:"operator",operator:"<",operatorType:OPType.CP},"<=":{type:"operator",operator:"<=",operatorType:OPType.CP},"+":{type:"operator",operator:"+",operatorType:OPType.PLUMIN},"-":{type:"operator",operator:"-",operatorType:OPType.PLUMIN},"*":{type:"operator",operator:"*",operatorType:OPType.MULDIV},"/":{type:"operator",operator:"/",operatorType:OPType.MULDIV},"(":{type:"operator",operator:"(",operatorType:OPType.LP},")":{type:"operator",operator:")",operatorType:OPType.RP},",":{type:"operator",operator:",",operatorType:OPType.COMMA}},LEXER_REGEX=/(\s+)|((?:true|false|null|and|or|not)(?=\W|$))|([a-zA-Z_]\w*(?:\.\w+)*(?=\s*\())|([a-zA-Z_]\w*(?:\.\w+)*)|(<=|>=|!=|!~|[,\-+*/=~<>()])|(\d+(?:\.\d+)?)|("(?:[^"]|\\")*"|'(?:[^']|\\')*')|(.+)/gm;!function(LexType){LexType[LexType.SPACE=0]="SPACE",LexType[LexType.KEYWORD=1]="KEYWORD",LexType[LexType.FN=2]="FN",LexType[LexType.ID=3]="ID",LexType[LexType.OP=4]="OP",LexType[LexType.NUM=5]="NUM",LexType[LexType.STR=6]="STR",LexType[LexType.UNKNOW=7]="UNKNOW"}(LexType||(LexType={}));var Parser=function(){function Parser(source){this._last=null,this._input=source,this._rex=new RegExp(LEXER_REGEX)}return Parser.prototype.reset=function(){this._rex.lastIndex=0,this._last=null},Parser.prototype.next=function(){for(var match;null!=(match=this._rex.exec(this._input));){var type=findIndex(match);if(type!=LexType.SPACE){if(type==LexType.FN)return this._last={type:"function",name:match[0],operator:"fn",operatorType:OPType.FN,pos:match.index},this._last;if(type==LexType.ID||type==LexType.KEYWORD)return(token=getPredefined(match[0]))?(this._last=addPos(token,match.index),this._last):(this._last={type:"variable",name:match[0],pos:match.index},this._last);if(type==LexType.NUM)return this._last={type:"constant",value:parseFloat(match[0]),pos:match.index},this._last;if(type==LexType.STR)return this._last={type:"constant",value:parseString(match[0]),pos:match.index},this._last;if(type==LexType.OP){var op=match[0];if(("+"==op||"-"==op)&&(null==this._last||"operator"==this._last.type&&")"!=this._last.operator))return this._last={type:"operator",operator:"+"==op?"positive":"negative",operatorType:OPType.SIGN,pos:match.index},this._last;var token=getPredefined(op);if(token)return this._last=addPos(token,match.index),this._last;throw new Error("Internal error: Undefined operator: "+formatMsg(match))}throw new Error("Unexpected token: "+formatMsg(match))}}return{type:"operator",operator:"eof",operatorType:OPType.EOF,pos:this._input.length}},Parser}();exp.Parser=Parser}(tui.exp||(tui.exp={}))}(tui||(tui={}));var tui;!function(tui){var exp;!function(exp_1){function getPriority(opQueue,opScan){return PRIORITIES[opQueue*(exp.OPType.EOF+1)+opScan]}function isVal(node){return"constant"==node.type||"variable"==node.type}function makeNode(token){var node=token;return node.isUnary="not"==node.operator||"fn"==node.operator||"positive"==node.operator||"negative"==node.operator,node}function parse(expression){function formatMsg(pos){return"(pos: "+pos+"): ----\x3e "+expression.substr(pos,20)+" <----"}if("string"!=typeof expression)throw new Error("Invalid parameter, should be expression!");for(var valStack=[],opStack=[{type:"operator",operator:"eof",operatorType:exp.OPType.EOF,pos:0}],last=opStack[0],lexer=new exp.Parser(expression);;){var current=makeNode(lexer.next());if(isVal(current)){if(isVal(last)||")"==last.operator)throw new Error("Unexpected token: "+formatMsg(current.pos));valStack.push(current)}else for(;;){var priority=getPriority(opStack[opStack.length-1].operatorType,current.operatorType);if(priority==E)throw"eof"==current.operator?new Error("Unexpected EOF: "+current.pos):new Error("Unexpected token: "+formatMsg(current.pos));if(priority==L){opStack.push(current);break}if(priority!=H){opStack.pop();break}if(opStack.length<1)throw new Error("Unexpected operator: "+formatMsg(current.pos));var op=opStack.pop();if(valStack.length<1){if("function"!=op.type)throw new Error("Unexpected operator: "+formatMsg(op.pos))}else if((val=valStack.pop()).pos>op.pos)op.right=val;else{if("function"!=op.type)throw new Error("Unexpected operator: "+formatMsg(op.pos));valStack.push(val)}if(!op.isUnary){if(valStack.length<1)throw new Error("Unexpected operator: "+formatMsg(op.pos));var val=valStack.pop();if(!(val.pos<op.pos))throw new Error("Unexpected operator: "+formatMsg(op.pos));op.left=val}valStack.push(op)}if(last=current,"eof"==current.operator)break}if(1!=valStack.length)throw new Error("Unexpected EOF: "+last.pos);if(0!=opStack.length)throw new Error("Unexpected operator: "+formatMsg(opStack.pop().pos));return valStack[0]}var Priority,H=1,L=0,E=-1;!function(Priority){Priority[Priority.High=H]="High",Priority[Priority.Low=L]="Low",Priority[Priority.Error=E]="Error",Priority[Priority.Same=-2]="Same"}(Priority||(Priority={}));var PRIORITIES=[H,L,L,L,L,L,L,L,L,L,H,H,H,H,H,L,L,L,L,L,L,L,H,H,H,L,H,L,L,L,L,L,L,L,H,H,H,H,H,L,H,H,H,L,L,L,H,H,H,H,H,L,H,L,L,L,L,L,H,H,H,H,H,L,H,H,L,L,L,L,H,H,H,H,H,L,H,H,H,L,L,L,H,H,H,H,H,L,H,H,H,L,L,L,H,H,H,H,H,E,H,H,H,E,E,L,H,H,L,L,L,L,L,L,L,L,L,L,-2,E,H,H,H,H,H,H,H,H,E,E,H,H,L,L,L,L,L,L,L,L,L,L,E,-2];exp_1.parse=parse;var CALCULATOR={"+":function(l,r){return l+r},"-":function(l,r){return l-r},"*":function(l,r){return l*r},"/":function(l,r){return l/r},"=":function(l,r){return l==r},"!=":function(l,r){return l!=r},"~":function(l,r){return new RegExp(r+"").test(l+"")},"!~":function(l,r){return!new RegExp(r+"").test(l+"")},">":function(l,r){return l>r},">=":function(l,r){return l>=r},"<":function(l,r){return l<r},"<=":function(l,r){return l<=r},",":function(l,r){return r},not:function(l,r){return!r},positive:function(l,r){return+r},negative:function(l,r){return-r}};exp_1.evaluate=function(exp,resolver){function evalArgs(node){var args=[];return null==node?args:(","==node.operator?(","==node.left.operator?args=args.concat(evalArgs(node.left)):args.push(evalNode(node.left)),args.push(evalNode(node.right))):args.push(evalNode(node)),args)}function evalNode(node){if(!node)return null;if("function"==node.type){if("function"!=typeof resolver)throw new Error("Cannot evaluate function: '"+node.name+"': no resolver provide!");var args=evalArgs(node.right);return resolver({name:node.name,type:"function",args:args})}if("variable"==node.type){if("function"!=typeof resolver)throw new Error("Cannot evaluate variable: '"+node.name+"': no resolver provide!");return resolver({name:node.name,type:"variable"})}if("constant"==node.type)return node.value;if("and"==node.operator)return evalNode(node.left)&&evalNode(node.right);if("or"==node.operator)return evalNode(node.left)||evalNode(node.right);var cacl=CALCULATOR[node.operator];if(cacl)return cacl(evalNode(node.left),evalNode(node.right));throw new Error("Unexpected operator: '"+node.operator+"': internal error!")}var root;if("string"==typeof exp)root=parse(exp);else{if(!(exp instanceof Node))throw new Error("Invalid parameter, should be expression or exp tree!");root=exp}return evalNode(root)},exp_1.processStandardFunc=function(id){if("len"==id.name){if(id.args.length<1)throw new Error("Invalid parameter for function 'len()'");return(v=id.args[0])instanceof Array?v.length:null==v?0:(v+"").length}if("has"==id.name){if(id.args.length<2)throw new Error("Invalid parameter for function 'has()'");if(null==(arr=id.args[0]))return!1;for(arr instanceof Array||(arr=[arr]),i=1;i<id.args.length;i++)for(var t=id.args[i],_i=0,arr_1=arr;_i<arr_1.length;_i++)if(t==(v=arr_1[_i]))return!0;return!1}if("hasAll"==id.name){if(id.args.length<2)throw new Error("Invalid parameter for function 'hasAll()'");if(null==(arr=id.args[0]))return!1;arr instanceof Array||(arr=[arr]);for(var i=1;i<id.args.length;i++){for(var t=id.args[i],find=!1,_a=0,arr_2=arr;_a<arr_2.length;_a++){var v=arr_2[_a];if(t==v){find=!0;break}}if(!find)return!1}return!0}if("get"==id.name){if(id.args.length<2)throw new Error("Invalid parameter for function 'get()'");var obj=id.args[0];if(null==obj)return null;if(obj instanceof Object||obj instanceof Array)return obj[k=id.args[1]];throw new Error("Invalid parameter for function 'get()'")}if("getAll"==id.name){if(id.args.length<2)throw new Error("Invalid parameter for function 'getAll()'");var arr=id.args[0];if(null==arr)return null;arr instanceof Array||(arr=[arr]);for(var k=id.args[1],result=[],_b=0,arr_3=arr;_b<arr_3.length;_b++){var item=arr_3[_b];result.push(item[k])}return result}throw new Error("Invalid expression: Undefined function: '"+id.name+"()'")}}(exp=tui.exp||(tui.exp={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function makeHandler(item){var itemHandler={getValue:function(){return item&&item.available?item.getValue(null):null},setValue:function(v){return item.setValue(v)},getLabel:function(){return item.define.label},setLabel:function(label){item.define.label=label,item.update()},getKey:function(){return item.define.key},getDefinition:function(){return item?tui.clone(item.define,"value"):null},setDefinition:function(definition){if(item&&"object"==typeof definition){for(var k in definition)definition.hasOwnProperty(k)&&!/^type|key|value$/.test(k)&&(item.define[k]=definition[k]);item.update(),item.applySize()}}};return"function"==typeof Object.defineProperty&&(-1===tui.ieVer||tui.ieVer>=9)&&(Object.defineProperty(itemHandler,"value",{get:function(){return this.getValue()},set:function(v){this.setValue(v)}}),Object.defineProperty(itemHandler,"label",{get:function(){return this.getLabel()},set:function(v){this.setLabel(v)}}),Object.defineProperty(itemHandler,"key",{get:function(){return this.getKey()}})),itemHandler}var _controls={},namePattern=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/,Form=function(_super){function Form(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._formulaContext={callStacks:0,cacheValue:null},_this}return __extends(Form,_super),Form.register=function(type,controlType){_controls[type]=controlType},Form.getType=function(type){return _controls[type]},Form.prototype.removeAll=function(){for(var _i=0,_a=this._items;_i<_a.length;_i++)_a[_i].hide();this._items=[],this._scripts={}},Form.prototype.hideAll=function(){for(var _i=0,_a=this._items;_i<_a.length;_i++)_a[_i].hide()},Form.prototype.selectItem=function(target){for(var _i=0,_a=this._items;_i<_a.length;_i++){var item=_a[_i];item!==target?item.select(!1):item.select(!0)}},Form.prototype.getItem=function(index){if("number"==typeof index)return index>=0&&index<this._items.length?this._items[index]:null;if("string"==typeof index){for(var _i=0,_a=this._items;_i<_a.length;_i++){var item=_a[_i];if(item.getKey()===index)return item}return null}return null},Form.prototype.getSelectedItem=function(){for(var _i=0,_a=this._items;_i<_a.length;_i++){var item=_a[_i];if(item.isSelect())return item}return null},Form.prototype.setScript=function(key,formula){key&&("string"==typeof formula&&formula?this._scripts[key]=formula:delete this._scripts[key],this._valueChanged=!0,this.render())},Form.prototype.removeScript=function(key){delete this._scripts[key],this.render()},Form.prototype.getScript=function(key){return this._scripts[key]},Form.prototype.addItem=function(type,label,pos){void 0===label&&(label=null),void 0===pos&&(pos=-1);var c=_controls[type];null!==label&&label!==undefined||(label=tui.str(c.desc));for(var define={type:type,label:label},key=type+ ++this._maxId;this.getItem(key);)key=type+ ++this._maxId;if(define.key=key,c.init)for(var k in c.init)c.init.hasOwnProperty(k)&&(define[k]=c.init[k]);var newItem=new c(this,define);newItem.update(),pos<0||pos>=this._items.length?this._items.push(newItem):this._items.splice(pos,0,newItem),this.update(),this.selectItem(newItem),this._valueChanged=!0},Form.prototype.removeItem=function(target){var pos=this._items.indexOf(target);pos>=0&&(this._items.splice(pos,1),target.hide(),this._valueChanged=!0,this.render())},Form.prototype.getItemIndex=function(target){return this._items.indexOf(target)},Form.prototype.selectNext=function(){for(var found=!1,i=0;i<this._items.length;i++)if(this._items[i].isSelect()&&(found=!0,i<this._items.length-1))return this._items[i].select(!1),this._items[i+1].select(!0),!0;return!found&&this._items.length>0&&(this._items[0].select(!0),!0)},Form.prototype.selectPrevious=function(){for(var found=!1,i=0;i<this._items.length;i++)if(this._items[i].isSelect()&&(found=!0,i>0))return this._items[i].select(!1),this._items[i-1].select(!0),!0;return!found&&this._items.length>0&&(this._items[0].select(!0),!0)},Form.prototype.update=function(){this._.style.height=this._.offsetHeight+"px",this.hideAll(),this.render(),this._.style.height=null},Form.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this._items=[],this._scripts={},this._valueCache=null,this._autoResizeTimer=null,this._parentWidth=null,this.setRestrictions({mode:{set:function(value){if(/^(design|input|view)$/.test(value)&&value!=_this.get("mode")){_this._data.mode=value,_this._valueChanged=!0;for(var _i=0,_a=_this._items;_i<_a.length;_i++)_a[_i].update()}},get:function(){return _this._data.mode||"input"}},definition:{set:function(value){if(value instanceof Array){_this.removeAll();for(var _i=0,_a=value;_i<_a.length;_i++){var define=_a[_i];if("script"===define.type&&define.key&&define.value){var v=_this._scripts[define.key];_this._scripts[define.key]=v?v+"\n"+define.value:define.value}else{var cstor=_controls[define.type];if(cstor){var item=new cstor(_this,define);item.update(),_this._items.push(item)}}}}else null===value&&_this.removeAll();_this._valueChanged=!0},get:function(){for(var result=[],_i=0,_a=_this._items;_i<_a.length;_i++){var item=_a[_i];result.push(item.define)}for(var k in _this._scripts)if(_this._scripts.hasOwnProperty(k)){var v=_this._scripts[k];result.push({type:"script",key:k,value:v,label:null})}return result}},value:{set:function(value){if(null===value)for(var _i=0,_a=_this._items;_i<_a.length;_i++)(item=_a[_i]).setValue(null);else if("object"==typeof value)for(var _b=0,_c=_this._items;_b<_c.length;_b++){var item=_c[_b],k=item.getKey();k&&value.hasOwnProperty(k)&&item.setValue(value[k])}_this._valueChanged=!0},get:function(){function computeValue(key,searchPath){if(!index.hasOwnProperty(key))throw new Error('Invalid expression: Field "'+key+'" was not found in "'+searchPath[searchPath.length-1]+"\"'s condition expression.");var exp=me._items[index[key]].define.condition;if(exp){if(searchPath.indexOf(key)>=0)throw new Error('Invalid expression: Cycle reference was detected on field: "'+key+'"');searchPath.push(key);try{tui.exp.evaluate(exp,function(id){return"function"==id.type?tui.exp.processStandardFunc(id):me._valueCache.hasOwnProperty(id.name)?me._valueCache[id.name]:(computeValue(id.name,searchPath),me._valueCache[id.name])})?(searchPath.pop(),me._valueCache[key]=me._items[index[key]].getValue({cache:me._valueCache,calc:computeValue,path:searchPath}),me._items[index[key]].available=!0):(searchPath.pop(),me._valueCache[key]=null,me._items[index[key]].available=!1)}catch(e){throw new Error(e.message+" ("+key+")")}}else me._valueCache[key]=me._items[index[key]].getValue({cache:me._valueCache,calc:computeValue,path:searchPath}),me._items[index[key]].available=!0}var index,me=_this;if(_this._valueChanged||null===_this._valueCache){_this._valueCache={},index={};for(i=0;i<_this._items.length;i++)if(k=_this._items[i].getKey()){if(index.hasOwnProperty(k))throw new Error('Duplicate field name was found: "'+k+'".');index[k]=i}for(var k in index)index.hasOwnProperty(k)&&computeValue(k,[]);for(i=0;i<_this._items.length;i++)!function(i){var item=_this._items[i];null===item.getKey()&&(item.define.condition?tui.exp.evaluate(item.define.condition,function(id){if("function"==id.type)return tui.exp.processStandardFunc(id);if(me._valueCache.hasOwnProperty(id.name))return me._valueCache[id.name];throw new Error('Invalid expression: Field "'+id.name+'" not found in control['+i+"] condition.")})?(item.available=!0,item.getValue({cache:me._valueCache,calc:computeValue,path:[]})):item.available=!1:(item.available=!0,item.getValue({cache:me._valueCache,calc:computeValue,path:[]})))}(i);var f=_this._scripts.formula;if(f){if(_this._formulaContext.callStacks>30)throw new Error("Invalid formula: call stacks should not exceed 30!");for(var formulaValueCache=[],i=0;i<_this._items.length;i++)_this._items[i].available&&formulaValueCache.push(_this._items[i].define.value);var cacheStr=tui.stringify(formulaValueCache);if(_this._formulaContext.cacheValue!=cacheStr){_this._formulaContext.callStacks++,_this._formulaContext.cacheValue=cacheStr;try{for(var cells={},params={cells:cells},i=0;i<_this._items.length;i++)cells[i]=makeHandler(_this._items[i]),null!=(k=_this._items[i].getKey())&&(cells[k]=cells[i],namePattern.test(k)&&(params[k]=cells[i]));tui.browser.safeExec(f,params)}catch(e){throw new Error("Invalid formula: "+e)}finally{_this._formulaContext.callStacks--,0==_this._formulaContext.callStacks&&(_this._formulaContext.cacheValue=null)}}}return _this._valueChanged=!1,_this._valueCache}return _this._valueCache}}})},Form.prototype.init=function(){var _this=this;this._maxId=0,this._.setAttribute("unselectable","on");var newItem=this._components.newitem=tui.elem("div");newItem.className="tui-form-new-item-box",(this._components.errmsg=tui.elem("div")).className="tui-form-error",$(this._).mousedown(function(){tui.ieVer>0&&"design"===_this.get("mode")&&tui.browser.focusWithoutScroll(_this._)}),$(this._).on("keydown",function(e){"design"===_this.get("mode")&&(9===e.keyCode?(e.shiftKey?_this.selectPrevious():_this.selectNext(),e.preventDefault()):e.keyCode===tui.browser.KeyCode.DELETE&&(_this.removeItem(_this.getSelectedItem()),e.preventDefault()))}),this.on("resize",function(){_this.computeSize(),_this.render()}),this.on("itemremove",function(e){_this.removeItem(e.data.control)}),this.on("itemresize",function(e){_this.render()}),this.on("itemmoveup",function(e){var pos=_this._items.indexOf(e.data.control);if(pos>0){var tmp=_this._items[pos];_this._items[pos]=_this._items[pos-1],_this._items[pos-1]=tmp,_this.update()}}),this.on("itemmovedown",function(e){var pos=_this._items.indexOf(e.data.control);if(pos>=0&&pos<_this._items.length-1){var tmp=_this._items[pos];_this._items[pos]=_this._items[pos+1],_this._items[pos+1]=tmp,_this.update()}});var firstPoint=null,oldRect=null;this.on("itemmousemove",function(e){var ev=e.data.e;if(ev.preventDefault(),tui.browser.isLButton(ev)&&firstPoint&&e.data.control==firstPoint.ctrl&&(Math.abs(ev.clientX-firstPoint.x)>=5||Math.abs(ev.clientY-firstPoint.y)>=5)){var ctrl=e.data.control,pos=_this._items.indexOf(ctrl),placeholder=tui.elem("div");placeholder.className="tui-form-item-placeholder";var divStyle=tui.browser.getCurrentStyle(ctrl.div);placeholder.style.display=divStyle.display,placeholder.style.clear=divStyle.clear,tui.browser.hasClass(ctrl.div,"tui-form-item-newline")&&tui.browser.addClass(placeholder,"tui-form-item-newline"),tui.browser.hasClass(ctrl.div,"tui-form-item-pull-left")&&(tui.browser.addClass(placeholder,"tui-form-item-pull-left"),placeholder.style.display="inline-block"),tui.browser.hasClass(ctrl.div,"tui-form-item-pull-right")&&(tui.browser.addClass(placeholder,"tui-form-item-pull-right"),placeholder.style.display="inline-block"),placeholder.style.width=ctrl.div.offsetWidth+"px",placeholder.style.height=ctrl.div.offsetHeight+"px",oldRect=tui.browser.getRectOfScreen(ctrl.div);var curWidth=ctrl.div.offsetWidth-parseFloat(divStyle.paddingLeft)-parseFloat(divStyle.paddingRight);ctrl.div.style.position="fixed",ctrl.div.style.zIndex="100",ctrl.div.style.opacity="0.8",ctrl.div.style.filter="alpha(opacity=80)",ctrl.div.style.left=oldRect.left+"px",ctrl.div.style.top=oldRect.top+"px";var savedWidth=ctrl.div.style.width;ctrl.div.style.width=curWidth+"px",tui.browser.addClass(ctrl.div,"tui-form-item-moving"),_this._.insertBefore(placeholder,ctrl.div);var targetIndex=null;tui.widget.openDragMask(function(e){ctrl.div.style.left=oldRect.left+e.clientX-firstPoint.x+"px",ctrl.div.style.top=oldRect.top+e.clientY-firstPoint.y+"px";for(var i=0;i<_this._items.length;i++){var item=_this._items[i];if(item!==ctrl){var testHeight="block"===tui.browser.getCurrentStyle(item.div).display||"block"===placeholder.style.display,rc=tui.browser.getRectOfScreen(item.div);if(testHeight){if(e.clientX>rc.left&&e.clientX<rc.left+rc.width&&e.clientY>rc.top&&e.clientY<rc.top+rc.height/2){_this._.insertBefore(placeholder,item.div),targetIndex=i;break}if(e.clientX>rc.left&&e.clientX<rc.left+rc.width&&e.clientY>rc.top+rc.height/2&&e.clientY<rc.top+rc.height){_this._.insertBefore(placeholder,item.div.nextSibling),targetIndex=i+1;break}}else{if(e.clientX>rc.left&&e.clientX<rc.left+rc.width/2&&e.clientY>rc.top&&e.clientY<rc.top+rc.height){_this._.insertBefore(placeholder,item.div),targetIndex=i;break}if(e.clientX>rc.left+rc.width/2&&e.clientX<rc.left+rc.width&&e.clientY>rc.top&&e.clientY<rc.top+rc.height){_this._.insertBefore(placeholder,item.div.nextSibling),targetIndex=i+1;break}}}}},function(e){firstPoint=null,ctrl.div.style.position="",ctrl.div.style.zIndex="",ctrl.div.style.opacity="",ctrl.div.style.filter="",ctrl.div.style.left="",ctrl.div.style.top="",ctrl.div.style.width=savedWidth,tui.browser.removeClass(ctrl.div,"tui-form-item-moving"),_this._.removeChild(placeholder),null!=targetIndex&&targetIndex!=pos&&(_this._items.splice(pos,1),targetIndex<pos?_this._items.splice(targetIndex,0,ctrl):_this._items.splice(targetIndex-1,0,ctrl),_this.update())})}}),this.on("itemmousedown",function(e){var ev=e.data.e;firstPoint=tui.browser.isLButton(ev)?{x:ev.clientX,y:ev.clientY,ctrl:e.data.control}:null,_this.selectItem(e.data.control)}),this.on("itemmouseup",function(e){firstPoint=null}),this.on("itemadd",function(e){var pos=_this._items.indexOf(e.data.control);pos>=0&&_this.addNewItem(e.data.button._,pos)}),this.on("itemvaluechanged",function(e){_this._valueChanged=!0,_this.render()}),newItem.onclick=function(){_this.addNewItem(newItem,_this._items.length)},this.computeSize()},Form.prototype.computeSize=function(){this.removeClass("tui-size-1 tui-size-2 tui-size-3 tui-size-4 tui-size-5 tui-size-6");var pw=$(this._).width(),s=Form.ITEM_SIZE,i=Math.floor(pw/s);i<1&&(i=1),i>6&&(i=6);var c="tui-size-"+i;this.addClass(c)},Form.prototype.bindNewItemClick=function(popup,newItemDiv,type,pos){var _this=this;newItemDiv.onclick=function(){_this.addItem(type,null,pos),popup.close()}},Form.prototype.addNewItem=function(button,pos){var div=tui.elem("div");div.setAttribute("unselectable","on"),div.className="tui-form-new-item-menu";var controls=[];for(var type in _controls)_controls.hasOwnProperty(type)&&controls.push({type:type,name:_controls[type].desc,icon:_controls[type].icon,order:_controls[type].order});controls.sort(function(a,b){return a.order-b.order});for(var popup=widget.create("popup"),usePlugins=!1,_i=0,controls_1=controls;_i<controls_1.length;_i++){var c=controls_1[_i];if(!usePlugins&&c.order>=100){usePlugins=!0;var hr=tui.elem("hr");div.appendChild(hr)}var itemDiv=tui.elem("div"),itemIcon=tui.elem("span"),label=tui.elem("div");itemDiv.appendChild(itemIcon),itemDiv.appendChild(label),itemIcon.className="fa "+c.icon,label.innerHTML=tui.browser.toSafeText(tui.str(c.name)),div.appendChild(itemDiv),this.bindNewItemClick(popup,itemDiv,c.type,pos)}popup._set("content",div),popup.open(button)},Form.prototype.validate=function(){for(var result=!0,_i=0,_a=this._items;_i<_a.length;_i++){var item=_a[_i];item.available&&!item.validate()&&(result=!1)}return this.render(),result},Form.prototype.render=function(){var newItem=this._components.newitem;tui.browser.removeNode(newItem);var errmsg=this._components.errmsg;tui.browser.removeNode(errmsg);var designMode="design"===this.get("mode");if(!designMode)try{this.get("value")}catch(e){return this.hideAll(),errmsg.innerHTML=tui.browser.toSafeText(e.message+""),void this._.appendChild(errmsg)}for(var folded=!1,_i=0,_a=this._items;_i<_a.length;_i++)(item=_a[_i]).isPresent()||item.show(),item.setDesign(designMode),designMode?tui.browser.removeClass(item.div,"tui-form-item-unavailable"):(item.select(!1),item.available?tui.browser.removeClass(item.div,"tui-form-item-unavailable"):tui.browser.addClass(item.div,"tui-form-item-unavailable")),tui.browser.removeClass(item.div,"tui-form-item-exceed"),designMode?(tui.browser.removeClass(item.div,"tui-hidden"),item.updateIndex(this.getItemIndex(item)),item.render(designMode)):"section"!=item.define.type?folded?tui.browser.addClass(item.div,"tui-hidden"):(tui.browser.removeClass(item.div,"tui-hidden"),item.render(designMode)):(folded=!("folder"!=item.define.display||!item.define.folded),item.render(designMode));var cfs=tui.browser.getCurrentStyle(this._);if("none"!=cfs.display)for(var pad=parseFloat(cfs.paddingLeft)+parseFloat(cfs.paddingRight),_b=0,_c=this._items;_b<_c.length;_b++){var item=_c[_b];item.div.offsetWidth>this._.clientWidth-pad&&(tui.browser.addClass(item.div,"tui-form-item-exceed"),item.render(designMode))}designMode?(this._.appendChild(newItem),this._.setAttribute("tabIndex","0"),tui.browser.addClass(this._,"tui-form-design-mode")):(this._.removeAttribute("tabIndex"),tui.browser.removeClass(this._,"tui-form-design-mode"))},Form.ITEM_SIZE=260,Form}(widget.Widget);widget.Form=Form,widget.register(Form,"form"),widget.registerResize("form")}(tui.widget||(tui.widget={}))}(tui||(tui={})),function(tui){"use strict";tui.inputbox=function(define,title,initValue,callback,maxWidth){var container=tui.elem("div"),form=tui.create("form");form._.className="number"==typeof maxWidth&&maxWidth>=1&&maxWidth<=5?"tui-form-max-"+maxWidth:"tui-form-property-form",form.set("definition",define),initValue&&"function"!=typeof initValue&&form.set("value",initValue),container.appendChild(form._);var dialog=tui.create("dialog");return dialog._set("content",container),title&&dialog._set("title",title),dialog.open("ok#tui-primary"),dialog.on("btnclick",function(e){if("ok"===e.data.button){if(form.validate()){if("function"==typeof initValue&&(callback=initValue),"function"==typeof callback){var result=callback(form.get("value"));if(0==result)return;if("object"==typeof result&&"function"==typeof result.done)return void result.then(function(){dialog.close()})}dialog.close()}}else"cancel"===e.data.button&&dialog.close()}),dialog.form=form,dialog}}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function reorder(){tui.browser.removeNode(_mask),widget.dialogStack.length>0&&document.body.insertBefore(_mask,widget.dialogStack[widget.dialogStack.length-1]._)}function push(dlg){widget.dialogStack.push(dlg),document.body.appendChild(dlg._),reorder()}function remove(dlg){var index=widget.dialogStack.indexOf(dlg);index>=0&&widget.dialogStack.splice(index,1),document.body.removeChild(dlg._),reorder()}function getParent(dlg){var index=widget.dialogStack.indexOf(dlg);if(!(index>0))return null;widget.dialogStack[index-1]}function disableSelect(){return!1}widget.dialogStack=[];var _mask=tui.elem("div");_mask.className="tui-dialog-mask",_mask.setAttribute("unselectable","on");var mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";$(_mask).on(mousewheelevt+" selectstart",function(ev){ev.stopPropagation(),ev.preventDefault()});var Dialog=function(_super){function Dialog(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._sizeTimer=null,_this._contentSize=null,_this._moved=!1,_this._init=!0,_this}return __extends(Dialog,_super),Dialog.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this._calc=!1,this.setRestrictions({content:{set:function(value){_this._data.content=value,_this._components.content&&_this.setContent(value,!1)}}})},Dialog.prototype.initChildren=function(childNodes){if(childNodes.length>0){for(var div=tui.elem("div"),_i=0,childNodes_2=childNodes;_i<childNodes_2.length;_i++){var node=childNodes_2[_i];div.appendChild(node)}this._set("content",div)}},Dialog.prototype.init=function(){var _this=this,root$=$(this._);root$.attr("tabIndex","-1"),root$.html("<div class='tui-title-bar' unselectable='on'><span class='tui-text'></span><span class='tui-close'></span></div><div class='tui-content'></div><div class='tui-button-bar'></div>");var titleBar=this._components.titleBar=root$.children(".tui-title-bar")[0],contentDiv=this._components.content=root$.children(".tui-content")[0],buttonBar=this._components.buttonBar=root$.children(".tui-button-bar")[0],closeIcon=this._components.closeIcon=$(titleBar).children(".tui-close")[0];titleBar.onselectstart=disableSelect,buttonBar.onselectstart=disableSelect;var content=this.get("content");"object"==typeof content&&content&&content.nodeName?contentDiv.appendChild(content):"string"==typeof content&&(contentDiv.innerHTML=content),this.setInit("esc",!0),widget.init(contentDiv),closeIcon.onclick=function(){_this.close()},tui.browser.removeNode(this._),$(titleBar).on("mousedown",function(e){if((e.target||e.srcElement)!==closeIcon&&!(_this.get("mobileModel")&&_mask.offsetWidth<=580)){var dialogX=_this._.offsetLeft,dialogY=_this._.offsetTop,beginX=e.clientX,beginY=e.clientY,winSize={width:_mask.offsetWidth,height:_mask.offsetHeight};tui.widget.openDragMask(function(e){var l=dialogX+e.clientX-beginX,t=dialogY+e.clientY-beginY;l>winSize.width-_this._.offsetWidth&&(l=winSize.width-_this._.offsetWidth),l<0&&(l=0),t>winSize.height-_this._.offsetHeight&&(t=winSize.height-_this._.offsetHeight),t<0&&(t=0),_this._.style.left=l+"px",_this._.style.top=t+"px",_this._moved=!0},function(e){_this.render()})}}),root$.on(mousewheelevt,function(ev){ev.stopPropagation()})},Dialog.prototype.setContent=function(content,render){void 0===render&&(render=!0);for(var contentDiv=this._components.content;contentDiv.childNodes.length>0;)contentDiv.removeChild(contentDiv.lastChild);"object"==typeof content&&content.nodeName?(content.style.display="block",contentDiv.appendChild(content)):"string"==typeof content&&(contentDiv.innerHTML=content),render&&this._calc&&this.render()},Dialog.prototype.setButtons=function(buttonDef,render){var _this=this;void 0===buttonDef&&(buttonDef=null),void 0===render&&(render=!0);var buttonBar=this._components.buttonBar;if(buttonBar.innerHTML="","string"==typeof buttonDef&&buttonDef.length>0){for(var _i=0,names_3=buttonDef.split(",");_i<names_3.length;_i++)!function(name_3){var pair=name_3.split("#"),btn=widget.create("button",{text:tui.str($.trim(pair[0]))});pair.length>1&&$.trim(pair[1]).length>0&&(btn._.className=pair[1]),btn.on("click",function(e){_this.fire("btnclick",{e:e,button:$.trim(pair[0])})}),btn.appendTo(buttonBar)}(names_3[_i]);buttonBar.style.display="block"}else buttonBar.style.display="none";render&&this._calc&&this.render()},Dialog.prototype.open=function(buttonDef){var _this=this;if(void 0===buttonDef&&(buttonDef=null),!this.get("opened")){this._set("opened",!0),this._calc=!1;var contentDiv=this._components.content;return this._init=!0,this._moved=!1,$(this._).css({top:"3000px",left:"0",right:"0",display:"block",position:"fixed"}),push(this),this.get("mobileModel")&&$(this._).css({top:_mask.offsetHeight+1+"px"}),this.setButtons(buttonDef,!1),widget.init(contentDiv),this._.focus(),setTimeout(function(){$(_this._).css({left:"",right:""}),_this.render(),_this._calc=!0,_this.fire("open"),_this._sizeTimer=setInterval(function(){null!=_this._contentSize&&(contentDiv.scrollHeight===_this._contentSize.height&&contentDiv.scrollWidth===_this._contentSize.width||_this.refresh())},50)}),this}},Dialog.prototype.close=function(){if(this.get("opened"))return clearInterval(this._sizeTimer),this._sizeTimer=null,this._moved=!1,this._contentSize=null,remove(this),this._set("opened",!1),this.fire("close"),this},Dialog.prototype.render=function(){if(this.get("opened")){var titleBar=this._components.titleBar,buttonBar=this._components.buttonBar,contentDiv=this._components.content,closeIcon=this._components.closeIcon,mobileModel=this.get("mobileModel");if(mobileModel?this.addClass("tui-dialog-mobile-model"):this.removeClass("tui-dialog-mobile-model"),null!==this.get("title")||this.get("esc")){titleBar.style.display="block",this.get("esc")?closeIcon.style.display="inline-block":closeIcon.style.display="none";var titleText=$(titleBar).children(".tui-text")[0];titleText.innerHTML=null!==this.get("title")?this.get("title"):"",tui.ieVer>=7&&tui.ieVer<9&&(titleText.style.width="",titleText.style.width=titleText.offsetWidth+"px")}else titleBar.style.display="none";var winSize={width:_mask.offsetWidth,height:_mask.offsetHeight},root=this._,root$=$(root);if(contentDiv.style.maxHeight="",root$.css({maxWidth:winSize.width+"px",maxHeight:winSize.height+"px"}),mobileModel&&winSize.width<=580){var mobileSize={width:winSize.width-40+"px",height:winSize.height-titleBar.offsetHeight-buttonBar.offsetHeight-$(contentDiv).outerHeight()+$(contentDiv).height()+"px"};mobileSize.maxWidth=mobileSize.minWidth=mobileSize.width,mobileSize.maxHeight=mobileSize.minHeight=mobileSize.height,$(contentDiv).css(mobileSize)}else $(contentDiv).css({width:"",height:"",maxWidth:winSize.width-40+"px",maxHeight:winSize.height-40-titleBar.offsetHeight-buttonBar.offsetHeight-$(contentDiv).outerHeight()+$(contentDiv).height()+"px",minWidth:winSize.width<=580?winSize.width-80+"px":"none",minHeight:""});var box={left:root.offsetLeft,top:root.offsetTop,width:root.offsetWidth,height:root.offsetHeight};if(this._init){var centX,centY,parent=getParent(this);if(parent){var e=parent._;centX=e.offsetLeft+e.offsetWidth/2,centY=e.offsetTop+e.offsetHeight/2,this._moved=!0}else centX=winSize.width/2,centY=winSize.height/2,this._moved=!1;box.left=centX-box.width/2,box.top=centY-box.height/2,this._init=!1}else this._moved||(box.left=(winSize.width-box.width)/2,box.top=(winSize.height-box.height)/2);box.left+box.width>winSize.width&&(box.left=winSize.width-box.width),box.top+box.height>winSize.height&&(box.top=winSize.height-box.height),box.left<0&&(box.left=0),box.top<0&&(box.top=0),this._.style.left=box.left+"px",this._.style.top=box.top+"px",this._contentSize={width:contentDiv.scrollWidth,height:contentDiv.scrollHeight}}},Dialog}(widget.Widget);widget.Dialog=Dialog,widget.register(Dialog,"dialog"),$(document).on("keydown",function(e){var k=e.keyCode;if(!(widget.dialogStack.length<=0)){var dlg=widget.dialogStack[widget.dialogStack.length-1];k===tui.browser.KeyCode.ESCAPE?dlg.get("esc")&&dlg.close():k===tui.browser.KeyCode.TAB&&setTimeout(function(){tui.browser.isPosterity(dlg._,document.activeElement)||dlg._.focus()})}}),$(window).resize(function(){for(var i=0;i<widget.dialogStack.length;i++)widget.dialogStack[i].refresh()})}(tui.widget||(tui.widget={}))}(tui||(tui={})),function(tui){"use strict";function makeContent(message){return message?tui.text.format("<div class='tui-msg-container'><span></span><div name='dialogMsgDiv'>{0}</div></div>",tui.browser.toSafeText(message)):tui.text.format("<div class='tui-msg-container'><span></span></div>")}function makeDialog(message,className,title,btn,callback,esc){void 0===btn&&(btn="ok#tui-primary"),void 0===callback&&(callback=null),void 0===esc&&(esc=!0);var dlg=tui.widget.create("dialog",{content:makeContent(message),title:title,esc:esc});return $(dlg._).addClass(className),dlg.on("btnclick",function(e){dlg.close(),callback&&callback(e.data.button)}),dlg.open(btn),dlg}tui.msgbox=function(message,title){return void 0===title&&(title=null),makeDialog(message,"tui-msg-box",title)},tui.infobox=function(message,title){void 0===title&&(title=tui.str("note"));var titleText="<i class='tui-dialog-title-info'></i>";return title&&(titleText+=title),makeDialog(message,"tui-info-box",titleText)},tui.okbox=function(message,title){void 0===title&&(title=tui.str("success"));var titleText="<i class='tui-dialog-title-ok'></i>";return title&&(titleText+=title),makeDialog(message,"tui-ok-box",titleText)},tui.errbox=function(message,title){void 0===title&&(title=tui.str("error"));var titleText="<i class='tui-dialog-title-error'></i>";return title&&(titleText+=title),makeDialog(message,"tui-err-box",titleText)},tui.warnbox=function(message,title){void 0===title&&(title=tui.str("warning"));var titleText="<i class='tui-dialog-title-warning'></i>";return title&&(titleText+=title),makeDialog(message,"tui-warn-box",titleText)},tui.askbox=function(message,title,callback){"function"==typeof title?(callback=title,title=tui.str("confirm")):null!=title&&typeof title!==tui.UNDEFINED||(title=tui.str("confirm"));var titleText="<i class='tui-dialog-title-ask'></i>";return titleText+=title,makeDialog(message,"tui-ask-box",titleText,"cancel,ok#tui-primary",function(buttonName){"function"==typeof callback&&callback("ok"===buttonName)})};var refCount=0,waitDlg=null,waitMsg=null;tui.waitbox=function(message){null==waitDlg?(refCount=0,waitMsg=[message],waitDlg=makeDialog(message,"tui-wait-box",null,null,null,!1)):(waitMsg.push(message),$(waitDlg.getComponent("content")).find("div[name='dialogMsgDiv']").text(message),setTimeout(function(){waitDlg&&waitDlg.refresh()}));var index=waitMsg.length-1;refCount++;var closed=!1;return{close:function(){if(!closed){refCount--,closed=!0,waitMsg[index]=null;for(var i=index-1;i>=0;i--)if(null!=waitMsg[i]){waitDlg.setContent(makeContent(waitMsg[i]));break}0===refCount&&(waitDlg.close(),waitDlg=null,waitMsg=null)}},setMessage:function(message){closed||(waitMsg[index]=message,index===waitMsg.length-1&&waitDlg.setContent(makeContent(message)))}}},tui.progressbox=function(message,cancelProc){return void 0===cancelProc&&(cancelProc=null),null}}(tui||(tui={}));var tui;!function(tui){var ajax;!function(ajax){function send(url,method,data,options){var deffered=$.Deferred(),waitbox=null;options&&options.silent||(waitbox=tui.waitbox(tui.str("Processing...")));var ajaxData={type:method.toUpperCase(),url:url,contentType:"application/json",data:"GET"===method.toUpperCase()?data:tui.stringify(data),complete:function(jqXHR,status){if(waitbox&&waitbox.close(),"success"===status){var respVal=/^\s*application\/json\s*(;.+)?/i.test(jqXHR.getResponseHeader("content-type"))?jqXHR.responseJSON:jqXHR.responseText;deffered.resolve(respVal,jqXHR)}else{var respText;respText=/^\s*text\/plain\s*(;.+)?/i.test(jqXHR.getResponseHeader("content-type"))&&jqXHR.responseText?tui.str(jqXHR.responseText):0!=jqXHR.status?tui.str(status)+" ("+jqXHR.status+")":"Operation was canceled!",options&&options.silent||0==jqXHR.status||tui.errbox(respText),deffered.reject(jqXHR.status,respText,jqXHR)}},processData:!1};if(options)for(var k in options)options.hasOwnProperty(k)&&(ajaxData[k]=options[k]);return $.ajax(ajaxData),deffered}function post(url,data,options){return send(url,"post",data,options)}function post_(url,data,options){return options?options.silent=!0:options={silent:!0},send(url,"post",data,options)}function get(url,options){return send(url,"get",null,options)}function get_(url,options){return options?options.silent=!0:options={silent:!0},send(url,"get",null,options)}function getScript(url){var deffered=$.Deferred(),xhr=new XMLHttpRequest;return xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status?deffered.resolve(xhr.responseText,xhr):deffered.reject(xhr.status,xhr.responseText,xhr))},xhr.open("GET",url,!0),xhr.send(null),deffered}function getHtmlBody(result){if(null==result||0==result.length)return tui.elem("body");TAG.lastIndex=0;for(var m,bodyStart=null,bodyEnd=null;null!=(m=TAG.exec(result));){var tag=m[1].toLowerCase();if("script"===tag){if(SCRIPT_END.lastIndex=TAG.lastIndex,null==SCRIPT_END.exec(result))break;TAG.lastIndex=SCRIPT_END.lastIndex}else"body"===tag?bodyStart=TAG.lastIndex:"/body"===tag?bodyEnd=m.index:"/html"===tag&&null==bodyEnd&&(bodyEnd=m.index)}null!=bodyStart&&(result=null!=bodyEnd&&bodyEnd>=bodyStart?result.substring(bodyStart,bodyEnd):result.substring(bodyStart));var body=tui.elem("body");return body.innerHTML=result,body}function getBody(url){var deffered=$.Deferred();return getScript(url).done(function(result){deffered.resolve(getHtmlBody(result).innerHTML)}).fail(function(status,responseText,xhr){deffered.reject(status,responseText,xhr)}),deffered}function getComponent(url){var deffered=$.Deferred();return getScript(url).done(function(result){for(var body=getHtmlBody(result),i=0;i<body.children.length;i++){var child=body.children[i];if("tui:component"===tui.widget.getFullName(child)){var handler=child.getAttribute("handler");return handler&&handler.trim()&&(tui.text.isAbsUrl(handler)||(handler=tui.text.joinUrl(tui.text.getBaseUrl(url),handler))),void deffered.resolve(child.innerHTML,handler||null)}}deffered.resolve(body.innerHTML)}).fail(function(status,responseText,xhr){deffered.reject(status,responseText,xhr)}),deffered}function getFunction(url,param){var deffered=$.Deferred();return getScript(url).done(function(result){var fn=eval("(0,function(){\n"+result+"})\n//# sourceURL="+url);deffered.resolve(fn,param)}).fail(function(status,responseText,xhr){deffered.reject(status,responseText,xhr)}),deffered}$.ajaxSetup({timeout:3e4,xhrFields:{withCredentials:!0}}),ajax.send=send,ajax.post=post,ajax.post_=post_,ajax.get=get,ajax.get_=get_,ajax.getScript=getScript;var TAG=/<(\/?[a-z0-9_\-:]+)(\s+[a-z0-9_\-]+(\s*=('[^']*'|"[^"]*"|[^\s>]+)))*\/?>/gim,SCRIPT_END=/<\/\s*script(\s+[a-z0-9_\-]+(\s*=('[^']*'|"[^"]*"|[^\s>]+)))*>/gim;ajax.getBody=getBody,ajax.getComponent=getComponent,ajax.getFunction=getFunction,window.$ajax=send,window.$post=post,window.$post_=post_,window.$get=get,window.$get_=get_}(ajax=tui.ajax||(tui.ajax={}))}(tui||(tui={}));var tui;!function(tui){!function(browser){"use strict";function hashChange(e){e&&e.preventDefault();var hash=location.hash,state=null;if(hash){var p=hash.indexOf("?");state=p>=0?hash.substring(1,p):hash.substring(1)}if(_rules){for(var matchRule=null,_i=0,_rules_1=_rules;_i<_rules_1.length;_i++)if((r=_rules_1[_i]).state===state){matchRule=r;break}if(null==matchRule)for(var _a=0,_rules_2=_rules;_a<_rules_2.length;_a++){var r=_rules_2[_a];if("/"===r.state){matchRule=r;break}}if(matchRule){if(matchRule.handler&&!1===matchRule.handler(matchRule.state,hash,matchRule.url))return;_handler&&_handler(matchRule.state,hash,matchRule.url)}}}var _rules,_handler;browser.startRouter=function(rules,handler){return _rules=rules,_handler=handler,$(window).on("hashchange",hashChange),$(window).on("onpopstate",hashChange),tui.event.on("initialized",function(){hashChange()}),tui.service.register("router",function(){var stack=[],this_=this;this.push=function(state){stack.push(state),location.href="#"+state},this.pop=function(){stack.length>0&&(stack.pop(),history.back(),stack.length>0&&this_.go(stack[stack.length-1]))},this.goRoot=function(state){var len=stack.length;stack.length=0,history.go(-len),this_.go(state)},this.go=function(state){0==stack.length?stack.push(state):(stack.pop(),stack.push(state)),location.replace("#"+state)}})},browser.stopRouter=function(){$(window).off("hashchange",hashChange),tui.service.unregister("router")}}(tui.browser||(tui.browser={}))}(tui||(tui={}));var tui;!function(tui){var browser;!function(browser){"use strict";function fileFromPath(file){return file.replace(/.*(\/|\\)/,"")}function getExt(file){return-1!==file.indexOf(".")?file.replace(/.*[.]/,""):""}function preventDefault(e){return e.preventDefault()}function createUploader(container,options){return new Uploader(container,options)}var Uploader=function(_super){function Uploader(container,options){var _this=_super.call(this)||this;if(_this._settings={action:"%UPLOAD_PATH%",name:"file",multiple:!1,autoSubmit:!0},_this._container=null,_this._input=null,_this.setOptions(options),!container||1!==container.nodeType)throw new Error("Please make sure that you're passing a valid element");return"a"===container.nodeName.toLowerCase()&&$(container).on("click",function(e){e.preventDefault()}),_this._container=container,_this._input=null,_this}return __extends(Uploader,_super),Uploader.prototype.setOptions=function(options){if(options)for(var i in options)options.hasOwnProperty(i)&&(this._settings[i]=options[i])},Uploader.prototype.getOptions=function(){return this._settings},Uploader.prototype.createIframe=function(){var id=tui.tuid(),iframe=browser.toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute("id",id),iframe.style.display="none",document.body.appendChild(iframe);var doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document;try{doc.charset="utf-8"}catch(e){}return iframe},Uploader.prototype.createForm=function(iframe){var settings=this._settings,form=browser.toElement('<form method="post" enctype="multipart/form-data" accept-charset="UTF-8"></form>');return form.setAttribute("accept-charset","UTF-8"),settings.action&&form.setAttribute("action",tui.useEnv(settings.action)),form.setAttribute("target",iframe.name),form.style.display="none",document.body.appendChild(form),form},Uploader.prototype.createInput=function(){var _this=this;if(!this._input){var input=tui.elem("input");input.setAttribute("type","file"),this._settings.accept&&input.setAttribute("accept",this._settings.accept),input.setAttribute("name",this._settings.name),tui.ieVer>0?input.setAttribute("title",""):input.setAttribute("title"," "),this._settings.multiple&&input.setAttribute("multiple","multiple"),$(input).css({position:"absolute",right:0,top:0,height:"1000px",width:"2000px",margin:0,padding:0,opacity:0,filter:"alpha(opacity=0)",fontSize:"10000px",fontFamily:"sans-serif",cursor:"pointer"}),$(input).on("change",function(e){if(input&&""!==input.value){var file=fileFromPath(input.value),fileExt=getExt(file);!1!==_this.fire("change",{e:e,file:file,ext:fileExt})?_this._settings.autoSubmit&&_this.submit():_this.clearInput()}}),"static"===browser.getCurrentStyle(this._container).position&&(this._container.style.position="relative"),this._container.style.overflow="hidden",this._container.appendChild(input),this._input=input,$(this._input).focus(function(){_this.fire("focus")}),$(this._input).blur(function(){_this.fire("blur")})}},Uploader.prototype.deleteInput=function(){this._input&&(browser.removeNode(this._input),this._input=null)},Uploader.prototype.getInput=function(){return this._input},Uploader.prototype.clearInput=function(){this.deleteInput(),this.createInput()},Uploader.prototype.processResponse=function(iframe,file){var _this=this,waitbox=tui.waitbox(tui.str("Uploading...")),toDeleteFlag=!1,settings=this._settings;$(iframe).on("load",function(){if("javascript:'%3Chtml%3E%3C/html%3E';"!==iframe.src&&"javascript:'<html></html>';"!==iframe.src){var doc;try{if((doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document).readyState&&"complete"!==doc.readyState)return void waitbox.close();if(doc.body&&"false"===doc.body.innerHTML)return void waitbox.close()}catch(err){return waitbox.close(),_this.fireError(tui.str("message.invalid.file")),toDeleteFlag=!0,iframe.src="javascript:'<html></html>';",void browser.removeNode(iframe)}waitbox.close();var response;if(doc.body){response=doc.body.innerHTML;try{if(doc.body.firstChild&&"PRE"===doc.body.firstChild.nodeName.toUpperCase()&&(doc.normalize&&doc.normalize(),response=doc.body.firstChild.firstChild.nodeValue),response){var responseObj=eval("("+response+")");responseObj?responseObj.error?_this.fireError(responseObj.error):responseObj.fileId&&responseObj.fileName?_this.fire("success",{file:file,ext:getExt(file),response:responseObj}):_this.fireError():_this.fireError()}else _this.fireError()}catch(e){_this.fireError()}}else _this.fireError();toDeleteFlag=!0,iframe.src="javascript:'<html></html>';",browser.removeNode(iframe)}else toDeleteFlag&&setTimeout(function(){browser.removeNode(iframe)},0)})},Uploader.prototype.fireInvalidError=function(){this.fire("error",{response:{error:tui.str("Upload failed: invalid response content!")}})},Uploader.prototype.fireError=function(errorMessage){this.fire("error",{response:{error:tui.str("message.upload.failed")+(errorMessage||"")}})},Uploader.prototype.uploadV5=function(file,fileObject,extraData){var _this=this,waitbox=tui.waitbox(tui.str("Uploading...")),fd=new FormData;if(fd.append(this._settings.name,fileObject),extraData)for(var key in extraData)extraData.hasOwnProperty(key)&&fd.append(key,extraData[key]);var xhr=new XMLHttpRequest;xhr.upload.addEventListener("progress",function(e){if(e.lengthComputable){var percentComplete=Math.round(100*e.loaded/e.total);waitbox.setMessage(tui.str("Uploading... ")+percentComplete.toString()+"%")}},!1),xhr.addEventListener("load",function(e){if(waitbox.close(),200!=e.target.status)_this.fire("error",{file:file,ext:getExt(file),response:{error:tui.str(e.target.response||e.target.statusText||e.target.status)}});else try{var result=JSON.parse(e.target.responseText);result.fileId&&result.fileName?_this.fire("success",{file:file,ext:getExt(file),response:result}):_this.fireError()}catch(e){_this.fireInvalidError()}},!1),xhr.addEventListener("error",function(e){waitbox.close(),_this.fireError()},!1),xhr.addEventListener("abort",function(e){waitbox.close(),_this.fireError()},!1),xhr.open("POST",tui.useEnv(this._settings.action)),xhr.send(fd)},Uploader.prototype.submitV5=function(file,extraData){if(this._input.files.length>0){var fileObject=this._input.files[0];this.uploadV5(file,fileObject,extraData)}this.clearInput()},Uploader.prototype.submitV4=function(file,extraData){var iframe=this.createIframe(),form=this.createForm(iframe);if(form.appendChild(this._input),extraData)for(var prop in extraData)if(extraData.hasOwnProperty(prop)){var el=tui.elem("input");el.setAttribute("type","hidden"),el.setAttribute("name",prop),el.setAttribute("value",extraData[prop]),form.appendChild(el)}this.processResponse(iframe,file),form.submit(),browser.removeNode(form),form=null,this.clearInput()},Uploader.prototype.submit=function(extraData){if(this._input&&""!==this._input.value){var file=fileFromPath(this._input.value);if(!1===this.fire("submit",{file:file,ext:getExt(file)}))return this.clearInput(),void this.fire("blur");this.fire("blur"),"function"==typeof FormData?this.submitV5(file,extraData):this.submitV4(file,extraData)}},Uploader}(tui.EventObject);browser.Uploader=Uploader,browser.createUploader=createUploader}(browser=tui.browser||(tui.browser={}))}(tui||(tui={}));var tui;!function(tui){!function(ds){"use strict";function filter(value,filter){if(filter)for(var _i=0,filter_1=filter;_i<filter_1.length;_i++){var f=filter_1[_i],v=value[f.key];if(null==v){if(null==f.value)continue;return!1}try{var regex=new RegExp(f.value,"i");if(null==v.toString().match(regex))return!1}catch(e){if(v.indexOf(f.value)<0)return!1}}return!0}function sort(data,order,treeData){order&&order.length>0&&data.sort(function(a,b){for(var _i=0,order_1=order;_i<order_1.length;_i++){var s=order_1[_i],aVal=treeData?a.item[s.key]:a[s.key],bVal=treeData?b.item[s.key]:b[s.key];if(aVal!=bVal)return s.desc?aVal>bVal?-1:1:aVal<bVal?-1:1}return 0})}var DSBase=function(_super){function DSBase(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._finalData=null,_this._order=null,_this._filter=null,_this}return __extends(DSBase,_super),DSBase.prototype.setOrder=function(order){this._order=order,this.build()},DSBase.prototype.getOrder=function(){return this._order},DSBase.prototype.setFilter=function(filter){this._filter=filter,this.build()},DSBase.prototype.getFilter=function(){return this._filter},DSBase}(tui.EventObject);ds.DSBase=DSBase;var List=function(_super){function List(data,filter,order){void 0===filter&&(filter=null),void 0===order&&(order=null);var _this=_super.call(this)||this;return _this._data=data,_this._filter=filter,_this._order=order,_this.build(),_this}return __extends(List,_super),List.prototype.length=function(){return null==this._finalData?this._data.length:this._finalData.length},List.prototype.get=function(index){return null==this._finalData?this._data[index]:this._finalData[index]},List.prototype.build=function(){var _this=this;null!=this._data?(null!=this._filter&&0!=this._filter.length||null!=this._order&&0!=this._order.length?(this._finalData=this._data.filter(function(value,index,array){return filter(value,_this._filter)}),sort(this._finalData,this._order,!1)):this._finalData=null,this.fire("update",{completely:!0})):this._finalData=null},List}(DSBase);ds.List=List;var RemoteList=function(_super){function RemoteList(cacheSize,filter,order){void 0===cacheSize&&(cacheSize=50),void 0===filter&&(filter=null),void 0===order&&(order=null);var _this=_super.call(this)||this;return _this._cache1=null,_this._cache2=null,_this._length=null,_this._cacheSize=cacheSize,_this.reset(),_this._filter=filter,_this._order=order,_this}return __extends(RemoteList,_super),RemoteList.prototype.length=function(){var _this=this;return null===this._length?(null!=this._queryTimer&&clearTimeout(this._queryTimer),this._queryTimer=setTimeout(function(){_this.fire("query",{begin:0,size:_this._cacheSize,filter:_this._filter,order:_this._order})},16),0):this._length},RemoteList.prototype.get=function(index){var _this=this;if(!(index>=0&&index<this.length()))return null;var item=this.getFromCache(index,this._cache1);if(null===item&&(item=this.getFromCache(index,this._cache2)),null!==item)return item;var page=this.getIndexPage(index);null===this._cache1?this._fillCache=1:null===this._cache2?this._fillCache=2:this._fillCache=Math.abs(page-this._cache1.page)>Math.abs(page-this._cache2.page)?1:2,null!=this._queryTimer&&clearTimeout(this._queryTimer),this._queryTimer=setTimeout(function(){_this.fire("query",{begin:page*_this._cacheSize,size:_this._cacheSize,filter:_this._filter,rder:_this._order}),_this._queryTimer=null},16)},RemoteList.prototype.getIndexPage=function(index){return Math.ceil((index+1)/this._cacheSize-1)},RemoteList.prototype.getFromCache=function(index,cache){if(null===cache)return null;var begin=cache.page*this._cacheSize,end=begin+cache.data.length;return index>=begin&&index<end?cache.data[index-begin]:null},RemoteList.prototype.update=function(result){var completely=this._length!=result.length;this._length=result.length,1===this._fillCache?this._cache1={page:this.getIndexPage(result.begin),data:result.data}:2===this._fillCache&&(this._cache2={page:this.getIndexPage(result.begin),data:result.data}),this.fire("update",{completely:completely})},RemoteList.prototype.reset=function(){this._length=null,this._cache1=this._cache2=null,this._fillCache=1},RemoteList.prototype.build=function(){this.reset(),this.fire("query",{begin:0,size:this._cacheSize,filter:this._filter,order:this._order})},RemoteList}(DSBase);ds.RemoteList=RemoteList;var TreeBase=function(_super){function TreeBase(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._index=null,_this._rawData=null,_this}return __extends(TreeBase,_super),TreeBase.prototype.getConfig=function(){return this._config},TreeBase.prototype.length=function(){return this._finalData?this._finalData.length:this._index?this._index.length:0},TreeBase.prototype.getRawData=function(){return this._rawData},TreeBase.prototype.get=function(index){return this._finalData?index>=0&&index<this._finalData.length?this._finalData[index]:null:index>=0&&index<this.length()?this._index[index]:null},TreeBase.prototype.findNodeIndex=function(node){for(var i=0;i<this._index.length;i++)if(this._index[i]===node)return i;return-1},TreeBase.prototype.expandItems=function(parent,items,index,level,init){void 0===init&&(init=!1),typeof items!==tui.UNDEFINED&&null!==items||(items=[]);for(var _i=0,items_1=items;_i<items_1.length;_i++){var item=items_1[_i],children=item[this._config.children],expand=void 0;init?(expand=!1,item[this._config.expand]=!1):expand=item[this._config.expand]&&children&&children.length>0;var hasChild=void 0,node={parent:parent,hasChild:hasChild=!!(children&&children.length>0)||!!item[this._config.hasChild],item:item,level:level,expand:expand};index&&index.push(node),expand&&this.expandItems(node,children,index,level+1)}},TreeBase.prototype.getExpandCount=function(children){if(!children)return 0;for(var delCount=children.length,_i=0,children_1=children;_i<children_1.length;_i++){var child=children_1[_i];child.children&&child.children.length>0&&child[this._config.expand]&&(delCount+=this.getExpandCount(child.children))}return delCount},TreeBase.prototype.expand=function(index){if(index>=0&&index<this._index.length){var node=this._index[index];if(node.hasChild&&!node.expand){node.expand=!0,node.item[this._config.expand]=!0;var appendNodes=[];this.expandItems(node,node.item[this._config.children],appendNodes,node.level+1),(_a=this._index).splice.apply(_a,[index+1,0].concat(appendNodes))}}var _a},TreeBase.prototype.collapse=function(index){if(index>=0&&index<this._index.length){var node=this._index[index];if(node.hasChild&&node.expand){node.expand=!1,node.item[this._config.expand]=!1;var delCount=this.getExpandCount(node.item[this._config.children]);this._index.splice(index+1,delCount)}}},TreeBase}(DSBase);ds.TreeBase=TreeBase;var Tree=function(_super){function Tree(data,config,filter,order){void 0===config&&(config={children:"children",expand:"expand"}),void 0===filter&&(filter=null),void 0===order&&(order=null);var _this=_super.call(this)||this;return _this._config=config,_this._filter=filter,_this._order=order,_this.update(data),_this}return __extends(Tree,_super),Tree.prototype.update=function(data){this._index=[],this._rawData=data,this.expandItems(null,data,this._index,0),this.build()},Tree.prototype.build=function(){var _this=this;if(null!=this._rawData){if(null!=this._filter&&0!=this._filter.length||null!=this._order&&0!=this._order.length){this._finalData=[];var iterate_1=function(items){typeof items!==tui.UNDEFINED&&null!==items||(items=[]);for(var _i=0,items_2=items;_i<items_2.length;_i++){var item=items_2[_i];if(filter(item,_this._filter)){var node={parent:null,hasChild:!1,item:item,level:0,expand:!1};_this._finalData.push(node)}var children=item[_this._config.children];children&&iterate_1(children)}};iterate_1(this._rawData),sort(this._finalData,this._order,!0)}else this._finalData=null;this.fire("update",{completely:!0})}else this._finalData=null},Tree}(TreeBase);ds.Tree=Tree;var RemoteTree=function(_super){function RemoteTree(config,filter,order){void 0===config&&(config={children:"children",expand:"expand",hasChild:"hasChild"}),void 0===filter&&(filter=null),void 0===order&&(order=null);var _this=_super.call(this)||this;return _this._querying=!1,_this._config=config,_this._filter=filter,_this._order=order,_this}return __extends(RemoteTree,_super),RemoteTree.prototype.length=function(){return this._index?this._index.length:(this._querying||(this._querying=!0,this.fire("query",{parent:null,filter:this._filter,order:this._order})),0)},RemoteTree.prototype.expand=function(index){if(index>=0&&index<this._index.length){var node=this._index[index];if(node.hasChild&&!node.expand){node.expand=!0,node.item[this._config.expand]=!0;var children=node.item[this._config.children];if(children){var appendNodes=[];this.expandItems(node,children,appendNodes,node.level+1),(_a=this._index).splice.apply(_a,[index+1,0].concat(appendNodes))}else this.fire("query",{parent:node,filter:this._filter,order:this._order}),this._querying=!0}}var _a},RemoteTree.prototype.update=function(result){if(this._querying=!1,null===result.parent)this._index=[],this._rawData=result.data,this.expandItems(null,result.data,this._index,0);else{var expand=result.parent.expand,index=this.findNodeIndex(result.parent);index>=0&&this.collapse(index),result.parent.item[this._config.children]=result.data,result.data&&0!=result.data.length?(result.parent.hasChild=!0,index>=0&&expand&&this.expand(index)):result.parent.hasChild=!1}this.fire("update",{completely:!0})},RemoteTree.prototype.build=function(){this._index=null,this._rawData=null,this._finalData=null,this.fire("query",{parent:null,filter:this._filter,order:this._order})},RemoteTree}(TreeBase);ds.RemoteTree=RemoteTree}(tui.ds||(tui.ds={}))}(tui||(tui={}));var tui;!function(tui){!function(time){function dateDiff(dt1,dt2,unit){void 0===unit&&(unit="d");var d1=dt1.getTime(),diff=dt2.getTime()-d1,symbol=diff<0?-1:1;return diff=Math.abs(diff),"d"===(unit=unit.toLocaleLowerCase())?Math.floor(diff/864e5)*symbol:"h"===unit?Math.floor(diff/36e5)*symbol:"m"===unit?Math.floor(diff/6e4)*symbol:"s"===unit?Math.floor(diff/1e3)*symbol:"ms"===unit?diff*symbol:NaN}function dayOfYear(dt){var y=dt.getFullYear();return dateDiff(new Date(y,0,1),dt,"d")}function totalDaysOfMonth(dt){var y=dt.getFullYear(),m=dt.getMonth(),d1=new Date(y,m,1);return 11===m?(y++,m=0):m++,dateDiff(d1,new Date(y,m,1),"d")}function parseDateInternal(dtStr,format){function matchEnum(v,key,enumArray){var m=dtStr.match(new RegExp("^"+enumArray.join("|"),"i"));return null!==m&&(v=m[0].toLowerCase(),v=v.substr(0,1).toUpperCase()+v.substr(1),values[key]=enumArray.indexOf(v),dtStr=dtStr.substr(v.length),!0)}function matchNumber(v,key,min,max){var len=v.length;if(0==len)return!1;var m=dtStr.match("^[0-9]{1,"+len+"}");if(null===m)return!1;v=m[0];var num=parseInt(v);return!(num<min||num>max)&&(key&&(values[key]=num),dtStr=dtStr.substr(v.length),!0)}if(!dtStr||!format)return null;var mapping={},gcount=0,isUTC=!1,values={},rule={"y+":function(v){return!!matchNumber(v,"year")&&(values.year<100&&(values.year+=1900),!0)},"M+":function(v){var len=v.length;return len<3?!!matchNumber(v,"month",1,12)&&(values.month-=1,!0):3===len?matchEnum(v,"month",time.shortMonths):matchEnum(v,"month",time.months)},"d+":function(v){return matchNumber(v,"date",1,31)},"D+":matchNumber,"h+":function(v){return matchNumber(v,"12hour",1,12)},"H+":function(v){return matchNumber(v,"hour",0,24)},"m+":function(v){return matchNumber(v,"minute",0,59)},"s+":function(v){return matchNumber(v,"second",0,59)},"[qQ]+":function(v){return matchNumber(v,null,1,4)},"S+":function(v){return matchNumber(v,"millisecond",0,999)},"E+":function(v){var len=v.length;return len<3?!!matchNumber(v,null,0,6):3===len?matchEnum(v,null,time.shortWeeks):matchEnum(v,null,time.weeks)},"a|A":function(v){var m=dtStr.match(/^(am|pm)/i);return null!==m&&(v=m[0],values.ampm=v.toLowerCase(),dtStr=dtStr.substr(v.length),!0)},"z+":function(v){var m,len=v.length;if(null===(m=len<=2?dtStr.match(/^([\-+][0-9]{2})/i):3===len?dtStr.match(/^([\-+][0-9]{2})([0-9]{2})/i):dtStr.match(/^([\-+][0-9]{2}):([0-9]{2})/i)))return!1;v=m[0];var tz=parseInt(m[1]);return!(Math.abs(tz)<-11||Math.abs(tz)>11)&&(tz*=60,typeof m[2]!==tui.UNDEFINED&&(tz>0?tz+=parseInt(m[2]):tz-=parseInt(m[2])),values.tz=-tz,dtStr=dtStr.substr(v.length),!0)},Z:function(v){return"Z"===dtStr.substr(0,1)&&(isUTC=!0,dtStr=dtStr.substr(1),!0)},"\"[^\"]*\"|'[^']*'":function(v){return v=v.substr(1,v.length-2),dtStr.substr(0,v.length).toLowerCase()===v.toLowerCase()&&(dtStr=dtStr.substr(v.length),!0)},"[^yMmdDhHsSqEaAzZ'\"]+":function(v){v=v.replace(/(.)/g,"\\$1");var m=dtStr.match(new RegExp("^"+v));return null!==m&&(v=m[0],dtStr=dtStr.substr(v.length),!0)}},regex="";for(var k in rule)rule.hasOwnProperty(k)&&(regex.length>0&&(regex+="|"),regex+="(^"+k+")",mapping[k]=++gcount);for(var result;null!==(result=format.match(regex));){for(var k in mapping){var v=result[mapping[k]];if("string"==typeof v&&v){if(!1===rule[k](v))return null;break}}format=format.substr(result[0].length)}if(format.length>0||dtStr.length>0)return null;var parseCount=0;for(var k in values)values.hasOwnProperty(k)&&parseCount++;if(parseCount<=0)return null;var hour,now=new Date,year=values.hasOwnProperty("year")?values.year:isUTC?now.getUTCFullYear():now.getFullYear(),month=values.hasOwnProperty("month")?values.month:isUTC?now.getUTCMonth():now.getMonth(),date=values.hasOwnProperty("date")?values.date:isUTC?now.getUTCDate():now.getDate(),ampm=values.hasOwnProperty("ampm")?values.ampm:"am";if(values.hasOwnProperty("hour"))hour=values.hour;else if(values.hasOwnProperty("12hour")){var h12=values["12hour"];if("am"===ampm)if(h12>=1&&h12<=11)hour=h12;else{if(12!==h12)return null;hour=h12-12}else if(12===h12)hour=h12;else{if(!(h12>=1&&h12<=11))return null;hour=h12+12}}else hour=0;var minute=values.hasOwnProperty("minute")?values.minute:0,second=values.hasOwnProperty("second")?values.second:0,millisecond=values.hasOwnProperty("millisecond")?values.millisecond:0,tz=values.hasOwnProperty("tz")?values.tz:now.getTimezoneOffset();return now.setUTCFullYear(year),now.setUTCDate(1),now.setUTCMonth(month),now.setUTCDate(date),now.setUTCHours(hour),now.setUTCMinutes(minute),now.setUTCSeconds(second),now.setUTCMilliseconds(millisecond),isUTC||now.setTime(now.getTime()+60*tz*1e3),now}time.shortWeeks=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],time.weeks=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],time.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],time.months=["January","February","March","April","May","June","July","August","September","October","November","December"],time.now=function(){return new Date},time.timespan=function(seconds,lang){var desc=["day","hour","minute","second"],val=[],beg="",end="",d=Math.floor(seconds/86400);val.push(d),seconds%=86400;var h=Math.floor(seconds/3600);val.push(h),seconds%=3600;var m=Math.floor(seconds/60);val.push(m),val.push(seconds%60);for(var i=0,j=3;i<4;){if(val[i]>0){beg.length&&(beg+=" "),beg+=val[i]+" "+tui.str(val[i]>1?desc[i]+"s":desc[i],lang);break}i++}for(;i<j;){if(val[j]>0){end.length&&(end+=" "),end+=val[j]+" "+tui.str(val[j]>1?desc[j]+"s":desc[j],lang);break}j--}for(i++;i<j;)beg.length&&(beg+=" "),beg+=val[i]+" "+tui.str(val[i]>1?desc[i]+"s":desc[i],lang),i++;return beg+(beg.length?" ":"")+end},time.dateDiff=dateDiff,time.dateAdd=function(dt,val,unit){void 0===unit&&(unit="d");var tm=dt.getTime();if("y"===unit){var y=dt.getFullYear(),m=dt.getMonth(),d=dt.getDate(),h=dt.getHours(),mi=dt.getMinutes(),s=dt.getSeconds(),ms=dt.getMilliseconds(),totalMonth=12*y+m+12*val;return y=Math.floor(totalMonth/12),m=totalMonth%12,d>totalDaysOfMonth(newDate=new Date(y,m,1))&&(d=totalDaysOfMonth(newDate)),new Date(y,m,d,h,mi,s,ms)}if("M"===unit){var y=dt.getFullYear(),m=dt.getMonth(),d=dt.getDate(),h=dt.getHours(),mi=dt.getMinutes(),s=dt.getSeconds(),ms=dt.getMilliseconds(),totalMonth=12*y+m+val;y=Math.floor(totalMonth/12),m=totalMonth%12;var newDate=new Date(y,m,1);return d>totalDaysOfMonth(newDate)&&(d=totalDaysOfMonth(newDate)),new Date(y,m,d,h,mi,s,ms)}return"d"===unit?new Date(tm+864e5*val):"h"===unit?new Date(tm+36e5*val):"m"===unit?new Date(tm+6e4*val):"s"===unit?new Date(tm+1e3*val):"ms"===unit?new Date(tm+val):null},time.dayOfYear=dayOfYear,time.totalDaysOfMonth=totalDaysOfMonth,time.parseDate=function(dtStr,format){if("string"==typeof format)return parseDateInternal(dtStr,format);if(typeof format===tui.UNDEFINED){var dt=new Date(dtStr);if(!isNaN(dt.getTime()))return dt;if(null!==(dt=parseDateInternal(dtStr,"yyyy-MM-dd HH:mm:ss.SSS")))return dt;if(null!==(dt=parseDateInternal(dtStr,"yyyy-MM-ddTHH:mm:sszzz")))return dt;if(null!==(dt=parseDateInternal(dtStr,"yyyy-MM-dd")))return dt;if(null!==(dt=parseDateInternal(dtStr,"yyyy-MM-dd HH:mm:ss")))return dt;if(null!==(dt=parseDateInternal(dtStr,"MMM dd, yyyy HH:mm:ss")))return dt;if(null!==(dt=parseDateInternal(dtStr,"MMM dd, yyyy")))return dt;if(null!==(dt=parseDateInternal(dtStr,"dd MMM yyyy HH:mm:ss")))return dt;if(null!==(dt=parseDateInternal(dtStr,"dd MMM yyyy")))return dt;if(null!==(dt=parseDateInternal(dtStr,"HH:mm:ss")))return dt}return null},time.formatDate=function(dt,dateFmt){void 0===dateFmt&&(dateFmt="yyyy-MM-ddTHH:mm:sszzz");var isUTC=dateFmt.indexOf("Z")>=0,fullYear=isUTC?dt.getUTCFullYear():dt.getFullYear(),month=isUTC?dt.getUTCMonth():dt.getMonth(),date=isUTC?dt.getUTCDate():dt.getDate(),hours=isUTC?dt.getUTCHours():dt.getHours(),minutes=isUTC?dt.getUTCMinutes():dt.getMinutes(),seconds=isUTC?dt.getUTCSeconds():dt.getSeconds(),milliseconds=isUTC?dt.getUTCMilliseconds():dt.getMilliseconds(),day=isUTC?dt.getUTCDay():dt.getDay(),rule={"y+":fullYear,"M+":month+1,"d+":date,"D+":dayOfYear(dt)+1,"h+":function(h){return 0===h?h+12:h>=1&&h<=12?h:h>=13&&h<=23?h-12:void 0}(hours),"H+":hours,"m+":minutes,"s+":seconds,"q+":Math.floor((month+3)/3),"S+":milliseconds,"E+":day,a:function(h){return h>=0&&h<=11?"am":"pm"}(isUTC?dt.getUTCHours():dt.getHours()),A:function(h){return h>=0&&h<=11?"AM":"PM"}(hours),"z+":dt.getTimezoneOffset()},regex="";for(var k in rule)rule.hasOwnProperty(k)&&(regex.length>0&&(regex+="|"),regex+=k);var regexp=new RegExp(regex,"g");return dateFmt.replace(regexp,function(str,pos,source){for(var k in rule)if(null!==str.match(k)){if("y+"===k)return tui.text.paddingNumber(rule[k],str.length,str.length);if("a"===k||"A"===k)return rule[k];if("z+"===k){var z="";return rule[k]>=0?z+="-":z+="+",str.length<2?z+=Math.abs(Math.floor(rule[k]/60)):z+=tui.text.paddingNumber(Math.abs(Math.floor(rule[k]/60)),2),3===str.length?z+=tui.text.paddingNumber(Math.abs(Math.floor(rule[k]%60)),2):str.length>3&&(z+=":"+tui.text.paddingNumber(Math.abs(Math.floor(rule[k]%60)),2)),z}return"E+"===k?str.length<3?tui.text.paddingNumber(rule[k],str.length):3===str.length?time.shortWeeks[rule[k]]:time.weeks[rule[k]]:"M+"===k?str.length<3?tui.text.paddingNumber(rule[k],str.length):3===str.length?time.shortMonths[rule[k]-1]:time.months[rule[k]-1]:"S+"===k?tui.text.paddingNumber(rule[k],str.length,str.length,!0):tui.text.paddingNumber(rule[k],str.length)}return str})}}(tui.time||(tui.time={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Button=function(_super){function Button(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Button,_super),Button.prototype.initChildren=function(childNodes){childNodes&&childNodes.length>0&&this._set("text",tui.browser.toHTML(childNodes))},Button.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this.setRestrictions({type:{get:function(){if(_this._data.type)return _this._data.type;var parent=_this.get("parent");return parent&&parent instanceof widget.Group&&parent.get("type")?parent.get("type"):null}},value:{get:function(){return typeof _this._data.value!==tui.UNDEFINED?_this._data.value:_this.get("text")}},checked:{set:function(value){_this._data.checked=!!value,value||(_this._data.tristate=!1)}},tristate:{set:function(value){_this._data.tristate=!!value,value&&(_this._data.checked=!0)}}})},Button.prototype.init=function(){var _this=this,$root=$(this._);$root.attr({unselectable:"on"}),$root.mousedown(function(e){_this.get("disable")||($root.focus(),_this.fire("mousedown",e))}),$root.mouseup(function(e){_this.get("disable")||_this.fire("mouseup",e)}),$root.keydown(function(e){_this.get("disable")||_this.fire("keydown",e)}),$root.keyup(function(e){_this.get("disable")||_this.fire("keyup",e)});var onClick=function(e){if(!_this.get("disable")){"toggle"===_this.get("type")||"toggle-radio"===_this.get("type")?_this.set("checked",!_this.get("checked")):"radio"===_this.get("type")&&_this.set("checked",!0);var parent=_this.get("parent"),groupName=_this.get("group");if("radio"===_this.get("type")||"toggle-radio"===_this.get("type")&&_this.get("checked"))for(var result=void 0,_i=0,result_1=result=parent&&parent instanceof widget.Group?widget.search(parent._,function(elem){return("radio"===elem.get("type")||"toggle-radio"===elem.get("type"))&&elem!==_this}):widget.search(function(elem){return!(!groupName||elem.get("group")!==groupName||"radio"!==elem.get("type")&&"toggle-radio"!==elem.get("type")||elem===_this)});_i<result_1.length;_i++)result_1[_i].set("checked",!1);var onclick=_this.get("onclick");onclick&&eval.call(window,onclick),_this.fire("click",e),parent&&parent instanceof widget.Group&&parent.fire("click",{e:e,button:_this})}};$root.click(onClick),$root.keydown(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),onClick(e))})},Button.prototype.render=function(){var $root=$(this._);this.get("checked")?$root.addClass("tui-checked"):$root.removeClass("tui-checked"),this.get("disable")?($root.addClass("tui-disable"),$root.removeAttr("tabIndex")):($root.removeClass("tui-disable"),$root.attr("tabIndex","0")),this.get("checked")&&this.get("tristate")?$root.addClass("tui-tristate"):$root.removeClass("tui-tristate");var text=this.get("text");"string"!=typeof text&&(text=""),$root.html(text)},Button}(widget.Widget);widget.Button=Button;var Check=function(_super){function Check(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Check,_super),Check.prototype.init=function(){_super.prototype.init.call(this),this._set("type","toggle")},Check}(Button);widget.Check=Check;var Radio=function(_super){function Radio(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Radio,_super),Radio.prototype.init=function(){_super.prototype.init.call(this),this._set("type","radio")},Radio}(Button);widget.Radio=Radio,widget.register(Button,"button"),widget.register(Check,"check"),widget.register(Radio,"radio")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function formatNumber(v,maxValue){return v<0&&(v=0),v>maxValue&&(v=maxValue),v<10?"0"+v:v+""}function firstDay(date){var y=date.getFullYear(),m=date.getMonth();return new Date(y,m,1)}var Calendar=function(_super){function Calendar(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Calendar,_super),Calendar.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this.setRestrictions({time:{set:function(value){value instanceof Date?_this._data.time=value:"string"==typeof value&&(value=tui.time.parseDate(value),_this._data.time=value)},get:function(){var tm=_this._data.time;return typeof tm!==tui.UNDEFINED&&null!==tm||((tm=tui.time.now()).setHours(0),tm.setMinutes(0),tm.setSeconds(0),tm.setMilliseconds(0),_this._data.time=tm),tm}},value:{set:function(value){_this._set("time",value)},get:function(){var fmt,tm=_this.get("time"),md=_this.get("mode"),tz=_this.get("timezone");return"date"===md?(fmt="yyyy-MM-dd","utc"===tz?fmt+="Z":"locale"===tz&&(fmt+="Zzzz")):"month"===md?(fmt="yyyy-MM","utc"===tz?fmt+="Z":"locale"===tz&&(fmt+="Zzzz")):"time"===md?fmt="HH:mm:ss":(fmt="yyyy-MM-ddTHH:mm:ss","utc"===tz?fmt+="Z":"locale"===tz?fmt+="zzz":fmt="yyyy-MM-dd HH:mm:ss"),tui.time.formatDate(tm,fmt)}},year:{set:function(value){"number"!=typeof value||isNaN(value)||_this.get("time").setFullYear(value)},get:function(){return _this.get("time").getFullYear()}},month:{set:function(value){"number"!=typeof value||isNaN(value)||_this.get("time").setMonth(value-1)},get:function(){return _this.get("time").getMonth()+1}},day:{set:function(value){"number"!=typeof value||isNaN(value)||_this.get("time").setDate(value)},get:function(){return _this.get("time").getDate()}},hour:{set:function(value){"number"!=typeof value||isNaN(value)||_this.get("time").setHours(value)},get:function(){return _this.get("time").getHours()}},minute:{set:function(value){"number"!=typeof value||isNaN(value)||_this.get("time").setMinutes(value)},get:function(){return _this.get("time").getMinutes()}},second:{set:function(value){"number"!=typeof value||isNaN(value)||_this.get("time").setSeconds(value)},get:function(){return _this.get("time").getSeconds()}},mode:{set:function(value){["date","date-time","month","time"].indexOf(value)>=0&&(_this._data.mode=value)},get:function(){return _this._data.mode?_this._data.mode:"date"}},timezone:{set:function(value){["utc","locale","none"].indexOf(value)>=0&&(_this._data.timezone=value)},get:function(){return _this._data.timezone?_this._data.timezone:"none"}}})},Calendar.prototype.makeTable=function(){var monthOnly="month"===this.get("mode");if(this._monthOnly!==monthOnly){for(var tb=this._components.table;tb.children.length>0;)tb.removeChild(tb.firstChild);if(monthOnly){(bar=tb.insertRow(-1)).className="tui-yearbar",bar.insertCell(-1).className="tui-py",(ym=bar.insertCell(-1)).className="tui-ym",ym.setAttribute("colSpan","2"),bar.insertCell(-1).className="tui-ny";for(var i_1=0;i_1<3;i_1++)for(var line=tb.insertRow(-1),j_1=0;j_1<4;j_1++){var cell_1=line.insertCell(-1);cell_1.className=0==i_1?"tui-month tui-calendar-first-line":"tui-month";var m=4*i_1+j_1;cell_1.innerHTML=tui.str(tui.time.shortMonths[m]),cell_1.setAttribute("month",m+1+"")}}else{var bar=tb.insertRow(-1);bar.className="tui-yearbar",bar.insertCell(-1).className="tui-pm",bar.insertCell(-1).className="tui-py";var ym=bar.insertCell(-1);ym.className="tui-ym",ym.setAttribute("colSpan","3"),bar.insertCell(-1).className="tui-ny",bar.insertCell(-1).className="tui-nm";for(var i=0;i<7;i++)for(var line=tb.insertRow(-1),j=0;j<7;j++){var cell=line.insertCell(-1);0!==j&&6!==j||(cell.className="tui-week-end"),0===i&&(cell.className="tui-week",cell.innerHTML=tui.str(tui.time.shortWeeks[j]))}}this._monthOnly=monthOnly}},Calendar.prototype.init=function(){function getMaxValue(name){return"hours"===name?23:59}function plus(o$,input){var max=getMaxValue(o$.attr("name")),v=parseInt(input.value)+1;v>max&&(v=0),input.value=formatNumber(v,max),getInputTime()}function minus(o$,input){var max=getMaxValue(o$.attr("name")),v=parseInt(input.value)-1;v<0&&(v=max),input.value=formatNumber(v,max),getInputTime()}var _this=this;$(this._).attr({tabIndex:"0",unselectable:"on"});var tb=this._components.table=tui.browser.toElement("<table cellPadding='0' cellspacing='0' border='0'></table>");this._.appendChild(tb),this._monthOnly=null;var timebar=this._components.timeBar=tui.browser.toElement("<div class=\"tui-calendar-timebar\" unselectable='on'>\n<div><span name='hours-plus' class='plus' tabIndex='0' ></span>\n<input name='hours' type='tel' maxLength='2' unselectable='on'>\n<span name='hours-minus' class='minus' tabIndex='0'></span>\n</div> : <div><span name='minutes-plus' class='plus' tabIndex='0'></span>\n<input name='minutes' type='tel' maxLength='2' unselectable='on'>\n<span name='minutes-minus' class='minus' tabIndex='0'></span>\n</div> : <div><span name='seconds-plus' class='plus' tabIndex='0'></span>\n<input name='seconds' type='tel' maxLength='2' unselectable='on'>\n<span name='seconds-minus' class='minus' tabIndex='0'></span></div>\n<a class='tui-update'></a></div>");this._.appendChild(timebar);var getInputTime=function(){function getInput(index){return $(timebar).find("input")[index]}var tm=_this.get("time");tm.setHours(parseInt(getInput(0).value)),tm.setMinutes(parseInt(getInput(1).value)),tm.setSeconds(parseInt(getInput(2).value)),_this.set("time",tm)},timebar$=$(timebar);timebar$.keydown(function(e){if(_this.get("disable"))return!1;var o=e.srcElement||e.target,o$=$(o),k=e.keyCode;if("INPUT"===o.nodeName.toUpperCase()){if(k===tui.browser.KeyCode.TAB)return;e.preventDefault(),e.stopPropagation();var input=o;if(k===tui.browser.KeyCode.LEFT)"seconds"===o$.attr("name")?timebar$.find("input[name=minutes]").focus():"minutes"===o$.attr("name")&&timebar$.find("input[name=hours]").focus();else if(k===tui.browser.KeyCode.RIGHT)"hours"===o$.attr("name")?timebar$.find("input[name=minutes]").focus():"minutes"===o$.attr("name")&&timebar$.find("input[name=seconds]").focus();else if(k===tui.browser.KeyCode.UP)plus(o$,input);else if(k===tui.browser.KeyCode.DOWN)minus(o$,input);else if(k>=tui.browser.KeyCode.KEY_0&&k<=tui.browser.KeyCode.KEY_9){var max=getMaxValue(o$.attr("name")),v=k-tui.browser.KeyCode.KEY_0,now=tui.time.now().getTime();o._lastInputTime&&now-o._lastInputTime<1e3?o.value=formatNumber(10*parseInt(o.value.substr(1,1))+v,max):o.value=formatNumber(v,max),o._lastInputTime=now,getInputTime()}else 13==k&&_this.fire("click",{e:e,time:_this.get("time"),type:"pick"})}}),timebar$.on("mousedown",function(e){if(_this.get("disable"))return!1;var o=e.srcElement||e.target;if("span"===o.nodeName.toLowerCase()){var arr=o.getAttribute("name").split("-"),o$=timebar$.find("input[name="+arr[0]+"]"),input=o$[0],timer=null,beginner=null;"plus"==arr[1]?(plus(o$,input),beginner=setTimeout(function(){timer=setInterval(function(){plus(o$,input)},100)},500),widget.openDragMask(null,function(){clearTimeout(beginner),clearInterval(timer)})):(minus(o$,input),beginner=setTimeout(function(){timer=setInterval(function(){minus(o$,input)},100)},500),widget.openDragMask(null,function(){clearTimeout(beginner),clearInterval(timer)}))}}),timebar$.find("input").on("focus mousedown mouseup",function(e){(e.srcElement||e.target).focus(),e.preventDefault()}).on("contextmenu",function(e){e.preventDefault()}),timebar$.children("a").mousedown(function(e){if(_this.get("disable"))return!1;var now=tui.time.now(),newTime=new Date(_this.get("year"),_this.get("month")-1,_this.get("day"),now.getHours(),now.getMinutes(),now.getSeconds());return _this.set("time",newTime),setTimeout(function(){_this._.focus()}),e.stopPropagation(),!1}).click(function(e){if(_this.get("disable"))return!1;_this.fire("click",{e:e,time:_this.get("time"),type:"refresh"})}),$(tb).mousedown(function(e){if(_this.get("disable"))return!1;tui.ffVer>0&&setTimeout(function(){_this._.focus()});var cell=e.target||e.srcElement;if("td"===cell.nodeName.toLowerCase())if($(cell).hasClass("tui-pm"))_this.prevMonth();else if($(cell).hasClass("tui-py"))_this.prevYear();else if($(cell).hasClass("tui-ny"))_this.nextYear();else if($(cell).hasClass("tui-nm"))_this.nextMonth();else if("number"==typeof cell.offsetMonth){var d=parseInt(cell.innerHTML,10),y=_this.get("year"),m=_this.get("month"),offset=cell.offsetMonth;offset<0?(1===m?(y--,m=12):m--,_this.onPicked(y,m,d)):offset>0?(12===m?(y++,m=1):m++,_this.onPicked(y,m,d)):0===offset&&_this.onPicked(y,m,d)}else if(cell.hasAttribute("month")){var y=_this.get("year"),m=parseInt(cell.getAttribute("month"));_this.onPicked(y,m,1)}}).click(function(e){if(_this.get("disable"))return!1;var cell=e.target||e.srcElement;"td"===cell.nodeName.toLowerCase()&&("number"==typeof cell.offsetMonth||cell.hasAttribute("month")?_this.fire("click",{e:e,time:_this.get("time"),type:"pick"}):/^(tui-pm|tui-py|tui-nm|tui-ny)$/.test(cell.className)&&_this.fire("click",{e:e,time:_this.get("time"),type:"change"}))}).dblclick(function(e){if(_this.get("disable"))return!1;var cell=e.target||e.srcElement;"td"===cell.nodeName.toLowerCase()&&("number"==typeof cell.offsetMonth||cell.hasAttribute("month"))&&_this.fire("dblclick",{e:e,time:_this.get("time")})}),$(this._).keydown(function(e){if(_this.get("disable"))return!1;var k=e.keyCode;if([13,33,34,37,38,39,40].indexOf(k)>=0){if(37===k)tm=_this._monthOnly?tui.time.dateAdd(_this.get("time"),-1,"M"):tui.time.dateAdd(_this.get("time"),-1),_this.set("time",tm),_this.fire("change",{time:_this.get("time")});else if(38===k){if(_this._monthOnly)tm=tui.time.dateAdd(_this.get("time"),-4,"M");else var tm=tui.time.dateAdd(_this.get("time"),-7);_this.set("time",tm),_this.fire("change",{time:_this.get("time")})}else 39===k?(tm=_this._monthOnly?tui.time.dateAdd(_this.get("time"),1,"M"):tui.time.dateAdd(_this.get("time"),1),_this.set("time",tm),_this.fire("change",{time:_this.get("time")})):40===k?(tm=_this._monthOnly?tui.time.dateAdd(_this.get("time"),4,"M"):tui.time.dateAdd(_this.get("time"),7),_this.set("time",tm),_this.fire("change",{time:_this.get("time")})):33===k?(tm=_this._monthOnly?tui.time.dateAdd(_this.get("time"),-1,"y"):tui.time.dateAdd(_this.get("time"),-1,"M"),_this.set("time",tm),_this.fire("change",{time:_this.get("time")})):34===k?(tm=_this._monthOnly?tui.time.dateAdd(_this.get("time"),1,"y"):tui.time.dateAdd(_this.get("time"),1,"M"),_this.set("time",tm),_this.fire("change",{time:_this.get("time")})):13===k&&_this.fire("click",{e:e,time:_this.get("time"),type:"pick"});return e.preventDefault()}})},Calendar.prototype.onPicked=function(y,m,d){var oldTime=this.get("time"),newTime=new Date(y,m-1,d,oldTime.getHours(),oldTime.getMinutes(),oldTime.getSeconds());this.set("time",newTime),this.fire("change",{time:this.get("time")})},Calendar.prototype.makeTime=function(proc){var t={y:this.get("year"),m:this.get("month"),d:this.get("day")};proc(t);var newDate=new Date(t.y,t.m-1,1);t.d>tui.time.totalDaysOfMonth(newDate)&&(t.d=tui.time.totalDaysOfMonth(newDate)),this.onPicked(t.y,t.m,t.d)},Calendar.prototype.prevMonth=function(){this.makeTime(function(t){1===t.m?(t.y--,t.m=12):t.m--})},Calendar.prototype.nextMonth=function(){this.makeTime(function(t){12===t.m?(t.y++,t.m=1):t.m++})},Calendar.prototype.prevYear=function(){this.makeTime(function(t){t.y--})},Calendar.prototype.nextYear=function(){this.makeTime(function(t){t.y++})},Calendar.prototype.render=function(){this.makeTable();var tb=this._components.table,tm=this.get("time"),today=tui.time.now(),mode=this.get("mode");if("time"!==mode){if(this._monthOnly){tb.rows[0].cells[1].innerHTML=tm.getFullYear()+" - "+this.get("month");for(var i=0;i<3;i++)for(var j=0;j<4;j++){var cell=tb.rows[i+1].cells[j];4*i+j+1==this.get("month")?tui.browser.addClass(cell,"tui-actived"):tui.browser.removeClass(cell,"tui-actived")}}else{var firstWeek=firstDay(tm).getDay(),daysOfMonth=tui.time.totalDaysOfMonth(tm),day=0;tb.rows[0].cells[2].innerHTML=tm.getFullYear()+" - "+this.get("month");for(var i_2=0;i_2<6;i_2++)for(var j_2=0;j_2<7;j_2++){if((cell=tb.rows[i_2+2].cells[j_2]).className="",0===day)if(j_2===firstWeek)day=1,cell.innerHTML=day+"",cell.offsetMonth=0;else{var preMonthDay=new Date(firstDay(tm).valueOf()-1e3*(firstWeek-j_2)*24*60*60);cell.innerHTML=preMonthDay.getDate()+"",cell.offsetMonth=-1,$(cell).addClass("tui-before")}else++day<=daysOfMonth?(cell.innerHTML=day+"",cell.offsetMonth=0):(cell.innerHTML=day-daysOfMonth+"",cell.offsetMonth=1,$(cell).addClass("tui-after"));day===this.get("day")&&$(cell).addClass("tui-actived"),0!==j_2&&6!==j_2||$(cell).addClass("tui-weekend"),this.get("year")===today.getFullYear()&&this.get("month")===today.getMonth()+1&&day===today.getDate()&&$(cell).addClass("tui-today"),5==i_2&&"date-time"===mode&&$(cell).addClass("tui-calendar-last-line")}}tb.style.display=""}else tb.style.display="none";var timebar=this._components.timeBar;"date-time"===mode||"time"===mode?(timebar.style.display="",$(timebar).find("input[name=hours]").val(formatNumber(tm.getHours(),23)),$(timebar).find("input[name=minutes]").val(formatNumber(tm.getMinutes(),59)),$(timebar).find("input[name=seconds]").val(formatNumber(tm.getSeconds(),59))):timebar.style.display="none"},Calendar}(widget.Widget);widget.Calendar=Calendar,widget.register(Calendar,"calendar")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Group=function(_super){function Group(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Group,_super),Group.prototype.initChildren=function(childNodes){for(var _i=0,childNodes_3=childNodes;_i<childNodes_3.length;_i++){var node=childNodes_3[_i];this._.appendChild(node)}},Group.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this.setRestrictions({value:{set:function(value){if("object"==typeof value&&null!==value)for(var _i=0,children_2=widget.search(_this._);_i<children_2.length;_i++){var item=children_2[_i],key=item.get("name");null!==key&&item.set("value",value[key])}},get:function(){for(var value={},_i=0,children_3=widget.search(_this._);_i<children_3.length;_i++){var item=children_3[_i],key=item.get("name");null!==key&&(value[key]=item.get("value"))}return value}}})},Group.prototype.init=function(){widget.init(this._)},Group.prototype.render=function(){for(var root=this._,_i=0,result_2=widget.search(root);_i<result_2.length;_i++)result_2[_i].render()},Group}(widget.Widget);widget.Group=Group;var ButtonGroup=function(_super){function ButtonGroup(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ButtonGroup,_super),ButtonGroup.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this.setRestrictions({value:{set:function(value){for(var children=widget.search(_this._,function(elem){return elem.get("parent")===_this&&elem instanceof widget.Button}),_i=(_this.get("type"),0),children_4=children;_i<children_4.length;_i++){var button=children_4[_i];!function(v){return value instanceof Array?value.indexOf(v)>=0:value===v}(button.get("value"))?button.set("checked",!1):button.set("checked",!0)}},get:function(){for(var values=[],_i=0,children_5=widget.search(_this._,function(elem){return elem.get("parent")===_this&&elem instanceof widget.Button});_i<children_5.length;_i++){var button=children_5[_i];button.get("checked")&&values.push(button.get("value"))}return"radio"===_this.get("type")||"toggle-radio"===_this.get("type")?values.length>0?values[0]:null:values}},text:{get:function(){for(var values=[],_i=0,children_6=widget.search(_this._,function(elem){return elem.get("parent")===_this&&elem instanceof widget.Button});_i<children_6.length;_i++){var button=children_6[_i];button.get("checked")&&values.push(button.get("text"))}return values.join(",")}}})},ButtonGroup}(Group);widget.ButtonGroup=ButtonGroup,widget.register(Group,"group"),widget.register(ButtonGroup,"button-group")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget_5){"use strict";var Component=function(_super){function Component(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Component,_super),Component.prototype.checkReady=function(){var hasHandler=!!this.get("handler"),hasSrc=!!this.get("src");if((!hasHandler||hasHandler&&this._scriptReady)&&(!hasSrc||hasSrc&&this._htmlReady)&&this._changed&&this._childrenInit&&this._noReadyCount<=0){if(this._changed=!1,this._fn)try{this._fn.call(this)}finally{this._fn=null}this.fire("load");var parent=this.get("parent");parent&&parent.fire("componentReady",{name:this.get("name")})}},Component.prototype.initRestriction=function(){var _this=this;this._fn=null,this._changed=!0,this._noReadyCount=0,this._childrenInit=!1,this._scriptReady=!1,this._htmlReady=!1,this.on("componentReady",function(e){_this._noReadyCount--,_this.checkReady()}),_super.prototype.initRestriction.call(this),this.setRestrictions({handler:{set:function(value){var oldValue=_this._data.handler;value&&(value+"").trim().length>0?(oldValue!=(value=(value+"").trim())&&(_this._changed=!0),_this._data.handler=value,_this._fn=null,_this._scriptReady=!1,tui.ajax.getFunction(value).done(function(result){_this._fn=result,_this._scriptReady=!0,_this.checkReady()}).fail(function(){_this._scriptReady=!0,_this.checkReady()})):(oldValue&&(_this._changed=!0),delete _this._data.handler,_this._scriptReady=!0,_this._fn=null,_this.checkReady())}},src:{set:function(value){var oldValue=_this._data.src;value!=oldValue&&(value&&(value+"").trim().length>0?(value=(value+"").trim(),_this._data.src=value,_this._htmlReady=!1,_this._childrenInit=!1,tui.ajax.getComponent(_this.get("url")).done(function(result,handler){_this._htmlReady=!0,tui.browser.setInnerHtml(_this._,result),_this.loadComponents(),handler&&_this.set("handler",handler),_this.render(),_this.checkReady()}).fail(function(){_this._htmlReady=!0,_this.checkReady()})):(oldValue&&(_this._changed=!0,_this._.innerHTML=""),delete _this._data.src,_this._htmlReady=!0,_this.checkReady()))}},url:{get:function(){var parentUrl=_this.getParentUrl(),path=_this.get("src");return path?tui.text.isAbsUrl(path)?path:tui.text.joinUrl(tui.text.getBaseUrl(parentUrl),path):parentUrl}}})},Component.prototype.getParentUrl=function(){for(var elem=this._.parentNode;elem;){if(elem.__widget__&&"component"===elem.__widget__.getNodeName())return elem.__widget__.get("url");elem=elem.parentNode}return location.href},Component.prototype.loadComponents=function(){var _this=this,searchElem=function(parent){for(var i=0;i<parent.childNodes.length;i++){var node=parent.childNodes[i];if(1===node.nodeType){var elem_4=node,widget_6=elem_4.__widget__,name_4=void 0,fullName=widget_5.getFullName(elem_4);"tui:component"===fullName&&_this._noReadyCount++,widget_6?"string"==typeof(name_4=tui.get(elem_4).get("name"))&&name_4.trim().length>0&&(_this._components[name_4]=elem_4):("string"==typeof(name_4=elem_4.getAttribute("name"))&&name_4.trim().length>0&&(_this._components[name_4]=elem_4),fullName.match(/^tui:/i)&&!fullName.match(/^tui:(dialog-select|input-group|group|button-group|dialog)$/)||searchElem(node))}}};this._components={"":this._},this._noReadyCount=0,searchElem(this._),this._childrenInit=!0},Component.prototype.initChildren=function(childNodes){var _this=this;null==this.get("src")&&(childNodes.forEach(function(n){return _this._.appendChild(n)}),this.loadComponents(),this.checkReady())},Component.prototype.use=function(fn,desc){var _this=this;if("function"==typeof fn){var argv=tui.service.parseParameters(fn,desc).split(",").map(function(s){if(s=s.trim()){if("$"===s[0])return tui.service.get(s.substr(1));var c=_this.getComponent(s);return c&&c.__widget__&&(c=c.__widget__),c}return null});fn.apply(this,argv)}},Component.prototype.render=function(){widget_5.init(this._)},Component}(widget_5.Group);widget_5.Component=Component,widget_5.register(Component,"component")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var VALIDATORS={"*email":"^(\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*)?$","*chinese":"^[\\u4e00-\\u9fa5]*$","*url":"^(https?://([\\w-_]+:[^@/]+@)?[\\w-]+(\\.[\\w-]+)*(:[0-9]+)?(/[\\w-./?%&=]*)?)?$","*digital":"^\\d*$","*integer":"^([+\\-]?\\d+)?$","*float":"^([+\\-]?\\d*\\.\\d+)?$","*number":"^([+\\-]?\\d+|(\\d*\\.\\d+))?$","*currency":"^(-?\\d{1,3}(,\\d{3})*\\.\\d{2,3})?$","*date":"^([0-9]{4}-1[0-2]|0?[1-9]-0?[1-9]|[12][0-9]|3[01])?$","*key":"^([_a-zA-Z][a-zA-Z0-9_]*)?$","*any":"\\S+"},InputBase=function(_super){function InputBase(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._valid=!0,_this._invalidMessage=null,_this}return __extends(InputBase,_super),InputBase.parseValidators=function(childNodes){for(var validators=[],_i=0,childNodes_4=childNodes;_i<childNodes_4.length;_i++){var node=childNodes_4[_i];if("tui:verify"===widget.getFullName(node)){var format=node.getAttribute("format");if(format){var validator={format:format,message:node.innerHTML};validators.push(validator)}}}return validators},InputBase.prototype.initChildren=function(childNodes){this._set("validate",InputBase.parseValidators(childNodes))},InputBase.prototype.reset=function(){!0!==this._valid&&(this._valid=!0,this._invalidMessage=null,this.render())},InputBase.prototype.updateEmptyState=function(empty){this._isEmpty!==empty&&(this._isEmpty=empty,!0===this._valid&&this.render())},InputBase.prototype.validate=function(e){var text=this.get("text");null===text&&(text=""),this._valid=!0;var validator=this.get("validate");if(""===text&&this.get("allowEmpty"))return!0;if(!(validator instanceof Array))return!0;for(var _i=0,validator_1=validator;_i<validator_1.length;_i++){var item=validator_1[_i],k=item.format;if("*password"===k)/[a-z]/.test(text)&&/[A-Z]/.test(text)&&/[0-9]/.test(text)&&/[\~\`\!\@\#\$\%\^\&\*\(\)\_\-\+\=\\\]\[\{\}\:\;\"\'\/\?\,\.\<\>\|]/.test(text)&&!(text.length<6)||(this._valid=!1);else if("*maxlen:"===k.substr(0,8)){var imaxLen=parseFloat(k.substr(8));if(isNaN(imaxLen))throw new Error("Invalid validator: '*maxlen:...' must follow a number");(ival=text.length)>imaxLen&&(this._valid=!1)}else if("*minlen:"===k.substr(0,8)){var iminLen=parseFloat(k.substr(8));if(isNaN(iminLen))throw new Error("Invalid validator: '*minLen:...' must follow a number");(ival=text.length)<iminLen&&(this._valid=!1)}else if("*max:"===k.substr(0,5)){var imax=parseFloat(k.substr(5));if(isNaN(imax))throw new Error("Invalid validator: '*max:...' must follow a number");(ival=parseFloat(text))>imax&&(this._valid=!1)}else if("*min:"===k.substr(0,5)){var imin=parseFloat(k.substr(5));if(isNaN(imin))throw new Error("Invalid validator: '*min:...' must follow a number");var ival=parseFloat(text);ival<imin&&(this._valid=!1)}else if("*same:"===k.substr(0,6)){var other=k.substr(6),o=widget.get(other);if(o){var otherText=o.get("text");null===otherText&&(otherText=""),text!==otherText&&(this._valid=!1)}else this._valid=!1}else if("*exp:"===k.substr(0,5)){other=k.substr(5);this._valid=!!this.fire("checkexp",{e:e,exp:other})}else{var regexp;if("*"===k.substr(0,1)){var v=VALIDATORS[k];if(!v)throw new Error("Invalid validator: "+k+" is not a valid validator");regexp=new RegExp(v)}else regexp=new RegExp(k);this._valid=regexp.test(text)}if(!this._valid){this._invalidMessage=item.message;break}}return this._valid||this._invalidMessage||(this._invalidMessage=tui.str("Invalid input.")),this.render(),this.fire("validate",{e:e,valid:this._valid,message:this._invalidMessage}),this._valid},InputBase}(widget.Widget);widget.InputBase=InputBase}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var SelectBase=function(_super){function SelectBase(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._inSelection=!1,_this}return __extends(SelectBase,_super),SelectBase.prototype.closeSelect=function(){var popup=widget.get(this._components.popup);popup&&popup.close()},SelectBase.prototype.init=function(){var _this=this,$root=$(this._),popup=this.createPopup();this._components.popup=popup._;var label=this._components.label=tui.elem("span"),iconRight=this._components.iconRight=tui.elem("i"),iconInvalid=this._components.iconInvalid=tui.elem("i"),clearButton=this._components.clearButton=tui.elem("i");clearButton.className="tui-input-clear-button",iconInvalid.className="tui-invalid-icon",label.className="tui-input-label",label.setAttribute("unselectable","on"),this._.appendChild(label),this._.appendChild(iconInvalid),this._.appendChild(iconRight),this._.appendChild(clearButton),this._.setAttribute("tabIndex","0"),$(this._).focus(function(){$root.addClass("tui-active")}),$(this._).blur(function(){$root.removeClass("tui-active"),_this.get("disable")||_this.get("autoValidate")&&(_this._inSelection||_this.validate())}),$root.on("mousedown",function(e){_this.get("disable")||(_this._.focus(),_this.reset(),setTimeout(function(){_this._inSelection=!0,_this.openSelect()},0))}),$root.keypress(function(e){_this.get("disable")||e.charCode===tui.browser.KeyCode.SPACE&&(e.preventDefault(),_this.reset(),setTimeout(function(){_this._inSelection=!0,_this.openSelect()},0))}),$(clearButton).on("mousedown",function(e){_this.set("value",null),_this.set("text",""),_this.reset(),_this.fire("change",e),_this.fire("clear",e),e.stopPropagation()}),popup.on("close",function(){_this._inSelection=!1,_this.get("autoValidate")&&setTimeout(function(){document.activeElement!==_this._&&_this.validate()})})},SelectBase.prototype.render=function(){this._.scrollLeft=0;var $root=$(this._),label=this._components.label,iconRight=this._components.iconRight,iconInvalid=this._components.iconInvalid,clearButton=this._components.clearButton;this.get("disable")?$root.addClass("tui-disable"):$root.removeClass("tui-disable");var text=this.get("text"),noValue=!1;null===text||""===text?(noValue=!0,text=this.get("placeholder"),$(label).addClass("tui-placeholder")):$(label).removeClass("tui-placeholder"),null===text&&(text=""),$(label).text(text),iconRight.className=this.get("iconRight"),iconRight.style.display="",iconRight.style.right="0",this._valid?($root.removeClass("tui-invalid"),iconInvalid.style.display="none"):($root.addClass("tui-invalid"),iconInvalid.style.display="",iconInvalid.style.right=iconRight.offsetWidth+"px"),!this.get("clearable")||noValue||this.get("disable")?clearButton.style.display="none":(clearButton.style.display="",clearButton.style.right=iconRight.offsetWidth+iconInvalid.offsetWidth+"px"),!this._valid&&this._invalidMessage?this._set("follow-tooltip",this._invalidMessage):this._set("follow-tooltip",null)},SelectBase.PADDING=6,SelectBase}(widget.InputBase);widget.SelectBase=SelectBase;var SelectPopupBase=function(_super){function SelectPopupBase(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SelectPopupBase,_super),SelectPopupBase.prototype.createPopup=function(){return widget.create("popup")},SelectPopupBase}(SelectBase);widget.SelectPopupBase=SelectPopupBase}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var DatePicker=function(_super){function DatePicker(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DatePicker,_super),DatePicker.prototype.initRestriction=function(){var _this=this,calendar=widget.create("calendar");this._components.calendar=calendar._,_super.prototype.initRestriction.call(this),this.setRestrictions({time:{set:function(value){value instanceof Date||"string"==typeof value?(calendar.set("time",value),_this._data.value=calendar.get("value")):_this._data.value=null},get:function(){return _this._data.value?calendar.get("time"):null}},value:{set:function(value){value instanceof Date||"string"==typeof value?(calendar.set("value",value),_this._data.value=calendar.get("value")):_this._data.value=null},get:function(){return _this._data.value?calendar.get("value"):null}},text:{set:function(value){},get:function(){var value=_this.get("time");return null===value?"":tui.time.formatDate(value,_this.get("format"))}},mode:{set:function(value){calendar.set("mode",value),"time"===value?_this._set("iconRight","fa-clock-o"):_this._set("iconRight","fa-calendar")},get:function(){return calendar.get("mode")}},format:{get:function(){var mode=_this.get("mode");return _this._data.format?_this._data.format:"month"===mode?"yyyy-MM":"date-time"===mode?"yyyy-MM-dd HH:mm:ss":"time"===mode?"HH:mm:ss":"yyyy-MM-dd"}},timezone:{set:function(value){calendar.set("timezone",value)},get:function(){return calendar.get("timezone")}}})},DatePicker.prototype.init=function(){var _this=this;_super.prototype.init.call(this),"time"===this.get("mode")?this._set("iconRight","fa-clock-o"):this._set("iconRight","fa-calendar");var calendar=widget.get(this._components.calendar),container=tui.elem("div"),toolbar=container.appendChild(tui.elem("div"));toolbar.className="tui-select-toolbar",toolbar.setAttribute("unselectable","on"),container.insertBefore(calendar._,container.firstChild),widget.get(this._components.popup)._set("content",container),this._components.toolbar=toolbar,calendar._.style.display="block",calendar._.style.borderWidth="0",calendar.on("click",function(e){_this.set("value",calendar.get("value")),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),"pick"===e.data.type&&(_this.closeSelect(),_this._.focus())}),$(toolbar).click(function(e){var name=(e.target||e.srcElement).getAttribute("name");if("today"===name){var tm=tui.time.now(),v=_this.get("time");v instanceof Date?(tm.setHours(v.getHours()),tm.setMinutes(v.getMinutes()),tm.setSeconds(v.getSeconds()),tm.setMilliseconds(v.getMilliseconds())):(tm.setHours(0),tm.setMinutes(0),tm.setSeconds(0),tm.setMilliseconds(0)),_this.set("value",tm),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),_this.closeSelect(),_this._.focus()}else"clear"===name?(_this.set("value",null),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),_this.closeSelect(),_this._.focus()):"ok"===name&&(_this.set("value",calendar.get("value")),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),_this.closeSelect(),_this._.focus())})},DatePicker.prototype.openSelect=function(){var calendar=widget.get(this._components.calendar),popup=widget.get(this._components.popup),toolbar=this._components.toolbar,todayButton="<a name='today'>"+tui.str("Today")+"</a>",okButton="<a name='ok'>"+tui.str("ok")+"</a>",clearButton="<a name='clear'>"+tui.str("Clear")+"</a>",clearable=this.get("clearable");calendar._.style.outline="none",toolbar.style.display="",toolbar.innerHTML=clearable?okButton+" | "+todayButton+" | "+clearButton:okButton+" | "+todayButton,popup.open(this._,"Lb"),setTimeout(function(){calendar._.focus()})},DatePicker}(widget.SelectPopupBase);widget.DatePicker=DatePicker,widget.register(DatePicker,"date-picker")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var File=function(_super){function File(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(File,_super),File.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this._uploader=tui.browser.createUploader(this._),this.setRestrictions({action:{set:function(value){_this._uploader.getOptions().action=value},get:function(){return _this._uploader.getOptions().action}},accept:{set:function(value){_this._uploader.getOptions().accept=value,_this._uploader.getInput()&&(_this._uploader.deleteInput(),_this._uploader.createInput())},get:function(){return _this._uploader.getOptions().accept}},text:{set:function(value){},get:function(){var v=_this.get("value");return v&&v.fileName?v.fileName:""}}})},File.prototype.init=function(){var _this=this;this.setInit("iconRight","fa-file-text-o");var $root=$(this._),label=this._components.label=tui.elem("span"),iconRight=this._components.iconRight=tui.elem("i"),iconInvalid=this._components.iconInvalid=tui.elem("i");iconInvalid.className="tui-invalid-icon",label.className="tui-input-label",label.setAttribute("unselectable","on"),this._.appendChild(label),this._.appendChild(iconInvalid),this._.appendChild(iconRight),this._.setAttribute("tabIndex","0"),$(this._).focus(function(){$root.addClass("tui-active")});var onblur=function(){document.activeElement!==_this._&&document.activeElement!==_this._uploader.getInput()&&($root.removeClass("tui-active"),_this.get("disable")||_this.get("autoValidate")&&_this.validate())};$(this._).blur(function(){setTimeout(function(){onblur()})}),this._uploader.on("focus",function(){$root.addClass("tui-active")}),this._uploader.on("blur",function(){setTimeout(function(){onblur()})}),this._uploader.on("change",function(e){return _this.fire("change",e)}),this._uploader.on("success",function(e){_this.set("value",e.data.response),_this.fire("success",e)}),this._uploader.on("error",function(e){!1!==_this.fire("error",e)&&tui.errbox(e.data.response.error,tui.str("Error"))})},File.prototype.render=function(){this._.scrollLeft=0;var $root=$(this._),label=this._components.label,iconRight=this._components.iconRight,iconInvalid=this._components.iconInvalid;this.get("disable")?($root.addClass("tui-disable"),this._uploader.deleteInput(),this._.setAttribute("tabIndex","0")):($root.removeClass("tui-disable"),this._uploader.createInput(),this._.removeAttribute("tabIndex"));var text=this.get("text");null===text||""===text?(text=this.get("placeholder"),$(label).addClass("tui-placeholder")):$(label).removeClass("tui-placeholder"),null===text&&(text=""),$(label).text(text),iconRight.className=this.get("iconRight"),iconRight.style.display="",iconRight.style.right="0",this._valid?($root.removeClass("tui-invalid"),iconInvalid.style.display="none"):($root.addClass("tui-invalid"),iconInvalid.style.display="",iconInvalid.style.right=iconRight.offsetWidth+"px"),!this._valid&&this._invalidMessage?this._set("follow-tooltip",this._invalidMessage):this._set("follow-tooltip",null)},File}(widget.InputBase);widget.File=File,widget.register(File,"file")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function getFileTypeIcon(item){return item?IMAGE_EXT.test(item.fileName)||IMAGE_MIME.test(item.mimeType)?"file-type-image":WORD_EXT.test(item.fileName)||WORD_MIME.test(item.mimeType)?"file-type-word":EXCEL_EXT.test(item.fileName)||EXCEL_MIME.test(item.mimeType)?"file-type-excel":PPT_EXT.test(item.fileName)||PPT_MIME.test(item.mimeType)?"file-type-ppt":TXT_EXT.test(item.fileName)||TXT_MIME.test(item.mimeType)?"file-type-txt":PDF_EXT.test(item.fileName)||PDF_MIME.test(item.mimeType)?"file-type-pdf":"file-type-unknow":"file-type-unknow"}var IMAGE_EXT=/\.(png|jpg|jpeg|gif)$/i,IMAGE_MIME=/^image\/(png|jpeg|gif)$/i,WORD_EXT=/\.(doc|docx|rft|docm)$/i,WORD_MIME=/^application\/(rtf|vnd\.ms-word(\.document\.macroEnabled\.12)?|vnd\.openxmlformats-officedocument\.wordprocessingml\.document)$/i,EXCEL_EXT=/\.(xls|xlsx|xlsm|csv)$/i,EXCEL_MIME=/^text\/csv|application\/(vnd\.ms-excel(\.sheet\.macroEnabled\.12)?|vnd\.openxmlformats-officedocument\.spreadsheetml\.sheet)$/i,PPT_EXT=/\.(ppt|pptx|ppat)$/i,PPT_MIME=/^application\/(vnd\.ms-powerpoint(\.presentation\.macroEnabled\.12)?|vnd\.openxmlformats-officedocument\.presentationml\.presentation)$/i,TXT_EXT=/\.(txt|log)$/i,TXT_MIME=/^text\/plain$/i,PDF_EXT=/\.pdf$/i,PDF_MIME=/^application\/pdf$/i,Files=function(_super){function Files(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Files,_super),Files.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this._uploadBox=tui.elem("div"),this._uploader=tui.browser.createUploader(this._uploadBox),this._values=[],this.setRestrictions({action:{set:function(value){_this._uploader.getOptions().action=value},get:function(){return _this._uploader.getOptions().action}},accept:{set:function(value){_this._uploader.getOptions().accept=value,_this._uploader.getInput()&&(_this._uploader.deleteInput(),_this._uploader.createInput())},get:function(){return _this._uploader.getOptions().accept}},value:{set:function(value){value instanceof Array?_this._values=value:null===value&&(_this._values.length=0)},get:function(){return _this._values}},reorder:{set:function(value){typeof value!=tui.UNDEFINED&&(_this._data.reorder=!!value)},get:function(){return!!_this._data.reorder}},bigLabel:{set:function(value){typeof value!=tui.UNDEFINED&&(_this._data.bigLabel=!!value)},get:function(){return!!_this._data.bigLabel}}})},Files.prototype.init=function(){var _this=this;this._uploadBox.className="tui-files-upload-box";var onblur=function(){document.activeElement!==_this._&&document.activeElement!==_this._uploader.getInput()&&($(_this._uploadBox).removeClass("tui-active"),_this.get("disable"))};$(this._).blur(function(){setTimeout(function(){onblur()})}),this._uploader.on("focus",function(){$(_this._uploadBox).addClass("tui-active")}),this._uploader.on("blur",function(){setTimeout(function(){onblur()})}),this._uploader.on("change",function(e){return _this.fire("change",e)}),this._uploader.on("success",function(e){var newItem={fileId:e.data.response.fileId,fileName:e.data.response.fileName,mimeType:e.data.response.mimeType,length:e.data.response.length,url:e.data.response.url};_this._values.push(newItem),_this.render(),_this.fire("success",e)}),this._uploader.on("error",function(e){!1!==_this.fire("error",e)&&tui.errbox(e.data.response.error,tui.str("Error"))})},Files.prototype.bindRemove=function(removeIcon,fileIndex){var _this=this;$(removeIcon).click(function(e){_this._values.splice(fileIndex,1),_this.render(),_this.fire("delete",e),e.preventDefault(),e.stopPropagation()})},Files.prototype.bindDownload=function(item,url){$(item).click(function(e){window.open(url),e.preventDefault(),e.stopPropagation()})},Files.prototype.bindReorder=function(item,fileItem){var _this=this;if(this.get("reorder")){var firstPoint=null,oldRect=null;$(item).on("mousedown",function(ev){firstPoint=tui.browser.isLButton(ev)?{x:ev.clientX,y:ev.clientY}:null}),$(item).on("mouseup",function(e){firstPoint=null}),$(item).on("mousemove",function(e){var ev=e;if(ev.preventDefault(),tui.browser.isLButton(ev)&&firstPoint&&tui.browser.isPosterity(item,e.target)&&(Math.abs(ev.clientX-firstPoint.x)>=5||Math.abs(ev.clientY-firstPoint.y)>=5)){var pos=item._index,placeholder=tui.elem("div");placeholder.className="tui-files-item",placeholder.style.verticalAlign="middle";var divStyle=tui.browser.getCurrentStyle(item);placeholder.style.display=divStyle.display,placeholder.style.width=item.offsetWidth-2+"px",placeholder.style.height=item.offsetHeight-2+"px",oldRect=tui.browser.getRectOfScreen(item);var curWidth=item.offsetWidth-parseFloat(divStyle.paddingLeft)-parseFloat(divStyle.paddingRight);item.style.position="fixed",item.style.zIndex="100",item.style.opacity="0.8",item.style.filter="alpha(opacity=80)",item.style.left=oldRect.left+"px",item.style.top=oldRect.top+"px";var savedWidth=item.style.width;item.style.width=curWidth+"px",tui.browser.addClass(item,"tui-form-item-moving"),_this._.insertBefore(placeholder,item);var targetIndex=null;tui.widget.openDragMask(function(e){item.style.left=oldRect.left+e.clientX-firstPoint.x+"px",item.style.top=oldRect.top+e.clientY-firstPoint.y+"px";for(var i=0;i<_this._.childNodes.length;i++){var icon=_this._.childNodes[i];if(icon!==item&&"number"==typeof icon._index){var testHeight="block"===tui.browser.getCurrentStyle(icon).display||"block"===placeholder.style.display,rc=tui.browser.getRectOfScreen(icon);if(testHeight){if(e.clientX>rc.left&&e.clientX<rc.left+rc.width&&e.clientY>rc.top&&e.clientY<rc.top+rc.height/2){_this._.insertBefore(placeholder,icon),targetIndex=icon._index;break}if(e.clientX>rc.left&&e.clientX<rc.left+rc.width&&e.clientY>rc.top+rc.height/2&&e.clientY<rc.top+rc.height){_this._.insertBefore(placeholder,icon.nextSibling),targetIndex=icon._index+1;break}}else{if(e.clientX>rc.left&&e.clientX<rc.left+rc.width/2&&e.clientY>rc.top&&e.clientY<rc.top+rc.height){_this._.insertBefore(placeholder,icon),targetIndex=icon._index;break}if(e.clientX>rc.left+rc.width/2&&e.clientX<rc.left+rc.width&&e.clientY>rc.top&&e.clientY<rc.top+rc.height){_this._.insertBefore(placeholder,icon.nextSibling),targetIndex=icon._index+1;break}}}}},function(e){firstPoint=null,item.style.position="",item.style.zIndex="",item.style.opacity="",item.style.filter="",item.style.left="",item.style.top="",item.style.width=savedWidth,tui.browser.removeClass(item,"tui-form-item-moving"),_this._.removeChild(placeholder),null!=targetIndex&&targetIndex!=pos&&(_this._values.splice(pos,1),targetIndex<pos?_this._values.splice(targetIndex,0,fileItem):_this._values.splice(targetIndex-1,0,fileItem),_this.render())})}})}},Files.prototype.render=function(){tui.browser.removeNode(this._uploadBox),this._.innerHTML="";for(var readonly=!!this.get("readonly"),disable=!!this.get("disable"),i=0;i<this._values.length;i++){var fileItem=this._values[i],item=tui.elem("div");item._index=i,item.className="tui-files-item",this.get("bigLabel")&&tui.browser.addClass(item,"tui-files-big-label");var label=tui.elem("div"),nameText=fileItem?tui.browser.toSafeText(fileItem.fileName):"NOT FOUND";if(item.setAttribute("tooltip",nameText),label.innerHTML=nameText,fileItem&&fileItem.url&&(IMAGE_EXT.test(fileItem.fileName)||IMAGE_MIME.test(fileItem.mimeType))){var image=tui.elem("img");image.src=fileItem.url,item.appendChild(image)}else item.className+=" "+getFileTypeIcon(fileItem);if(item.appendChild(label),!readonly&&!disable){var removeIcon=tui.elem("span");removeIcon.className="tui-files-remove-icon",item.appendChild(removeIcon),this.bindRemove(removeIcon,i),this.get("reorder")&&this.bindReorder(item,fileItem)}!disable&&fileItem&&fileItem.url&&this.bindDownload(item,fileItem.url),this._.appendChild(item)}readonly||disable||"number"==typeof this.get("max")&&this._values.length>=this.get("max")||this._.appendChild(this._uploadBox),this.get("bigLabel")?tui.browser.addClass(this._uploadBox,"tui-files-big-label"):tui.browser.removeClass(this._uploadBox,"tui-files-big-label"),this._uploader.createInput()},Files}(widget.Widget);widget.Files=Files,widget.register(Files,"files")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function optionsToText(options){function addNodes(nodes,level){if(void 0===level&&(level=""),nodes)for(var padding=level?level+" ":"",_i=0,nodes_1=nodes;_i<nodes_1.length;_i++){var item=nodes_1[_i];item.value==item.text?result+=padding+item.value+"\n":result+=padding+item.value+": "+item.text+"\n",addNodes(item.children,level+">")}}var result="";if(!options)return result;for(var _i=0,options_1=options;_i<options_1.length;_i++){var o=options_1[_i];result.length>0&&(result+="\n"),o.condition&&(result+="["+o.condition+"]\n"),addNodes(o.data)}return result}function textToOptions(text,multiOption){function getLeve(s){var count=0;if(!s)return 0;for(var _i=0,s_1=s;_i<s_1.length;_i++)">"==s_1[_i]&&count++;return count}function getNode(s){var pos=(s=s.trim()).indexOf(":");return pos<0?{value:s,text:s,check:!multiOption&&undefined}:{value:s.substring(0,pos).trim(),text:s.substring(pos+1).trim(),check:!multiOption&&undefined}}var result=[];if(!text)return result;for(var tmp=[],arr=text.split("\n"),condition=undefined,nodeList=null,_i=0,arr_4=arr;_i<arr_4.length;_i++){var s=arr_4[_i];if(s.trim().length>0)if("["===(s=s.trim())[0]){if(/^\[.+\]$/.test(s)){if(nodeList){data={condition:condition,list:nodeList};tmp.push(data)}condition=s.substr(1,s.length-2),nodeList=null}}else null==nodeList&&(nodeList=[]),nodeList.push(s)}if(nodeList){var data={condition:condition,list:nodeList};tmp.push(data)}for(var _a=0,tmp_1=tmp;_a<tmp_1.length;_a++){var t=tmp_1[_a];result.push({condition:t.condition,data:function(list){function getList(pos,nodes,level){for(var i=pos;i<list.length;i++){var s=list[i],lv=getLeve(s);if(lv==level)nodes.push(getNode(s.substr(lv)));else{if(!(lv==level+1&&nodes.length>0)){if(lv<level)return i-1;continue}var children=[];nodes[nodes.length-1].children=children,i=getList(i,children,level+1)}}return i}var result=[];return getList(0,result,0),result}(t.list)})}return result}function exist(arr,option){return arr instanceof Array&&arr.indexOf(option)>=0}var MAX=6,FormControl=function(){function FormControl(form,define){var _this=this;this.selected=!1,this.form=form,this.define=define,this.div=tui.elem("div"),this.mask=tui.elem("div"),this.mask.setAttribute("unselectable","on"),this.mask.className="tui-form-item-mask",this.mask.style.display="none",this.mask.appendChild(tui.elem("span")),this.toolbar=tui.elem("div"),this.toolbar.className="tui-form-item-toolbar",this.btnAdd=widget.create("button",{text:"<i class='fa fa-plus'></i>"}),this.btnAdd.appendTo(this.toolbar),this.btnEdit=widget.create("button",{text:"<i class='fa fa-pencil'></i>"}),this.btnEdit.appendTo(this.toolbar),this.toolbar.appendChild(tui.elem("span")),this.btnSize=widget.create("button",{text:"1x"}),this.btnPosition=widget.create("button",{text:"N"}),this._sizeSplitter=tui.elem("span"),this._posSplitter=tui.elem("span"),this.btnSize.appendTo(this.toolbar),this.toolbar.appendChild(this._sizeSplitter),this.btnPosition.appendTo(this.toolbar),this.toolbar.appendChild(this._posSplitter),this.btnDelete=widget.create("button",{text:"<i class='fa fa-trash'></i>"}),this.btnDelete.appendTo(this.toolbar),this.div.appendChild(this.mask),this.div.className="tui-form-item-container",this.applySize(),this.label=tui.elem("div"),this.label.className="tui-form-item-label",this.div.appendChild(this.label),$(this.mask).mousedown(function(e){e.stopPropagation(),_this.form.fire("itemmousedown",{e:e,control:_this})}),$(this.mask).mousemove(function(e){_this.form.fire("itemmousemove",{e:e,control:_this})}),$(this.mask).mouseup(function(e){_this.form.fire("itemmouseup",{e:e,control:_this})}),$(this.mask).dblclick(function(){_this.showProperties()}),this.btnDelete.on("click",function(){_this.form.fire("itemremove",{control:_this})});var menuSize=widget.create("menu");this.btnSize.on("click",function(){menuSize._set("items",[{type:"radio",text:"1x",group:"size",value:1,checked:1===_this.define.size||!_this.define.size},{type:"radio",text:"2x",group:"size",value:2,checked:2===_this.define.size},{type:"radio",text:"3x",group:"size",value:3,checked:3===_this.define.size},{type:"radio",text:"4x",group:"size",value:4,checked:4===_this.define.size},{type:"radio",text:"5x",group:"size",value:5,checked:5===_this.define.size},{type:"radio",text:"MAX",group:"size",value:MAX,checked:_this.define.size===MAX}]),menuSize.open(_this.btnSize._)}),menuSize.on("click",function(e){var v=e.data.item.value;v>=1&&v<=MAX&&(_this.define.size=v),_this.applySize(),_this.form.fire("itemresize",{e:e,control:_this})});var menuPos=widget.create("menu");this.btnPosition.on("click",function(){menuPos._set("items",[{type:"radio",text:"Normal",group:"pos",value:"normal",checked:!/^(left|right|newline)$/.test(_this.define.position)},{type:"radio",text:"Left",group:"pos",value:"left",checked:"left"===_this.define.position},{type:"radio",text:"Right",group:"pos",value:"right",checked:"right"===_this.define.position},{type:"radio",text:"Newline",group:"pos",value:"newline",checked:"newline"===_this.define.position}]),menuPos.open(_this.btnPosition._)}),menuPos.on("click",function(e){var v=e.data.item.value;_this.define.position=v,_this.applySize(),_this.form.fire("itemresize",{e:e,control:_this})}),this.btnEdit.on("click",function(){_this.showProperties()}),this.btnAdd.on("click",function(){_this.form.fire("itemadd",{button:_this.btnAdd,control:_this})})}return FormControl.detectRequired=function(pages,recentPage){var options=pages[0].form.get("value").options,atLeast=pages[1].form.getItem("atLeast").getValue(null);0==recentPage?options.indexOf("required")>=0?(!atLeast||atLeast<=0)&&pages[1].form.getItem("atLeast").setValue(1):pages[1].form.getItem("atLeast").setValue(null):1==recentPage&&(atLeast&&atLeast>0?tui.text.arrayAdd(options,"required"):tui.text.arrayRemove(options,"required"),pages[0].form.getItem("options").setValue(options))},FormControl.detectRequiredByValidation=function(pages,recentPage){var options=pages[0].form.get("value").options,vdef=pages[1].form.getItem("validation"),validation=vdef&&vdef.getValue(null)||null,hasAny=!1;if(validation){for(var _i=0,validation_1=validation;_i<validation_1.length;_i++)if("*any"===validation_1[_i].format.trim()){hasAny=!0;break}}else validation=[];if(0==recentPage){if(options.indexOf("required")>=0)hasAny||validation.push({format:"*any",message:tui.str("message.cannot.be.empty")});else if(hasAny)for(var i=0;i<validation.length;)"*any"===validation[i].format.trim()?validation.splice(i,1):i++;pages[1].form.getItem("validation").setValue(validation)}else 1==recentPage&&(hasAny?tui.text.arrayAdd(options,"required"):tui.text.arrayRemove(options,"required"),pages[0].form.getItem("options").setValue(options))},FormControl.prototype.onPropertyPageSwitch=function(propertyPages,recentPage){},FormControl.prototype.showProperties=function(){var _this=this,properties=[{type:"textbox",label:tui.str("form.section"),key:"label",value:this.define.label},{type:"textbox",label:tui.str("form.field.name"),key:"key",value:this.define.key},{type:"options",label:tui.str("form.options"),key:"options",size:2,options:[{data:[{value:"required",text:tui.str("form.required")},{value:"disable",text:tui.str("form.disable")},{value:"emphasize",text:tui.str("form.emphasize")}]}],position:"newline",value:[this.define.required?"required":null,this.define.disable?"disable":null,this.define.emphasize?"emphasize":null]},{type:"textarea",maxHeight:200,label:tui.str("form.description"),key:"description",value:this.define.description,size:MAX},{type:"textarea",maxHeight:200,label:tui.str("form.precondition"),key:"condition",value:this.define.condition,size:MAX}],pages=[{name:tui.str("form.common"),properties:properties}],specificProperties=this.getProperties();if(specificProperties)for(var _i=0,specificProperties_1=specificProperties;_i<specificProperties_1.length;_i++){var p=specificProperties_1[_i];pages.push(p)}var container=tui.elem("div"),tab=widget.create("button-group");tab._.className="tui-tab tui-form-properties-tab",tab._set("type","radio"),container.appendChild(tab._);for(var i=0;i<pages.length;i++){var page=pages[i],btn=widget.create("radio");btn._set("text",page.name.toUpperCase()),btn._set("value",i),0==i&&btn._set("checked",!0),tab._.appendChild(btn._);var form=widget.create("form");form._.className="tui-form-property-form",i>0&&(form._.style.display="none"),form.set("definition",page.properties),page.designMode&&form.set("mode","design"),page.form=form,container.appendChild(form._)}var recentPage=0;tab.on("click",function(){for(var target=tab.get("value"),i=0;i<pages.length;i++)i!=target&&(pages[i].form._.style.display="none");for(i=0;i<pages.length;i++)i==target&&(pages[i].form._.style.display="block");recentPage!=target&&("function"==typeof _this.onPropertyPageSwitch&&_this.onPropertyPageSwitch(pages,recentPage),recentPage=target)});var dialog=widget.create("dialog");dialog.set("content",container),dialog.set("mobileModel",!0),dialog.open("ok#tui-primary"),dialog.on("btnclick",function(){"function"==typeof _this.onPropertyPageSwitch&&_this.onPropertyPageSwitch(pages,recentPage);var values=pages[0].form.get("value"),customValues=[];customValues.push(values);for(var i=1;i<pages.length;i++)if(pages[i].designMode)customValues.push(pages[i].form.get("definition"));else{if(!pages[i].form.validate())return tab.set("value",i),void tab.fire("click");customValues.push(pages[i].form.get("value"))}_this.define.label=values.label?values.label:undefined,_this.define.key=values.key?values.key:undefined,_this.define.condition=values.condition?values.condition:undefined,_this.define.description=values.description?values.description:undefined,_this.define.disable=values.options.indexOf("disable")>=0||undefined,_this.define.required=values.options.indexOf("required")>=0||undefined,_this.define.emphasize=values.options.indexOf("emphasize")>=0||undefined,_this.setProperties(customValues),_this.update(),_this.form.fire("itemvaluechanged",{control:_this}),dialog.close()})},FormControl.prototype.update=function(){var d=this.define;if(d.label||d.description||d.required){if(tui.browser.removeClass(this.label,"tui-hidden"),d.label?this.label.innerHTML=tui.browser.toSafeText(d.label):this.label.innerHTML="&nbsp;",d.required?tui.browser.addClass(this.label,"tui-form-item-required"):tui.browser.removeClass(this.label,"tui-form-item-required"),d.emphasize?tui.browser.addClass(this.label,"tui-form-item-emphasize"):tui.browser.removeClass(this.label,"tui-form-item-emphasize"),d.description){var desc=tui.elem("span");desc.setAttribute("tooltip",d.description),this.label.appendChild(desc)}}else tui.browser.addClass(this.label,"tui-hidden")},FormControl.prototype.isPresent=function(){return this.div.parentElement===this.form._},FormControl.prototype.hide=function(){tui.browser.removeNode(this.div)},FormControl.prototype.show=function(){this.form._.appendChild(this.div)},FormControl.prototype.setDesign=function(value){value?tui.browser.addClass(this.div,"tui-form-in-design"):tui.browser.removeClass(this.div,"tui-form-in-design")},FormControl.prototype.updateIndex=function(index){this.mask.childNodes[0].innerHTML=index+""},FormControl.prototype.select=function(value){var _this=this;this.selected=!!value,this.selected?(tui.browser.addClass(this.div,"tui-form-item-selected"),this.toolbar.style.opacity="0",this.div.appendChild(this.toolbar),setTimeout(function(){_this.selected&&(_this.toolbar.style.opacity="1")},16)):(tui.browser.removeClass(this.div,"tui-form-item-selected"),this.toolbar.style.opacity="0",tui.ieVer<9&&tui.ieVer>0?tui.browser.removeNode(this.toolbar):setTimeout(function(){_this.selected||tui.browser.removeNode(_this.toolbar)},500))},FormControl.prototype.isSelect=function(){return this.selected},FormControl.prototype.getKey=function(){return this.define.key||null},FormControl.prototype.applySize=function(){var define=this.define;tui.browser.removeClass(this.div,"tui-form-item-size-2 tui-form-item-size-3 tui-form-item-size-4 tui-form-item-size-5 tui-form-item-size-full tui-form-item-newline tui-form-item-pull-left tui-form-item-pull-right"),define.size>1&&define.size<MAX?(define.size=Math.floor(define.size),tui.browser.addClass(this.div," tui-form-item-size-"+define.size)):define.size>=MAX?(tui.browser.addClass(this.div,"tui-form-item-size-full"),define.size=MAX):delete define.size,"newline"===define.position?tui.browser.addClass(this.div,"tui-form-item-newline"):"left"===define.position?tui.browser.addClass(this.div,"tui-form-item-pull-left"):"right"===define.position?tui.browser.addClass(this.div,"tui-form-item-pull-right"):delete define.position,"left"==this.define.position?this.btnPosition.set("text","L"):"right"==this.define.position?this.btnPosition.set("text","R"):"newline"==this.define.position?this.btnPosition.set("text","NL"):this.btnPosition.set("text","N"),"number"!=typeof this.define.size||isNaN(this.define.size)||this.define.size<1&&this.define.size>MAX?this.btnSize.set("text","1x"):this.define.size==MAX?this.btnSize.set("text","MAX"):this.btnSize.set("text",this.define.size+"x"),this.isResizable()?(this.btnSize.removeClass("tui-hidden"),this.btnPosition.removeClass("tui-hidden"),tui.browser.removeClass(this._sizeSplitter,"tui-hidden"),tui.browser.removeClass(this._posSplitter,"tui-hidden")):(this.btnSize.addClass("tui-hidden"),this.btnPosition.addClass("tui-hidden"),tui.browser.addClass(this._sizeSplitter,"tui-hidden"),tui.browser.addClass(this._posSplitter,"tui-hidden"))},FormControl}();widget.FormControl=FormControl;var BasicFormControl=function(_super){function BasicFormControl(form,define,type){var _this=_super.call(this,form,define)||this;return _this._name=name,_this._widget=widget.create(type),_this._widget.appendTo(_this.div),_this}return __extends(BasicFormControl,_super),BasicFormControl.prototype.update=function(){_super.prototype.update.call(this),this._widget._set("disable",!!this.define.disable),this._widget._set("value",typeof this.define.value===tui.UNDEFINED?null:this.define.value),this.define.validation instanceof Array?this._widget._set("validate",this.define.validation):this._widget._set("validate",[]),this.define.required?this._widget._set("clearable",!1):this._widget._set("clearable",!0)},BasicFormControl.prototype.isResizable=function(){return!0},BasicFormControl.prototype.getValue=function(cal){return void 0===cal&&(cal=null),this._widget.get("value")},BasicFormControl.prototype.setValue=function(value){this._widget.set("value",value),this.define.value=value,this.form.fire("itemvaluechanged",{control:this})},BasicFormControl.prototype.render=function(designMode){designMode&&"function"==typeof this._widget.reset&&this._widget.reset(),this._widget.render()},BasicFormControl}(FormControl);widget.BasicFormControl=BasicFormControl;var FormSection=function(_super){function FormSection(form,define){var _this=_super.call(this,form,define)||this;return _this._hr=tui.elem("hr"),_this.label.className="tui-form-item-label tui-form-section-label",_this._hr.className="tui-form-line-label",_this.div.appendChild(_this._hr),_this.div.style.display="block",_this.div.style.clear="both",_this.div.style.width="auto",_this.label.onmousedown=function(){"folder"==_this.define.display&&(_this.define.folded=!_this.define.folded,_this.form.render())},_this.label.onclick=function(){"link"!=_this.define.display||_this.define.disable||form.fire("itemevent",{event:"openLink",control:_this,name:_this.define.label,url:_this.getValue()})},_this}return __extends(FormSection,_super),FormSection.prototype.update=function(){_super.prototype.update.call(this),/^(visible|folder|invisible|newline|link)$/.test(this.define.display)||(this.define.display="visible"),this.applySize()},FormSection.prototype.isResizable=function(){return!1},FormSection.prototype.getValue=function(){return typeof this.define.value!==tui.UNDEFINED?this.define.value:null},FormSection.prototype.setValue=function(value){typeof value!==tui.UNDEFINED&&(this.define.value=value),this.form.fire("itemvaluechanged",{control:this})},FormSection.prototype.render=function(designMode){var l,d=this.define;if(l=""!=d.value&&null!=d.value&&typeof d.value!=tui.UNDEFINED&&d.valueAsLabel&&"link"!=d.display?d.value+"":d.label,this.label.innerHTML=l?tui.browser.toSafeText(l):"&nbsp;",d.description){var desc=tui.elem("span");desc.setAttribute("tooltip",d.description),this.label.appendChild(desc)}(l||"folder"==this.define.display)&&("number"!=typeof d.fontSize&&(d.fontSize=22),d.fontSize<12&&(d.fontSize=12),d.fontSize>48&&(d.fontSize=48),this.label.style.fontSize=d.fontSize+"px",this.label.style.lineHeight=d.fontSize+4+"px","visible"==d.display&&/^(left|right|center)$/.test(d.align)?this.label.style.textAlign=d.align:this.label.style.textAlign="left"),"link"==d.display?(tui.browser.addClass(this._hr,"tui-hidden"),tui.browser.addClass(this.label,"tui-form-item-link"),this.define.disable?tui.browser.addClass(this.label,"tui-disable"):tui.browser.removeClass(this.label,"tui-disable")):(tui.browser.removeClass(this._hr,"tui-hidden"),tui.browser.removeClass(this.label,"tui-form-item-link"),tui.browser.removeClass(this.label,"tui-disable")),"folder"!=d.display&&"link"!=d.display||(d.required=undefined,tui.browser.removeClass(this.label,"tui-form-item-required")),this.define.label||this.define.description||"folder"==this.define.display?tui.browser.removeClass(this.label,"tui-hidden"):tui.browser.addClass(this.label,"tui-hidden"),designMode?(tui.browser.removeClass(this.div,"tui-hidden"),tui.browser.removeClass(this._hr,"tui-hidden"),tui.browser.removeClass(this.div,"tui-form-section-newline"),tui.browser.removeClass(this.div,"tui-form-section-folder"),tui.browser.removeClass(this.div,"tui-folded"),"folder"===this.define.display&&(tui.browser.addClass(this.div,"tui-form-section-folder"),this.define.folded&&tui.browser.addClass(this.div,"tui-folded"))):(tui.browser.removeClass(this.div,"tui-form-section-newline"),tui.browser.removeClass(this.div,"tui-form-section-folder"),tui.browser.removeClass(this.div,"tui-folded"),tui.browser.removeClass(this.div,"tui-hidden"),"invisible"===this.define.display?tui.browser.addClass(this.div,"tui-hidden"):"newline"===this.define.display?tui.browser.addClass(this.div,"tui-form-section-newline"):"folder"===this.define.display&&(tui.browser.addClass(this.div,"tui-form-section-folder"),this.define.folded&&tui.browser.addClass(this.div,"tui-folded")))},FormSection.prototype.getProperties=function(){return[{name:tui.str("form.section"),properties:[{type:"textbox",key:"fontSize",inputType:"number",label:tui.str("form.font.size"),value:this.define.fontSize,validation:[{format:"*digital",message:tui.str("message.invalid.format")},{format:"*min:12",message:tui.str("message.invalid.value")},{format:"*max:48",message:tui.str("message.invalid.value")}],description:"12 ~ 48"},{type:"textbox",key:"value",label:tui.str("form.value"),value:this.define.value},{type:"options",key:"display",label:tui.str("form.display"),atMost:1,options:[{data:[{value:"visible",text:tui.str("form.section")},{value:"folder",text:tui.str("form.foldable")},{value:"invisible",text:tui.str("form.invisible")},{value:"newline",text:tui.str("form.newline")},{value:"link",text:tui.str("form.link")}]}],size:6,value:/^(visible|folder|invisible|newline|link)$/.test(this.define.display)?this.define.display:"visible"},{type:"options",key:"align",label:tui.str("form.text.align"),atMost:1,options:[{data:[{value:"left",text:tui.str("form.align.left")},{value:"center",text:tui.str("form.align.center")},{value:"right",text:tui.str("form.align.right")}]}],size:6,value:this.define.align||"left",condition:'display = "visible"'},{type:"options",key:"valueAsLabel",label:tui.str("form.value.as.label"),atMost:1,options:[{data:[{value:"enable",text:tui.str("form.enable")},{value:"disable",text:tui.str("form.disable")}]}],size:6,value:this.define.valueAsLabel?"enable":"disable",condition:'display != "link"'}]}]},FormSection.prototype.setProperties=function(properties){var values=properties[1];values.fontSize&&/^\d+$/.test(values.fontSize)?this.define.fontSize=parseInt(values.fontSize):this.define.fontSize=undefined,"visible"==values.display&&/^(left|center|right)$/.test(values.align)?this.define.align="left"==values.align?undefined:values.align:this.define.align=undefined,"folder"!=values.display&&"link"!=this.define.display||(this.define.required=undefined),this.define.value=values.value,this.define.display=values.display,"enable"==values.valueAsLabel&&"link"!=this.define.display?this.define.valueAsLabel=!0:this.define.valueAsLabel=undefined},FormSection.prototype.validate=function(){return!0},FormSection.icon="fa-header",FormSection.desc="form.section",FormSection.order=0,FormSection}(FormControl);widget.Form.register("section",FormSection);var FormTextView=function(_super){function FormTextView(form,define){var _this=_super.call(this,form,define)||this;return _this._textDiv=tui.elem("div"),_this._textDiv.className="tui-form-text-view-content",_this.div.appendChild(_this._textDiv),_this}return __extends(FormTextView,_super),FormTextView.prototype.update=function(){_super.prototype.update.call(this),/^(normal|inline)$/.test(this.define.style)||(this.define.style="normal"),"inline"==this.define.style&&(this.define.size=MAX),this.applySize()},FormTextView.prototype.isResizable=function(){return"inline"!=this.define.style},FormTextView.prototype.getValue=function(){return typeof this.define.value!==tui.UNDEFINED?this.define.value:null},FormTextView.prototype.setValue=function(value){typeof value!==tui.UNDEFINED&&(this.define.value=value),this.form.fire("itemvaluechanged",{control:this})},FormTextView.prototype.render=function(designMode){var d=this.define,l=d.label;if(this.label.innerHTML=l?tui.browser.toSafeText(l):"&nbsp;",d.description)if("inline"==d.style)this.label.setAttribute("tooltip",d.description);else{var desc=tui.elem("span");desc.setAttribute("tooltip",d.description),this.label.appendChild(desc)}"number"==typeof d.fontSize?(d.fontSize<12&&(d.fontSize=12),d.fontSize>40&&(d.fontSize=40),this._textDiv.style.fontSize=d.fontSize+"px",this._textDiv.style.lineHeight=d.fontSize+4+"px"):(this._textDiv.style.fontSize="",this._textDiv.style.lineHeight=""),/^(left|right|center)$/.test(d.align)||(d.align="left"),this._textDiv.style.textAlign=d.align,/^(#[0-9a-fA-F]{3}|#[0-9a-fA-F]{6})$/i.test(d.color)||(d.color="#555"),this._textDiv.style.color=d.color,"inline"==d.style?tui.browser.addClass(this.div,"tui-text-view-inline"):tui.browser.removeClass(this.div,"tui-text-view-inline"),this.define.label||this.define.description?tui.browser.removeClass(this.label,"tui-hidden"):tui.browser.addClass(this.label,"tui-hidden");var t=d.value?tui.browser.toSafeText(d.value):"&nbsp;";this._textDiv.innerHTML=t},FormTextView.prototype.getProperties=function(){return[{name:tui.str("form.textview"),properties:[{type:"textarea",key:"value",label:tui.str("form.value"),value:this.define.value,size:6},{type:"textbox",key:"fontSize",inputType:"number",label:tui.str("form.font.size"),value:this.define.fontSize,validation:[{format:"*digital",message:tui.str("message.invalid.format")},{format:"*min:12",message:tui.str("message.invalid.value")},{format:"*max:40",message:tui.str("message.invalid.value")}],description:"12 ~ 40"},{type:"textbox",key:"color",label:tui.str("form.text.color"),value:this.define.color,validation:[{format:"#[0-9a-zA-Z]{3}|#[0-9a-zA-Z]{6}",message:tui.str("message.invalid.format")}]},{type:"options",key:"style",label:tui.str("form.text.view.style"),atMost:1,options:[{data:[{value:"normal",text:tui.str("form.style.normal")},{value:"inline",text:tui.str("form.style.inline")}]}],value:this.define.style||"normal"},{type:"options",key:"align",label:tui.str("form.text.align"),atMost:1,options:[{data:[{value:"left",text:tui.str("form.align.left")},{value:"center",text:tui.str("form.align.center")},{value:"right",text:tui.str("form.align.right")}]}],value:this.define.align||"left"}]}]},FormTextView.prototype.setProperties=function(properties){var values=properties[1];values.fontSize&&/^\d+$/.test(values.fontSize)?this.define.fontSize=parseInt(values.fontSize):this.define.fontSize=undefined,/^(center|right)$/.test(values.align)?this.define.align=values.align:this.define.align=undefined,this.define.value=values.value,this.define.color=values.color,/^(inline)$/.test(values.style)?this.define.style=values.style:this.define.style=undefined},FormTextView.prototype.validate=function(){return!0},FormTextView.icon="fa-align-left",FormTextView.desc="form.textview",FormTextView.order=1,FormTextView.init={value:tui.str("form.text.content")},FormTextView}(FormControl);widget.Form.register("textview",FormTextView);var FormTextbox=function(_super){function FormTextbox(form,define){var _this=_super.call(this,form,define,"input")||this;return _this._widget.on("checkexp",function(e){try{return tui.exp.evaluate(e.data.exp,function(id){return"function"==id.type?tui.exp.processStandardFunc(id):_this.form.get("value")[id.name]})}catch(e){return!1}}),_this._widget.on("change",function(e){_this.define.value=_this.getValue(),form.fire("itemvaluechanged",{control:_this})}),_this._widget.on("right-icon-mousedown",function(e){if(_this.define.selection&&_this.define.selection.length)return!1}),_this._widget.on("right-icon-mouseup",function(e){if(_this.define.selection&&_this.define.selection.length){for(var menu=widget.create("menu"),items=[],_i=0,_a=_this.define.selection;_i<_a.length;_i++){var s=_a[_i];items.push({text:s})}return menu._set("items",items),e.data.preventDefault(),menu.on("click",function(e){_this._widget.set("text",e.data.item.text),_this.define.value=_this.getValue(),_this._widget.reset(),_this._widget.focus(),form.fire("itemvaluechanged",{control:_this})}),menu.open(_this._widget._,"Rb"),!1}}),_this}return __extends(FormTextbox,_super),FormTextbox.prototype.update=function(){_super.prototype.update.call(this),/^(text|password|email|url|number)$/.test(this.define.inputType)?this._widget._set("type",this.define.inputType):this._widget._set("type","text"),this.define.selection instanceof Array&&this.define.selection.length>0?this._widget._set("iconRight","fa-caret-down"):this._widget._set("iconRight",null),this._widget._set("clearable",!0)},FormTextbox.prototype.getProperties=function(){return[{name:tui.str("form.textbox"),properties:[{type:"options",key:"inputType",label:tui.str("form.input.type"),options:[{data:[{value:"text",text:tui.str("form.text")},{value:"password",text:tui.str("form.password")},{value:"email",text:tui.str("form.email")},{value:"url",text:tui.str("form.url")},{value:"number",text:tui.str("form.number")}]}],atMost:1,value:this.define.inputType?this.define.inputType:"text",size:2,position:"newline"},{type:"textarea",maxHeight:300,key:"selection",label:tui.str("form.options"),description:tui.str("form.textbox.selection.desc"),value:this.define.selection?this.define.selection.join("\n"):"",size:2},{type:"grid",key:"validation",features:["append","delete","edit"],label:tui.str("form.validation"),size:2,position:"newline",height:120,definitions:[{type:"textbox",key:"format",required:!0,label:tui.str("form.format"),selection:["*any","*url","*email","*digital","*integer","*float","*number","*currency","*date","*key","*max:<?>","*min:<?>","*maxlen:<?>","*minlen:<?>","*exp:<?>"],validation:[{format:"*any",message:tui.str("message.cannot.be.empty")},{format:"^(\\*(any|key|integer|number|digital|url|email|float|currency|date|max:\\d+|min:\\d+|maxlen:\\d+|minlen:\\d+|exp:.+)|[^\\*].*)$",message:tui.str("message.invalid.format")}],size:2},{type:"textarea",key:"message",maxHeight:300,required:!0,label:tui.str("form.message"),size:2,position:"newline",validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}]}],value:tui.clone(this.define.validation)}]}]},FormTextbox.prototype.setProperties=function(properties){var values=properties[1],selection=[];if(values.selection)for(var arr=(values.selection+"").split("\n"),i=0;i<arr.length;i++){var s=arr[i].trim();s&&selection.push(s)}this.define.selection=selection.length>0?selection:undefined,this.define.inputType="text"!=values.inputType?values.inputType:undefined,this.define.validation=(values.validation&&values.validation.length)>0?values.validation:undefined},FormTextbox.prototype.onPropertyPageSwitch=function(pages,recentPage){FormControl.detectRequiredByValidation(pages,recentPage)},FormTextbox.prototype.validate=function(){return this._widget.validate()},FormTextbox.icon="fa-pencil",FormTextbox.desc="form.textbox",FormTextbox.order=2,FormTextbox}(BasicFormControl);widget.Form.register("textbox",FormTextbox);var FormTextarea=function(_super){function FormTextarea(form,define){var _this=_super.call(this,form,define,"textarea")||this;return _this._widget.on("change",function(e){_this.define.value=_this.getValue(),form.fire("itemvaluechanged",{control:_this})}),_this._widget.on("checkexp",function(e){try{return tui.exp.evaluate(e.data.exp,function(id){return"function"==id.type?tui.exp.processStandardFunc(id):_this.form.get("value")[id.name]})}catch(e){return!1}}),_this}return __extends(FormTextarea,_super),FormTextarea.prototype.getProperties=function(){return[{name:tui.str("form.textarea"),properties:[{type:"textbox",key:"minHeight",inputType:"number",label:tui.str("form.min.height"),value:this.define.minHeight,validation:[{format:"*digital",message:tui.str("message.invalid.format")}]},{type:"textbox",key:"maxHeight",inputType:"number",label:tui.str("form.max.height"),value:this.define.maxHeight,validation:[{format:"*digital",message:tui.str("message.invalid.format")}]},{type:"grid",key:"validation",features:["append","delete","edit"],label:tui.str("form.validation"),size:2,position:"newline",height:150,definitions:[{type:"textbox",key:"format",required:!0,label:tui.str("form.format"),selection:["*any","*email","*url","*maxlen:<?>","*minlen:<?>","*exp:<?>"],validation:[{format:"*any",message:tui.str("message.cannot.be.empty")},{format:"^(\\*(any|url|email|maxlen:\\d+|minlen:\\d+|exp:.+)|[^\\*].*)$",message:tui.str("message.invalid.format")}],size:2},{type:"textarea",key:"message",maxHeight:300,required:!0,label:tui.str("form.message"),size:2,position:"newline",validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}]}],value:tui.clone(this.define.validation)}]}]},FormTextarea.prototype.update=function(){_super.prototype.update.call(this);var box=this._widget.getComponent("textbox");/\d+/.test((this.define.minHeight+"").trim())?box.style.minHeight=(this.define.minHeight+"").trim()+"px":box.style.minHeight="",/\d+/.test((this.define.maxHeight+"").trim())?this._widget._.style.maxHeight=(this.define.maxHeight+"").trim()+"px":this._widget._.style.maxHeight=""},FormTextarea.prototype.setProperties=function(properties){var values=properties[1];this.define.validation=(values.validation&&values.validation.length)>0?values.validation:undefined,/\d+/.test(values.minHeight+"")?this.define.minHeight=values.minHeight:this.define.minHeight=null,/\d+/.test(values.maxHeight+"")?this.define.maxHeight=values.maxHeight:this.define.maxHeight=null},FormTextarea.prototype.onPropertyPageSwitch=function(pages,recentPage){FormControl.detectRequiredByValidation(pages,recentPage)},FormTextarea.prototype.validate=function(){return this._widget.validate()},FormTextarea.icon="fa-edit",FormTextarea.desc="form.textarea",FormTextarea.order=3,FormTextarea.init={maxHeight:300,size:2,position:"newline"},FormTextarea}(BasicFormControl);widget.Form.register("textarea",FormTextarea);var FormOptions=function(_super){function FormOptions(form,define){var _this=_super.call(this,form,define)||this;return _this._group=widget.create("button-group"),_this._allBtn=widget.create("check"),_this._allBtn._set("text","<span>"+tui.str("all")+"</span>"),_this._allBtn._set("value",null),_this._group.on("click",function(e){if(e.data.button===_this._allBtn){var isCheck=!!_this._allBtn.get("checked");tui.search(_this._group._,function(elem){return elem instanceof widget.Button&&elem.set("checked",isCheck),!0})}else _this.syncSelectState();_this.define.value=_this.getValue(),_this._notifyBar.innerHTML="",form.fire("itemvaluechanged",{control:_this})}),_this._group.appendTo(_this.div),_this._notifyBar=tui.elem("div"),_this._notifyBar.className="tui-form-notify-bar",_this.div.appendChild(_this._notifyBar),_this}return __extends(FormOptions,_super),FormOptions.prototype.syncSelectState=function(){var _this=this,selectCount=0,totalCount=0;tui.search(this._group._,function(elem){return elem!==_this._allBtn&&(elem instanceof widget.Button&&(totalCount++,elem.get("checked")&&selectCount++),!0)}),0==selectCount?this._allBtn._set("checked",!1):selectCount==totalCount?(this._allBtn._set("checked",!0),this._allBtn._set("tristate",!1)):this._allBtn._set("tristate",!0)},FormOptions.prototype.isResizable=function(){return!0},FormOptions.prototype.update=function(){_super.prototype.update.call(this);var define=this.define;"vertical"===define.align?tui.browser.addClass(this._group._," tui-form-group-align-vertical"):tui.browser.removeClass(this._group._," tui-form-group-align-vertical"),this._group._set("disable",!!define.disable),this._notifyBar.innerHTML="",this.renderDesign()},FormOptions.prototype.getValue=function(cal){if(void 0===cal&&(cal=null),!cal)return this._group.get("value");var define=this.define,optionType=1==define.atMost?"radio":"check";this._group._set("type",optionType),tui.browser.removeNode(this._allBtn._),this._group._.innerHTML="";var key=define.key,data=[];if(define.options&&define.options.length>0){if(cal.path.indexOf(key)>=0)throw new Error('Invalid expression of select control: Cycle reference detected on "'+key+'"');cal.path.push(key);for(var _i=0,_a=this.define.options;_i<_a.length;_i++){var d=_a[_i];d.condition?tui.exp.evaluate(d.condition,function(id){return"function"==id.type?tui.exp.processStandardFunc(id):cal.cache.hasOwnProperty(id.name)?cal.cache[id.name]:(cal.calc(id.name,cal.path),cal.cache[id.name])})&&d.data&&d.data.length>0&&data.splice.apply(data,[data.length,0].concat(d.data)):d.data&&d.data.length>0&&data.splice.apply(data,[data.length,0].concat(d.data))}}if(data.length>0){"check"==optionType&&exist(this.define.features,"selectAll")&&this._group._.appendChild(this._allBtn._);for(var i=0;i<data.length;i++){var option=data[i],o=widget.create(optionType);o._set("value",option.value),o._set("text","<span>"+tui.browser.toSafeText(option.text)+"</span>"),this._group._.appendChild(o._)}}else{var padding=tui.elem("div");padding.style.padding="10px",padding.innerHTML=tui.str("message.not.available"),this._group._.appendChild(padding)}this._group._set("value",define.value);var tmpValue=this._group.get("value");return data.length>0&&"check"==optionType&&exist(this.define.features,"selectAll")&&this._allBtn.get("checked")&&tmpValue.splice(0,1),define.value=tmpValue,define.text=this._group.get("text"),define.value},FormOptions.prototype.setValue=function(value){this._group.set("value",value),this.define.value=value,this.form.fire("itemvaluechanged",{control:this})},FormOptions.prototype.renderDesign=function(){var define=this.define,data=[];if(define.options&&define.options.length>0)for(var _i=0,_a=this.define.options;_i<_a.length;_i++){var d=_a[_i];if(d.data&&d.data.length>0){for(i=0;i<d.data.length;i++)null!==(o=d.data[i]).value&&typeof o.value!==tui.UNDEFINED||(o.value=o.text),null!==o.text&&typeof o.text!==tui.UNDEFINED||(o.text=o.value),null!==o.value&&typeof o.value!==tui.UNDEFINED||d.data.splice(i--,1);data.splice.apply(data,[data.length,0].concat(d.data))}}var optionType=1==define.atMost?"radio":"check";if(this._group._set("type",optionType),tui.browser.removeNode(this._allBtn._),this._group._.innerHTML="",data.length>0){"check"==optionType&&exist(this.define.features,"selectAll")&&this._group._.appendChild(this._allBtn._);for(var i=0;i<data.length;i++){var option=data[i],o=widget.create(optionType);o._set("value",option.value),o._set("text","<span>"+tui.browser.toSafeText(option.text)+"</span>"),this._group._.appendChild(o._)}}else{var padding=tui.elem("div");padding.style.padding="10px",padding.innerHTML=tui.str("message.not.available"),this._group._.appendChild(padding)}this._group._set("value",define.value),this.syncSelectState()},FormOptions.prototype.render=function(designMode){designMode?this.renderDesign():this.syncSelectState();var g=this._group;g.render();for(var i=0;i<g._.children.length;i++){var btn=g._.children[i];btn.children.length>0&&btn.clientWidth-30>=0&&(btn.children[0].style.width=btn.clientWidth-30+"px")}""==this._notifyBar.innerHTML?tui.browser.addClass(this._notifyBar,"tui-hidden"):tui.browser.removeClass(this._notifyBar,"tui-hidden")},FormOptions.prototype.getProperties=function(){return[{name:tui.str("form.option.group"),properties:[{type:"textarea",maxHeight:300,key:"options",label:tui.str("form.options"),description:tui.str("form.option.group.desc"),value:optionsToText(this.define.options),validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}],size:6},{type:"options",key:"align",label:tui.str("form.arrange"),value:"vertical"===this.define.align?"vertical":"normal",options:[{data:[{value:"normal",text:tui.str("normal")},{value:"vertical",text:tui.str("vertical")}]}],atMost:1,size:1},{type:"options",key:"features",label:tui.str("form.grid.features"),value:this.define.features,options:[{data:[{value:"selectAll",text:tui.str("support.select.all")}]}],size:1,condition:"atMost > 1 or atMost = ''"},{type:"section",key:null,label:null,display:"newline"},{type:"textbox",inputType:"number",key:"atLeast",label:tui.str("form.at.least"),value:/^\d+$/.test(this.define.atLeast+"")?this.define.atLeast:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]},{type:"textbox",inputType:"number",key:"atMost",label:tui.str("form.at.most"),value:/^\d+$/.test(this.define.atMost+"")?this.define.atMost:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]}]}]},FormOptions.prototype.setProperties=function(properties){var values=properties[1];this.define.align="normal"!=values.align?values.align:undefined,this.define.atLeast=values.atLeast?parseInt(values.atLeast):undefined,this.define.atMost=values.atMost?parseInt(values.atMost):undefined,"number"!=typeof this.define.atMost||this.define.atMost>1?this.define.features=values.features:this.define.features=[],this.define.options=textToOptions(values.options,!1)},FormOptions.prototype.onPropertyPageSwitch=function(pages,recentPage){FormControl.detectRequired(pages,recentPage)},FormOptions.prototype.validate=function(){var count;if(count=this.define.value instanceof Array?this.define.value.length:this.define.value?1:0,this.define.atLeast){var atLeast=parseInt(this.define.atLeast+"");if(count<atLeast)return this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.least.p",atLeast)),!1}if(this.define.atMost){var atMost=parseInt(this.define.atMost+"");if(count>atMost)return this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.most.p",atMost)),!1}return!0},FormOptions.icon="fa-check-square-o",FormOptions.desc="form.option.group",FormOptions.order=4,FormOptions.init={options:[{data:[{value:"A"},{value:"B"},{value:"C"},{value:"D"}]}]},FormOptions.translator=function(value,item,index){return value instanceof Array?document.createTextNode(value.join(", ")):null!=value?document.createTextNode(value+""):null},FormOptions}(FormControl);widget.Form.register("options",FormOptions);var FormSelect=function(_super){function FormSelect(form,define){var _this=_super.call(this,form,define,"select")||this;return _this._widget._set("nameKey","text"),_this._widget.on("change",function(e){_this.define.value=_this._widget.get("value"),_this._notifyBar.innerHTML="",form.fire("itemvaluechanged",{control:_this})}),_this._notifyBar=tui.elem("div"),_this._notifyBar.className="tui-form-notify-bar",_this.div.appendChild(_this._notifyBar),_this}return __extends(FormSelect,_super),FormSelect.prototype.update=function(){if(_super.prototype.update.call(this),this._widget._set("multiSelect",1!=this.define.atMost),this._widget._set("clearable",!this.define.atLeast||parseInt(this.define.atLeast+"")<=0),this._widget._set("canSearch",!!this.define.canSearch),this._notifyBar.innerHTML="",this.define.selection&&this.define.selection.length>0)for(var _i=0,_a=this.define.selection;_i<_a.length;_i++){var d=_a[_i];if(d.data&&d.data.length>0)for(var i=0;i<d.data.length;i++){var o=d.data[i];null!==o.value&&typeof o.value!==tui.UNDEFINED||(o.value=o.text),null!==o.text&&typeof o.text!==tui.UNDEFINED||(o.text=o.value),null!==o.value&&typeof o.value!==tui.UNDEFINED||d.data.splice(i--,1)}}},FormSelect.prototype.getProperties=function(){return[{name:tui.str("form.selection"),properties:[{type:"textarea",key:"selection",maxHeight:400,label:tui.str("form.options"),description:tui.str("form.selection.desc"),value:optionsToText(this.define.selection),validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}],size:6},{type:"options",key:"canSearch",label:tui.str("form.use.search"),value:this.define.canSearch?"true":"false",options:[{data:[{value:"true",text:tui.str("form.enable")},{value:"false",text:tui.str("form.disable")}]}],size:2,atMost:1,position:"newline"},{type:"textbox",inputType:"number",key:"atLeast",label:tui.str("form.at.least"),value:/^\d+$/.test(this.define.atLeast+"")?this.define.atLeast:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]},{type:"textbox",inputType:"number",key:"atMost",label:tui.str("form.at.most"),value:/^\d+$/.test(this.define.atMost+"")?this.define.atMost:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]}]}]},FormSelect.prototype.setProperties=function(properties){var values=properties[1];this.define.atLeast=values.atLeast>0?parseInt(values.atLeast):undefined,this.define.atMost=values.atMost>0?parseInt(values.atMost):undefined,this.define.selection=textToOptions(values.selection,1!=this.define.atMost),this.define.canSearch=tui.text.parseBoolean(values.canSearch)},FormSelect.prototype.onPropertyPageSwitch=function(pages,recentPage){FormControl.detectRequired(pages,recentPage)},FormSelect.prototype.getValue=function(cal){if(void 0===cal&&(cal=null),!cal)return this._widget.get("value");var key=this.define.key,data=[];if(this.define.selection&&this.define.selection.length>0){if(cal.path.indexOf(key)>=0)throw new Error('Invalid expression of select control: Cycle reference detected on "'+key+'"');cal.path.push(key);for(var _i=0,_a=this.define.selection;_i<_a.length;_i++){var d=_a[_i];d.condition?tui.exp.evaluate(d.condition,function(id){return"function"==id.type?tui.exp.processStandardFunc(id):cal.cache.hasOwnProperty(id.name)?cal.cache[id.name]:(cal.calc(id.name,cal.path),cal.cache[id.name])})&&d.data&&d.data.length>0&&data.splice.apply(data,[data.length,0].concat(d.data)):d.data&&d.data.length>0&&data.splice.apply(data,[data.length,0].concat(d.data))}}return this._widget._set("tree",data),this._widget.set("value",this.define.value),this.define.value=this._widget.get("value"),this.define.text=this._widget.get("text"),this.define.value},FormSelect.prototype.validate=function(){var count;if(count=this.define.value instanceof Array?this.define.value.length:this.define.value?1:0,this.define.atLeast){var atLeast=parseInt(this.define.atLeast+"");if(count<atLeast)return this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.least.p",atLeast)),!1}if(this.define.atMost){var atMost=parseInt(this.define.atMost+"");if(count>atMost)return this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.most.p",atMost)),!1}return!0},FormSelect.icon="fa-toggle-down",FormSelect.desc="form.selection",FormSelect.order=5,FormSelect.init={atMost:1,selection:[{data:[{value:"A"},{value:"B"},{value:"C"}]}]},FormSelect.translator=function(value,item,index){return value instanceof Array?document.createTextNode(value.join(", ")):null!=value?document.createTextNode(value+""):null},FormSelect}(BasicFormControl);widget.Form.register("select",FormSelect);var FormDatePicker=function(_super){function FormDatePicker(form,define){var _this=_super.call(this,form,define,"date-picker")||this;return _this._widget.on("change",function(e){_this.define.value=_this.getValue(),form.fire("itemvaluechanged",{control:_this})}),_this}return __extends(FormDatePicker,_super),FormDatePicker.prototype.update=function(){_super.prototype.update.call(this),this._widget._set("format",this.define.format||null),this._widget._set("mode",/^(date|date-time|time|month)$/.test(this.define.mode)?this.define.mode:null),/^(utc|locale|none)$/.test(this.define.timezone)||(this.define.timezone="none"),this._widget._set("timezone",this.define.timezone),"input"===this.form.get("mode")&&this.define.autoInit&&null==this._widget.get("value")&&null==this.define.value&&(this._widget._set("value",tui.time.now()),this.define.value=this._widget.get("value"))},FormDatePicker.prototype.getProperties=function(){return[{name:tui.str("form.datepicker"),properties:[{type:"options",key:"mode",label:tui.str("form.format"),options:[{data:[{value:"date",text:tui.str("form.date")},{value:"time",text:tui.str("form.time")},{value:"date-time",text:tui.str("form.date.time")},{value:"month",text:tui.str("form.month")}]}],atMost:1,value:/^(date|date-time|time|month)$/.test(this.define.mode)?this.define.mode:"date",size:2,position:"newline"},{type:"options",key:"timezone",label:tui.str("form.timezone"),options:[{data:[{value:"utc",text:tui.str("form.tz.utc")},{value:"locale",text:tui.str("form.tz.locale")},{value:"none",text:tui.str("form.tz.none")}]}],atMost:1,value:/^(utc|locale|none)$/.test(this.define.timezone)?this.define.timezone:"utc",size:2,position:"newline"},{type:"options",key:"autoInit",label:tui.str("form.init.by.current.time"),options:[{data:[{value:!0,text:tui.str("yes")},{value:!1,text:tui.str("no")}]}],atMost:1,value:!!this.define.autoInit,size:2,position:"newline"},{type:"textbox",key:"format",label:tui.str("form.custom.format"),description:tui.str("form.date.desc"),value:this.define.format?this.define.format:null,size:2}]}]},FormDatePicker.prototype.setProperties=function(properties){var values=properties[1];this.define.format=values.format?values.format:undefined,this.define.mode=values.mode,this.define.required?this.define.validation=[{format:"*any",message:tui.str("message.cannot.be.empty")}]:this.define.validation=undefined,this.define.timezone=values.timezone,this.define.autoInit=!!values.autoInit||undefined},FormDatePicker.prototype.validate=function(){return this._widget.validate()},FormDatePicker.icon="fa-calendar-o",FormDatePicker.desc="form.datepicker",FormDatePicker.order=6,FormDatePicker}(BasicFormControl);widget.Form.register("datepicker",FormDatePicker);var FormCalendar=function(_super){function FormCalendar(form,define){var _this=_super.call(this,form,define,"calendar")||this;return _this._widget.on("change",function(e){_this.define.value=_this.getValue(),form.fire("itemvaluechanged",{control:_this})}),_this}return __extends(FormCalendar,_super),FormCalendar.prototype.update=function(){_super.prototype.update.call(this),this._widget._set("mode",/^(date|month)$/.test(this.define.mode)?this.define.mode:null),null==this.define.value&&(this._widget._set("value",tui.time.now()),this.define.value=this._widget.get("value"))},FormCalendar.prototype.getProperties=function(){return[{name:tui.str("form.calendar"),properties:[{type:"options",key:"mode",label:tui.str("form.format"),options:[{data:[{value:"date",text:tui.str("form.date")},{value:"month",text:tui.str("form.month")}]}],atMost:1,value:/^(date|month)$/.test(this.define.mode)?this.define.mode:"date",size:2,position:"newline"}]}]},FormCalendar.prototype.setProperties=function(properties){var values=properties[1];this.define.mode=values.mode},FormCalendar.prototype.validate=function(){return!0},FormCalendar.icon="fa-calendar",FormCalendar.desc="form.calendar",FormCalendar.order=7,FormCalendar.init={size:1,position:"newline"},FormCalendar}(BasicFormControl);widget.Form.register("calendar",FormCalendar);var FormPicture=function(_super){function FormPicture(form,define){var _this=_super.call(this,form,define,"picture")||this;return _this._widget.on("success",function(e){_this._notifyBar.innerHTML="",_this.define.value=_this._widget.get("value"),form.fire("itemvaluechanged",{control:_this})}),_this._notifyBar=tui.elem("div"),_this._notifyBar.className="tui-form-notify-bar",_this.div.appendChild(_this._notifyBar),_this}return __extends(FormPicture,_super),FormPicture.prototype.update=function(){_super.prototype.update.call(this),this._notifyBar.innerHTML="",new RegExp(FormPicture.MIME).test(this.define.accept)?this._widget._set("accept",this.define.accept):this.define.accept=this._widget.get("accept"),this.define.action?this._widget._set("action",this.define.action):this.define.action=this._widget.get("action")},FormPicture.prototype.getProperties=function(){return[{name:tui.str("form.picture"),properties:[{type:"textbox",key:"action",label:tui.str("form.upload.url"),value:this.define.action,validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}],size:2,position:"newline"},{type:"textbox",key:"accept",label:tui.str("form.file.type"),value:this.define.accept,validation:[{format:FormPicture.MIME,message:tui.str("message.must.be.image")}],size:2,position:"newline"}]}]},FormPicture.prototype.setProperties=function(properties){var values=properties[1];this.define.accept=values.accept,this.define.action=values.action},FormPicture.prototype.validate=function(){return this.define.required&&null===this.getValue()?(this._notifyBar.innerHTML=tui.browser.toSafeText(tui.str("message.cannot.be.empty")),!1):(this._notifyBar.innerHTML="",!0)},FormPicture.icon="fa-file-image-o",FormPicture.desc="form.picture",FormPicture.order=8,FormPicture.translator=function(value,item,index){return null!=value?value.fileName?document.createTextNode(value.fileName):document.createTextNode("[ "+tui.str("form.picture")+" ]"):null},FormPicture.MIME="^image/(png|jpeg|gif)(\\s*,\\s*image/(png|jpeg|gif))*$",FormPicture}(BasicFormControl);widget.Form.register("picture",FormPicture);var FormFile=function(_super){function FormFile(form,define){var _this=_super.call(this,form,define,"file")||this;return _this._widget.on("success",function(e){_this.define.value=_this._widget.get("value"),form.fire("itemvaluechanged",{control:_this})}),_this}return __extends(FormFile,_super),FormFile.prototype.update=function(){_super.prototype.update.call(this),this._widget._set("accept",this.define.accept),this.define.action?this._widget._set("action",this.define.action):this.define.action=this._widget.get("action")},FormFile.prototype.getProperties=function(){return[{name:tui.str("form.file"),properties:[{type:"textbox",key:"action",label:tui.str("form.upload.url"),value:this.define.action,validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}],size:2,position:"newline"},{type:"textbox",key:"accept",label:tui.str("form.file.type"),value:this.define.accept,size:2,position:"newline"}]}]},FormFile.prototype.setProperties=function(properties){var values=properties[1];this.define.accept=values.accept?values.accept:undefined,this.define.action=values.action,this.define.required?this.define.validation=[{format:"*any",message:tui.str("message.cannot.be.empty")}]:this.define.validation=undefined},FormFile.prototype.validate=function(){return this._widget.validate()},FormFile.icon="fa-file-text-o",FormFile.desc="form.file",FormFile.order=9,FormFile.translator=function(value,item,index){return null!=value?value.fileName?document.createTextNode(value.fileName):document.createTextNode("[ "+tui.str("form.file")+" ]"):null},FormFile}(BasicFormControl);widget.Form.register("file",FormFile);var FormFiles=function(_super){function FormFiles(form,define){var _this=_super.call(this,form,define,"files")||this;return _this._widget.on("success delete",function(e){_this._notifyBar.innerHTML="",_this.define.value=_this._widget.get("value"),form.fire("itemvaluechanged",{control:_this})}),_this._notifyBar=tui.elem("div"),_this._notifyBar.className="tui-form-notify-bar",_this.div.appendChild(_this._notifyBar),_this}return __extends(FormFiles,_super),FormFiles.prototype.update=function(){_super.prototype.update.call(this),this._notifyBar.innerHTML="",this._widget._set("accept",this.define.accept),this.define.action?this._widget._set("action",this.define.action):this.define.action=this._widget.get("action"),"number"==typeof this.define.atMost&&this.define.atMost>0?this._widget._set("max",this.define.atMost):this._widget._set("max",null)},FormFiles.prototype.getProperties=function(){return[{name:tui.str("form.files"),properties:[{type:"textbox",key:"action",label:tui.str("form.upload.url"),value:this.define.action,validation:[{format:"*any",message:tui.str("message.cannot.be.empty")}],size:2,position:"newline"},{type:"textbox",key:"accept",label:tui.str("form.file.type"),value:this.define.accept,size:2,position:"newline"},{type:"textbox",inputType:"number",key:"atLeast",label:tui.str("form.at.least"),value:/^\d+$/.test(this.define.atLeast+"")?this.define.atLeast:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]},{type:"textbox",inputType:"number",key:"atMost",label:tui.str("form.at.most"),value:/^\d+$/.test(this.define.atMost+"")?this.define.atMost:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]}]}]},FormFiles.prototype.setProperties=function(properties){var values=properties[1];this.define.accept=values.accept?values.accept:undefined,this.define.action=values.action,this.define.atLeast=values.atLeast?parseInt(values.atLeast):undefined,this.define.atMost=values.atMost?parseInt(values.atMost):undefined},FormFiles.prototype.onPropertyPageSwitch=function(pages,recentPage){FormControl.detectRequired(pages,recentPage)},FormFiles.prototype.validate=function(){var count;if(count=this.define.value instanceof Array?this.define.value.length:this.define.value?1:0,this.define.atLeast){var atLeast=parseInt(this.define.atLeast+"");if(count<atLeast)return this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.least.p",atLeast)),!1}if(this.define.atMost){var atMost=parseInt(this.define.atMost+"");if(count>atMost)return this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.most.p",atMost)),!1}return!0},FormFiles.icon="fa-copy",FormFiles.desc="form.files",FormFiles.order=10,FormFiles.init={size:2,position:"newline"},FormFiles.translator=function(value,item,index){return value instanceof Array?document.createTextNode("[ "+tui.strp("file.count.p",value.length)+" ]"):null},FormFiles}(BasicFormControl);widget.Form.register("files",FormFiles);var FormGrid=function(_super){function FormGrid(form,define){var _this=_super.call(this,form,define,"grid")||this;return _this._widget._.style.margin="2px",_this._buttonBar=tui.elem("div"),_this.div.appendChild(_this._buttonBar),_this._btnAdd=widget.create("button",{text:"<i class='fa fa-plus'></i>"}),_this._btnAdd.appendTo(_this._buttonBar),_this._btnAdd.on("click",function(){var dialog=widget.create("dialog"),fm=widget.create("form");fm._.className="tui-form-property-form",fm.set("definition",tui.clone(_this.define.definitions)),dialog.set("content",fm._),dialog.set("mobileModel",!0),dialog.open("ok#tui-primary"),dialog.on("btnclick",function(){if(fm.validate())try{var v=fm.get("value");_this._values.push(v),dialog.close(),_this._notifyBar.innerHTML="",form.fire("itemvaluechanged",{control:_this})}catch(e){}})}),_this._btnDelete=widget.create("button",{text:"<i class='fa fa-minus'></i>"}),_this._btnDelete.appendTo(_this._buttonBar),_this._btnDelete.on("click",function(){var i=_this._widget.get("activeRow");null!==i&&(_this._values.splice(i,1),_this._notifyBar.innerHTML="",form.fire("itemvaluechanged",{control:_this}))}),_this._btnEdit=widget.create("button",{text:"<i class='fa fa-pencil'></i>"}),_this._btnEdit.appendTo(_this._buttonBar),_this._btnEdit.on("click",function(){_this.editRow()}),_this._widget.on("rowdblclick",function(){exist(_this.define.features,"edit")&&_this.editRow()}),_this._notifyBar=tui.elem("div"),_this._notifyBar.className="tui-form-notify-bar",_this.div.appendChild(_this._notifyBar),_this}return __extends(FormGrid,_super),FormGrid.prototype.editRow=function(){var _this=this,i=this._widget.get("activeRow");if(null!==i){var dialog=widget.create("dialog"),fm=widget.create("form");fm._.className="tui-form-property-form",fm.set("definition",tui.clone(this.define.definitions)),dialog.set("content",fm._),dialog.set("mobileModel",!0),dialog.open("ok#tui-primary"),fm.set("value",this._values[i]),dialog.on("btnclick",function(){if(fm.validate()){var v=fm.get("value");_this._values.splice(i,1,v),dialog.close(),_this._notifyBar.innerHTML="",_this.form.fire("itemvaluechanged",{control:_this})}})}},FormGrid.prototype.update=function(){_super.prototype.update.call(this),this._notifyBar.innerHTML="";var d=this.define;if(d.value instanceof Array?this._values=d.value:d.value=this._values=[],this._widget._set("list",this._values),this.define.definitions){for(var columns=[],_i=0,_a=d.definitions;_i<_a.length;_i++){var subDef=_a[_i];if(subDef.key){var type=widget.Form.getType(subDef.type);if(type&&type!=FormSection){var col={name:subDef.label,key:subDef.key,translator:type.translator};columns.push(col)}}}this._widget._set("columns",columns)}else this._widget._set("columns",[]);this.define.disable?(this._btnAdd.set("disable",!0),this._btnEdit.set("disable",!0),this._btnDelete.set("disable",!0),this._widget.set("disable",!0)):(this._btnAdd.set("disable",!1),this._btnEdit.set("disable",!1),this._btnDelete.set("disable",!1),this._widget.set("disable",!1)),this._btnAdd._.style.display=exist(this.define.features,"append")?"inline-block":"none",this._btnEdit._.style.display=exist(this.define.features,"edit")?"inline-block":"none",this._btnDelete._.style.display=exist(this.define.features,"delete")?"inline-block":"none",exist(this.define.features,"autoHeight")?(this._widget._.style.height="",this._widget.set("autoHeight",!0)):(this._widget.set("autoHeight",!1),"number"==typeof d.height&&!isNaN(d.height)||"string"==typeof d.height&&/^\d+$/.test(d.height)?this._widget._.style.height=d.height+"px":(this._widget._.style.height="",d.height=undefined)),this._widget.set("autoWidth",exist(this.define.features,"autoColumnWidth"))},FormGrid.prototype.getProperties=function(){return[{name:tui.str("form.grid"),properties:[{type:"options",key:"features",label:tui.str("form.grid.features"),value:this.define.features,options:[{data:[{value:"append",text:tui.str("allow.append")},{value:"delete",text:tui.str("allow.delete")},{value:"edit",text:tui.str("allow.edit")},{value:"autoHeight",text:tui.str("auto.height")},{value:"autoColumnWidth",text:tui.str("auto.column.width")}]}],size:6,position:"newline"},{type:"textbox",inputType:"number",key:"atLeast",label:tui.str("form.at.least"),value:/^\d+$/.test(this.define.atLeast+"")?this.define.atLeast:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]},{type:"textbox",inputType:"number",key:"atMost",label:tui.str("form.at.most"),value:/^\d+$/.test(this.define.atMost+"")?this.define.atMost:"",validation:[{format:"*digital",message:tui.str("message.invalid.value")}]},{type:"textbox",inputType:"number",key:"height",label:tui.str("form.height"),value:/^\d+$/.test(this.define.height+"")?this.define.height:null,validation:[{format:"*digital",message:tui.str("message.invalid.value")}],condition:"features !~ 'autoHeight'"}]},{name:tui.str("form.design"),designMode:!0,properties:this.define.definitions}]},FormGrid.prototype.onPropertyPageSwitch=function(pages,recentPage){FormControl.detectRequired(pages,recentPage)},FormGrid.prototype.setProperties=function(properties){var values=properties[1];this.define.height=/^\d+$/.test(values.height)?values.height:undefined,this.define.atLeast=values.atLeast?parseInt(values.atLeast):undefined,this.define.atMost=values.atMost?parseInt(values.atMost):undefined,this.define.definitions=properties[2],this.define.features=values.features},FormGrid.prototype.getValue=function(){return this._values},FormGrid.prototype.setValue=function(value){value!==this._values&&value instanceof Array&&(this._values=value,this.define.value=value,this._widget._set("list",this._values)),this._widget.render(),this.form.fire("itemvaluechanged",{control:this})},FormGrid.prototype.validate=function(){var d=this.define,data=this._widget.get("data");return d.atLeast&&data.length()<d.atLeast?(this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.least.p",d.atLeast)),!1):!(d.atMost&&data.length()>d.atMost)||(this._notifyBar.innerHTML=tui.browser.toSafeText(tui.strp("form.at.most.p",d.atMost)),!1)},FormGrid.icon="fa-table",FormGrid.desc="form.grid",FormGrid.order=11,FormGrid.init={size:6,features:["append","delete","edit"]},FormGrid.translator=function(value,item,index){return value instanceof Array?document.createTextNode("[ "+tui.strp("item.count.p",value.length)+" ]"):null},FormGrid}(BasicFormControl);widget.Form.register("grid",FormGrid)}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Frame=function(_super){function Frame(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Frame,_super),Frame.prototype.initRestriction=function(){var _this=this;this._cache={},_super.prototype.initRestriction.call(this),this.setRestrictions({src:{set:function(value){_this._go(value)}}})},Frame.prototype._go=function(src,cache,name){var _this=this;void 0===cache&&(cache=!0),this._data.src=src,typeof name!==tui.UNDEFINED&&null!=name||(name="");var key=name+":"+src;if(cache&&this._cache.hasOwnProperty(key)){if(tui.ieVer>0)for(;this._.children.length>0;)this._.removeChild(this._.children[0]);else this._.innerHTML="";var page=this._cache[key];this._.appendChild(page)}else tui.ajax.getBody(src).done(function(content){var page=tui.browser.toElement(content,!0);if(cache&&(_this._cache[key]=page),_this._data.src===src){if(tui.ieVer>0)for(;_this._.children.length>0;)_this._.removeChild(_this._.children[0]);else _this._.innerHTML="";_this._.appendChild(page),_this.render()}})},Frame.prototype.go=function(src,cache,name){void 0===cache&&(cache=!0),this._go(src,cache,name),this.render()},Frame.prototype.render=function(){widget.init(this._)},Frame}(widget.Widget);widget.Frame=Frame,widget.register(Frame,"frame")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function vval(v){return isNaN(v)?0:v}function getAlignText(align){return align&&/^(left|center|right)$/i.test(align)?align.toLowerCase():"left"}var CHECKCOL_MATCHER=/^(un)?checked|tristate$/,Grid=function(_super){function Grid(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._setupHeadMoveListener=!1,_this._columnWidths=[],_this._vLines=[],_this._handlers=[],_this}return __extends(Grid,_super),Grid.prototype.initRestriction=function(){var _this=this,updateCallback=function(){var me=_this;return function(data){data.data.completely?(me.render(),me.fire("update")):(me.drawContent(),me.fire("update"))}}();_super.prototype.initRestriction.call(this),this.setRestrictions({selectable:{get:function(){var val=_this._data.selectable;return typeof val===tui.UNDEFINED||null===val||!!val}},lineHeight:{get:function(){var val=_this._data.lineHeight;return"number"!=typeof val||isNaN(val)?Grid.LINE_HEIGHT:val}},dataType:{set:function(value){}},data:{set:function(value){_this._data.data&&"function"==typeof _this._data.data.off&&_this._data.data.off("update",updateCallback),value instanceof tui.ds.List||value instanceof tui.ds.RemoteList?(_this._data.data=value,_this._data.dataType="list"):value instanceof tui.ds.Tree||value instanceof tui.ds.RemoteTree?(_this._data.data=value,_this._data.dataType="tree"):value instanceof Array?_this._data.data=new tui.ds.List(value):null===value&&(_this._data.data=new tui.ds.List([])),_this._data.data&&"function"==typeof _this._data.data.on&&_this._data.data.on("update",updateCallback),_this._vbar&&_this._vbar._set("value",0),_this._vbar&&_this._hbar._set("value",0),_this._set("activeRow",null)},get:function(){var data=_this._data.data;return data||new tui.ds.List([])}},list:{set:function(value){value instanceof tui.ds.List||value instanceof tui.ds.RemoteList?_this._set("data",value):value instanceof Array?_this._set("data",new tui.ds.List(value)):null===value&&_this._set("data",null)},get:function(){}},tree:{set:function(value){value instanceof tui.ds.Tree||value instanceof tui.ds.RemoteTree?_this._set("data",value):value instanceof Array?_this._set("data",new tui.ds.Tree(value)):null===value&&_this._set("data",null)},get:function(){}},columns:{set:function(value){value instanceof Array&&(_this._data.columns=value,_this.clearBuffer(),_this._columnWidths=[])},get:function(){return _this._data.columns?_this._data.columns:[]}},scrollTop:{set:function(value){_this._vbar._set("value",value)},get:function(){return _this._vbar.get("value")}},scrollLeft:{set:function(value){_this._hbar._set("value",value)},get:function(){return _this._hbar.get("value")}},activeRow:{set:function(value){("number"==typeof value&&!isNaN(value)||null===value)&&(value<0&&(value=0),value>_this.get("data").length()-1&&(value=_this.get("data").length()-1),null!=_this._data.activeRow&&_this._buffer&&$(_this._buffer.lines[_this._data.activeRow-_this._buffer.begin]).removeClass("tui-actived"),_this._data.activeRow=value,null!=value&&_this._buffer&&$(_this._buffer.lines[value-_this._buffer.begin]).addClass("tui-actived"))},get:function(){var row=_this._data.activeRow;return null===row?null:row>=0&&row<_this.get("data").length()?row:null}},activeRowData:{set:function(value){},get:function(){var r=_this.get("activeRow");return null!=r?_this.getRowData(r):r}}})},Grid.prototype.getRowData=function(rowIndex){var data=this.get("data");return"tree"===this.get("dataType")?data.get(rowIndex).item:data.get(rowIndex)},Grid.prototype.init=function(){var _this=this;this._tuid=tui.tuid(),$(this._).attr({tabIndex:0,unselectable:"on"}),tui.browser.setInnerHtml(this._,"<div class='tui-grid-head'></div><div class='tui-content'></div>");var head=this._components.head=$(this._).children(".tui-grid-head")[0],content=this._components.content=$(this._).children(".tui-content")[0];this._hbar=tui.create("scrollbar",{direction:"horizontal"}),this._components.hScroll=this._hbar.appendTo(this._,!1)._,this._vbar=tui.create("scrollbar"),this._components.vScroll=this._vbar.appendTo(this._,!1)._,this._clearTimes=0,document.createStyleSheet?this._gridStyle=document.createStyleSheet():(this._gridStyle=tui.elem("style"),document.head.appendChild(this._gridStyle)),this._buffer={begin:0,end:0,lines:[]},this.setInit("header",!0),this.on("resize",function(){_this._columnWidths=[],_this.render()}),this._vbar.on("scroll",function(){_this.drawContent()}),this._hbar.on("scroll",function(){_this.computeHOffset()});var mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";$(this._).on(mousewheelevt,function(ev){if(!_this.get("autoHeight")){var e=ev.originalEvent,delta=e.detail?-1*e.detail:e.wheelDelta,step=_this.get("lineHeight"),scrollSize=step>1?step:1;delta<=0?_this._vbar.get("value")<_this._vbar.get("total")?(ev.stopPropagation(),ev.preventDefault(),_this._vbar.set("value",_this._vbar.get("value")+scrollSize),_this.drawContent()):_this.get("noMouseWheel")&&(ev.stopPropagation(),ev.preventDefault()):_this._vbar.get("value")>0?(ev.stopPropagation(),ev.preventDefault(),_this._vbar.set("value",_this._vbar.get("value")-scrollSize),_this.drawContent()):_this.get("noMouseWheel")&&(ev.stopPropagation(),ev.preventDefault())}});var lastPos,lastTime,scrollX=function(distance){var oldValue=_this._hbar.get("value");return _this._hbar.set("value",oldValue-distance),_this.drawContent(),_this.computeHOffset(),_this._hbar.get("value")!==oldValue&&Math.abs(lastSpeed)>.02},scrollY=function(distance){var oldValue=_this._vbar.get("value");return _this._vbar.set("value",oldValue-distance),_this.drawContent(),_this._vbar.get("value")!==oldValue&&Math.abs(lastSpeed)>.02},inTouched=!1,lastSpeed=0,direction=null;$(this._).on("touchstart",function(ev){if(!inTouched){var obj=ev.target||ev.srcElement;if(!$(obj).hasClass("tui-grid-handler")){direction=null,inTouched=!0,lastSpeed=0;var e=ev.originalEvent;if(1==e.targetTouches.length){var touch=e.targetTouches[0];lastPos={x:touch.pageX,y:touch.pageY},lastTime=(new Date).getMilliseconds()}}}}),$(this._).on("touchmove",function(ev){if(clearTimeout(hittestTimer),inTouched){var touch=ev.originalEvent.targetTouches[0],movePos={x:touch.pageX,y:touch.pageY},moveX=movePos.x-lastPos.x,moveY=movePos.y-lastPos.y,currentTime=(new Date).getMilliseconds(),spanTime=currentTime-lastTime;spanTime<=0||(lastPos=movePos,lastTime=currentTime,null==direction&&(Math.abs(moveX)>0&&Math.abs(moveY)>0?direction=Math.abs(moveX)>Math.abs(moveY)?"x":"y":Math.abs(moveX)>0?direction="x":Math.abs(moveY)>0&&(direction="y")),"x"===direction?(lastSpeed=moveX/spanTime,scrollX(moveX)&&(ev.stopPropagation(),ev.preventDefault())):"y"===direction&&(lastSpeed=moveY/spanTime,scrollY(moveY)&&(ev.stopPropagation(),ev.preventDefault())))}}),$(this._).on("touchend",function(ev){clearTimeout(hittestTimer),requestAnimationFrame(function keepMove(timestamp){Math.abs(lastSpeed)>.1&&("x"===direction?scrollX(20*lastSpeed)&&(lastSpeed*=.95,requestAnimationFrame(keepMove)):"y"===direction?scrollY(20*lastSpeed)&&(lastSpeed*=.95,requestAnimationFrame(keepMove)):lastSpeed=0)}),inTouched=!1,lastTime=null}),$(this._).on("mousedown touchstart",function(ev){var obj=ev.target||ev.srcElement;if($(obj).hasClass("tui-grid-handler")){ev.stopPropagation(),ev.preventDefault();var idx=_this._handlers.indexOf(obj),columns=_this.get("columns"),l=obj.offsetLeft,srcX=tui.browser.getEventPosition(ev)[0].x;obj.style.height=_this._.clientHeight+"px",$(obj).addClass("tui-handler-move"),widget.openDragMask(function(e){var positions=tui.browser.getEventPosition(e);obj.style.left=l+positions[0].x-srcX+"px"},function(e){var positions=tui.browser.getEventPosition(e);obj.style.height="",$(obj).removeClass("tui-handler-move"),columns[idx].width=columns[idx].width+positions[0].x-srcX,columns[idx].width<0&&(columns[idx].width=0),_this._columnWidths=[],_this.initColumnWidth(),_this.computeScroll(),_this.computeColumnWidth(),_this.drawHeader(),_this.computeHOffset()}).style.cursor="col-resize"}});var hittest=function(obj){var line=null,col=null;if(!_this.get("disable"))for(;obj;){var parent=obj.parentNode;if(parent&&$(parent).hasClass("tui-grid-line")){line=_this._buffer.begin+_this._buffer.lines.indexOf(parent),col=obj.col,!0===_this.get("selectable")&&(_this._set("activeRow",line),_this._set("activeColumn",col));break}obj=parent}return{line:line,col:col}},hittestTimer=null,testLine=function(ev){var obj=ev.target||ev.srcElement,target=hittest(obj);if(null!==target.line){var data=_this.get("data");if($(obj).hasClass("tui-arrow-expand"))data.collapse(target.line),_this.render(),ev.preventDefault(),_this.fire("collapse",{e:ev,line:target.line});else if($(obj).hasClass("tui-arrow-collapse"))data.expand(target.line),_this.render(),ev.preventDefault(),_this.fire("expand",{e:ev,line:target.line});else if($(obj).hasClass("tui-grid-check")){var checked,column=_this.get("columns")[target.col],checkKey=column.checkKey?column.checkKey:"check";checked="tree"===_this.get("dataType")?data.get(target.line).item[checkKey]=!data.get(target.line).item[checkKey]:data.get(target.line)[checkKey]=!data.get(target.line)[checkKey],_this.drawLine(_this._buffer.lines[target.line-_this._buffer.begin],target.line,_this.get("lineHeight"),_this.get("columns"),data.get(target.line)),ev.preventDefault(),!1!==_this.fire("rowcheck",{e:ev,row:target.line,col:target.col,checked:checked})&&onRowCheck({col:target.col,row:target.line,checked:checked})}else _this.fire("rowmousedown",{e:ev,row:target.line,col:target.col})}},onRowCheck=function(e){_this.updateCheckState(e.col)};$(this._).on("mousedown",function(ev){testLine(ev)}),$(this._).on("mouseup",function(ev){var obj=ev.target||ev.srcElement,target=hittest(obj);null!=target.line&&_this.fire("rowmouseup",{e:ev,row:target.line,col:target.col})}),$(content).click(function(ev){var obj=ev.target||ev.srcElement;if(!$(obj).hasClass("tui-arrow-expand")&&!$(obj).hasClass("tui-arrow-collapse")&&!$(obj).hasClass("tui-grid-check")){var target=hittest(obj);null!=target.line&&_this.fire("rowclick",{e:ev,row:target.line,col:target.col})}}),$(content).dblclick(function(ev){var obj=ev.target||ev.srcElement;if(!$(obj).hasClass("tui-arrow-expand")&&!$(obj).hasClass("tui-arrow-collapse")&&!$(obj).hasClass("tui-grid-check")){var target=hittest(obj);null!=target.line&&_this.fire("rowdblclick",{e:ev,row:target.line,col:target.col})}}),$(this._).keyup(function(e){var activeRow=_this.get("activeRow");_this.fire("keyup",{e:e,row:activeRow})}),$(this._).keydown(function(e){if(!_this.get("disable")){var k=e.keyCode,activeRow=_this.get("activeRow");if(_this.fire("keydown",{e:e,row:activeRow}),k>=33&&k<=40||k==tui.browser.KeyCode.ENTER){if(k===tui.browser.KeyCode.LEFT){if("tree"===_this.get("dataType")&&null!==activeRow&&(node=_this.get("data").get(activeRow)).hasChild&&node.expand)return _this.get("data").collapse(activeRow),_this.render(),void _this.fire("collapse",{e:e,line:activeRow});_this.get("autoWidth")||(_this._hbar.set("value",_this._hbar.get("value")-30),_this.computeHOffset())}else if(k===tui.browser.KeyCode.UP)if(_this.get("selectable"))null===_this.get("activeRow")?_this._set("activeRow",0):_this._set("activeRow",_this.get("activeRow")-1),_this.scrollTo(_this.get("activeRow")),_this.fire("keyselect",{e:e,row:_this.get("activeRow")});else{t=_this.get("scrollTop");_this._vbar.set("value",t-10),_this.drawContent()}else if(k===tui.browser.KeyCode.RIGHT){if("tree"===_this.get("dataType")&&null!==activeRow){var node=_this.get("data").get(activeRow);if(node.hasChild&&!node.expand)return _this.get("data").expand(activeRow),_this.render(),void _this.fire("collapse",{e:e,line:activeRow})}_this.get("autoWidth")||(_this._hbar.set("value",_this._hbar.get("value")+30),_this.computeHOffset())}else if(k===tui.browser.KeyCode.DOWN)if(_this.get("selectable"))null===_this.get("activeRow")?_this._set("activeRow",0):_this._set("activeRow",_this.get("activeRow")+1),_this.scrollTo(_this.get("activeRow")),_this.fire("keyselect",{e:e,row:_this.get("activeRow")});else{t=_this.get("scrollTop");_this._vbar.set("value",t+10),_this.drawContent()}else if(k===tui.browser.KeyCode.PRIOR)if(_this.get("selectable"))null===_this.get("activeRow")?_this._set("activeRow",0):_this._set("activeRow",_this.get("activeRow")-_this._dispLines+1),_this.scrollTo(_this.get("activeRow")),_this.fire("keyselect",{e:e,row:_this.get("activeRow")});else{t=_this.get("scrollTop");_this._vbar.set("value",t-_this._vbar.get("page")),_this.drawContent()}else if(k===tui.browser.KeyCode.NEXT)if(_this.get("selectable"))null===_this.get("activeRow")?_this._set("activeRow",0):_this._set("activeRow",_this.get("activeRow")+_this._dispLines-1),_this.scrollTo(_this.get("activeRow")),_this.fire("keyselect",{e:e,row:_this.get("activeRow")});else{var t=_this.get("scrollTop");_this._vbar.set("value",t+_this._vbar.get("page")),_this.drawContent()}else if(k===tui.browser.KeyCode.HOME)_this.get("selectable")?(_this._set("activeRow",0),_this.scrollTo(_this.get("activeRow")),_this.fire("keyselect",{e:e,row:_this.get("activeRow")})):(_this._vbar.set("value",0),_this.drawContent());else if(k===tui.browser.KeyCode.END)if(_this.get("selectable")){var data=_this.get("data");_this._set("activeRow",data.length()-1),_this.scrollTo(_this.get("activeRow")),_this.fire("keyselect",{e:e,row:_this.get("activeRow")})}else _this._vbar.set("value",_this._vbar.get("total")),_this.drawContent();else k===tui.browser.KeyCode.ENTER&&_this.get("selectable")&&null!=_this.get("activeRow")&&_this.fire("rowclick",{e:e,row:_this.get("activeRow"),col:_this.get("activeColumn")});e.preventDefault(),e.stopPropagation()}}});var onCheckCol=function(e){var col=_this.get("columns")[e.col],data=_this.get("data")._data;if("checked"===e.state)for(i=0;i<data.length;i++)!1===data[i][col.checkKey]&&(data[i][col.checkKey]=!0);else if("unchecked"===e.state)for(var i=0;i<data.length;i++)!0===data[i][col.checkKey]&&(data[i][col.checkKey]=!1);_this.render()};$(head).click(function(ev){if(!_this.get("disable"))for(var obj=ev.target||ev.srcElement,columns=_this.get("columns");obj;){if(obj.parentNode===head){var col=obj.col;if("checked"===columns[col].checkCol)columns[col].checkCol="unchecked",_this.drawHeader(),!1!==_this.fire("checkcol",{e:ev,column:columns[col],col:col,checkCol:columns[col].checkCol})&&onCheckCol({col:col,state:columns[col].checkCol});else if("unchecked"===columns[col].checkCol||"tristate"===columns[col].checkCol)columns[col].checkCol="checked",_this.drawHeader(),0!=_this.fire("checkcol",{e:ev,column:columns[col],col:col,checkCol:columns[col].checkCol})&&onCheckCol({col:col,state:columns[col].checkCol});else if(columns[col].sortable){var sortType="asc";_this.get("sortColumn")==col&&("asc"===_this.get("sortType")?sortType="desc":(sortType=null,col=null)),_this.fire("sort",{e:ev,column:null===col?null:columns[col],type:sortType})&&_this.setSortFlag(col,sortType),_this.drawHeader()}return}obj=obj.parentNode}})},Grid.prototype.updateCheckState=function(colIndex){var col=this.get("columns")[colIndex];if(CHECKCOL_MATCHER.test(col.checkCol)){for(var data=this.get("data")._data,cc=0,uc=0,i=0;i<data.length;i++)!0===data[i][col.checkKey]?cc++:uc++;col.checkCol=0==cc?"unchecked":0==uc?"checked":"tristate",this.render()}},Grid.prototype.setSortFlag=function(col,type){this._set("sortColumn",col),this._set("sortType",type);var column=this.get("columns")[col],ds=this.get("data");null===col||null===type?ds.setOrder(null):ds.setOrder([{key:column.key,desc:"desc"===type}])},Grid.prototype.scrollTo=function(index){if(!("number"!=typeof index||isNaN(index)||index<0||index>=this.get("data").length())){var v=this._vbar.get("value"),lineHeight=this.get("lineHeight");if(v>index*lineHeight)this._vbar.set("value",index*lineHeight),this.drawContent();else{var h=(index-this._dispLines+1)*lineHeight,diff=this._.clientHeight-this.getComponent("head").offsetHeight-this._hbar._.offsetHeight-this._dispLines*lineHeight;v<h-diff&&(this._vbar.set("value",h-diff),this.drawContent())}}},Grid.prototype.iterate=function(func){function iterateItem(treeItem,path){if(!1===func(treeItem,path,!0))return!1;var children=treeItem[childrenKey];if(children)for(var i=0;i<children.length;i++)if(!1===iterateItem(children[i],path.concat(i)))return!1}var data=this.get("data"),dataType=this.get("dataType");if("tree"===dataType&&null==data._finalData){var tree=data,childrenKey=tree.getConfig().children,rawData=tree.getRawData();if(!rawData)return;for(i=0;i<rawData.length&&!1!==iterateItem(rawData[i],[i]);i++);}else for(var list=data,i=0;i<list.length();i++){var listItem="tree"===dataType?list.get(i).item:list.get(i);if(!1===func(listItem,[i],"tree"===dataType))break}},Grid.prototype.activeTo=function(dataKey,value){var data=this.get("data"),dataType=this.get("dataType"),path=[];if("tree"===dataType&&null==data._finalData){var tree=data;if(this.iterate(function(item,p,treeNode){if(item[dataKey]===value)return path=p,!1}),path&&path.length>0){for(var searchPath=[],searchLevel=-1,found=!1,i=0;i<tree.length();i++){var node=tree.get(i);if(node.level===searchLevel)searchPath[searchLevel]++;else if(node.level<searchLevel){for(var j=node.level;j<searchLevel;j++)searchPath.pop();searchPath[searchLevel=node.level]++}else searchPath.push(0),searchLevel++;var state=function(p1,p2){for(var i=0;i<p1.length;i++){if(i>=p2.length)return 0;if(p1[i]!==p2[i])return 0}return p1.length===p2.length?2:1}(searchPath,path);if(2===state){found=!0;break}1===state&&tree.expand(i)}found&&(this._set("activeRow",i),this.computeScroll(),this.scrollTo(i))}}else if("tree"===dataType&&data._finalData){for(var list=data,i_3=0;i_3<list.length();i_3++)if(list.get(i_3).item[dataKey]===value){this._set("activeRow",i_3),this.scrollTo(i_3);break}}else for(var list=data,i_4=0;i_4<list.length();i_4++)if(list.get(i_4)[dataKey]===value){this._set("activeRow",i_4),this.scrollTo(i_4);break}},Grid.prototype.computeWidth=function(){if(this.get("autoWidth"))return this._.clientWidth;for(var contentWidth=0,i=0;i<this._columnWidths.length;i++)contentWidth+=this._columnWidths[i]+2*Grid.CELL_SPACE;return contentWidth},Grid.prototype.computeScroll=function(){var _this=this,vScroll=this._vbar;$(vScroll._).addClass("tui-hidden");var vEnable=!1,hScroll=this._hbar;$(hScroll._).addClass("tui-hidden");var hEnable=!1,clientWidth=this._.clientWidth,clientHeight=this._.clientHeight,data=this.get("data"),lineHeight=this.get("lineHeight");this._contentHeight=(data.length()+(this.get("header")?1:0))*lineHeight,this._contentWidth=this.computeWidth();var head=this._components.head,content=this._components.content,computeV=function(first){var realClientHeight=clientHeight-(hEnable?hScroll._.offsetHeight:0),shouldEnable=!_this.get("autoHeight")&&_this._contentHeight>realClientHeight;shouldEnable?($(vScroll._).removeClass("tui-hidden"),vScroll._.style.height=realClientHeight+"px",vScroll._set("total",_this._contentHeight-realClientHeight),_this._contentHeight>0?vScroll.set("page",realClientHeight/_this._contentHeight*(_this._contentHeight-realClientHeight)):vScroll.set("page",1)):_this.get("autoHeight")?(vScroll._set("value",0),vScroll._set("total",0),content.style.height=_this._contentHeight+"px",_this._.style.height=hEnable?_this._contentHeight+hScroll._.offsetHeight+"px":_this._contentHeight+"px",clientHeight=_this._.clientHeight):(vScroll._set("value",0),vScroll._set("total",0)),vEnable!==shouldEnable&&(vEnable=shouldEnable,first||computeH())},computeH=function(){var realClientWidth=clientWidth-(vEnable?vScroll._.offsetWidth:0),shouldEnable=!_this.get("autoWidth")&&_this._contentWidth>realClientWidth;shouldEnable?($(hScroll._).removeClass("tui-hidden"),hScroll._.style.width=realClientWidth+"px",hScroll._set("total",_this._contentWidth-realClientWidth),_this._contentWidth>0?hScroll.set("page",realClientWidth/_this._contentWidth*(_this._contentWidth-realClientWidth)):hScroll.set("page",1)):(hScroll._set("total",0),hScroll.set("value",0)),hEnable!==shouldEnable&&(hEnable=shouldEnable,computeV(!1))};computeV(!0),computeH(),this.get("header")?(head.style.display="block",width=(width=vEnable?clientWidth-vScroll._.offsetWidth:clientWidth)>=0?width:0,head.style.width=width+"px"):head.style.display="none";var width=vEnable?clientWidth-vScroll._.offsetWidth:clientWidth;width=width>=0?width:0,content.style.width=width+"px";var dispHeight=hEnable?clientHeight-hScroll._.offsetHeight:clientHeight;dispHeight=dispHeight>=0?dispHeight:0,content.style.height=dispHeight+"px",this._dispLines=Math.ceil((dispHeight-(this.get("header")?lineHeight:0))/lineHeight)},Grid.prototype.drawLine=function(line,index,lineHeight,columns,lineData){var isTree="tree"===this.get("dataType"),item=lineData?isTree?lineData.item:lineData:[],tipKey=this.get("rowTooltipKey");if(item[tipKey]&&line.setAttribute("tooltip",item[tipKey]),line.style.height=lineHeight+"px",line.style.lineHeight=lineHeight+"px",line.childNodes.length!=columns.length){line.innerHTML="";for(i=0;i<columns.length;i++){var span=tui.elem("span");span.className="tui-grid-"+this._tuid+"-"+i,span.setAttribute("unselectable","on"),span.col=i,line.appendChild(span)}}for(var i=0;i<columns.length;i++){var col=columns[i],prefix="";if(!0===col.arrow&&isTree){for(var j=0;j<lineData.level;j++)prefix+="<i class='tui-space'></i>";lineData.hasChild?lineData.expand?prefix+="<i class='tui-arrow-expand'></i>":prefix+="<i class='tui-arrow-collapse'></i>":prefix+="<i class='tui-arrow'></i>"}if("check"===col.type)!0===item[k=col.checkKey?col.checkKey:"checked"]?prefix+="<i class='fa fa-check-square tui-grid-check tui-checked'></i>":!1===item[k]?prefix+="<i class='fa fa-square-o tui-grid-check tui-unchecked'></i>":prefix+="<i class='tui-grid-no-check'></i>";else if("tristate"===col.type){var k=col.checkKey?col.checkKey:"checked";!0===item[k]?prefix+="<i class='fa-check-square tui-grid-check tui-checked'></i>":!1===item[k]?prefix+="<i class='fa-square-o tui-grid-check tui-unchecked'></i>":"tristate"===item[k]?prefix+="<i class='fa-check-square tui-grid-check tui-tristate'></i>":prefix+="<i class='tui-grid-no-check'></i>"}else"select"===col.type?prefix+="<i class='fa fa-caret-down tui-grid-select'></i>":"edit"===col.type&&(prefix+="<i class='fa fa-edit tui-grid-edit'></i>");col.iconKey&&item[col.iconKey]&&(prefix+="<i class='fa "+item[col.iconKey]+" tui-grid-icon'></i>");var cell=line.childNodes[i];cell.style.height=lineHeight+"px",cell.style.lineHeight=lineHeight+"px",tui.browser.setInnerHtml(cell,prefix);var prefixContent=null!==columns[i].prefixKey?item[columns[i].prefixKey]:null;if(prefixContent){var prefixSpan=tui.elem("span");tui.browser.setInnerHtml(prefixSpan,prefixContent),cell.appendChild(prefixSpan)}var txt=item[columns[i].key];if("function"==typeof columns[i].translator){var el=columns[i].translator(txt,item,index,line);el&&cell.appendChild(el)}else cell.appendChild(document.createTextNode(null===txt||txt===undefined?"":txt));var suffixContent=null!==columns[i].suffixKey?item[columns[i].suffixKey]:null;if(suffixContent){var suffixSpan=tui.elem("span");tui.browser.setInnerHtml(suffixSpan,suffixContent),cell.appendChild(suffixSpan)}}},Grid.prototype.moveLine=function(line,index,base,lineHeight){line.style.top=base+index*lineHeight+"px",line.style.width=this._contentWidth+"px"},Grid.prototype.createLine=function(parent){var line=tui.elem("div");return line.className="tui-grid-line",line.setAttribute("unselectable","on"),parent.appendChild(line)},Grid.prototype.clearBuffer=function(){if(this._buffer){for(var content=this._components.content,i=0;i<this._buffer.lines.length;i++)content.removeChild(this._buffer.lines[i]);this._buffer.begin=0,this._buffer.end=0,this._buffer.lines=[]}},Grid.prototype.drawHeader=function(){if(this.get("header")){var head=this._components.head;head.innerHTML="";for(var columns=this.get("columns"),i=0;i<columns.length;i++){var prefix=void 0,sortClass="";"checked"===columns[i].checkCol?prefix="<i class='fa fa-check-square tui-grid-check'></i>":"unchecked"===columns[i].checkCol?prefix="<i class='fa fa-square-o tui-grid-check tui-unchecked'></i>":"tristate"===columns[i].checkCol?prefix="<i class='fa fa-check-square tui-grid-check tui-unchecked'></i>":(prefix="<i class='tui-grid-no-sort'></i>",columns[i].sortable&&(prefix="<i class='tui-grid-sortable'></i>",this.get("sortColumn")==i&&("desc"===this.get("sortType")?(prefix="<i class='tui-grid-desc'></i>",sortClass="tui-desc"):(prefix="<i class='tui-grid-asc'></i>",sortClass="tui-asc")),sortClass+=" tui-sortable"));var span=tui.elem("span");span.setAttribute("unselectable","on"),span.className="tui-grid-"+this._tuid+"-"+i+" "+sortClass,span.col=i,head.appendChild(span),tui.browser.setInnerHtml(span,prefix);var txt=columns[i].name;span.appendChild(document.createTextNode(null===txt||txt===undefined?"":txt))}}},Grid.prototype.drawContent=function(){for(var _this=this,vbar=widget.get(this._components.vScroll),content=this._components.content,lineHeight=this.get("lineHeight"),base=(this.get("header")?lineHeight:0)-vbar.get("value")%lineHeight,begin=Math.floor(vbar.get("value")/lineHeight),end=begin+this._dispLines+1,data=this.get("data"),columns=this.get("columns"),length=data.length(),newBuffer=[],reusable=[],i=this._buffer.begin;i<this._buffer.end;i++)(i<begin||i>=end||i>=length)&&reusable.push(this._buffer.lines[i-this._buffer.begin]);var activeRow=this.get("activeRow");null===activeRow&&this._set("activeRow",null);for(i=begin;i<end&&i<length;i++){var line;i>=this._buffer.begin&&i<this._buffer.end?line=this._buffer.lines[i-this._buffer.begin]:(reusable.length>0?((line=reusable.pop()).innerHTML="",line.removeAttribute("tooltip")):line=this.createLine(content),i===activeRow?$(line).addClass("tui-actived"):$(line).removeClass("tui-actived")),this.moveLine(line,i-begin,base,lineHeight),newBuffer.push(line)}for(i=0;i<reusable.length;i++)content.removeChild(reusable[i]);this._buffer.lines=newBuffer,this._buffer.begin=begin,this._buffer.end=this._buffer.begin+this._buffer.lines.length;var drawRoutine=function(){for(var begin=Math.floor(vbar.get("value")/lineHeight),end=begin+_this._dispLines+1,i=_this._buffer.begin;i<_this._buffer.end;i++)i>=begin&&i<end&&_this.drawLine(_this._buffer.lines[i-_this._buffer.begin],i,_this.get("lineHeight"),columns,data.get(i));_this._drawTimer=null};data instanceof tui.ds.RemoteList?(clearTimeout(this._drawTimer),this._drawTimer=setTimeout(drawRoutine,32)):drawRoutine()},Grid.prototype.initColumnWidth=function(){for(var columns=this.get("columns"),i=0;i<columns.length;i++)("number"!=typeof this._columnWidths[i]||isNaN(this._columnWidths[i]))&&("number"!=typeof columns[i].width||isNaN(columns[i].width)?this._columnWidths[i]=150:this._columnWidths[i]=columns[i].width),this._columnWidths[i]<0&&(this._columnWidths[i]=0)},Grid.prototype.computeHOffset=function(){var head=this._components.head,content=this._components.content,scrollLeft=this._hbar.get("value"),columns=this.get("columns");try{head.scrollLeft=scrollLeft,content.scrollLeft=scrollLeft}catch(e){}for(var used=0,i=0;i<columns.length;i++)this._vLines[i].style.left=used+vval(columns[i].width)+2*Grid.CELL_SPACE-scrollLeft+"px",used+=vval(columns[i].width)+2*Grid.CELL_SPACE;if(this.get("header")){used=0;for(i=0;i<columns.length;i++)this._handlers[i].style.left=used+vval(columns[i].width)+Grid.CELL_SPACE-this._hbar.get("value")+"px",used+=vval(columns[i].width)+2*Grid.CELL_SPACE}},Grid.prototype.computeColumnWidth=function(){var columns=this.get("columns");if(this.get("autoWidth")){for(var totalNoFixed=this._contentWidth-2*Grid.CELL_SPACE*columns.length,totalCompute=0,i=0;i<columns.length;i++)columns[i].fixed?totalNoFixed-=this._columnWidths[i]:totalCompute+=this._columnWidths[i];for(i=0;i<columns.length;i++)columns[i].fixed||(this._columnWidths[i]=totalCompute<=0?NaN:1*this._columnWidths[i]/totalCompute*totalNoFixed)}for(i=0;i<this._columnWidths.length;i++){var val=Math.round(this._columnWidths[i]);!isNaN(val)&&val>0&&(columns[i].width=val)}for(i=0;i<this._vLines.length;i++)this._vLines[i].parentNode&&this._.removeChild(this._vLines[i]);for(var used=0,i=0;i<columns.length;i++)i>=this._vLines.length&&(this._vLines[i]=tui.elem("div"),this._vLines[i].className="tui-grid-vline"),this._vLines[i].style.left=used+vval(columns[i].width)+2*Grid.CELL_SPACE-this._hbar.get("value")+"px",used+=vval(columns[i].width)+2*Grid.CELL_SPACE,this._vLines[i].style.height=Math.min(this._contentHeight,this._.clientHeight)+"px",this._.appendChild(this._vLines[i]);for(i=0;i<this._handlers.length;i++)this._handlers[i].parentNode&&this._.removeChild(this._handlers[i]);if(this.get("header")){used=0;for(i=0;i<columns.length;i++)i>=this._handlers.length&&(this._handlers[i]=tui.elem("div"),this._handlers[i].className="tui-grid-handler"),this._handlers[i].style.left=used+vval(columns[i].width)+Grid.CELL_SPACE-this._hbar.get("value")+"px",columns[i].fixed?this._handlers[i].style.display="none":this._handlers[i].style.display="",used+=vval(columns[i].width)+2*Grid.CELL_SPACE,this._.appendChild(this._handlers[i])}for(var cssText="",i_5=0;i_5<columns.length;i_5++)cssText+=".tui-grid-"+this._tuid+"-"+i_5+"{width:"+vval(columns[i_5].width)+"px; text-align: "+getAlignText(columns[i_5].align)+"}";document.createStyleSheet?this._gridStyle.cssText=cssText:this._gridStyle.innerHTML=cssText;for(var i_6=0;i_6<this._buffer.lines.length;i_6++)this._buffer.lines[i_6].style.width=this._contentWidth+"px"},Grid.prototype.render=function(){this.initColumnWidth(),this.computeScroll(),this.computeColumnWidth(),this.drawHeader(),this.drawContent(),this.computeHOffset(),this.get("disable")?this.addClass("tui-disable"):this.removeClass("tui-disable")},Grid.CELL_SPACE=4,Grid.LINE_HEIGHT=31,Grid}(widget.Widget);widget.Grid=Grid,widget.register(Grid,"grid"),widget.registerResize("grid");var List=function(_super){function List(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(List,_super),List.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this._column={name:"",key:"name",checkKey:"check",iconKey:"icon",prefixKey:"prefix",suffixKey:"suffix",arrow:!0},this.setRestrictions({lineHeight:{get:function(){var val=_this._data.lineHeight;return"number"!=typeof val||isNaN(val)?List.LINE_HEIGHT:val}},columns:{set:function(value){},get:function(){return[_this._column]}},checkKey:{set:function(value){_this._column.checkKey=value,_this.clearBuffer()},get:function(){return _this._column.checkKey}},nameKey:{set:function(value){_this._column.key=value,_this.clearBuffer()},get:function(){return _this._column.key}},textKey:{set:function(value){_this._set("nameKey",value)},get:function(){return _this.get("nameKey")}},iconKey:{set:function(value){_this._column.iconKey=value,_this.clearBuffer()},get:function(){return _this._column.iconKey}},prefixKey:{set:function(value){_this._column.prefixKey=value,_this.clearBuffer()},get:function(){return _this._column.prefixKey}},suffixKey:{set:function(value){_this._column.suffixKey=value,_this.clearBuffer()},get:function(){return _this._column.suffixKey}},checkable:{set:function(value){_this._column.type=value?"check":null,_this.clearBuffer()},get:function(){return"check"===_this._column.type}},checkedValues:{set:function(value){var valueKey=_this.get("valueKey"),checkKey=_this.get("checkKey");null===value&&(value=[]),value instanceof Array||(value=[value]),_this.iterate(function(item,path,treeNode){return"boolean"==typeof item[checkKey]&&(value.indexOf(item[valueKey])>=0?item[checkKey]=!0:item[checkKey]=!1),!0})},get:function(){var value=[],valueKey=_this.get("valueKey"),checkKey=_this.get("checkKey");return _this.iterate(function(item,path){return!0===item[checkKey]&&value.push(item[valueKey]),!0}),value}},checkedItems:{set:function(value){},get:function(){var items=[],checkKey=_this.get("checkKey");return _this.iterate(function(item,path){return!0===item[checkKey]&&items.push(item),!0}),items}}})},List.prototype.init=function(){_super.prototype.init.call(this),this._set("header",!1),this.setInit("autoWidth",!0),this.setInit("valueKey","value")},List.prototype.selectAll=function(){var checkKey=this.get("checkKey");this.iterate(function(item,path){return"boolean"==typeof item[checkKey]&&(item[checkKey]=!0),!0}),this.render()},List.prototype.deselectAll=function(){var checkKey=this.get("checkKey");this.iterate(function(item,path){return"boolean"==typeof item[checkKey]&&(item[checkKey]=!1),!0}),this.render()},List.LINE_HEIGHT=30,List}(Grid);widget.List=List,widget.register(List,"list"),widget.registerResize("list")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Input=function(_super){function Input(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Input,_super),Input.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this);var textbox=this._components.textbox=tui.elem("input");this.setRestrictions({value:{set:function(value){textbox.value=null!=value?value:"",_this._isEmpty=""===textbox.value},get:function(){return textbox.value}},text:{set:function(value){_this._set("value",value)},get:function(){return _this.get("value")}},maxLength:{set:function(value){"number"==typeof value&&value>=0&&(textbox.maxLength=value)},get:function(){return textbox.maxLength}},type:{set:function(value){value=value.toLowerCase(),["text","password","email","url","number","search","tel","color","date","datetime","month","week","time","datetime-local"].indexOf(value)<0||(textbox.type=value)},get:function(){return textbox.type}}})},Input.prototype.onInput=function(textbox,e){this.updateEmptyState(""===textbox.value),this.reset(),this.fire("input",e)},Input.prototype.init=function(){var _this=this,$root=$(this._),placeholder=this._components.placeholder=tui.elem("span"),textbox=this._components.textbox,iconLeft=this._components.iconLeft=tui.elem("i"),iconRight=this._components.iconRight=tui.elem("i"),iconInvalid=this._components.iconInvalid=tui.elem("i"),clearButton=this._components.clearButton=tui.elem("i");iconInvalid.className="tui-invalid-icon",clearButton.className="tui-input-clear-button",placeholder.className="tui-placeholder",placeholder.setAttribute("unselectable","on"),this._.appendChild(placeholder),this._.appendChild(iconLeft),this._.appendChild(textbox),this._.appendChild(iconInvalid),this._.appendChild(iconRight),this._.appendChild(clearButton),$(textbox).focus(function(){$root.addClass("tui-active"),_this.render()}),$(textbox).blur(function(){$root.removeClass("tui-active"),_this.render(),_this.get("disable")||_this.get("autoValidate")&&_this.validate()}),tui.ieVer>0&&tui.ieVer<9?$(textbox).on("propertychange",function(e){"value"===e.originalEvent.propertyName&&_this.onInput(textbox,e)}):(9===tui.ieVer&&$(textbox).on("keyup",function(e){(e.keyCode=tui.browser.KeyCode.BACK)&&_this.onInput(textbox,e)}),$(textbox).on("input",function(e){_this.onInput(textbox,e)})),$(textbox).on("keydown",function(e){e.keyCode===tui.browser.KeyCode.ENTER&&_this.fire("enter",e)}),$(textbox).on("change",function(e){_this.fire("change",e)}),$(clearButton).on("mousedown",function(e){_this.set("value",""),_this.reset(),_this.fire("change",e),_this.fire("clear",e),e.stopPropagation(),setTimeout(function(){textbox.focus()})}),$root.mousedown(function(e){if(!_this.get("disable")){var obj=e.target||e.srcElement;obj!==textbox&&(obj===iconLeft&&!1===_this.fire("left-icon-mousedown",e)||obj===iconRight&&!1===_this.fire("right-icon-mousedown",e)||setTimeout(function(){textbox.focus()}))}}),$root.mouseup(function(e){if(!_this.get("disable")){var obj=e.target||e.srcElement;obj!==textbox&&(obj===iconLeft&&!1===_this.fire("left-icon-mouseup",e)||obj!==iconRight||_this.fire("right-icon-mouseup",e))}}),$root.click(function(e){if(!_this.get("disable")){var obj=e.target||e.srcElement;obj!==textbox&&(obj===iconLeft&&_this.fire("left-icon-click",e),obj===iconRight&&_this.fire("right-icon-click",e))}}),this.on("resize",function(){_this.render()})},Input.prototype.focus=function(){this._components.textbox.focus()},Input.prototype.render=function(){try{this._.scrollLeft=0}catch(e){}var $root=$(this._),textbox=this._components.textbox,iconLeft=this._components.iconLeft,iconRight=this._components.iconRight,iconInvalid=this._components.iconInvalid,placeholder=this._components.placeholder,clearButton=this._components.clearButton;this.get("disable")?($root.addClass("tui-disable"),textbox.setAttribute("readonly","readonly")):($root.removeClass("tui-disable"),textbox.removeAttribute("readonly"));var marginLeft=0;this.get("iconLeft")?(iconLeft.className=this.get("iconLeft"),iconLeft.style.display="",iconLeft.style.left="0"):(iconLeft.className="",iconLeft.style.display="none",marginLeft=Input.PADDING);var marginRight=0;this.get("iconRight")?(iconRight.className=this.get("iconRight"),iconRight.style.display="",iconRight.style.right="0"):(iconRight.className="",iconRight.style.display="none",marginRight=Input.PADDING),this._valid?($root.removeClass("tui-invalid"),iconInvalid.style.display="none",0===marginRight&&(marginRight=Input.PADDING)):($root.addClass("tui-invalid"),iconInvalid.style.display="",iconInvalid.style.right=iconRight.offsetWidth+"px"),this.get("clearable")&&this.get("value").length>0&&$root.hasClass("tui-active")&&!this.get("disable")?(clearButton.style.display="",clearButton.style.right=iconRight.offsetWidth+iconInvalid.offsetWidth+"px"):clearButton.style.display="none",textbox.style.left=iconLeft.offsetWidth+marginLeft+"px";var width=this._.clientWidth-iconLeft.offsetWidth-iconInvalid.offsetWidth-iconRight.offsetWidth-clearButton.offsetWidth-marginLeft-marginRight;width<0&&(width=0),textbox.style.width=width+"px";var phText=this.get("placeholder");phText&&!this.get("value")?($(placeholder).text(phText),placeholder.style.left=iconLeft.offsetWidth+marginLeft+"px",placeholder.style.width=textbox.style.width,placeholder.style.display=""):placeholder.style.display="none",!this._valid&&this._invalidMessage?this._set("follow-tooltip",this._invalidMessage):this._set("follow-tooltip",null)},Input.PADDING=6,Input}(widget.InputBase);widget.Input=Input,widget.register(Input,"input"),widget.registerResize("input")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function findPopupToClose(bindElem){var index=0;if(bindElem&&bindElem.nodeName)for(var i=0;i<widget.popStack.length;i++){var item=widget.popStack[i];if(tui.browser.isAncestry(bindElem,item._)){index=i+1;break}}index<widget.popStack.length&&widget.popStack[index].close()}widget.popStack=[],setInterval(function(){findPopupToClose(document.activeElement)},50),$(window).on("mousedown",function(){widget.popStack[0]&&widget.popStack[0].close()});var Popup=function(_super){function Popup(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.popIndex=null,_this.referRect=null,_this.checkInterval=null,_this.refProc=function(){_this.render()},_this}return __extends(Popup,_super),Popup.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this.setRestrictions({content:{set:function(value){_this._data.content=value,"string"==typeof value?_this._.innerHTML=value:value&&value.nodeName&&_this._.appendChild(value)}}})},Popup.prototype.initChildren=function(childNodes){if(childNodes.length>0){for(var div=tui.elem("div"),_i=0,childNodes_5=childNodes;_i<childNodes_5.length;_i++){var node=childNodes_5[_i];div.appendChild(node)}this._set("content",div)}},Popup.prototype.init=function(){var _this=this,$root=$(this._);$root.attr("tabIndex","-1"),$root.css("display","none");var content=this.get("content");"string"==typeof content?$root.html(content):content&&content.nodeName&&$root.append(content),widget.init(this._),tui.browser.removeNode(this._),$root.keydown(function(e){e.keyCode===tui.browser.KeyCode.ESCAPE&&(_this.close(),_this.get("referElement")&&_this.get("referElement").focus())}),$(this._).mousedown(function(e){e.stopImmediatePropagation()})},Popup.prototype.open=function(refer,direction){var _this=this;if(!this.get("opened")){if("string"==typeof refer&&(refer=document.getElementById(refer)),typeof direction===tui.UNDEFINED&&(direction="Lb"),"string"!=typeof direction||!/^[lLrR][tTbB]$/.test(direction))throw new SyntaxError("Invalid popup direction value");if("object"==typeof refer&&refer.nodeName)this._set("referElement",refer),findPopupToClose(refer),this.referRect=tui.browser.getRectOfScreen(refer),this.checkInterval=setInterval(function(){var newRect=tui.browser.getRectOfScreen(refer);newRect.left===_this.referRect.left&&newRect.top===_this.referRect.top&&newRect.width===_this.referRect.width&&newRect.height===_this.referRect.height||(_this.referRect=newRect,_this.render())},16),$(window).on("resize scroll",this.refProc);else{if("object"!=typeof refer||"number"!=typeof refer.left||"number"!=typeof refer.top)throw new SyntaxError("Invalid popup refer value, must be an element or position");this._set("referPos",refer),findPopupToClose()}this.popIndex=widget.popStack.push(this)-1,this._set("direction",direction),this._set("opened",!0),$(this._).css({display:"block",position:"fixed"}),this.appendTo(document.body),widget.init(this._),this.render(),this._.focus(),this.fire("open")}},Popup.prototype.closeSelf=function(){tui.browser.removeNode(this._),this._set("opened",!1),null!=this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),$(window).off("resize scroll",this.refProc),this.fire("close")},Popup.prototype.close=function(){if(this.get("opened")){for(var i=this.popIndex;i<widget.popStack.length;i++)widget.popStack[i].closeSelf();widget.popStack.splice(this.popIndex,widget.popStack.length-this.popIndex+1)}},Popup.prototype.render=function(){if(this.get("opened")){var root=this._,ww=$(window).width(),wh=$(window).height();root.style.left="0px",root.style.top="0px",root.style.width="",root.style.width=root.clientWidth+1+"px";var ew=root.offsetWidth,eh=root.offsetHeight,box={left:0,top:0,width:0,height:0},pos={left:0,top:0};this.get("referPos")?((box=this.get("referPos")).width=0,box.height=0):this.get("referElement")&&(box=tui.browser.getRectOfScreen(this.get("referElement")));var compute={l:function(){pos.left=box.left-ew,pos.left<2&&(pos.left=box.left+box.width)},r:function(){pos.left=box.left+box.width,pos.left+ew>ww-2&&(pos.left=box.left-ew)},t:function(){pos.top=box.top-eh,pos.top<2&&(pos.top=box.top+box.height)},b:function(){pos.top=box.top+box.height,pos.top+eh>wh-2&&(pos.top=box.top-eh)},L:function(){pos.left=box.left,pos.left+ew>ww-2&&(pos.left=box.left+box.width-ew)},R:function(){pos.left=box.left+box.width-ew,pos.left<2&&(pos.left=box.left)},T:function(){pos.top=box.top,pos.top+eh>wh-2&&(pos.top=box.top+box.height-eh)},B:function(){pos.top=box.top+box.height-eh,pos.top<2&&(pos.top=box.top)}},direction=this.get("direction");compute[direction.substring(0,1)](),compute[direction.substring(1,2)](),pos.left>ww-2&&(pos.left=ww-2),pos.left<2&&(pos.left=2),pos.top>wh-2&&(pos.top=wh-2),pos.top<2&&(pos.top=2),root.style.left=pos.left+"px",root.style.top=pos.top+"px"}},Popup}(widget.Widget);widget.Popup=Popup,widget.register(Popup,"popup")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Menu=function(_super){function Menu(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.activeItem=null,_this}return __extends(Menu,_super),Menu.prototype.initChildren=function(childNodes){function hasChildItem(node){for(var i=0;i<node.childNodes.length;i++){var child=node.childNodes[i];if("tui:item"===widget.getFullName(child))return!0}return!1}function addChild(node,items){var item=new widget.Item(node),text=item.get("text");null===text&&(text=$.trim(tui.browser.getNodeOwnText(node)));var menuItem={text:text},type=item.get("type");type&&/^(button|check|radio|menu|line)$/.test(type)&&(menuItem.type=type),!hasChildItem(node)||typeof menuItem.type!==tui.UNDEFINED&&null!==menuItem.type||(menuItem.type="menu");var icon=item.get("icon");"string"==typeof icon&&icon.trim().length>0&&(menuItem.icon=icon);var shortcut=item.get("shortcut");"string"==typeof shortcut&&shortcut.trim().length>0&&(menuItem.shortcut=shortcut);var checked=item.get("checked");"boolean"==typeof checked&&(menuItem.checked=checked);var disable=item.get("disable");if("boolean"==typeof disable&&(menuItem.disable=disable),"radio"===menuItem.type){var group=item.get("group");"string"==typeof group&&group.length>0?menuItem.group=group:menuItem.group=""}var value=item.get("value");null!==value&&typeof value!==tui.UNDEFINED&&(menuItem.value=value),"menu"===menuItem.type&&(menuItem.children=[],addChildren(node.childNodes,menuItem.children)),items.push(menuItem)}function addChildren(childNodes,items){for(var i=0;i<childNodes.length;i++){var node=childNodes[i];"tui:item"===widget.getFullName(node)&&addChild(node,items)}}var data=[];addChildren(childNodes,data),data.length>0&&this._set("items",data)},Menu.prototype.open=function(refer,direction){var data=this.get("items");null==data&&(data=[]),this._.innerHTML="";for(var _i=0,data_1=data;_i<data_1.length;_i++){var item=data_1[_i],div=void 0;"line"!==item.type?(div=tui.browser.toElement("<div tabIndex='-1' unselectable='on'><span class='tui-icon'></span><span class='tui-arrow'></span><span class='tui-label'></span><span class='tui-shortcut'></span></div>"),item.disable&&$(div).addClass("tui-disabled"),"check"===item.type?item.checked&&$(div).children(".tui-icon").addClass("fa-check"):"radio"===item.type?item.checked&&$(div).children(".tui-icon").addClass("radio-checked"):item.icon&&$(div).children(".tui-icon").addClass(item.icon),$(div).children(".tui-label").text(item.text),"string"==typeof item.shortcut&&$(div).children(".tui-shortcut").text(item.shortcut),"menu"===item.type&&$(div).children(".tui-arrow").addClass("fa-caret-right"),item.disable&&$(div).addClass("tui-disabled")):div=tui.browser.toElement("<div class='tui-line'></div>"),this._.appendChild(div)}_super.prototype.open.call(this,refer,direction),null!=this.activeItem&&($(this._).children("div").removeClass("tui-active"),this.activeItem=null)},Menu.prototype.init=function(){function findMenuItemDiv(elem){for(var children=$root.children("div"),i=0;i<children.length;i++){var div=children[i];if("number"==typeof elem&&elem===i||"object"==typeof elem&&tui.browser.isAncestry(elem,div))return div}return null}function findDivIndex(elem){for(var children=$root.children("div"),i=0;i<children.length;i++)if(children[i]===elem)return i;return null}function activeLine(index){var div=findMenuItemDiv(index);$(div).addClass("tui-actived"),ie8hack(div,index)}function deactiveLine(index){var div=findMenuItemDiv(index);$(div).removeClass("tui-actived"),ie8hack(div,index)}var _this=this,$root=$(this._);$root.attr("tabIndex","-1"),$root.css("display","none"),tui.browser.removeNode(this._),$(this._).mousedown(function(e){e.stopImmediatePropagation()});var ie8hack=function(div,index){if(tui.ieVer>=7&&tui.ieVer<9){var item=_this.get("items")[index],icon=$(div).children(".tui-icon")[0];if("check"===item.type||"radio"===item.type?item.checked&&($(icon).removeClass("fa-check"),setTimeout(function(){$(icon).addClass("fa-check")})):item.icon&&($(icon).removeClass(item.icon),setTimeout(function(){$(icon).addClass(item.icon)})),"menu"===item.type){var arrow=$(div).children(".tui-arrow")[0];$(arrow).removeClass("fa-caret-right"),setTimeout(function(){$(arrow).addClass("fa-caret-right")})}}};$root.mousemove(function(e){var div=findMenuItemDiv(e.target||e.srcElement);if(null!==div){var found=findDivIndex(div);if(found!==_this.activeItem){if(null!==_this.activeItem&&deactiveLine(_this.activeItem),$(div).hasClass("tui-disabled"))return clearTimeout(openSubMenuTimer),_this.activeItem=null,void _this._.focus();_this.activeItem=found,activeLine(_this.activeItem),$(div).hasClass("tui-sub")||(_this._.focus(),openSubMenu())}}}),$root.on("touchstart",function(e){var div=findMenuItemDiv(e.target||e.srcElement);if(null!==div){var found=findDivIndex(div);if(found!==_this.activeItem){if(null!==_this.activeItem&&deactiveLine(_this.activeItem),$(div).hasClass("tui-disabled"))return clearTimeout(openSubMenuTimer),_this.activeItem=null,void _this._.focus();if(_this.activeItem=found,activeLine(_this.activeItem),null!==_this.activeItem){var item=_this.get("items")[_this.activeItem];item.children&&item.children.length>0&&(_this._.focus(),openSubMenu(),e.preventDefault())}}}}),$root.mouseleave(function(e){null!=_this.activeItem&&(deactiveLine(_this.activeItem),_this.activeItem=null),clearTimeout(openSubMenuTimer)}),$root.click(function(e){if(null!=_this.activeItem){var data=_this.get("items"),item=data[_this.activeItem];if("check"===item.type)item.checked=!item.checked;else if("radio"===item.type){if("string"==typeof item.group)for(var _i=0,data_2=data;_i<data_2.length;_i++){var it=data_2[_i];"radio"===it.type&&it.group==item.group&&(it.checked=!1)}item.checked=!0}item.children&&0!=item.children.length||(_this.fire("click",{e:e,item:item}),_this.close())}});var findItem=function(from,step){for(var data=_this.get("items"),i=from;i<data.length&&i>=0;i+=step)if("line"!==data[i].type&&!data[i].disable)return i;return null};$root.keydown(function(e){function stopEvent(){e.stopPropagation(),e.preventDefault()}var c=e.keyCode,data=_this.get("items");if(c===tui.browser.KeyCode.ESCAPE)stopEvent(),_this.close(),_this.get("referElement")&&_this.get("referElement").focus();else if(c===tui.browser.KeyCode.LEFT){if(stopEvent(),widget.popStack.length<2||!(widget.popStack[widget.popStack.length-2]instanceof Menu))return;widget.popStack[widget.popStack.length-2]._.focus()}if(0!==data.length){if(c===tui.browser.KeyCode.DOWN||c===tui.browser.KeyCode.TAB)stopEvent(),null===_this.activeItem?_this.activeItem=findItem(0,1):(deactiveLine(_this.activeItem),_this.activeItem=findItem(_this.activeItem+1,1),null===_this.activeItem&&(_this.activeItem=0)),activeLine(_this.activeItem);else if(c===tui.browser.KeyCode.UP)stopEvent(),null===_this.activeItem?_this.activeItem=findItem(data.length-1,-1):(deactiveLine(_this.activeItem),_this.activeItem=findItem(_this.activeItem-1,-1),null===_this.activeItem&&(_this.activeItem=data.length-1)),activeLine(_this.activeItem);else if(c===tui.browser.KeyCode.RIGHT)stopEvent(),openSubMenu();else if(c===tui.browser.KeyCode.ENTER&&(stopEvent(),null!==_this.activeItem)){var item=data[_this.activeItem];_this.fire("click",{e:e,item:item}),_this.close()}}else _this.activeItem=null});var openSubMenuTimer=null,openSubMenu=function(){var data=_this.get("items");if(null!==_this.activeItem){clearTimeout(openSubMenuTimer);var item=data[_this.activeItem];if("menu"!==item.type)return;var div_1=findMenuItemDiv(_this.activeItem);if($(div_1).hasClass("tui-sub"))return;var itemIndex_1=_this.activeItem;openSubMenuTimer=setTimeout(function(){var childItems=item.children,subMenu=widget.create("menu",{items:childItems});$(_this._).hasClass("tui-big")&&$(subMenu._).addClass("tui-big"),$(div_1).addClass("tui-sub"),ie8hack(div_1,itemIndex_1),subMenu.open(div_1,"rT"),subMenu.on("close",function(){$(div_1).removeClass("tui-sub"),ie8hack(div_1,itemIndex_1)}),subMenu.on("click",function(e){_this.fire("click",e.data),_this.close()})},200)}}},Menu}(widget.Popup);widget.Menu=Menu,widget.register(Menu,"menu")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Picture=function(_super){function Picture(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Picture,_super),Picture.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this._uploader=tui.browser.createUploader(this._),this.setRestrictions({action:{set:function(value){_this._uploader.getOptions().action=value},get:function(){return _this._uploader.getOptions().action}},accept:{set:function(value){_this._uploader.getOptions().accept=value,_this._uploader.getInput()&&(_this._uploader.deleteInput(),_this._uploader.createInput())},get:function(){return _this._uploader.getOptions().accept}}})},Picture.prototype.init=function(){var _this=this,img=this._components.image=tui.elem("img"),toolbar=this._components.toolbar=tui.elem("div");this._.appendChild(img),this._.appendChild(toolbar),this._uploader.on("success",function(e){_this.set("value",e.data.response),_this.fire("success",e)}),this._uploader.on("error",function(e){!1!==_this.fire("error",e)&&tui.errbox(e.data.response.error,tui.str("Error"))}),this.setInit("accept","image/png, image/jpeg, image/gif");var $root=$(this._);$root.on("dragenter",function(e){e.preventDefault(),e.stopPropagation(),_this._uploader.deleteInput(),$root.addClass("tui-drag-enter")}),$root.on("dragleave",function(e){e.preventDefault(),e.stopPropagation(),_this.get("disable")||_this._uploader.createInput(),$root.removeClass("tui-drag-enter")}),$root.on("dragover",function(e){e.preventDefault()}),$root.on("drop",function(e){e.preventDefault(),e.stopPropagation();var dts=e.originalEvent.dataTransfer;if(dts&&dts.files&&dts.files.length>0){var fileName=dts.files[0].name;/\.(jpg|jpeg|png|gif)$/i.test(fileName)?_this._uploader.uploadV5(fileName,dts.files[0]):tui.errbox(tui.str("invalid.file.type"))}_this.get("disable")||_this._uploader.createInput(),$root.removeClass("tui-drag-enter")}),$root.on("mouseenter mouseover",function(){if(!_this.get("disable")){var v=_this.get("value");v&&v.url&&tui.browser.addClass(toolbar,"tui-toolbar-show")}}),$root.on("mouseleave mouseout",function(){tui.browser.removeClass(toolbar,"tui-toolbar-show")}),$(toolbar).click(function(e){_this.get("disable")||(_this.set("value",null),tui.browser.removeClass(toolbar,"tui-toolbar-show"))})},Picture.prototype.render=function(){var $root=$(this._);this.get("disable")?(this._uploader.deleteInput(),this._.setAttribute("tabIndex","0")):(this._uploader.createInput(),this._.removeAttribute("tabIndex"));var v=this.get("value"),url=v&&v.url,img=this._components.image;url?($root.removeClass("tui-picture-empty"),url!==img.getAttribute("src")&&img.setAttribute("src",url)):$root.addClass("tui-picture-empty")},Picture}(widget.Widget);widget.Picture=Picture,widget.register(Picture,"picture")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Scrollbar=function(_super){function Scrollbar(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Scrollbar,_super),Scrollbar.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this),this.setRestrictions({total:{get:function(){var value=_this._data.total;return"number"!=typeof value||isNaN(value)||value<0?0:value},set:function(value){("number"!=typeof value||isNaN(value))&&(value=0),value<0&&(value=0),value=Math.round(value),_this._data.total=value,_this.get("value")>value&&_this._set("value",value),_this.get("page")>value&&_this._set("page",value)}},page:{get:function(){var value=_this._data.page;return"number"!=typeof value||isNaN(value)||value<1?1:value},set:function(value){("number"!=typeof value||isNaN(value))&&(value=1),(value=Math.round(value))<1&&(value=1),value>_this.get("total")&&(value=_this.get("total")),_this._data.page=value}},value:{get:function(){var value=_this._data.value;return"number"!=typeof value||isNaN(value)||value<0?0:value},set:function(value){("number"!=typeof value||isNaN(value))&&(value=0),(value=Math.round(value))<0&&(value=0),value>_this.get("total")&&(value=_this.get("total")),_this._data.value=value}},direction:{get:function(){var dir=_this._data.direction;return"vertical"!==dir&&"horizontal"!==dir?"vertical":dir},set:function(value){"vertical"!==value&&"horizontal"!==value||(_this._data.direction=value)}}})},Scrollbar.prototype.init=function(){var _this=this,root$=$(this._);this._.innerHTML="<span class='tui-scroll-thumb'></span>";var btnThumb=this._components.thumb=root$.children(".tui-scroll-thumb")[0];root$.attr("unselectable","on"),$(this._).mousedown(function(e){if(e.stopPropagation(),e.preventDefault(),(e.target||e.srcElement)===_this._&&!(_this.get("total")<=0)){var pos,thumbLen;"vertical"===_this.get("direction")?(pos="number"==typeof e.offsetY?e.offsetY:e.originalEvent.layerY,thumbLen=btnThumb.offsetHeight):(pos="number"==typeof e.offsetX?e.offsetX:e.originalEvent.layerX,thumbLen=btnThumb.offsetWidth);var v=_this.posToValue(pos-thumbLen/2);return _this.set("value",v),_this.fire("scroll",{e:e,value:_this.get("value"),type:"mousedown"}),!1}});var mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";$(this._).on(mousewheelevt,function(e){var ev=e.originalEvent,delta=ev.detail?-1*ev.detail:ev.wheelDelta,page=_this.get("page"),scrollSize=Math.round(page/2)>1?Math.round(page/2):1,oldValue=_this.get("value");delta<=-0?_this.set("value",oldValue+scrollSize):_this.set("value",oldValue-scrollSize),oldValue!==_this.get("value")&&_this.fire("scroll",{e:e,value:_this.get("value"),type:"mousewheel"}),e.stopPropagation(),e.preventDefault()});var beginX=0,beginY=0,beginLeft=0,beginTop=0,dragThumb=function(e){var pos,diff=0,oldValue=_this.get("value"),positions=tui.browser.getEventPosition(e);"vertical"===_this.get("direction")?(diff=positions[0].y-beginY,pos=beginTop+diff):(diff=positions[0].x-beginX,pos=beginLeft+diff),_this.set("value",_this.posToValue(pos)),oldValue!==_this.get("value")&&_this.fire("scroll",{e:e,value:_this.get("value"),type:"drag"})},dragEnd=function(e){$(_this._).removeClass("tui-actived"),_this.fire("dragend",{e:e,value:_this.get("value")})};$(btnThumb).on("mousedown touchstart",function(e){if(1===e.which||"touchstart"===e.type){var positions=tui.browser.getEventPosition(e);positions.length>1||(e.preventDefault(),beginX=positions[0].x,beginY=positions[0].y,beginLeft=btnThumb.offsetLeft,beginTop=btnThumb.offsetTop,$(_this._).addClass("tui-actived"),widget.openDragMask(dragThumb,dragEnd),_this.fire("dragstart",{e:e,value:_this.get("value")}))}}),this.on("resize",function(){_this.render()}),this.refresh()},Scrollbar.prototype.posToValue=function(pos){var btnThumb=this._components.thumb,total=this.get("total");if(total<=0)return 0;var len=0,val=0;return val="vertical"===this.get("direction")?(len=this._.clientHeight-btnThumb.offsetHeight)<=0?0:pos/len*total:(len=this._.clientWidth-btnThumb.offsetWidth)<=0?0:pos/len*total,val=Math.round(val)},Scrollbar.prototype.valueToPos=function(value){var total=this.get("total"),page=this.get("page"),vertical="vertical"===this.get("direction");if(total<=0)return{pos:0,thumbLen:0};var len=vertical?this._.clientHeight:this._.clientWidth,thumbLen=Math.round(page/total*len);thumbLen<20&&(thumbLen=20),thumbLen>len-10&&(thumbLen=len-10);var scale=value/total;return scale<0&&(scale=0),scale>1&&(scale=1),{pos:Math.round(scale*(len-thumbLen)),thumbLen:thumbLen}},Scrollbar.prototype.render=function(){var pos=this.valueToPos(this.get("value")),vertical="vertical"===this.get("direction"),btnThumb=this._components.thumb;vertical?($(this._).removeClass("tui-horizontal"),$(this._).addClass("tui-vertical"),btnThumb.style.height=(pos.thumbLen>0?pos.thumbLen:0)+"px",btnThumb.style.top=pos.pos+"px",btnThumb.style.left="",btnThumb.style.width=""):($(this._).addClass("tui-horizontal"),$(this._).removeClass("tui-vertical"),btnThumb.style.width=(pos.thumbLen>0?pos.thumbLen:0)+"px",btnThumb.style.left=pos.pos+"px",btnThumb.style.top="",btnThumb.style.height="")},Scrollbar}(widget.Widget);widget.Scrollbar=Scrollbar,widget.register(Scrollbar,"scrollbar"),widget.registerResize("scrollbar")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Select=function(_super){function Select(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Select,_super),Select.prototype.initRestriction=function(){var _this=this,list=widget.create("list");list._set("noMouseWheel",!0),list.set("lineHeight",Select.LIST_LINE_HEIGHT),this._components.list=list._,_super.prototype.initRestriction.call(this),this.setRestrictions({value:{set:function(value){_this._data.value=value,_this.updateTextByValue(list)}},data:{set:function(value){list.set("data",value),_this.updateTextByValue(list)},get:function(){return list.get("data")}},list:{set:function(value){list.set("list",value),_this.updateTextByValue(list)},get:function(){return list.get("list")}},tree:{set:function(value){list.set("tree",value),_this.updateTextByValue(list)},get:function(){return list.get("tree")}},activeRow:{set:function(value){list.set("activeRow",value),_this.updateTextByValue(list)},get:function(){return list.get("activeRow")}},selection:{set:function(value){},get:function(){return _this.getSelection(list)}},activeRowData:{set:function(value){},get:function(){return list.get("activeRowData")}},multiSelect:{set:function(value){list._set("checkable",value)},get:function(){return list.get("checkable")}},checkKey:{set:function(value){list._set("checkKey",value)},get:function(){return list.get("checkKey")}},nameKey:{set:function(value){list._set("nameKey",value)},get:function(){return list.get("nameKey")}},textKey:{set:function(value){list._set("nameKey",value)},get:function(){return list.get("nameKey")}},iconKey:{set:function(value){list._set("iconKey",value)},get:function(){return list.get("iconKey")}},valueKey:{set:function(value){list._set("valueKey",value)},get:function(){return list.get("valueKey")}},showCount:{get:function(){var count=_this._data.showCount;return"number"!=typeof count||isNaN(count)?8:count}},canSearch:{get:function(){var value=_this._data.canSearch;return typeof value!==tui.UNDEFINED&&null!==value&&!!value},set:function(value){_this._data.canSearch=!!value}}})},Select.prototype.changeSize=function(){var list=widget.get(this._components.list),popup=widget.get(this._components.popup),count=list.get("data").length();count>this.get("showCount")&&(count=this.get("showCount")),list._.style.height=count*Select.LIST_LINE_HEIGHT+"px",popup.render()},Select.prototype.getSelection=function(list){var textKey=this.get("textKey");null===textKey&&(textKey=this.get("nameKey"));var valueKey=this.get("valueKey"),val=this.get("value");if(null===val)return null;if(this.get("multiSelect")){val instanceof Array||(val=[val]);var selectedItems_1=[];return list.iterate(function(item,path,treeNode){var nodeValue=item[valueKey];return val.indexOf(nodeValue)>=0&&selectedItems_1.push(item),!0}),selectedItems_1}var selectedItem_1=null;return list.iterate(function(item,path,treeNode){return item[valueKey]!==val||(selectedItem_1=item,!1)}),selectedItem_1},Select.prototype.updateTextByValue=function(list){var textKey=this.get("textKey");null===textKey&&(textKey=this.get("nameKey"));var selected=this.getSelection(list);null==selected?(this._set("text",null),this._data.value=null):selected instanceof Array?this._set("text",selected.reduce(function(s,v,i){return i>0?s+", "+v[textKey]:v[textKey]},"")):this._set("text",selected[textKey])},Select.prototype.init=function(){var _this=this;_super.prototype.init.call(this),this.setInit("iconRight","fa-caret-down");var list=widget.get(this._components.list),container=tui.elem("div"),searchbar=container.appendChild(tui.elem("div"));searchbar.className="tui-select-searchbar";var searchBox=widget.create("input");searchBox._set("clearable",!0),searchBox._set("iconLeft","fa-search"),searchbar.appendChild(searchBox._),container.appendChild(list._);var toolbar=container.appendChild(tui.elem("div"));toolbar.className="tui-select-toolbar",toolbar.setAttribute("unselectable","on"),widget.get(this._components.popup)._set("content",container),this._components.searchbar=searchbar,this._components.toolbar=toolbar,this._components.searchBox=searchBox._,list._.style.width="inherit",list._.style.display="block",list._.style.borderWidth="0",list.on("expand collapse update",function(){_this.changeSize()}),list.on("rowclick keyselect",function(e){var rowData=list.get("activeRowData");_this.get("multiSelect")||(_this.set("value",rowData[list.get("valueKey")]),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),"rowclick"===e.event&&(_this.closeSelect(),_this._.focus(),_this.fire("click",{e:e,value:_this.get("value"),text:_this.get("text")})))}),searchBox.on("enter change",function(e){var searchValue=searchBox.get("value");null==searchValue||0==searchValue.length?list.get("data").setFilter(null):list.get("data").setFilter([{key:_this.get("nameKey"),value:searchValue}]),list._set("activeRow",null),list.scrollTo(0),_this.get("multiSelect")||null===_this.get("value")||list.activeTo(_this.get("valueKey"),_this.get("value"))}),$(toolbar).click(function(e){var name=(e.target||e.srcElement).getAttribute("name");"selectAll"===name?list.selectAll():"deselectAll"===name?list.deselectAll():"ok"===name?(_this.set("value",list.get("checkedValues")),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),_this.closeSelect(),_this._.focus(),_this.fire("click",{e:e,value:_this.get("value"),text:_this.get("text")})):"clear"===name&&(_this.set("value",null),_this.fire("change",{e:e,value:_this.get("value"),text:_this.get("text")}),_this.closeSelect(),_this._.focus(),_this.fire("click",{e:e,value:_this.get("value"),text:_this.get("text")}))})},Select.prototype.openSelect=function(){var _this=this,list=widget.get(this._components.list),popup=widget.get(this._components.popup),minWidth=this._.offsetWidth-2;minWidth<250&&(minWidth=250),popup._.style.minWidth=minWidth+"px";var toolbar=this._components.toolbar,searchbar=this._components.searchbar,searchBox=widget.get(this._components.searchBox);this.get("canSearch")?searchbar.style.display="block":searchbar.style.display="none";var checkButtons="<a name='selectAll'>"+tui.str("Select all")+"</a> | <a name='deselectAll'>"+tui.str("Deselect all")+"</a> | <a name='ok'>"+tui.str("OK")+"</a>",clearButton="<a name='clear'>"+tui.str("Clear")+"</a>",multiSelect=this.get("multiSelect"),clearable=!multiSelect&&this.get("clearable");toolbar.style.display="",multiSelect?toolbar.innerHTML=checkButtons:clearable?toolbar.innerHTML=clearButton:toolbar.style.display="none",popup.open(this._),setTimeout(function(){if(_this.get("canSearch")&&searchBox.render(),list._.focus(),list.render(),tui.ieVer>0&&tui.ieVer<=9&&setTimeout(function(){list.render()}),_this.get("multiSelect")){var value=_this.get("value");list.set("checkedValues",value)}else null!==_this.get("value")?list.activeTo(_this.get("valueKey"),_this.get("value")):(list._set("activeRow",null),list.scrollTo(0));_this.changeSize()})},Select.LIST_LINE_HEIGHT=28,Select}(widget.SelectPopupBase);widget.Select=Select,widget.register(Select,"select");var DialogSelect=function(_super){function DialogSelect(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DialogSelect,_super),DialogSelect.prototype.openSelect=function(){!1!==this.fire("open",this.dialog)&&(this.dialog._set("mobileModel",this.get("mobileModel")),this.dialog.set("title",this.get("title")),this.dialog.setContent(this.get("content")),this.dialog.open("ok#tui-primary"),this.fire("active",this.dialog))},DialogSelect.prototype.initChildren=function(childNodes){_super.prototype.initChildren.call(this,childNodes),this.dialog=widget.create("dialog");var content=tui.elem("div");childNodes.forEach(function(n){"tui:verify"!==widget.getFullName(n)&&content.appendChild(n)}),widget.init(content),this._set("content",content)},DialogSelect.prototype.createPopup=function(){var _this=this;return this.dialog.on("btnclick",function(e){!1!==_this.fire("select",e)&&_this.dialog.close()}),this.dialog},DialogSelect.prototype.init=function(){_super.prototype.init.call(this),this.setInit("iconRight","fa-pencil")},DialogSelect}(widget.SelectBase);widget.DialogSelect=DialogSelect,widget.register(DialogSelect,"dialog-select")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";var Textarea=function(_super){function Textarea(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Textarea,_super),Textarea.prototype.initRestriction=function(){var _this=this;_super.prototype.initRestriction.call(this);var textbox=this._components.textbox=tui.elem("textarea");textbox.setAttribute("wrap","physical"),this.setRestrictions({value:{set:function(value){textbox.value=null!=value?value:"",_this._isEmpty=""===textbox.value},get:function(){return textbox.value}},maxLength:{set:function(value){"number"==typeof value&&value>=0&&(textbox.maxLength=value)},get:function(){return textbox.maxLength}},text:{set:function(value){_this._set("value",value)},get:function(){return _this.get("value")}}})},Textarea.prototype.onInput=function(textbox,e){this.updateEmptyState(""===textbox.value);var oldHeight=tui.browser.getCurrentStyle(textbox).height;textbox.style.height="",this._valid&&textbox.scrollHeight!==this._lastTextHeight?this.render():textbox.style.height=oldHeight,this.reset(),this.fire("input",e)},Textarea.prototype.init=function(){var _this=this,$root=$(this._),placeholder=this._components.placeholder=tui.elem("span"),textbox=this._components.textbox,iconInvalid=this._components.iconInvalid=tui.elem("i");iconInvalid.className="tui-invalid-icon",placeholder.className="tui-placeholder",placeholder.setAttribute("unselectable","on"),this._.appendChild(placeholder),this._.appendChild(textbox),this._.appendChild(iconInvalid),$(textbox).focus(function(){$root.addClass("tui-active")}),$(textbox).blur(function(){$root.removeClass("tui-active"),_this.get("disable")||_this.get("autoValidate")&&_this.validate()}),tui.ieVer>0&&tui.ieVer<9?$(textbox).on("propertychange",function(e){"value"===e.originalEvent.propertyName&&_this.onInput(textbox,e)}):(9===tui.ieVer&&$(textbox).on("keyup",function(e){(e.keyCode=tui.browser.KeyCode.BACK)&&_this.onInput(textbox,e)}),$(textbox).on("input",function(e){_this.onInput(textbox,e)})),$(textbox).on("change",function(e){_this.fire("change",e)}),this.on("resize",function(){_this.render()})},Textarea.prototype.focus=function(){this._components.textbox.focus()},Textarea.prototype.render=function(){this._.scrollLeft=0;var $root=$(this._),textbox=this._components.textbox,iconInvalid=this._components.iconInvalid,placeholder=this._components.placeholder;this.get("disable")?($root.addClass("tui-disable"),textbox.setAttribute("readonly","readonly")):($root.removeClass("tui-disable"),textbox.removeAttribute("readonly"));var marginLeft=widget.Input.PADDING,marginRight=widget.Input.PADDING;this._valid?($root.removeClass("tui-invalid"),iconInvalid.style.display="none"):($root.addClass("tui-invalid"),iconInvalid.style.display="",iconInvalid.style.right="0px"),textbox.style.height="",this._lastTextHeight=textbox.scrollHeight,this._lastTextHeight<66&&(this._lastTextHeight=66),textbox.style.height=this._lastTextHeight+2+"px",this._.style.height=this._lastTextHeight+4+"px",textbox.style.left=marginLeft+"px";var width=this._.clientWidth-iconInvalid.offsetWidth-marginLeft-marginRight;width<0&&(width=0),textbox.style.width=width+"px";var phText=this.get("placeholder");phText&&!this.get("value")?($(placeholder).text(phText),placeholder.style.left=marginLeft+"px",placeholder.style.width=textbox.style.width,placeholder.style.display=""):placeholder.style.display="none",!this._valid&&this._invalidMessage?this._set("follow-tooltip",this._invalidMessage):this._set("follow-tooltip",null)},Textarea}(widget.InputBase);widget.Textarea=Textarea,widget.register(Textarea,"textarea"),widget.registerResize("textarea")}(tui.widget||(tui.widget={}))}(tui||(tui={}));var tui;!function(tui){!function(widget){"use strict";function showTooltip(target,tooltip,pos,update){function show(){pos.x+_tooltip.offsetWidth>$(window).width()&&(pos.x=$(window).width()-_tooltip.offsetWidth),_tooltip.style.left=pos.x+"px",_tooltip.style.top=pos.y+25+"px"}target!==_tooltipTarget&&target!==_tooltip?(_tooltip.style.width="",_tooltip.style.whiteSpace="nowrap",target.hasAttribute("html-tooltip")?_tooltip.innerHTML=tooltip:$(_tooltip).text(tooltip),document.body.appendChild(_tooltip),_tooltipTarget=target,_tooltip.scrollWidth>_tooltip.clientWidth?_tooltip.style.whiteSpace="normal":_tooltip.style.whiteSpace="nowrap",_tooltip.style.width=$(_tooltip).width()+"px",show()):update&&show()}function closeTooltip(){_tooltip.parentNode&&_tooltip.parentNode.removeChild(_tooltip),_tooltip.innerHTML="",_tooltip.style.width="",_tooltipTarget=null}function whetherShowTooltip(target,e){if(!tui.browser.isAncestry(target,_tooltip)){for(var obj=target;obj;){if(!obj.getAttribute){obj=null;break}var tooltip=obj.getAttribute("follow-tooltip");if(tooltip)return void showTooltip(obj,tooltip,{x:e.clientX,y:e.clientY},!0);if(tooltip=obj.getAttribute("tooltip"))return closeTooltip(),void(_tooltipTimer=setTimeout(function(){showTooltip(obj,tooltip,{x:e.clientX,y:e.clientY},!1)},500));obj=obj.parentElement}obj||closeTooltip()}}var _tooltip=tui.elem("span");_tooltip.className="tui-tooltip",_tooltip.setAttribute("unselectable","on");var _tooltipTarget=null;widget.showTooltip=showTooltip,widget.closeTooltip=closeTooltip;var _tooltipTimer=null;widget.whetherShowTooltip=whetherShowTooltip,widget.whetherCloseTooltip=function(target){target!==_tooltipTarget&&target!==_tooltip&&closeTooltip()};var _hoverElement;$(window.document).mousemove(function(e){clearTimeout(_tooltipTimer),_hoverElement=e.target||e.toElement,0!==e.button||1!==e.which&&0!==e.which||whetherShowTooltip(_hoverElement,e)}),$(window).scroll(function(){closeTooltip()})}(tui.widget||(tui.widget={}))}(tui||(tui={}));